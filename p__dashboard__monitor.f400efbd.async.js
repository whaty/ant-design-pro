(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"+K+b":function(Re,E,i){var T=i("JHRd");function m(X){var z=new X.constructor(X.byteLength);return new T(z).set(new T(X)),z}Re.exports=m},"+Qka":function(Re,E,i){var T=i("fmRc"),m=i("t2Dn"),X=i("cq/+"),z=i("T1AV"),o=i("GoyQ"),Z=i("mTTR"),D=i("itsj");function K(re,de,Y,Fe,Ze){if(re===de)return;X(de,function(ye,we){if(Ze||(Ze=new T),o(ye))z(re,de,we,Y,K,Fe,Ze);else{var pt=Fe?Fe(D(re,we),ye,we+"",re,de,Ze):void 0;pt===void 0&&(pt=ye),m(re,we,pt)}},Z)}Re.exports=K},"+VLl":function(Re,E,i){"use strict";i.d(E,"a",function(){return ye});var T=i("lSNA"),m=i.n(T),X=i("J4zp"),z=i.n(X),o=i("Hel2"),Z=Math.PI/3,D=[0,Z,2*Z,3*Z,4*Z,5*Z];function K(we){return we[0]}function re(we){return we[1]}var de=function(){var we=0,pt=0,je=1,Tt=1,Xe=K,gt=re,Je,Et,_t;function Ne(Ue){var st={},Le=[],ut,Vt=Ue.length;for(ut=0;ut<Vt;++ut){if(isNaN(ir=+Xe.call(null,Zt=Ue[ut],ut,Ue))||isNaN(oe=+gt.call(null,Zt,ut,Ue)))continue;var Zt,ir,oe,Q=Math.round(oe=oe/_t),H=Math.round(ir=ir/Et-(Q&1)/2),Ce=oe-Q;if(Math.abs(Ce)*3>1){var Ee=ir-H,Ae=H+(ir<H?-1:1)/2,ge=Q+(oe<Q?-1:1),rt=ir-Ae,Yt=oe-ge;Ee*Ee+Ce*Ce>rt*rt+Yt*Yt&&(H=Ae+(Q&1?1:-1)/2,Q=ge)}var At=H+"-"+Q,be=st[At];be?be.push(Zt):(Le.push(be=st[At]=[Zt]),be.x=(H+(Q&1)/2)*Et,be.y=Q*_t)}return Le}function ke(Ue){var st=0,Le=0;return D.map(function(ut){var Vt=Math.sin(ut)*Ue,Zt=-Math.cos(ut)*Ue,ir=Vt-st,oe=Zt-Le;return st=Vt,Le=Zt,[ir,oe]})}return Ne.hexagon=function(Ue){return"m"+ke(Ue==null?Je:+Ue).join("l")+"z"},Ne.centers=function(){for(var Ue=[],st=Math.round(pt/_t),Le=Math.round(we/Et),ut=st*_t;ut<Tt+Je;ut+=_t,++st)for(var Vt=Le*Et+(st&1)*Et/2;Vt<je+Et/2;Vt+=Et)Ue.push([Vt,ut]);return Ue},Ne.mesh=function(){var Ue=ke(Je).slice(0,4).join("l");return Ne.centers().map(function(st){return"M"+st+"m"+Ue}).join("")},Ne.x=function(Ue){return arguments.length?(Xe=Ue,Ne):Xe},Ne.y=function(Ue){return arguments.length?(gt=Ue,Ne):gt},Ne.radius=function(Ue){return arguments.length?(Je=+Ue,Et=Je*2*Math.sin(Z),_t=Je*1.5,Ne):Je},Ne.size=function(Ue){return arguments.length?(we=pt=0,je=+Ue[0],Tt=+Ue[1],Ne):[je-we,Tt-pt]},Ne.extent=function(Ue){return arguments.length?(we=+Ue[0][0],pt=+Ue[0][1],je=+Ue[1][0],Tt=+Ue[1][1],Ne):[[we,pt],[je,Tt]]},Ne.radius(1)};function Y(we,pt){var je=Object.keys(we);if(Object.getOwnPropertySymbols){var Tt=Object.getOwnPropertySymbols(we);pt&&(Tt=Tt.filter(function(Xe){return Object.getOwnPropertyDescriptor(we,Xe).enumerable})),je.push.apply(je,Tt)}return je}function Fe(we){for(var pt=1;pt<arguments.length;pt++){var je=arguments[pt]!=null?arguments[pt]:{};pt%2?Y(Object(je),!0).forEach(function(Tt){m()(we,Tt,je[Tt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(we,Object.getOwnPropertyDescriptors(je)):Y(Object(je)).forEach(function(Tt){Object.defineProperty(we,Tt,Object.getOwnPropertyDescriptor(je,Tt))})}return we}var Ze=6378e3;function ye(we,pt){var je=we.dataArray,Tt=pt.size,Xe=Tt===void 0?10:Tt,gt=pt.method,Je=gt===void 0?"sum":gt,Et=Xe/(2*Math.PI*Ze)*(256<<20)/2,_t=je.map(function(st){var Le=Object(o.d)(st.coordinates),ut=z()(Le,2),Vt=ut[0],Zt=ut[1];return Fe(Fe({},st),{},{coordinates:[Vt,Zt]})}),Ne=de().radius(Et).x(function(st){return st.coordinates[0]}).y(function(st){return st.coordinates[1]}),ke=Ne(_t),Ue={dataArray:ke.map(function(st,Le){var ut;if(pt.field&&Je){var Vt=o.c.getColumn(st,pt.field);st[Je]=o.c.statMap[Je](Vt)}return ut={},m()(ut,pt.method,st[Je]),m()(ut,"count",st.length),m()(ut,"rawData",st),m()(ut,"coordinates",[st.x,st.y]),m()(ut,"_id",Le),ut}),radius:Et,xOffset:Et,yOffset:Et,type:"hexagon"};return Ue}},"+em5":function(Re,E,i){"use strict";i.d(E,"a",function(){return oe});var T=i("lSNA"),m=i.n(T),X=i("yG8O"),z=i.n(X),o=i("lwsE"),Z=i.n(o),D=i("W8MJ"),K=i.n(D),re=i("U+yc"),de=i.n(re),Y=i("1ABj"),Fe=i.n(Y),Ze=i("gQMU"),ye=i.n(Ze),we=i("J2iB"),pt=i.n(we),je=i("u6S6"),Tt=i.n(je),Xe=i("4cb6"),gt=i.n(Xe),Je=i("h1nZ"),Et=i("bB6j"),_t=i("bPkA"),Ne,ke,Ue,st,Le,ut;function Vt(Q,H){var Ce=Object.keys(Q);if(Object.getOwnPropertySymbols){var Ee=Object.getOwnPropertySymbols(Q);H&&(Ee=Ee.filter(function(Ae){return Object.getOwnPropertyDescriptor(Q,Ae).enumerable})),Ce.push.apply(Ce,Ee)}return Ce}function Zt(Q){for(var H=1;H<arguments.length;H++){var Ce=arguments[H]!=null?arguments[H]:{};H%2?Vt(Object(Ce),!0).forEach(function(Ee){m()(Q,Ee,Ce[Ee])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Q,Object.getOwnPropertyDescriptors(Ce)):Vt(Object(Ce)).forEach(function(Ee){Object.defineProperty(Q,Ee,Object.getOwnPropertyDescriptor(Ce,Ee))})}return Q}var ir=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,oe=(Ne=Object(Xe.injectable)(),ke=Object(Xe.inject)(Et.a.IShaderModuleService),Ne(Ue=(st=(ut=function(){function Q(){Z()(this,Q),z()(this,"shaderModuleService",Le,this),this.rendererService=void 0,this.config=void 0,this.quad=ir,this.enabled=!0,this.renderToScreen=!1,this.model=void 0,this.name=void 0,this.optionsToUpdate={}}return K()(Q,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(Ce){this.name=Ce}},{key:"getType",value:function(){return _t.a.PostProcessing}},{key:"init",value:function(Ce,Ee){this.config=Ee,this.rendererService=Ce.getContainer().get(Et.a.IRendererService);var Ae=this.rendererService,ge=Ae.createAttribute,rt=Ae.createBuffer,Yt=Ae.createModel,At=this.setupShaders(),be=At.vs,xe=At.fs,Ve=At.uniforms;this.model=Yt({vs:be,fs:xe,attributes:{a_Position:ge({buffer:rt({data:[-4,-4,4,-4,0,4],type:Je.gl.FLOAT}),size:2})},uniforms:Zt(Zt({u_Texture:null},Ve),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}},{key:"render",value:function(Ce){var Ee=this,Ae=Ce.multiPassRenderer.getPostProcessor(),ge=this.rendererService,rt=ge.useFramebuffer,Yt=ge.getViewportSize,At=ge.clear,be=Yt(),xe=be.width,Ve=be.height;rt(this.renderToScreen?null:Ae.getWriteFBO(),function(){At({framebuffer:Ae.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0}),Ee.model.draw({uniforms:Zt({u_Texture:Ae.getReadFBO(),u_ViewportSize:[xe,Ve]},Ee.convertOptionsToUniforms(Ee.optionsToUpdate))})})}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(Ce){this.enabled=Ce}},{key:"setRenderToScreen",value:function(Ce){this.renderToScreen=Ce}},{key:"updateOptions",value:function(Ce){this.optionsToUpdate=Zt(Zt({},this.optionsToUpdate),Ce)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(Ce){var Ee={};return Object.keys(Ce).forEach(function(Ae){pt()(Ce[Ae])||(Ee["u_".concat(ye()(Tt()(Ae)))]=Ce[Ae])}),Ee}}]),Q}(),ut),Le=de()(st.prototype,"shaderModuleService",[ke],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),st))||Ue)},"+iFO":function(Re,E,i){var T=i("dTAl"),m=i("LcsW"),X=i("6sVZ");function z(o){return typeof o.constructor=="function"&&!X(o)?T(m(o)):{}}Re.exports=z},"/33/":function(Re,E){},"/Uc5":function(Re,E){},"/ezw":function(Re,E,i){"use strict";var T=i("lSNA"),m=i.n(T),X=i("pVnL"),z=i.n(X),o=i("cDf5"),Z=i.n(o),D=i("q1tI"),K=i("TSYQ"),re=i.n(K),de=function(Ee){var Ae=Ee.prefixCls,ge=Ee.className,rt=Ee.width,Yt=Ee.style;return D.createElement("h3",{className:re()(Ae,ge),style:z()({width:rt},Yt)})},Y=de,Fe=i("RIqP"),Ze=i.n(Fe),ye=function(Ee){var Ae=function(Ve){var lt=Ee.width,Pe=Ee.rows,dt=Pe===void 0?2:Pe;return Array.isArray(lt)?lt[Ve]:dt-1===Ve?lt:void 0},ge=Ee.prefixCls,rt=Ee.className,Yt=Ee.style,At=Ee.rows,be=Ze()(Array(At)).map(function(xe,Ve){return D.createElement("li",{key:Ve,style:{width:Ae(Ve)}})});return D.createElement("ul",{className:re()(ge,rt),style:Yt},be)},we=ye,pt=i("H84U"),je=function(Ee){var Ae,ge,rt=Ee.prefixCls,Yt=Ee.className,At=Ee.style,be=Ee.size,xe=Ee.shape,Ve=re()((Ae={},m()(Ae,"".concat(rt,"-lg"),be==="large"),m()(Ae,"".concat(rt,"-sm"),be==="small"),Ae)),lt=re()((ge={},m()(ge,"".concat(rt,"-circle"),xe==="circle"),m()(ge,"".concat(rt,"-square"),xe==="square"),m()(ge,"".concat(rt,"-round"),xe==="round"),ge)),Pe=typeof be=="number"?{width:be,height:be,lineHeight:"".concat(be,"px")}:{};return D.createElement("span",{className:re()(rt,Ve,lt,Yt),style:z()(z()({},Pe),At)})},Tt=je,Xe=i("BGR+"),gt=function(Ee){var Ae=function(rt){var Yt=rt.getPrefixCls,At=Ee.prefixCls,be=Ee.className,xe=Ee.active,Ve=Yt("skeleton",At),lt=Object(Xe.a)(Ee,["prefixCls"]),Pe=re()(Ve,"".concat(Ve,"-element"),m()({},"".concat(Ve,"-active"),xe),be);return D.createElement("div",{className:Pe},D.createElement(Tt,z()({prefixCls:"".concat(Ve,"-avatar")},lt)))};return D.createElement(pt.a,null,Ae)};gt.defaultProps={size:"default",shape:"circle"};var Je=gt,Et=function(Ee){var Ae=function(rt){var Yt=rt.getPrefixCls,At=Ee.prefixCls,be=Ee.className,xe=Ee.active,Ve=Yt("skeleton",At),lt=Object(Xe.a)(Ee,["prefixCls"]),Pe=re()(Ve,"".concat(Ve,"-element"),m()({},"".concat(Ve,"-active"),xe),be);return D.createElement("div",{className:Pe},D.createElement(Tt,z()({prefixCls:"".concat(Ve,"-button")},lt)))};return D.createElement(pt.a,null,Ae)};Et.defaultProps={size:"default"};var _t=Et,Ne=function(Ee){var Ae=function(rt){var Yt=rt.getPrefixCls,At=Ee.prefixCls,be=Ee.className,xe=Ee.active,Ve=Yt("skeleton",At),lt=Object(Xe.a)(Ee,["prefixCls"]),Pe=re()(Ve,"".concat(Ve,"-element"),m()({},"".concat(Ve,"-active"),xe),be);return D.createElement("div",{className:Pe},D.createElement(Tt,z()({prefixCls:"".concat(Ve,"-input")},lt)))};return D.createElement(pt.a,null,Ae)};Ne.defaultProps={size:"default"};var ke=Ne,Ue="M365.714286 329.142857q0 45.714286-32.036571 77.677714t-77.677714 32.036571-77.677714-32.036571-32.036571-77.677714 32.036571-77.677714 77.677714-32.036571 77.677714 32.036571 32.036571 77.677714zM950.857143 548.571429l0 256-804.571429 0 0-109.714286 182.857143-182.857143 91.428571 91.428571 292.571429-292.571429zM1005.714286 146.285714l-914.285714 0q-7.460571 0-12.873143 5.412571t-5.412571 12.873143l0 694.857143q0 7.460571 5.412571 12.873143t12.873143 5.412571l914.285714 0q7.460571 0 12.873143-5.412571t5.412571-12.873143l0-694.857143q0-7.460571-5.412571-12.873143t-12.873143-5.412571zM1097.142857 164.571429l0 694.857143q0 37.741714-26.843429 64.585143t-64.585143 26.843429l-914.285714 0q-37.741714 0-64.585143-26.843429t-26.843429-64.585143l0-694.857143q0-37.741714 26.843429-64.585143t64.585143-26.843429l914.285714 0q37.741714 0 64.585143 26.843429t26.843429 64.585143z",st=function(Ee){var Ae=function(rt){var Yt=rt.getPrefixCls,At=Ee.prefixCls,be=Ee.className,xe=Ee.style,Ve=Yt("skeleton",At),lt=re()(Ve,"".concat(Ve,"-element"),be);return D.createElement("div",{className:lt},D.createElement("div",{className:re()("".concat(Ve,"-image"),be),style:xe},D.createElement("svg",{viewBox:"0 0 1098 1024",xmlns:"http://www.w3.org/2000/svg",className:"".concat(Ve,"-image-svg")},D.createElement("path",{d:Ue,className:"".concat(Ve,"-image-path")}))))};return D.createElement(pt.a,null,Ae)},Le=st;function ut(Ce){return Ce&&Z()(Ce)==="object"?Ce:{}}function Vt(Ce,Ee){return Ce&&!Ee?{size:"large",shape:"square"}:{size:"large",shape:"circle"}}function Zt(Ce,Ee){return!Ce&&Ee?{width:"38%"}:Ce&&Ee?{width:"50%"}:{}}function ir(Ce,Ee){var Ae={};return(!Ce||!Ee)&&(Ae.width="61%"),!Ce&&Ee?Ae.rows=3:Ae.rows=2,Ae}var oe=function(Ee){var Ae=function(rt){var Yt=rt.getPrefixCls,At=rt.direction,be=Ee.prefixCls,xe=Ee.loading,Ve=Ee.className,lt=Ee.children,Pe=Ee.avatar,dt=Ee.title,w=Ee.paragraph,I=Ee.active,q=Ee.round,ce=Yt("skeleton",be);if(xe||!("loading"in Ee)){var Ge,$e=!!Pe,yt=!!dt,nt=!!w,Nt;if($e){var $=z()(z()({prefixCls:"".concat(ce,"-avatar")},Vt(yt,nt)),ut(Pe));Nt=D.createElement("div",{className:"".concat(ce,"-header")},D.createElement(Tt,$))}var Ke;if(yt||nt){var ae;if(yt){var et=z()(z()({prefixCls:"".concat(ce,"-title")},Zt($e,nt)),ut(dt));ae=D.createElement(Y,et)}var jt;if(nt){var sr=z()(z()({prefixCls:"".concat(ce,"-paragraph")},ir($e,yt)),ut(w));jt=D.createElement(we,sr)}Ke=D.createElement("div",{className:"".concat(ce,"-content")},ae,jt)}var ft=re()(ce,(Ge={},m()(Ge,"".concat(ce,"-with-avatar"),$e),m()(Ge,"".concat(ce,"-active"),I),m()(Ge,"".concat(ce,"-rtl"),At==="rtl"),m()(Ge,"".concat(ce,"-round"),q),Ge),Ve);return D.createElement("div",{className:ft},Nt,Ke)}return lt};return D.createElement(pt.a,null,Ae)};oe.defaultProps={avatar:!1,title:!0,paragraph:!0},oe.Button=_t,oe.Avatar=Je,oe.Input=ke,oe.Image=Le;var Q=oe,H=E.a=Q},"/rf6":function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.earthRadius=63710088e-1,E.factors={centimeters:E.earthRadius*100,centimetres:E.earthRadius*100,degrees:E.earthRadius/111325,feet:E.earthRadius*3.28084,inches:E.earthRadius*39.37,kilometers:E.earthRadius/1e3,kilometres:E.earthRadius/1e3,meters:E.earthRadius,metres:E.earthRadius,miles:E.earthRadius/1609.344,millimeters:E.earthRadius*1e3,millimetres:E.earthRadius*1e3,nauticalmiles:E.earthRadius/1852,radians:1,yards:E.earthRadius/1.0936},E.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/E.earthRadius,yards:1/1.0936},E.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function T(Q,H,Ce){Ce===void 0&&(Ce={});var Ee={type:"Feature"};return(Ce.id===0||Ce.id)&&(Ee.id=Ce.id),Ce.bbox&&(Ee.bbox=Ce.bbox),Ee.properties=H||{},Ee.geometry=Q,Ee}E.feature=T;function m(Q,H,Ce){Ce===void 0&&(Ce={});switch(Q){case"Point":return X(H).geometry;case"LineString":return D(H).geometry;case"Polygon":return o(H).geometry;case"MultiPoint":return Y(H).geometry;case"MultiLineString":return de(H).geometry;case"MultiPolygon":return Fe(H).geometry;default:throw new Error(Q+" is invalid")}}E.geometry=m;function X(Q,H,Ce){Ce===void 0&&(Ce={});var Ee={type:"Point",coordinates:Q};return T(Ee,H,Ce)}E.point=X;function z(Q,H,Ce){return Ce===void 0&&(Ce={}),re(Q.map(function(Ee){return X(Ee,H)}),Ce)}E.points=z;function o(Q,H,Ce){Ce===void 0&&(Ce={});for(var Ee=0,Ae=Q;Ee<Ae.length;Ee++){var ge=Ae[Ee];if(ge.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var rt=0;rt<ge[ge.length-1].length;rt++)if(ge[ge.length-1][rt]!==ge[0][rt])throw new Error("First and last Position are not equivalent.")}var Yt={type:"Polygon",coordinates:Q};return T(Yt,H,Ce)}E.polygon=o;function Z(Q,H,Ce){return Ce===void 0&&(Ce={}),re(Q.map(function(Ee){return o(Ee,H)}),Ce)}E.polygons=Z;function D(Q,H,Ce){if(Ce===void 0&&(Ce={}),Q.length<2)throw new Error("coordinates must be an array of two or more positions");var Ee={type:"LineString",coordinates:Q};return T(Ee,H,Ce)}E.lineString=D;function K(Q,H,Ce){return Ce===void 0&&(Ce={}),re(Q.map(function(Ee){return D(Ee,H)}),Ce)}E.lineStrings=K;function re(Q,H){H===void 0&&(H={});var Ce={type:"FeatureCollection"};return H.id&&(Ce.id=H.id),H.bbox&&(Ce.bbox=H.bbox),Ce.features=Q,Ce}E.featureCollection=re;function de(Q,H,Ce){Ce===void 0&&(Ce={});var Ee={type:"MultiLineString",coordinates:Q};return T(Ee,H,Ce)}E.multiLineString=de;function Y(Q,H,Ce){Ce===void 0&&(Ce={});var Ee={type:"MultiPoint",coordinates:Q};return T(Ee,H,Ce)}E.multiPoint=Y;function Fe(Q,H,Ce){Ce===void 0&&(Ce={});var Ee={type:"MultiPolygon",coordinates:Q};return T(Ee,H,Ce)}E.multiPolygon=Fe;function Ze(Q,H,Ce){Ce===void 0&&(Ce={});var Ee={type:"GeometryCollection",geometries:Q};return T(Ee,H,Ce)}E.geometryCollection=Ze;function ye(Q,H){if(H===void 0&&(H=0),H&&!(H>=0))throw new Error("precision must be a positive number");var Ce=Math.pow(10,H||0);return Math.round(Q*Ce)/Ce}E.round=ye;function we(Q,H){H===void 0&&(H="kilometers");var Ce=E.factors[H];if(!Ce)throw new Error(H+" units is invalid");return Q*Ce}E.radiansToLength=we;function pt(Q,H){H===void 0&&(H="kilometers");var Ce=E.factors[H];if(!Ce)throw new Error(H+" units is invalid");return Q/Ce}E.lengthToRadians=pt;function je(Q,H){return Xe(pt(Q,H))}E.lengthToDegrees=je;function Tt(Q){var H=Q%360;return H<0&&(H+=360),H}E.bearingToAzimuth=Tt;function Xe(Q){var H=Q%(2*Math.PI);return H*180/Math.PI}E.radiansToDegrees=Xe;function gt(Q){var H=Q%360;return H*Math.PI/180}E.degreesToRadians=gt;function Je(Q,H,Ce){if(H===void 0&&(H="kilometers"),Ce===void 0&&(Ce="kilometers"),!(Q>=0))throw new Error("length must be a positive number");return we(pt(Q,H),Ce)}E.convertLength=Je;function Et(Q,H,Ce){if(H===void 0&&(H="meters"),Ce===void 0&&(Ce="kilometers"),!(Q>=0))throw new Error("area must be a positive number");var Ee=E.areaFactors[H];if(!Ee)throw new Error("invalid original units");var Ae=E.areaFactors[Ce];if(!Ae)throw new Error("invalid final units");return Q/Ee*Ae}E.convertArea=Et;function _t(Q){return!isNaN(Q)&&Q!==null&&!Array.isArray(Q)&&!/^\s*$/.test(Q)}E.isNumber=_t;function Ne(Q){return!!Q&&Q.constructor===Object}E.isObject=Ne;function ke(Q){if(!Q)throw new Error("bbox is required");if(!Array.isArray(Q))throw new Error("bbox must be an Array");if(Q.length!==4&&Q.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");Q.forEach(function(H){if(!_t(H))throw new Error("bbox must only contain numbers")})}E.validateBBox=ke;function Ue(Q){if(!Q)throw new Error("id is required");if(["string","number"].indexOf(typeof Q)===-1)throw new Error("id must be a number or a string")}E.validateId=Ue;function st(){throw new Error("method has been renamed to `radiansToDegrees`")}E.radians2degrees=st;function Le(){throw new Error("method has been renamed to `degreesToRadians`")}E.degrees2radians=Le;function ut(){throw new Error("method has been renamed to `lengthToDegrees`")}E.distanceToDegrees=ut;function Vt(){throw new Error("method has been renamed to `lengthToRadians`")}E.distanceToRadians=Vt;function Zt(){throw new Error("method has been renamed to `radiansToLength`")}E.radiansToDistance=Zt;function ir(){throw new Error("method has been renamed to `bearingToAzimuth`")}E.bearingToAngle=ir;function oe(){throw new Error("method has been renamed to `convertLength`")}E.convertDistance=oe},"0JQy":function(Re,E){var i="\\ud800-\\udfff",T="\\u0300-\\u036f",m="\\ufe20-\\ufe2f",X="\\u20d0-\\u20ff",z=T+m+X,o="\\ufe0e\\ufe0f",Z="["+i+"]",D="["+z+"]",K="\\ud83c[\\udffb-\\udfff]",re="(?:"+D+"|"+K+")",de="[^"+i+"]",Y="(?:\\ud83c[\\udde6-\\uddff]){2}",Fe="[\\ud800-\\udbff][\\udc00-\\udfff]",Ze="\\u200d",ye=re+"?",we="["+o+"]?",pt="(?:"+Ze+"(?:"+[de,Y,Fe].join("|")+")"+we+ye+")*",je=we+ye+pt,Tt="(?:"+[de+D+"?",D,Y,Fe,Z].join("|")+")",Xe=RegExp(K+"(?="+K+")|"+Tt+je,"g");function gt(Je){return Je.match(Xe)||[]}Re.exports=gt},"0ZTe":function(Re,E,i){var T=i("wy8a"),m=i("quyA"),X=i("Em2t"),z=i("dt0z");function o(Z){return function(D){D=z(D);var K=m(D)?X(D):void 0,re=K?K[0]:D.charAt(0),de=K?T(K,1).join(""):D.slice(1);return re[Z]()+de}}Re.exports=o},"0eqD":function(Re,E){},"0gSV":function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("GXnB"),m=i("Ztfv");function X(z,o){return function(Z,D,K){var re=new T.Metadata(z,o);typeof K=="number"?m.tagParameter(Z,D,K,re):m.tagProperty(Z,D,re)}}E.tagged=X},"1+5i":function(Re,E,i){var T=i("w/wX"),m=i("sEf8"),X=i("mdPL"),z=X&&X.isSet,o=z?m(z):T;Re.exports=o},"14J3":function(Re,E,i){"use strict";var T=i("cIOH"),m=i.n(T),X=i("1GLa")},"1ABj":function(Re,E){function i(T,m){throw new Error("Decorating class property failed. Please ensure that proposal-class-properties is enabled and runs after the decorators transform.")}Re.exports=i},"1XEM":function(Re,E,i){Re.exports={tagCloud:"antd-pro-pages-dashboard-monitor-components-charts-tag-cloud-index-tagCloud"}},"1gqn":function(Re,E){Re.exports=function(T){return T&&typeof T=="object"&&typeof T.copy=="function"&&typeof T.fill=="function"&&typeof T.readUInt8=="function"}},"1jvM":function(Re,E){},2:function(Re,E){},"2ajD":function(Re,E){function i(T){return T!==T}Re.exports=i},"3DfO":function(Re,E){function i(T){return T==null}Re.exports=i},"3L66":function(Re,E,i){var T=i("MMmD"),m=i("ExA7");function X(z){return m(z)&&T(z)}Re.exports=X},"3cYt":function(Re,E){function i(T){return function(m){return T==null?void 0:T[m]}}Re.exports=i},"406g":function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("z4Hk"),m=function(){function X(z){this._binding=z}return X.prototype.onActivation=function(z){return this._binding.onActivation=z,new T.BindingWhenSyntax(this._binding)},X}();E.BindingOnSyntax=m},"4U9+":function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.default=function(we){return(0,m.default)((0,K.default)(we)&&we.length>=1,"Must merge at least 1 JSON schema."),z.default.apply(void 0,[{}].concat(ye(we),[function(pt,je,Tt){if((0,Z.default)(pt))return;if(Tt==="required")return(0,de.default)(pt.concat(je));if((0,Fe.default)(pt)){if(!(0,Fe.default)(je))throw new Error('Failed to merge schemas because "'+Tt+'" has different values.');return}m.default.deepEqual(pt,je,'Failed to merge schemas because "'+Tt+'" has different values: '+JSON.stringify(pt)+" and "+JSON.stringify(je)+".")}]))};var T=i("9lTW"),m=Ze(T),X=i("qd8s"),z=Ze(X),o=i("3DfO"),Z=Ze(o),D=i("WFAs"),K=Ze(D),re=i("w26f"),de=Ze(re),Y=i("zZPE"),Fe=Ze(Y);function Ze(we){return we&&we.__esModule?we:{default:we}}function ye(we){if(Array.isArray(we)){for(var pt=0,je=Array(we.length);pt<we.length;pt++)je[pt]=we[pt];return je}else return Array.from(we)}Re.exports=E.default},"4ZJM":function(Re,E,i){(function(T,m){Re.exports=m()})(this,function(){"use strict";var T,m,X;function z(o,Z){if(!T)T=Z;else if(!m)m=Z;else{var D="var sharedChunk = {}; ("+T+")(sharedChunk); ("+m+")(sharedChunk);",K={};T(K),X=Z(K),typeof window!="undefined"&&(X.workerUrl=window.URL.createObjectURL(new Blob([D],{type:"text/javascript"})))}}return z(["exports"],function(o){"use strict";function Z(e,t){return e(t={exports:{}},t.exports),t.exports}var D=K;function K(e,t,r,u){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(u-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=u,this.p2x=r,this.p2y=u}K.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},K.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},K.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},K.prototype.solveCurveX=function(e,t){var r,u,h,g,A;for(t===void 0&&(t=1e-6),h=e,A=0;A<8;A++){if(g=this.sampleCurveX(h)-e,Math.abs(g)<t)return h;var L=this.sampleCurveDerivativeX(h);if(Math.abs(L)<1e-6)break;h-=g/L}if((h=e)<(r=0))return r;if(h>(u=1))return u;for(;r<u;){if(g=this.sampleCurveX(h),Math.abs(g-e)<t)return h;e>g?r=h:u=h,h=.5*(u-r)+r}return h},K.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var re=de;function de(e,t){this.x=e,this.y=t}de.prototype={clone:function(){return new de(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,r){return this.clone()._rotateAround(t,r)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var r=t.x-this.x,u=t.y-this.y;return r*r+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,r){return Math.atan2(this.x*r-this.y*t,this.x*t+this.y*r)},_matMult:function(t){var r=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var r=Math.cos(t),u=Math.sin(t),h=u*this.x+r*this.y;return this.x=r*this.x-u*this.y,this.y=h,this},_rotateAround:function(t,r){var u=Math.cos(t),h=Math.sin(t),g=r.y+h*(this.x-r.x)+u*(this.y-r.y);return this.x=r.x+u*(this.x-r.x)-h*(this.y-r.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},de.convert=function(e){return e instanceof de?e:Array.isArray(e)?new de(e[0],e[1]):e};var Y=typeof self!="undefined"?self:{},Fe=Math.pow(2,53)-1;function Ze(e,t,r,u){var h=new D(e,t,r,u);return function(g){return h.solve(g)}}var ye=Ze(.25,.1,.25,1);function we(e,t,r){return Math.min(r,Math.max(t,e))}function pt(e,t,r){var u=r-t,h=((e-t)%u+u)%u+t;return h===t?r:h}function je(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var u=0,h=t;u<h.length;u+=1){var g=h[u];for(var A in g)e[A]=g[A]}return e}var Tt=1;function Xe(){return Tt++}function gt(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function Je(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function Et(e,t){e.forEach(function(r){t[r]&&(t[r]=t[r].bind(t))})}function _t(e,t){return e.indexOf(t,e.length-t.length)!==-1}function Ne(e,t,r){var u={};for(var h in e)u[h]=t.call(r||this,e[h],h,e);return u}function ke(e,t,r){var u={};for(var h in e)t.call(r||this,e[h],h,e)&&(u[h]=e[h]);return u}function Ue(e){return Array.isArray(e)?e.map(Ue):typeof e=="object"&&e?Ne(e,Ue):e}var st={};function Le(e){st[e]||(typeof console!="undefined"&&console.warn(e),st[e]=!0)}function ut(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function Vt(e){for(var t=0,r=0,u=e.length,h=u-1,g=void 0,A=void 0;r<u;h=r++)t+=((A=e[h]).x-(g=e[r]).x)*(g.y+A.y);return t}function Zt(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function ir(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(u,h,g,A){var L=g||A;return t[h]=!L||L.toLowerCase(),""}),t["max-age"]){var r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t}var oe=null;function Q(e){if(oe==null){var t=e.navigator?e.navigator.userAgent:null;oe=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return oe}function H(e){try{var t=Y[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch(r){return!1}}var Ce,Ee,Ae,ge,rt=Y.performance&&Y.performance.now?Y.performance.now.bind(Y.performance):Date.now.bind(Date),Yt=Y.requestAnimationFrame||Y.mozRequestAnimationFrame||Y.webkitRequestAnimationFrame||Y.msRequestAnimationFrame,At=Y.cancelAnimationFrame||Y.mozCancelAnimationFrame||Y.webkitCancelAnimationFrame||Y.msCancelAnimationFrame,be={now:rt,frame:function(t){var r=Yt(t);return{cancel:function(){return At(r)}}},getImageData:function(t,r){r===void 0&&(r=0);var u=Y.document.createElement("canvas"),h=u.getContext("2d");if(!h)throw new Error("failed to create canvas 2d context");return u.width=t.width,u.height=t.height,h.drawImage(t,0,0,t.width,t.height),h.getImageData(-r,-r,t.width+2*r,t.height+2*r)},resolveURL:function(t){return Ce||(Ce=Y.document.createElement("a")),Ce.href=t,Ce.href},hardwareConcurrency:Y.navigator&&Y.navigator.hardwareConcurrency||4,get devicePixelRatio(){return Y.devicePixelRatio},get prefersReducedMotion(){return!!Y.matchMedia&&(Ee==null&&(Ee=Y.matchMedia("(prefers-reduced-motion: reduce)")),Ee.matches)}},xe={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Ve={supported:!1,testSupport:function(t){!lt&&ge&&(Pe?dt(t):Ae=t)}},lt=!1,Pe=!1;function dt(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,ge),e.isContextLost())return;Ve.supported=!0}catch(r){}e.deleteTexture(t),lt=!0}Y.document&&((ge=Y.document.createElement("img")).onload=function(){Ae&&dt(Ae),Ae=null,Pe=!0},ge.onerror=function(){lt=!0,Ae=null},ge.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var w="01",I=function(t,r){this._transformRequestFn=t,this._customAccessToken=r,this._createSkuToken()};function q(e){return e.indexOf("mapbox:")===0}I.prototype._createSkuToken=function(){var e=function(){for(var t="",r=0;r<10;r++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",w,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},I.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},I.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},I.prototype.normalizeStyleURL=function(e,t){if(!q(e))return e;var r=yt(e);return r.path="/styles/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},I.prototype.normalizeGlyphsURL=function(e,t){if(!q(e))return e;var r=yt(e);return r.path="/fonts/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},I.prototype.normalizeSourceURL=function(e,t){if(!q(e))return e;var r=yt(e);return r.path="/v4/"+r.authority+".json",r.params.push("secure"),this._makeAPIURL(r,this._customAccessToken||t)},I.prototype.normalizeSpriteURL=function(e,t,r,u){var h=yt(e);return q(e)?(h.path="/styles/v1"+h.path+"/sprite"+t+r,this._makeAPIURL(h,this._customAccessToken||u)):(h.path+=""+t+r,nt(h))},I.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!q(e))return e;var r=yt(e);r.path=r.path.replace(/(\.(png|jpg)\d*)(?=$)/,(be.devicePixelRatio>=2||t===512?"@2x":"")+(Ve.supported?".webp":"$1")),r.path=r.path.replace(/^.+\/v4\//,"/"),r.path="/v4"+r.path;var u=this._customAccessToken||function(h){for(var g=0,A=h;g<A.length;g+=1){var L=A[g].match(/^access_token=(.*)$/);if(L)return L[1]}return null}(r.params)||xe.ACCESS_TOKEN;return xe.REQUIRE_ACCESS_TOKEN&&u&&this._skuToken&&r.params.push("sku="+this._skuToken),this._makeAPIURL(r,u)},I.prototype.canonicalizeTileURL=function(e,t){var r=yt(e);if(!r.path.match(/(^\/v4\/)/)||!r.path.match(/\.[\w]+$/))return e;var u="mapbox://tiles/";u+=r.path.replace("/v4/","");var h=r.params;return t&&(h=h.filter(function(g){return!g.match(/^access_token=/)})),h.length&&(u+="?"+h.join("&")),u},I.prototype.canonicalizeTileset=function(e,t){for(var r=!!t&&q(t),u=[],h=0,g=e.tiles||[];h<g.length;h+=1){var A=g[h];Ge(A)?u.push(this.canonicalizeTileURL(A,r)):u.push(A)}return u},I.prototype._makeAPIURL=function(e,t){var r="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",u=yt(xe.API_URL);if(e.protocol=u.protocol,e.authority=u.authority,u.path!=="/"&&(e.path=""+u.path+e.path),!xe.REQUIRE_ACCESS_TOKEN)return nt(e);if(!(t=t||xe.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+r);if(t[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+r);return e.params=e.params.filter(function(h){return h.indexOf("access_token")===-1}),e.params.push("access_token="+t),nt(e)};var ce=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Ge(e){return ce.test(e)}var $e=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function yt(e){var t=e.match($e);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function nt(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function Nt(e){if(!e)return null;var t=e.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(Y.atob(t[1]).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(r){return null}}var $=function(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};$.prototype.getStorageKey=function(e){var t,r=Nt(xe.ACCESS_TOKEN);return t=r&&r.u?Y.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,function(u,h){return String.fromCharCode(Number("0x"+h))})):xe.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},$.prototype.fetchEventData=function(){var e=H("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{var u=Y.localStorage.getItem(t);u&&(this.eventData=JSON.parse(u));var h=Y.localStorage.getItem(r);h&&(this.anonId=h)}catch(g){Le("Unable to read from LocalStorage")}},$.prototype.saveEventData=function(){var e=H("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{Y.localStorage.setItem(r,this.anonId),Object.keys(this.eventData).length>=1&&Y.localStorage.setItem(t,JSON.stringify(this.eventData))}catch(u){Le("Unable to write to LocalStorage")}},$.prototype.processRequests=function(e){},$.prototype.postEvent=function(e,t,r,u){var h=this;if(xe.EVENTS_URL){var g=yt(xe.EVENTS_URL);g.params.push("access_token="+(u||xe.ACCESS_TOKEN||""));var A={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.12.0",skuId:w,userId:this.anonId},L=t?je(A,t):A,B={url:nt(g),headers:{"Content-Type":"text/plain"},body:JSON.stringify([L])};this.pendingRequest=Hn(B,function(te){h.pendingRequest=null,r(te),h.saveEventData(),h.processRequests(u)})}},$.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var Ke,ae,et=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(r,u,h,g){this.skuToken=h,(xe.EVENTS_URL&&g||xe.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(A){return q(A)||Ge(A)}))&&this.queueRequest({id:u,timestamp:Date.now()},g)},t.prototype.processRequests=function(r){var u=this;if(!this.pendingRequest&&this.queue.length!==0){var h=this.queue.shift(),g=h.id,A=h.timestamp;g&&this.success[g]||(this.anonId||this.fetchEventData(),Je(this.anonId)||(this.anonId=gt()),this.postEvent(A,{skuToken:this.skuToken},function(L){L||g&&(u.success[g]=!0)},r))}},t}($),jt=new(function(e){function t(r){e.call(this,"appUserTurnstile"),this._customAccessToken=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(r,u){xe.EVENTS_URL&&xe.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(h){return q(h)||Ge(h)})&&this.queueRequest(Date.now(),u)},t.prototype.processRequests=function(r){var u=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var h=Nt(xe.ACCESS_TOKEN),g=h?h.u:xe.ACCESS_TOKEN,A=g!==this.eventData.tokenU;Je(this.anonId)||(this.anonId=gt(),A=!0);var L=this.queue.shift();if(this.eventData.lastSuccess){var B=new Date(this.eventData.lastSuccess),te=new Date(L),pe=(L-this.eventData.lastSuccess)/864e5;A=A||pe>=1||pe<-1||B.getDate()!==te.getDate()}else A=!0;if(!A)return this.processRequests();this.postEvent(L,{"enabled.telemetry":!1},function(Se){Se||(u.eventData.lastSuccess=L,u.eventData.tokenU=g)},r)}},t}($)),sr=jt.postTurnstileEvent.bind(jt),ft=new et,mt=ft.postMapLoadEvent.bind(ft),Ct=500,vt=50;function Oe(){Y.caches&&!Ke&&(Ke=Y.caches.open("mapbox-tiles"))}function ct(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var Qe,Ft=1/0;function vr(){return Qe==null&&(Qe=Y.OffscreenCanvas&&new Y.OffscreenCanvas(1,1).getContext("2d")&&typeof Y.createImageBitmap=="function"),Qe}var Vr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Vr);var lr=function(e){function t(r,u,h){u===401&&Ge(h)&&(r+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,r),this.status=u,this.url=h,this.name=this.constructor.name,this.message=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),Nn=Zt()?function(){return self.worker&&self.worker.referrer}:function(){return(Y.location.protocol==="blob:"?Y.parent:Y).location.href},vn,na,ha=function(t,r){if(!(/^file:/.test(u=t.url)||/^file:/.test(Nn())&&!/^\w+:/.test(u))){if(Y.fetch&&Y.Request&&Y.AbortController&&Y.Request.prototype.hasOwnProperty("signal"))return function(h,g){var A,L=new Y.AbortController,B=new Y.Request(h.url,{method:h.method||"GET",body:h.body,credentials:h.credentials,headers:h.headers,referrer:Nn(),signal:L.signal}),te=!1,pe=!1,Se=(A=B.url).indexOf("sku=")>0&&Ge(A);h.type==="json"&&B.headers.set("Accept","application/json");var Me=function(xt,Gt,Bt){if(!pe){if(xt&&xt.message!=="SecurityError"&&Le(xt),Gt&&Bt)return it(Gt);var ar=Date.now();Y.fetch(B).then(function(hr){if(hr.ok){var Tr=Se?hr.clone():null;return it(hr,Tr,ar)}return g(new lr(hr.statusText,hr.status,h.url))}).catch(function(hr){hr.code!==20&&g(new Error(hr.message))})}},it=function(xt,Gt,Bt){(h.type==="arrayBuffer"?xt.arrayBuffer():h.type==="json"?xt.json():xt.text()).then(function(ar){pe||(Gt&&Bt&&function(hr,Tr,Fr){if(Oe(),Ke){var Ir={status:Tr.status,statusText:Tr.statusText,headers:new Y.Headers};Tr.headers.forEach(function(yn,Un){return Ir.headers.set(Un,yn)});var hn=ir(Tr.headers.get("Cache-Control")||"");hn["no-store"]||(hn["max-age"]&&Ir.headers.set("Expires",new Date(Fr+1e3*hn["max-age"]).toUTCString()),new Date(Ir.headers.get("Expires")).getTime()-Fr<42e4||function(yn,Un){if(ae===void 0)try{new Response(new ReadableStream),ae=!0}catch(Jn){ae=!1}ae?Un(yn.body):yn.blob().then(Un)}(Tr,function(yn){var Un=new Y.Response(yn,Ir);Oe(),Ke&&Ke.then(function(Jn){return Jn.put(ct(hr.url),Un)}).catch(function(Jn){return Le(Jn.message)})}))}}(B,Gt,Bt),te=!0,g(null,ar,xt.headers.get("Cache-Control"),xt.headers.get("Expires")))}).catch(function(ar){pe||g(new Error(ar.message))})};return Se?function(St,xt){if(Oe(),!Ke)return xt(null);var Gt=ct(St.url);Ke.then(function(Bt){Bt.match(Gt).then(function(ar){var hr=function(Tr){if(!Tr)return!1;var Fr=new Date(Tr.headers.get("Expires")||0),Ir=ir(Tr.headers.get("Cache-Control")||"");return Fr>Date.now()&&!Ir["no-cache"]}(ar);Bt.delete(Gt),hr&&Bt.put(Gt,ar.clone()),xt(null,ar,hr)}).catch(xt)}).catch(xt)}(B,Me):Me(null,null),{cancel:function(){pe=!0,te||L.abort()}}}(t,r);if(Zt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,r,void 0,!0)}var u;return function(h,g){var A=new Y.XMLHttpRequest;for(var L in A.open(h.method||"GET",h.url,!0),h.type==="arrayBuffer"&&(A.responseType="arraybuffer"),h.headers)A.setRequestHeader(L,h.headers[L]);return h.type==="json"&&(A.responseType="text",A.setRequestHeader("Accept","application/json")),A.withCredentials=h.credentials==="include",A.onerror=function(){g(new Error(A.statusText))},A.onload=function(){if((A.status>=200&&A.status<300||A.status===0)&&A.response!==null){var B=A.response;if(h.type==="json")try{B=JSON.parse(A.response)}catch(te){return g(te)}g(null,B,A.getResponseHeader("Cache-Control"),A.getResponseHeader("Expires"))}else g(new lr(A.statusText,A.status,h.url))},A.send(h.body),{cancel:function(){return A.abort()}}}(t,r)},Zn=function(t,r){return ha(je(t,{type:"arrayBuffer"}),r)},Hn=function(t,r){return ha(je(t,{method:"POST"}),r)};vn=[],na=0;var F=function e(t,r){if(Ve.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),na>=xe.MAX_PARALLEL_IMAGE_REQUESTS){var u={requestParameters:t,callback:r,cancelled:!1,cancel:function(){this.cancelled=!0}};return vn.push(u),u}na++;var h=!1,g=function(){if(!h)for(h=!0,na--;vn.length&&na<xe.MAX_PARALLEL_IMAGE_REQUESTS;){var B=vn.shift();B.cancelled||(B.cancel=e(B.requestParameters,B.callback).cancel)}},A=Zn(t,function(L,B,te,pe){g(),L?r(L):B&&(vr()?function(Se,Me){var it=new Y.Blob([new Uint8Array(Se)],{type:"image/png"});Y.createImageBitmap(it).then(function(St){Me(null,St)}).catch(function(St){Me(new Error("Could not load image because of "+St.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(B,r):function(Se,Me,it,St){var xt=new Y.Image,Gt=Y.URL;xt.onload=function(){Me(null,xt),Gt.revokeObjectURL(xt.src)},xt.onerror=function(){return Me(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Bt=new Y.Blob([new Uint8Array(Se)],{type:"image/png"});xt.cacheControl=it,xt.expires=St,xt.src=Se.byteLength?Gt.createObjectURL(Bt):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}(B,r,te,pe))});return{cancel:function(){A.cancel(),g()}}};function W(e,t,r){r[e]&&r[e].indexOf(t)!==-1||(r[e]=r[e]||[],r[e].push(t))}function le(e,t,r){if(r&&r[e]){var u=r[e].indexOf(t);u!==-1&&r[e].splice(u,1)}}var me=function(t,r){r===void 0&&(r={}),je(this,r),this.type=t},at=function(e){function t(r,u){u===void 0&&(u={}),e.call(this,"error",je({error:r},u))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(me),bt=function(){};bt.prototype.on=function(e,t){return this._listeners=this._listeners||{},W(e,t,this._listeners),this},bt.prototype.off=function(e,t){return le(e,t,this._listeners),le(e,t,this._oneTimeListeners),this},bt.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},W(e,t,this._oneTimeListeners),this},bt.prototype.fire=function(e,t){typeof e=="string"&&(e=new me(e,t||{}));var r=e.type;if(this.listens(r)){e.target=this;for(var u=0,h=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];u<h.length;u+=1)h[u].call(this,e);for(var g=0,A=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];g<A.length;g+=1){var L=A[g];le(r,L,this._oneTimeListeners),L.call(this,e)}var B=this._eventedParent;B&&(je(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),B.fire(e))}else e instanceof at&&console.error(e.error);return this},bt.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},bt.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var He={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},ht=function(t,r,u,h){this.message=(t?t+": ":"")+u,h&&(this.identifier=h),r!=null&&r.__line__&&(this.line=r.__line__)};function Qt(e){var t=e.value;return t?[new ht(e.key,t,"constants have been deprecated as of v8")]:[]}function qt(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var u=0,h=t;u<h.length;u+=1){var g=h[u];for(var A in g)e[A]=g[A]}return e}function Nr(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function qr(e){if(Array.isArray(e))return e.map(qr);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var r in e)t[r]=qr(e[r]);return t}return Nr(e)}var or=function(e){function t(r,u){e.call(this,u),this.message=u,this.key=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),Br=function(t,r){r===void 0&&(r=[]),this.parent=t,this.bindings={};for(var u=0,h=r;u<h.length;u+=1){var g=h[u];this.bindings[g[0]]=g[1]}};Br.prototype.concat=function(e){return new Br(this,e)},Br.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},Br.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var Tn={kind:"null"},dr={kind:"number"},Xr={kind:"string"},dn={kind:"boolean"},Kn={kind:"color"},gn={kind:"object"},ur={kind:"value"},kn={kind:"collator"},An={kind:"formatted"},Za={kind:"resolvedImage"};function ea(e,t){return{kind:"array",itemType:e,N:t}}function ca(e){if(e.kind==="array"){var t=ca(e.itemType);return typeof e.N=="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}return e.kind}var bo=[Tn,dr,Xr,dn,Kn,An,gn,ea(ur),Za];function Ri(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Ri(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(var r=0,u=bo;r<u.length;r+=1)if(!Ri(u[r],t))return null}}return"Expected "+ca(e)+" but found "+ca(t)+" instead."}function va(e,t){return t.some(function(r){return r.kind===e.kind})}function ii(e,t){return t.some(function(r){return r==="null"?e===null:r==="array"?Array.isArray(e):r==="object"?e&&!Array.isArray(e)&&typeof e=="object":r===typeof e})}var Ia=Z(function(e,t){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function u(L){return(L=Math.round(L))<0?0:L>255?255:L}function h(L){return u(L[L.length-1]==="%"?parseFloat(L)/100*255:parseInt(L))}function g(L){return(B=L[L.length-1]==="%"?parseFloat(L)/100:parseFloat(L))<0?0:B>1?1:B;var B}function A(L,B,te){return te<0?te+=1:te>1&&(te-=1),6*te<1?L+(B-L)*te*6:2*te<1?B:3*te<2?L+(B-L)*(2/3-te)*6:L}try{t.parseCSSColor=function(L){var B,te=L.replace(/ /g,"").toLowerCase();if(te in r)return r[te].slice();if(te[0]==="#")return te.length===4?(B=parseInt(te.substr(1),16))>=0&&B<=4095?[(3840&B)>>4|(3840&B)>>8,240&B|(240&B)>>4,15&B|(15&B)<<4,1]:null:te.length===7&&(B=parseInt(te.substr(1),16))>=0&&B<=16777215?[(16711680&B)>>16,(65280&B)>>8,255&B,1]:null;var pe=te.indexOf("("),Se=te.indexOf(")");if(pe!==-1&&Se+1===te.length){var Me=te.substr(0,pe),it=te.substr(pe+1,Se-(pe+1)).split(","),St=1;switch(Me){case"rgba":if(it.length!==4)return null;St=g(it.pop());case"rgb":return it.length!==3?null:[h(it[0]),h(it[1]),h(it[2]),St];case"hsla":if(it.length!==4)return null;St=g(it.pop());case"hsl":if(it.length!==3)return null;var xt=(parseFloat(it[0])%360+360)%360/360,Gt=g(it[1]),Bt=g(it[2]),ar=Bt<=.5?Bt*(Gt+1):Bt+Gt-Bt*Gt,hr=2*Bt-ar;return[u(255*A(hr,ar,xt+1/3)),u(255*A(hr,ar,xt)),u(255*A(hr,ar,xt-1/3)),St];default:return null}}return null}}catch(L){}}).parseCSSColor,Ln=function(t,r,u,h){h===void 0&&(h=1),this.r=t,this.g=r,this.b=u,this.a=h};Ln.parse=function(e){if(e){if(e instanceof Ln)return e;if(typeof e=="string"){var t=Ia(e);if(t)return new Ln(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},Ln.prototype.toString=function(){var e=this.toArray(),t=e[1],r=e[2],u=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(r)+","+u+")"},Ln.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},Ln.black=new Ln(0,0,0,1),Ln.white=new Ln(1,1,1,1),Ln.transparent=new Ln(0,0,0,0),Ln.red=new Ln(1,0,0,1);var Ei=function(t,r,u){this.sensitivity=t?r?"variant":"case":r?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Ei.prototype.compare=function(e,t){return this.collator.compare(e,t)},Ei.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Wi=function(t,r,u,h,g){this.text=t,this.image=r,this.scale=u,this.fontStack=h,this.textColor=g},qa=function(t){this.sections=t};qa.fromString=function(e){return new qa([new Wi(e,null,null,null,null)])},qa.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},qa.factory=function(e){return e instanceof qa?e:qa.fromString(e)},qa.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},qa.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var u=r[t];if(u.image)e.push(["image",u.image.name]);else{e.push(u.text);var h={};u.fontStack&&(h["text-font"]=["literal",u.fontStack.split(",")]),u.scale&&(h["font-scale"]=u.scale),u.textColor&&(h["text-color"]=["rgba"].concat(u.textColor.toArray())),e.push(h)}}return e};var Oo=function(t){this.name=t.name,this.available=t.available};function Ml(e,t,r,u){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:"Invalid rgba value ["+[e,t,r,u].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof u=="number"?[e,t,r,u]:[e,t,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function cu(e){if(e===null)return!0;if(typeof e=="string")return!0;if(typeof e=="boolean")return!0;if(typeof e=="number")return!0;if(e instanceof Ln)return!0;if(e instanceof Ei)return!0;if(e instanceof qa)return!0;if(e instanceof Oo)return!0;if(Array.isArray(e)){for(var t=0,r=e;t<r.length;t+=1)if(!cu(r[t]))return!1;return!0}if(typeof e=="object"){for(var u in e)if(!cu(e[u]))return!1;return!0}return!1}function fa(e){if(e===null)return Tn;if(typeof e=="string")return Xr;if(typeof e=="boolean")return dn;if(typeof e=="number")return dr;if(e instanceof Ln)return Kn;if(e instanceof Ei)return kn;if(e instanceof qa)return An;if(e instanceof Oo)return Za;if(Array.isArray(e)){for(var t,r=e.length,u=0,h=e;u<h.length;u+=1){var g=fa(h[u]);if(t){if(t===g)continue;t=ur;break}t=g}return ea(t||ur,r)}return gn}function Cs(e){var t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof Ln||e instanceof qa||e instanceof Oo?e.toString():JSON.stringify(e)}Oo.prototype.toString=function(){return this.name},Oo.fromString=function(e){return e?new Oo({name:e,available:!1}):null},Oo.prototype.serialize=function(){return["image",this.name]};var oo=function(t,r){this.type=t,this.value=r};oo.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!cu(e[1]))return t.error("invalid value");var r=e[1],u=fa(r),h=t.expectedType;return u.kind!=="array"||u.N!==0||!h||h.kind!=="array"||typeof h.N=="number"&&h.N!==0||(u=h),new oo(u,r)},oo.prototype.evaluate=function(){return this.value},oo.prototype.eachChild=function(){},oo.prototype.outputDefined=function(){return!0},oo.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Ln?["rgba"].concat(this.value.toArray()):this.value instanceof qa?this.value.serialize():this.value};var Na=function(t){this.name="ExpressionEvaluationError",this.message=t};Na.prototype.toJSON=function(){return this.message};var Fu={string:Xr,number:dr,boolean:dn,object:gn},Ai=function(t,r){this.type=t,this.args=r};Ai.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r,u=1,h=e[0];if(h==="array"){var g,A;if(e.length>2){var L=e[1];if(typeof L!="string"||!(L in Fu)||L==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);g=Fu[L],u++}else g=ur;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);A=e[2],u++}r=ea(g,A)}else r=Fu[h];for(var B=[];u<e.length;u++){var te=t.parse(e[u],u,ur);if(!te)return null;B.push(te)}return new Ai(r,B)},Ai.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var r=this.args[t].evaluate(e);if(!Ri(this.type,fa(r)))return r;if(t===this.args.length-1)throw new Na("Expected value to be of type "+ca(this.type)+", but found "+ca(fa(r))+" instead.")}return null},Ai.prototype.eachChild=function(e){this.args.forEach(e)},Ai.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Ai.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var r=e.itemType;if(r.kind==="string"||r.kind==="number"||r.kind==="boolean"){t.push(r.kind);var u=e.N;(typeof u=="number"||this.args.length>1)&&t.push(u)}}return t.concat(this.args.map(function(h){return h.serialize()}))};var li=function(t){this.type=An,this.sections=t};li.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[1];if(!Array.isArray(r)&&typeof r=="object")return t.error("First argument must be an image or text section.");for(var u=[],h=!1,g=1;g<=e.length-1;++g){var A=e[g];if(h&&typeof A=="object"&&!Array.isArray(A)){h=!1;var L=null;if(A["font-scale"]&&!(L=t.parse(A["font-scale"],1,dr)))return null;var B=null;if(A["text-font"]&&!(B=t.parse(A["text-font"],1,ea(Xr))))return null;var te=null;if(A["text-color"]&&!(te=t.parse(A["text-color"],1,Kn)))return null;var pe=u[u.length-1];pe.scale=L,pe.font=B,pe.textColor=te}else{var Se=t.parse(e[g],1,ur);if(!Se)return null;var Me=Se.type.kind;if(Me!=="string"&&Me!=="value"&&Me!=="null"&&Me!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");h=!0,u.push({content:Se,scale:null,font:null,textColor:null})}}return new li(u)},li.prototype.evaluate=function(e){return new qa(this.sections.map(function(t){var r=t.content.evaluate(e);return fa(r)===Za?new Wi("",r,null,null,null):new Wi(Cs(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},li.prototype.eachChild=function(e){for(var t=0,r=this.sections;t<r.length;t+=1){var u=r[t];e(u.content),u.scale&&e(u.scale),u.font&&e(u.font),u.textColor&&e(u.textColor)}},li.prototype.outputDefined=function(){return!1},li.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var u=r[t];e.push(u.content.serialize());var h={};u.scale&&(h["font-scale"]=u.scale.serialize()),u.font&&(h["text-font"]=u.font.serialize()),u.textColor&&(h["text-color"]=u.textColor.serialize()),e.push(h)}return e};var xo=function(t){this.type=Za,this.input=t};xo.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var r=t.parse(e[1],1,Xr);return r?new xo(r):t.error("No image name provided.")},xo.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=Oo.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r},xo.prototype.eachChild=function(e){e(this.input)},xo.prototype.outputDefined=function(){return!1},xo.prototype.serialize=function(){return["image",this.input.serialize()]};var ms={"to-boolean":dn,"to-color":Kn,"to-number":dr,"to-string":Xr},so=function(t,r){this.type=t,this.args=r};so.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[0];if((r==="to-boolean"||r==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var u=ms[r],h=[],g=1;g<e.length;g++){var A=t.parse(e[g],g,ur);if(!A)return null;h.push(A)}return new so(u,h)},so.prototype.evaluate=function(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){for(var t,r,u=0,h=this.args;u<h.length;u+=1){if(r=null,(t=h[u].evaluate(e))instanceof Ln)return t;if(typeof t=="string"){var g=e.parseColor(t);if(g)return g}else if(Array.isArray(t)&&!(r=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":Ml(t[0],t[1],t[2],t[3])))return new Ln(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new Na(r||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}if(this.type.kind==="number"){for(var A=null,L=0,B=this.args;L<B.length;L+=1){if((A=B[L].evaluate(e))===null)return 0;var te=Number(A);if(!isNaN(te))return te}throw new Na("Could not convert "+JSON.stringify(A)+" to number.")}return this.type.kind==="formatted"?qa.fromString(Cs(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Oo.fromString(Cs(this.args[0].evaluate(e))):Cs(this.args[0].evaluate(e))},so.prototype.eachChild=function(e){this.args.forEach(e)},so.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},so.prototype.serialize=function(){if(this.type.kind==="formatted")return new li([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new xo(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var Uu=["Unknown","Point","LineString","Polygon"],Ys=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Ys.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Ys.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?Uu[this.feature.type]:this.feature.type:null},Ys.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Ys.prototype.canonicalID=function(){return this.canonical},Ys.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Ys.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=Ln.parse(e)),t};var Eo=function(t,r,u,h){this.name=t,this.type=r,this._evaluate=u,this.args=h};Eo.prototype.evaluate=function(e){return this._evaluate(e,this.args)},Eo.prototype.eachChild=function(e){this.args.forEach(e)},Eo.prototype.outputDefined=function(){return!1},Eo.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},Eo.parse=function(e,t){var r,u=e[0],h=Eo.definitions[u];if(!h)return t.error('Unknown expression "'+u+'". If you wanted a literal array, use ["literal", [...]].',0);for(var g=Array.isArray(h)?h[0]:h.type,A=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,L=A.filter(function(Dn){var In=Dn[0];return!Array.isArray(In)||In.length===e.length-1}),B=null,te=0,pe=L;te<pe.length;te+=1){var Se=pe[te],Me=Se[0],it=Se[1];B=new $s(t.registry,t.path,null,t.scope);for(var St=[],xt=!1,Gt=1;Gt<e.length;Gt++){var Bt=e[Gt],ar=Array.isArray(Me)?Me[Gt-1]:Me.type,hr=B.parse(Bt,1+St.length,ar);if(!hr){xt=!0;break}St.push(hr)}if(!xt)if(Array.isArray(Me)&&Me.length!==St.length)B.error("Expected "+Me.length+" arguments, but found "+St.length+" instead.");else{for(var Tr=0;Tr<St.length;Tr++){var Fr=Array.isArray(Me)?Me[Tr]:Me.type,Ir=St[Tr];B.concat(Tr+1).checkSubtype(Fr,Ir.type)}if(B.errors.length===0)return new Eo(u,g,it,St)}}if(L.length===1)(r=t.errors).push.apply(r,B.errors);else{for(var hn=(L.length?L:A).map(function(Dn){var In;return In=Dn[0],Array.isArray(In)?"("+In.map(ca).join(", ")+")":"("+ca(In.type)+"...)"}).join(" | "),yn=[],Un=1;Un<e.length;Un++){var Jn=t.parse(e[Un],1+yn.length);if(!Jn)return null;yn.push(ca(Jn.type))}t.error("Expected arguments of type "+hn+", but found ("+yn.join(", ")+") instead.")}return null},Eo.register=function(e,t){for(var r in Eo.definitions=t,t)e[r]=Eo};var fu=function(t,r,u){this.type=kn,this.locale=u,this.caseSensitive=t,this.diacriticSensitive=r};function Ut(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function Ie(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function Mt(e,t){var r=(180+e[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,h=Math.pow(2,t.z);return[Math.round(r*h*8192),Math.round(u*h*8192)]}function cr(e,t,r){return t[1]>e[1]!=r[1]>e[1]&&e[0]<(r[0]-t[0])*(e[1]-t[1])/(r[1]-t[1])+t[0]}function en(e,t){for(var r,u,h,g,A,L,B,te=!1,pe=0,Se=t.length;pe<Se;pe++)for(var Me=t[pe],it=0,St=Me.length;it<St-1;it++){if((g=(r=e)[0]-(u=Me[it])[0])*(B=r[1]-(h=Me[it+1])[1])-(L=r[0]-h[0])*(A=r[1]-u[1])==0&&g*L<=0&&A*B<=0)return!1;cr(e,Me[it],Me[it+1])&&(te=!te)}return te}function bn(e,t){for(var r=0;r<t.length;r++)if(en(e,t[r]))return!0;return!1}function jn(e,t,r,u){var h=u[0]-r[0],g=u[1]-r[1],A=(e[0]-r[0])*g-h*(e[1]-r[1]),L=(t[0]-r[0])*g-h*(t[1]-r[1]);return A>0&&L<0||A<0&&L>0}function Fi(e,t,r){for(var u=0,h=r;u<h.length;u+=1)for(var g=h[u],A=0;A<g.length-1;++A)if((Se=[(pe=g[A+1])[0]-(te=g[A])[0],pe[1]-te[1]])[0]*(Me=[(B=t)[0]-(L=e)[0],B[1]-L[1]])[1]-Se[1]*Me[0]!=0&&jn(L,B,te,pe)&&jn(te,pe,L,B))return!0;var L,B,te,pe,Se,Me;return!1}function qi(e,t){for(var r=0;r<e.length;++r)if(!en(e[r],t))return!1;for(var u=0;u<e.length-1;++u)if(Fi(e[u],e[u+1],t))return!1;return!0}function Mo(e,t){for(var r=0;r<t.length;r++)if(qi(e,t[r]))return!0;return!1}function To(e,t,r){for(var u=[],h=0;h<e.length;h++){for(var g=[],A=0;A<e[h].length;A++){var L=Mt(e[h][A],r);Ut(t,L),g.push(L)}u.push(g)}return u}function tl(e,t,r){for(var u=[],h=0;h<e.length;h++){var g=To(e[h],t,r);u.push(g)}return u}function ql(e,t,r,u){if(e[0]<r[0]||e[0]>r[2]){var h=.5*u,g=e[0]-r[0]>h?-u:r[0]-e[0]>h?u:0;g===0&&(g=e[0]-r[2]>h?-u:r[2]-e[0]>h?u:0),e[0]+=g}Ut(t,e)}function Ks(e,t,r,u){for(var h=8192*Math.pow(2,u.z),g=[8192*u.x,8192*u.y],A=[],L=0,B=e;L<B.length;L+=1)for(var te=0,pe=B[L];te<pe.length;te+=1){var Se=pe[te],Me=[Se.x+g[0],Se.y+g[1]];ql(Me,t,r,h),A.push(Me)}return A}function jc(e,t,r,u){for(var h,g=8192*Math.pow(2,u.z),A=[8192*u.x,8192*u.y],L=[],B=0,te=e;B<te.length;B+=1){for(var pe=[],Se=0,Me=te[B];Se<Me.length;Se+=1){var it=Me[Se],St=[it.x+A[0],it.y+A[1]];Ut(t,St),pe.push(St)}L.push(pe)}if(t[2]-t[0]<=g/2){(h=t)[0]=h[1]=1/0,h[2]=h[3]=-1/0;for(var xt=0,Gt=L;xt<Gt.length;xt+=1)for(var Bt=0,ar=Gt[xt];Bt<ar.length;Bt+=1)ql(ar[Bt],t,r,g)}return L}fu.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var r=e[1];if(typeof r!="object"||Array.isArray(r))return t.error("Collator options argument must be an object.");var u=t.parse(r["case-sensitive"]!==void 0&&r["case-sensitive"],1,dn);if(!u)return null;var h=t.parse(r["diacritic-sensitive"]!==void 0&&r["diacritic-sensitive"],1,dn);if(!h)return null;var g=null;return r.locale&&!(g=t.parse(r.locale,1,Xr))?null:new fu(u,h,g)},fu.prototype.evaluate=function(e){return new Ei(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},fu.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},fu.prototype.outputDefined=function(){return!1},fu.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var vs=function(t,r){this.type=dn,this.geojson=t,this.geometries=r};function Bu(e){if(e instanceof Eo){if(e.name==="get"&&e.args.length===1)return!1;if(e.name==="feature-state")return!1;if(e.name==="has"&&e.args.length===1)return!1;if(e.name==="properties"||e.name==="geometry-type"||e.name==="id")return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof vs)return!1;var t=!0;return e.eachChild(function(r){t&&!Bu(r)&&(t=!1)}),t}function ws(e){if(e instanceof Eo&&e.name==="feature-state")return!1;var t=!0;return e.eachChild(function(r){t&&!ws(r)&&(t=!1)}),t}function _o(e,t){if(e instanceof Eo&&t.indexOf(e.name)>=0)return!1;var r=!0;return e.eachChild(function(u){r&&!_o(u,t)&&(r=!1)}),r}vs.parse=function(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(cu(e[1])){var r=e[1];if(r.type==="FeatureCollection")for(var u=0;u<r.features.length;++u){var h=r.features[u].geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new vs(r,r.features[u].geometry)}else if(r.type==="Feature"){var g=r.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new vs(r,r.geometry)}else if(r.type==="Polygon"||r.type==="MultiPolygon")return new vs(r,r)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},vs.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(t,r){var u=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],g=t.canonicalID();if(r.type==="Polygon"){var A=To(r.coordinates,h,g),L=Ks(t.geometry(),u,h,g);if(!Ie(u,h))return!1;for(var B=0,te=L;B<te.length;B+=1)if(!en(te[B],A))return!1}if(r.type==="MultiPolygon"){var pe=tl(r.coordinates,h,g),Se=Ks(t.geometry(),u,h,g);if(!Ie(u,h))return!1;for(var Me=0,it=Se;Me<it.length;Me+=1)if(!bn(it[Me],pe))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(t,r){var u=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],g=t.canonicalID();if(r.type==="Polygon"){var A=To(r.coordinates,h,g),L=jc(t.geometry(),u,h,g);if(!Ie(u,h))return!1;for(var B=0,te=L;B<te.length;B+=1)if(!qi(te[B],A))return!1}if(r.type==="MultiPolygon"){var pe=tl(r.coordinates,h,g),Se=jc(t.geometry(),u,h,g);if(!Ie(u,h))return!1;for(var Me=0,it=Se;Me<it.length;Me+=1)if(!Mo(it[Me],pe))return!1}return!0}(e,this.geometries)}return!1},vs.prototype.eachChild=function(){},vs.prototype.outputDefined=function(){return!0},vs.prototype.serialize=function(){return["within",this.geojson]};var Po=function(t,r){this.type=r.type,this.name=t,this.boundExpression=r};Po.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var r=e[1];return t.scope.has(r)?new Po(r,t.scope.get(r)):t.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},Po.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},Po.prototype.eachChild=function(){},Po.prototype.outputDefined=function(){return!1},Po.prototype.serialize=function(){return["var",this.name]};var $s=function(t,r,u,h,g){r===void 0&&(r=[]),h===void 0&&(h=new Br),g===void 0&&(g=[]),this.registry=t,this.path=r,this.key=r.map(function(A){return"["+A+"]"}).join(""),this.scope=h,this.errors=g,this.expectedType=u};function bl(e,t){for(var r,u=e.length-1,h=0,g=u,A=0;h<=g;)if((r=e[A=Math.floor((h+g)/2)])<=t){if(A===u||t<e[A+1])return A;h=A+1}else{if(!(r>t))throw new Na("Input is not a number.");g=A-1}return 0}$s.prototype.parse=function(e,t,r,u,h){return h===void 0&&(h={}),t?this.concat(t,r,u)._parse(e,h):this._parse(e,h)},$s.prototype._parse=function(e,t){function r(te,pe,Se){return Se==="assert"?new Ai(pe,[te]):Se==="coerce"?new so(pe,[te]):te}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var u=e[0];if(typeof u!="string")return this.error("Expression name must be a string, but found "+typeof u+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var h=this.registry[u];if(h){var g=h.parse(e,this);if(!g)return null;if(this.expectedType){var A=this.expectedType,L=g.type;if(A.kind!=="string"&&A.kind!=="number"&&A.kind!=="boolean"&&A.kind!=="object"&&A.kind!=="array"||L.kind!=="value")if(A.kind!=="color"&&A.kind!=="formatted"&&A.kind!=="resolvedImage"||L.kind!=="value"&&L.kind!=="string"){if(this.checkSubtype(A,L))return null}else g=r(g,A,t.typeAnnotation||"coerce");else g=r(g,A,t.typeAnnotation||"assert")}if(!(g instanceof oo)&&g.type.kind!=="resolvedImage"&&function te(pe){if(pe instanceof Po)return te(pe.boundExpression);if(pe instanceof Eo&&pe.name==="error")return!1;if(pe instanceof fu)return!1;if(pe instanceof vs)return!1;var Se=pe instanceof so||pe instanceof Ai,Me=!0;return pe.eachChild(function(it){Me=Se?Me&&te(it):Me&&it instanceof oo}),!!Me&&Bu(pe)&&_o(pe,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(g)){var B=new Ys;try{g=new oo(g.type,g.evaluate(B))}catch(te){return this.error(te.message),null}}return g}return this.error('Unknown expression "'+u+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},$s.prototype.concat=function(e,t,r){var u=typeof e=="number"?this.path.concat(e):this.path,h=r?this.scope.concat(r):this.scope;return new $s(this.registry,u,t||null,h,this.errors)},$s.prototype.error=function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];var u=""+this.key+t.map(function(h){return"["+h+"]"}).join("");this.errors.push(new or(u,e))},$s.prototype.checkSubtype=function(e,t){var r=Ri(e,t);return r&&this.error(r),r};var Su=function(t,r,u){this.type=t,this.input=r,this.labels=[],this.outputs=[];for(var h=0,g=u;h<g.length;h+=1){var A=g[h],L=A[1];this.labels.push(A[0]),this.outputs.push(L)}};function ka(e,t,r){return e*(1-r)+t*r}Su.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var r=t.parse(e[1],1,dr);if(!r)return null;var u=[],h=null;t.expectedType&&t.expectedType.kind!=="value"&&(h=t.expectedType);for(var g=1;g<e.length;g+=2){var A=g===1?-1/0:e[g],L=e[g+1],B=g,te=g+1;if(typeof A!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',B);if(u.length&&u[u.length-1][0]>=A)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',B);var pe=t.parse(L,te,h);if(!pe)return null;h=h||pe.type,u.push([A,pe])}return new Su(h,r,u)},Su.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var u=this.input.evaluate(e);if(u<=t[0])return r[0].evaluate(e);var h=t.length;return u>=t[h-1]?r[h-1].evaluate(e):r[bl(t,u)].evaluate(e)},Su.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},Su.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Su.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var hu=Object.freeze({__proto__:null,number:ka,color:function(t,r,u){return new Ln(ka(t.r,r.r,u),ka(t.g,r.g,u),ka(t.b,r.b,u),ka(t.a,r.a,u))},array:function(t,r,u){return t.map(function(h,g){return ka(h,r[g],u)})}}),ec=6/29*3*(6/29),Js=Math.PI/180,ns=180/Math.PI;function wt(e){return e>.008856451679035631?Math.pow(e,1/3):e/ec+4/29}function er(e){return e>6/29?e*e*e:ec*(e-4/29)}function Ar(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Bn(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Qa(e){var t=Bn(e.r),r=Bn(e.g),u=Bn(e.b),h=wt((.4124564*t+.3575761*r+.1804375*u)/.95047),g=wt((.2126729*t+.7151522*r+.072175*u)/1);return{l:116*g-16,a:500*(h-g),b:200*(g-wt((.0193339*t+.119192*r+.9503041*u)/1.08883)),alpha:e.a}}function Ii(e){var t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,u=isNaN(e.b)?t:t-e.b/200;return t=1*er(t),r=.95047*er(r),u=1.08883*er(u),new Ln(Ar(3.2404542*r-1.5371385*t-.4985314*u),Ar(-.969266*r+1.8760108*t+.041556*u),Ar(.0556434*r-.2040259*t+1.0572252*u),e.alpha)}function Ki(e,t,r){var u=t-e;return e+r*(u>180||u<-180?u-360*Math.round(u/360):u)}var ja={forward:Qa,reverse:Ii,interpolate:function(t,r,u){return{l:ka(t.l,r.l,u),a:ka(t.a,r.a,u),b:ka(t.b,r.b,u),alpha:ka(t.alpha,r.alpha,u)}}},pi={forward:function(t){var r=Qa(t),u=r.l,h=r.a,g=r.b,A=Math.atan2(g,h)*ns;return{h:A<0?A+360:A,c:Math.sqrt(h*h+g*g),l:u,alpha:t.a}},reverse:function(t){var r=t.h*Js,u=t.c;return Ii({l:t.l,a:Math.cos(r)*u,b:Math.sin(r)*u,alpha:t.alpha})},interpolate:function(t,r,u){return{h:Ki(t.h,r.h,u),c:ka(t.c,r.c,u),l:ka(t.l,r.l,u),alpha:ka(t.alpha,r.alpha,u)}}},Zo=Object.freeze({__proto__:null,lab:ja,hcl:pi}),Ci=function(t,r,u,h,g){this.type=t,this.operator=r,this.interpolation=u,this.input=h,this.labels=[],this.outputs=[];for(var A=0,L=g;A<L.length;A+=1){var B=L[A],te=B[1];this.labels.push(B[0]),this.outputs.push(te)}};function Xo(e,t,r,u){var h=u-r,g=e-r;return h===0?0:t===1?g/h:(Math.pow(t,g)-1)/(Math.pow(t,h)-1)}Ci.interpolationFactor=function(e,t,r,u){var h=0;if(e.name==="exponential")h=Xo(t,e.base,r,u);else if(e.name==="linear")h=Xo(t,1,r,u);else if(e.name==="cubic-bezier"){var g=e.controlPoints;h=new D(g[0],g[1],g[2],g[3]).solve(Xo(t,1,r,u))}return h},Ci.parse=function(e,t){var r=e[0],u=e[1],h=e[2],g=e.slice(3);if(!Array.isArray(u)||u.length===0)return t.error("Expected an interpolation type expression.",1);if(u[0]==="linear")u={name:"linear"};else if(u[0]==="exponential"){var A=u[1];if(typeof A!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:A}}else{if(u[0]!=="cubic-bezier")return t.error("Unknown interpolation type "+String(u[0]),1,0);var L=u.slice(1);if(L.length!==4||L.some(function(Gt){return typeof Gt!="number"||Gt<0||Gt>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:L}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(h=t.parse(h,2,dr)))return null;var B=[],te=null;r==="interpolate-hcl"||r==="interpolate-lab"?te=Kn:t.expectedType&&t.expectedType.kind!=="value"&&(te=t.expectedType);for(var pe=0;pe<g.length;pe+=2){var Se=g[pe],Me=g[pe+1],it=pe+3,St=pe+4;if(typeof Se!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',it);if(B.length&&B[B.length-1][0]>=Se)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',it);var xt=t.parse(Me,St,te);if(!xt)return null;te=te||xt.type,B.push([Se,xt])}return te.kind==="number"||te.kind==="color"||te.kind==="array"&&te.itemType.kind==="number"&&typeof te.N=="number"?new Ci(te,r,u,h,B):t.error("Type "+ca(te)+" is not interpolatable.")},Ci.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var u=this.input.evaluate(e);if(u<=t[0])return r[0].evaluate(e);var h=t.length;if(u>=t[h-1])return r[h-1].evaluate(e);var g=bl(t,u),A=Ci.interpolationFactor(this.interpolation,u,t[g],t[g+1]),L=r[g].evaluate(e),B=r[g+1].evaluate(e);return this.operator==="interpolate"?hu[this.type.kind.toLowerCase()](L,B,A):this.operator==="interpolate-hcl"?pi.reverse(pi.interpolate(pi.forward(L),pi.forward(B),A)):ja.reverse(ja.interpolate(ja.forward(L),ja.forward(B),A))},Ci.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},Ci.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Ci.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],r=0;r<this.labels.length;r++)t.push(this.labels[r],this.outputs[r].serialize());return t};var Au=function(t,r){this.type=t,this.args=r};Au.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var r=null,u=t.expectedType;u&&u.kind!=="value"&&(r=u);for(var h=[],g=0,A=e.slice(1);g<A.length;g+=1){var L=t.parse(A[g],1+h.length,r,void 0,{typeAnnotation:"omit"});if(!L)return null;r=r||L.type,h.push(L)}var B=u&&h.some(function(te){return Ri(u,te.type)});return new Au(B?ur:r,h)},Au.prototype.evaluate=function(e){for(var t,r=null,u=0,h=0,g=this.args;h<g.length&&(u++,(r=g[h].evaluate(e))&&r instanceof Oo&&!r.available&&(t||(t=r.name),r=null,u===this.args.length&&(r=t)),r===null);h+=1);return r},Au.prototype.eachChild=function(e){this.args.forEach(e)},Au.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Au.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var du=function(t,r){this.type=r.type,this.bindings=[].concat(t),this.result=r};du.prototype.evaluate=function(e){return this.result.evaluate(e)},du.prototype.eachChild=function(e){for(var t=0,r=this.bindings;t<r.length;t+=1)e(r[t][1]);e(this.result)},du.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var r=[],u=1;u<e.length-1;u+=2){var h=e[u];if(typeof h!="string")return t.error("Expected string, but found "+typeof h+" instead.",u);if(/[^a-zA-Z0-9_]/.test(h))return t.error("Variable names must contain only alphanumeric characters or '_'.",u);var g=t.parse(e[u+1],u+1);if(!g)return null;r.push([h,g])}var A=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return A?new du(r,A):null},du.prototype.outputDefined=function(){return this.result.outputDefined()},du.prototype.serialize=function(){for(var e=["let"],t=0,r=this.bindings;t<r.length;t+=1){var u=r[t];e.push(u[0],u[1].serialize())}return e.push(this.result.serialize()),e};var Ds=function(t,r,u){this.type=t,this.index=r,this.input=u};Ds.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,dr),u=t.parse(e[2],2,ea(t.expectedType||ur));return r&&u?new Ds(u.type.itemType,r,u):null},Ds.prototype.evaluate=function(e){var t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new Na("Array index out of bounds: "+t+" < 0.");if(t>=r.length)throw new Na("Array index out of bounds: "+t+" > "+(r.length-1)+".");if(t!==Math.floor(t))throw new Na("Array index must be an integer, but found "+t+" instead.");return r[t]},Ds.prototype.eachChild=function(e){e(this.index),e(this.input)},Ds.prototype.outputDefined=function(){return!1},Ds.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var xl=function(t,r){this.type=dn,this.needle=t,this.haystack=r};xl.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,ur),u=t.parse(e[2],2,ur);return r&&u?va(r.type,[dn,Xr,dr,Tn,ur])?new xl(r,u):t.error("Expected first argument to be of type boolean, string, number or null, but found "+ca(r.type)+" instead"):null},xl.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!ii(t,["boolean","string","number","null"]))throw new Na("Expected first argument to be of type boolean, string, number or null, but found "+ca(fa(t))+" instead.");if(!ii(r,["string","array"]))throw new Na("Expected second argument to be of type array or string, but found "+ca(fa(r))+" instead.");return r.indexOf(t)>=0},xl.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},xl.prototype.outputDefined=function(){return!0},xl.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Qs=function(t,r,u){this.type=dr,this.needle=t,this.haystack=r,this.fromIndex=u};Qs.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,ur),u=t.parse(e[2],2,ur);if(!r||!u)return null;if(!va(r.type,[dn,Xr,dr,Tn,ur]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+ca(r.type)+" instead");if(e.length===4){var h=t.parse(e[3],3,dr);return h?new Qs(r,u,h):null}return new Qs(r,u)},Qs.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!ii(t,["boolean","string","number","null"]))throw new Na("Expected first argument to be of type boolean, string, number or null, but found "+ca(fa(t))+" instead.");if(!ii(r,["string","array"]))throw new Na("Expected second argument to be of type array or string, but found "+ca(fa(r))+" instead.");if(this.fromIndex){var u=this.fromIndex.evaluate(e);return r.indexOf(t,u)}return r.indexOf(t)},Qs.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},Qs.prototype.outputDefined=function(){return!1},Qs.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var rl=function(t,r,u,h,g,A){this.inputType=t,this.type=r,this.input=u,this.cases=h,this.outputs=g,this.otherwise=A};rl.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var r,u;t.expectedType&&t.expectedType.kind!=="value"&&(u=t.expectedType);for(var h={},g=[],A=2;A<e.length-1;A+=2){var L=e[A],B=e[A+1];Array.isArray(L)||(L=[L]);var te=t.concat(A);if(L.length===0)return te.error("Expected at least one branch label.");for(var pe=0,Se=L;pe<Se.length;pe+=1){var Me=Se[pe];if(typeof Me!="number"&&typeof Me!="string")return te.error("Branch labels must be numbers or strings.");if(typeof Me=="number"&&Math.abs(Me)>Number.MAX_SAFE_INTEGER)return te.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof Me=="number"&&Math.floor(Me)!==Me)return te.error("Numeric branch labels must be integer values.");if(r){if(te.checkSubtype(r,fa(Me)))return null}else r=fa(Me);if(h[String(Me)]!==void 0)return te.error("Branch labels must be unique.");h[String(Me)]=g.length}var it=t.parse(B,A,u);if(!it)return null;u=u||it.type,g.push(it)}var St=t.parse(e[1],1,ur);if(!St)return null;var xt=t.parse(e[e.length-1],e.length-1,u);return xt?St.type.kind!=="value"&&t.concat(1).checkSubtype(r,St.type)?null:new rl(r,u,St,h,g,xt):null},rl.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(fa(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},rl.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},rl.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},rl.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],r=[],u={},h=0,g=Object.keys(this.cases).sort();h<g.length;h+=1){var A=g[h];(Se=u[this.cases[A]])===void 0?(u[this.cases[A]]=r.length,r.push([this.cases[A],[A]])):r[Se][1].push(A)}for(var L=function(St){return e.inputType.kind==="number"?Number(St):St},B=0,te=r;B<te.length;B+=1){var pe=te[B],Se=pe[0],Me=pe[1];t.push(Me.length===1?L(Me[0]):Me.map(L)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var qs=function(t,r,u){this.type=t,this.branches=r,this.otherwise=u};qs.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var r;t.expectedType&&t.expectedType.kind!=="value"&&(r=t.expectedType);for(var u=[],h=1;h<e.length-1;h+=2){var g=t.parse(e[h],h,dn);if(!g)return null;var A=t.parse(e[h+1],h+1,r);if(!A)return null;u.push([g,A]),r=r||A.type}var L=t.parse(e[e.length-1],e.length-1,r);return L?new qs(r,u,L):null},qs.prototype.evaluate=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var u=r[t],h=u[1];if(u[0].evaluate(e))return h.evaluate(e)}return this.otherwise.evaluate(e)},qs.prototype.eachChild=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var u=r[t],h=u[1];e(u[0]),e(h)}e(this.otherwise)},qs.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},qs.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Vu=function(t,r,u,h){this.type=t,this.input=r,this.beginIndex=u,this.endIndex=h};function tc(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function vc(e,t,r,u){return u.compare(t,r)===0}function gc(e,t,r){var u=e!=="=="&&e!=="!=";return function(){function h(g,A,L){this.type=dn,this.lhs=g,this.rhs=A,this.collator=L,this.hasUntypedArgument=g.type.kind==="value"||A.type.kind==="value"}return h.parse=function(g,A){if(g.length!==3&&g.length!==4)return A.error("Expected two or three arguments.");var L=g[0],B=A.parse(g[1],1,ur);if(!B)return null;if(!tc(L,B.type))return A.concat(1).error('"'+L+`" comparisons are not supported for type '`+ca(B.type)+"'.");var te=A.parse(g[2],2,ur);if(!te)return null;if(!tc(L,te.type))return A.concat(2).error('"'+L+`" comparisons are not supported for type '`+ca(te.type)+"'.");if(B.type.kind!==te.type.kind&&B.type.kind!=="value"&&te.type.kind!=="value")return A.error("Cannot compare types '"+ca(B.type)+"' and '"+ca(te.type)+"'.");u&&(B.type.kind==="value"&&te.type.kind!=="value"?B=new Ai(te.type,[B]):B.type.kind!=="value"&&te.type.kind==="value"&&(te=new Ai(B.type,[te])));var pe=null;if(g.length===4){if(B.type.kind!=="string"&&te.type.kind!=="string"&&B.type.kind!=="value"&&te.type.kind!=="value")return A.error("Cannot use collator to compare non-string types.");if(!(pe=A.parse(g[3],3,kn)))return null}return new h(B,te,pe)},h.prototype.evaluate=function(g){var A=this.lhs.evaluate(g),L=this.rhs.evaluate(g);if(u&&this.hasUntypedArgument){var B=fa(A),te=fa(L);if(B.kind!==te.kind||B.kind!=="string"&&B.kind!=="number")throw new Na('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+B.kind+", "+te.kind+") instead.")}if(this.collator&&!u&&this.hasUntypedArgument){var pe=fa(A),Se=fa(L);if(pe.kind!=="string"||Se.kind!=="string")return t(g,A,L)}return this.collator?r(g,A,L,this.collator.evaluate(g)):t(g,A,L)},h.prototype.eachChild=function(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)},h.prototype.outputDefined=function(){return!0},h.prototype.serialize=function(){var g=[e];return this.eachChild(function(A){g.push(A.serialize())}),g},h}()}Vu.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,ur),u=t.parse(e[2],2,dr);if(!r||!u)return null;if(!va(r.type,[ea(ur),Xr,ur]))return t.error("Expected first argument to be of type array or string, but found "+ca(r.type)+" instead");if(e.length===4){var h=t.parse(e[3],3,dr);return h?new Vu(r.type,r,u,h):null}return new Vu(r.type,r,u)},Vu.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(!ii(t,["string","array"]))throw new Na("Expected first argument to be of type array or string, but found "+ca(fa(t))+" instead.");if(this.endIndex){var u=this.endIndex.evaluate(e);return t.slice(r,u)}return t.slice(r)},Vu.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},Vu.prototype.outputDefined=function(){return!1},Vu.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Ui=gc("==",function(e,t,r){return t===r},vc),zc=gc("!=",function(e,t,r){return t!==r},function(e,t,r,u){return!vc(0,t,r,u)}),yc=gc("<",function(e,t,r){return t<r},function(e,t,r,u){return u.compare(t,r)<0}),nf=gc(">",function(e,t,r){return t>r},function(e,t,r,u){return u.compare(t,r)>0}),af=gc("<=",function(e,t,r){return t<=r},function(e,t,r,u){return u.compare(t,r)<=0}),of=gc(">=",function(e,t,r){return t>=r},function(e,t,r,u){return u.compare(t,r)>=0}),Ti=function(t,r,u,h,g){this.type=Xr,this.number=t,this.locale=r,this.currency=u,this.minFractionDigits=h,this.maxFractionDigits=g};Ti.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var r=t.parse(e[1],1,dr);if(!r)return null;var u=e[2];if(typeof u!="object"||Array.isArray(u))return t.error("NumberFormat options argument must be an object.");var h=null;if(u.locale&&!(h=t.parse(u.locale,1,Xr)))return null;var g=null;if(u.currency&&!(g=t.parse(u.currency,1,Xr)))return null;var A=null;if(u["min-fraction-digits"]&&!(A=t.parse(u["min-fraction-digits"],1,dr)))return null;var L=null;return u["max-fraction-digits"]&&!(L=t.parse(u["max-fraction-digits"],1,dr))?null:new Ti(r,h,g,A,L)},Ti.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},Ti.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},Ti.prototype.outputDefined=function(){return!1},Ti.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var Cu=function(t){this.type=dr,this.input=t};Cu.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1);return r?r.type.kind!=="array"&&r.type.kind!=="string"&&r.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+ca(r.type)+" instead."):new Cu(r):null},Cu.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string")return t.length;if(Array.isArray(t))return t.length;throw new Na("Expected value to be of type string or array, but found "+ca(fa(t))+" instead.")},Cu.prototype.eachChild=function(e){e(this.input)},Cu.prototype.outputDefined=function(){return!1},Cu.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var pu={"==":Ui,"!=":zc,">":nf,"<":yc,">=":of,"<=":af,array:Ai,at:Ds,boolean:Ai,case:qs,coalesce:Au,collator:fu,format:li,image:xo,in:xl,"index-of":Qs,interpolate:Ci,"interpolate-hcl":Ci,"interpolate-lab":Ci,length:Cu,let:du,literal:oo,match:rl,number:Ai,"number-format":Ti,object:Ai,slice:Vu,step:Su,string:Ai,"to-boolean":so,"to-color":so,"to-number":so,"to-string":so,var:Po,within:vs};function eu(e,t){var r=t[0],u=t[1],h=t[2],g=t[3];r=r.evaluate(e),u=u.evaluate(e),h=h.evaluate(e);var A=g?g.evaluate(e):1,L=Ml(r,u,h,A);if(L)throw new Na(L);return new Ln(r/255*A,u/255*A,h/255*A,A)}function Fc(e,t){return e in t}function rc(e,t){var r=t[e];return r===void 0?null:r}function mu(e){return{type:e}}function Uc(e){return{result:"success",value:e}}function nl(e){return{result:"error",value:e}}function tu(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function nc(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function bc(e){return!!e.expression&&e.expression.interpolated}function mi(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function xc(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function Rf(e){return e}function Ec(e,t,r){return e!==void 0?e:t!==void 0?t:r!==void 0?r:void 0}function If(e,t,r,u,h){return Ec(typeof r===h?u[r]:void 0,e.default,t.default)}function Bc(e,t,r){if(mi(r)!=="number")return Ec(e.default,t.default);var u=e.stops.length;if(u===1)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[u-1][0])return e.stops[u-1][1];var h=bl(e.stops.map(function(g){return g[0]}),r);return e.stops[h][1]}function Pl(e,t,r){var u=e.base!==void 0?e.base:1;if(mi(r)!=="number")return Ec(e.default,t.default);var h=e.stops.length;if(h===1)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[h-1][0])return e.stops[h-1][1];var g=bl(e.stops.map(function(Se){return Se[0]}),r),A=function(Se,Me,it,St){var xt=St-it,Gt=Se-it;return xt===0?0:Me===1?Gt/xt:(Math.pow(Me,Gt)-1)/(Math.pow(Me,xt)-1)}(r,u,e.stops[g][0],e.stops[g+1][0]),L=e.stops[g][1],B=e.stops[g+1][1],te=hu[t.type]||Rf;if(e.colorSpace&&e.colorSpace!=="rgb"){var pe=Zo[e.colorSpace];te=function(Me,it){return pe.reverse(pe.interpolate(pe.forward(Me),pe.forward(it),A))}}return typeof L.evaluate=="function"?{evaluate:function(){for(var Me=[],it=arguments.length;it--;)Me[it]=arguments[it];var St=L.evaluate.apply(void 0,Me),xt=B.evaluate.apply(void 0,Me);if(St!==void 0&&xt!==void 0)return te(St,xt,A)}}:te(L,B,A)}function al(e,t,r){return t.type==="color"?r=Ln.parse(r):t.type==="formatted"?r=qa.fromString(r.toString()):t.type==="resolvedImage"?r=Oo.fromString(r.toString()):mi(r)===t.type||t.type==="enum"&&t.values[r]||(r=void 0),Ec(r,e.default,t.default)}Eo.register(pu,{error:[{kind:"error"},[Xr],function(e,t){throw new Na(t[0].evaluate(e))}],typeof:[Xr,[ur],function(e,t){return ca(fa(t[0].evaluate(e)))}],"to-rgba":[ea(dr,4),[Kn],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[Kn,[dr,dr,dr],eu],rgba:[Kn,[dr,dr,dr,dr],eu],has:{type:dn,overloads:[[[Xr],function(e,t){return Fc(t[0].evaluate(e),e.properties())}],[[Xr,gn],function(e,t){var r=t[1];return Fc(t[0].evaluate(e),r.evaluate(e))}]]},get:{type:ur,overloads:[[[Xr],function(e,t){return rc(t[0].evaluate(e),e.properties())}],[[Xr,gn],function(e,t){var r=t[1];return rc(t[0].evaluate(e),r.evaluate(e))}]]},"feature-state":[ur,[Xr],function(e,t){return rc(t[0].evaluate(e),e.featureState||{})}],properties:[gn,[],function(e){return e.properties()}],"geometry-type":[Xr,[],function(e){return e.geometryType()}],id:[ur,[],function(e){return e.id()}],zoom:[dr,[],function(e){return e.globals.zoom}],"heatmap-density":[dr,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[dr,[],function(e){return e.globals.lineProgress||0}],accumulated:[ur,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[dr,mu(dr),function(e,t){for(var r=0,u=0,h=t;u<h.length;u+=1)r+=h[u].evaluate(e);return r}],"*":[dr,mu(dr),function(e,t){for(var r=1,u=0,h=t;u<h.length;u+=1)r*=h[u].evaluate(e);return r}],"-":{type:dr,overloads:[[[dr,dr],function(e,t){var r=t[1];return t[0].evaluate(e)-r.evaluate(e)}],[[dr],function(e,t){return-t[0].evaluate(e)}]]},"/":[dr,[dr,dr],function(e,t){var r=t[1];return t[0].evaluate(e)/r.evaluate(e)}],"%":[dr,[dr,dr],function(e,t){var r=t[1];return t[0].evaluate(e)%r.evaluate(e)}],ln2:[dr,[],function(){return Math.LN2}],pi:[dr,[],function(){return Math.PI}],e:[dr,[],function(){return Math.E}],"^":[dr,[dr,dr],function(e,t){var r=t[1];return Math.pow(t[0].evaluate(e),r.evaluate(e))}],sqrt:[dr,[dr],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[dr,[dr],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[dr,[dr],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[dr,[dr],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[dr,[dr],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[dr,[dr],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[dr,[dr],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[dr,[dr],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[dr,[dr],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[dr,[dr],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[dr,mu(dr),function(e,t){return Math.min.apply(Math,t.map(function(r){return r.evaluate(e)}))}],max:[dr,mu(dr),function(e,t){return Math.max.apply(Math,t.map(function(r){return r.evaluate(e)}))}],abs:[dr,[dr],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[dr,[dr],function(e,t){var r=t[0].evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[dr,[dr],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[dr,[dr],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[dn,[Xr,ur],function(e,t){var r=t[0],u=t[1];return e.properties()[r.value]===u.value}],"filter-id-==":[dn,[ur],function(e,t){var r=t[0];return e.id()===r.value}],"filter-type-==":[dn,[Xr],function(e,t){var r=t[0];return e.geometryType()===r.value}],"filter-<":[dn,[Xr,ur],function(e,t){var r=t[0],u=t[1],h=e.properties()[r.value],g=u.value;return typeof h==typeof g&&h<g}],"filter-id-<":[dn,[ur],function(e,t){var r=t[0],u=e.id(),h=r.value;return typeof u==typeof h&&u<h}],"filter->":[dn,[Xr,ur],function(e,t){var r=t[0],u=t[1],h=e.properties()[r.value],g=u.value;return typeof h==typeof g&&h>g}],"filter-id->":[dn,[ur],function(e,t){var r=t[0],u=e.id(),h=r.value;return typeof u==typeof h&&u>h}],"filter-<=":[dn,[Xr,ur],function(e,t){var r=t[0],u=t[1],h=e.properties()[r.value],g=u.value;return typeof h==typeof g&&h<=g}],"filter-id-<=":[dn,[ur],function(e,t){var r=t[0],u=e.id(),h=r.value;return typeof u==typeof h&&u<=h}],"filter->=":[dn,[Xr,ur],function(e,t){var r=t[0],u=t[1],h=e.properties()[r.value],g=u.value;return typeof h==typeof g&&h>=g}],"filter-id->=":[dn,[ur],function(e,t){var r=t[0],u=e.id(),h=r.value;return typeof u==typeof h&&u>=h}],"filter-has":[dn,[ur],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[dn,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[dn,[ea(Xr)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[dn,[ea(ur)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[dn,[Xr,ea(ur)],function(e,t){var r=t[0];return t[1].value.indexOf(e.properties()[r.value])>=0}],"filter-in-large":[dn,[Xr,ea(ur)],function(e,t){var r=t[0],u=t[1];return function(h,g,A,L){for(;A<=L;){var B=A+L>>1;if(g[B]===h)return!0;g[B]>h?L=B-1:A=B+1}return!1}(e.properties()[r.value],u.value,0,u.value.length-1)}],all:{type:dn,overloads:[[[dn,dn],function(e,t){var r=t[1];return t[0].evaluate(e)&&r.evaluate(e)}],[mu(dn),function(e,t){for(var r=0,u=t;r<u.length;r+=1)if(!u[r].evaluate(e))return!1;return!0}]]},any:{type:dn,overloads:[[[dn,dn],function(e,t){var r=t[1];return t[0].evaluate(e)||r.evaluate(e)}],[mu(dn),function(e,t){for(var r=0,u=t;r<u.length;r+=1)if(u[r].evaluate(e))return!0;return!1}]]},"!":[dn,[dn],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[dn,[Xr],function(e,t){var r=e.globals&&e.globals.isSupportedScript;return!r||r(t[0].evaluate(e))}],upcase:[Xr,[Xr],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[Xr,[Xr],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[Xr,mu(ur),function(e,t){return t.map(function(r){return Cs(r.evaluate(e))}).join("")}],"resolved-locale":[Xr,[kn],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var Os=function(t,r){this.expression=t,this._warningHistory={},this._evaluator=new Ys,this._defaultValue=r?function(u){return u.type==="color"&&xc(u.default)?new Ln(0,0,0,0):u.type==="color"?Ln.parse(u.default)||null:u.default===void 0?null:u.default}(r):null,this._enumValues=r&&r.type==="enum"?r.values:null};function ac(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in pu}function No(e,t){var r=new $s(pu,[],t?function(h){var g={color:Kn,string:Xr,number:dr,enum:Xr,boolean:dn,formatted:An,resolvedImage:Za};return h.type==="array"?ea(g[h.value]||ur,h.length):g[h.type]}(t):void 0),u=r.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?Uc(new Os(u,t)):nl(r.errors)}Os.prototype.evaluateWithoutErrorHandling=function(e,t,r,u,h,g){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=u,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=g,this.expression.evaluate(this._evaluator)},Os.prototype.evaluate=function(e,t,r,u,h,g){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=u,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=g||null;try{var A=this.expression.evaluate(this._evaluator);if(A==null||typeof A=="number"&&A!=A)return this._defaultValue;if(this._enumValues&&!(A in this._enumValues))throw new Na("Expected value to be one of "+Object.keys(this._enumValues).map(function(L){return JSON.stringify(L)}).join(", ")+", but found "+JSON.stringify(A)+" instead.");return A}catch(L){return this._warningHistory[L.message]||(this._warningHistory[L.message]=!0,typeof console!="undefined"&&console.warn(L.message)),this._defaultValue}};var Ll=function(t,r){this.kind=t,this._styleExpression=r,this.isStateDependent=t!=="constant"&&!ws(r.expression)};Ll.prototype.evaluateWithoutErrorHandling=function(e,t,r,u,h,g){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,u,h,g)},Ll.prototype.evaluate=function(e,t,r,u,h,g){return this._styleExpression.evaluate(e,t,r,u,h,g)};var El=function(t,r,u,h){this.kind=t,this.zoomStops=u,this._styleExpression=r,this.isStateDependent=t!=="camera"&&!ws(r.expression),this.interpolationType=h};function Vc(e,t){if((e=No(e,t)).result==="error")return e;var r=e.value.expression,u=Bu(r);if(!u&&!tu(t))return nl([new or("","data expressions not supported")]);var h=_o(r,["zoom"]);if(!h&&!nc(t))return nl([new or("","zoom expressions not supported")]);var g=function A(L){var B=null;if(L instanceof du)B=A(L.result);else if(L instanceof Au)for(var te=0,pe=L.args;te<pe.length&&!(B=A(pe[te]));te+=1);else(L instanceof Su||L instanceof Ci)&&L.input instanceof Eo&&L.input.name==="zoom"&&(B=L);return B instanceof or||L.eachChild(function(Se){var Me=A(Se);Me instanceof or?B=Me:!B&&Me?B=new or("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):B&&Me&&B!==Me&&(B=new or("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),B}(r);return g||h?g instanceof or?nl([g]):g instanceof Ci&&!bc(t)?nl([new or("",'"interpolate" expressions cannot be used with this property')]):Uc(g?new El(u?"camera":"composite",e.value,g.labels,g instanceof Ci?g.interpolation:void 0):new Ll(u?"constant":"source",e.value)):nl([new or("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}El.prototype.evaluateWithoutErrorHandling=function(e,t,r,u,h,g){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,u,h,g)},El.prototype.evaluate=function(e,t,r,u,h,g){return this._styleExpression.evaluate(e,t,r,u,h,g)},El.prototype.interpolationFactor=function(e,t,r){return this.interpolationType?Ci.interpolationFactor(this.interpolationType,e,t,r):0};var Rl=function(t,r){this._parameters=t,this._specification=r,qt(this,function u(h,g){var A,L,B,te=g.type==="color",pe=h.stops&&typeof h.stops[0][0]=="object",Se=pe||!(pe||h.property!==void 0),Me=h.type||(bc(g)?"exponential":"interval");if(te&&((h=qt({},h)).stops&&(h.stops=h.stops.map(function(Dn){return[Dn[0],Ln.parse(Dn[1])]})),h.default=Ln.parse(h.default?h.default:g.default)),h.colorSpace&&h.colorSpace!=="rgb"&&!Zo[h.colorSpace])throw new Error("Unknown color space: "+h.colorSpace);if(Me==="exponential")A=Pl;else if(Me==="interval")A=Bc;else if(Me==="categorical"){A=If,L=Object.create(null);for(var it=0,St=h.stops;it<St.length;it+=1){var xt=St[it];L[xt[0]]=xt[1]}B=typeof h.stops[0][0]}else{if(Me!=="identity")throw new Error('Unknown function type "'+Me+'"');A=al}if(pe){for(var Gt={},Bt=[],ar=0;ar<h.stops.length;ar++){var hr=h.stops[ar],Tr=hr[0].zoom;Gt[Tr]===void 0&&(Gt[Tr]={zoom:Tr,type:h.type,property:h.property,default:h.default,stops:[]},Bt.push(Tr)),Gt[Tr].stops.push([hr[0].value,hr[1]])}for(var Fr=[],Ir=0,hn=Bt;Ir<hn.length;Ir+=1){var yn=hn[Ir];Fr.push([Gt[yn].zoom,u(Gt[yn],g)])}var Un={name:"linear"};return{kind:"composite",interpolationType:Un,interpolationFactor:Ci.interpolationFactor.bind(void 0,Un),zoomStops:Fr.map(function(Dn){return Dn[0]}),evaluate:function(In,_a){var sa=In.zoom;return Pl({stops:Fr,base:h.base},g,sa).evaluate(sa,_a)}}}if(Se){var Jn=Me==="exponential"?{name:"exponential",base:h.base!==void 0?h.base:1}:null;return{kind:"camera",interpolationType:Jn,interpolationFactor:Ci.interpolationFactor.bind(void 0,Jn),zoomStops:h.stops.map(function(Dn){return Dn[0]}),evaluate:function(In){return A(h,g,In.zoom,L,B)}}}return{kind:"source",evaluate:function(In,_a){var sa=_a&&_a.properties?_a.properties[h.property]:void 0;return sa===void 0?Ec(h.default,g.default):A(h,g,sa,L,B)}}}(this._parameters,this._specification))};function ru(e){var t=e.key,r=e.value,u=e.valueSpec||{},h=e.objectElementValidators||{},g=e.style,A=e.styleSpec,L=[],B=mi(r);if(B!=="object")return[new ht(t,r,"object expected, "+B+" found")];for(var te in r){var pe=te.split(".")[0],Se=u[pe]||u["*"],Me=void 0;if(h[pe])Me=h[pe];else if(u[pe])Me=Yo;else if(h["*"])Me=h["*"];else{if(!u["*"]){L.push(new ht(t,r[te],'unknown property "'+te+'"'));continue}Me=Yo}L=L.concat(Me({key:(t&&t+".")+te,value:r[te],valueSpec:Se,style:g,styleSpec:A,object:r,objectKey:te},r))}for(var it in u)h[it]||u[it].required&&u[it].default===void 0&&r[it]===void 0&&L.push(new ht(t,r,'missing required property "'+it+'"'));return L}function Gc(e){var t=e.value,r=e.valueSpec,u=e.style,h=e.styleSpec,g=e.key,A=e.arrayElementValidator||Yo;if(mi(t)!=="array")return[new ht(g,t,"array expected, "+mi(t)+" found")];if(r.length&&t.length!==r.length)return[new ht(g,t,"array length "+r.length+" expected, length "+t.length+" found")];if(r["min-length"]&&t.length<r["min-length"])return[new ht(g,t,"array length at least "+r["min-length"]+" expected, length "+t.length+" found")];var L={type:r.value,values:r.values};h.$version<7&&(L.function=r.function),mi(r.value)==="object"&&(L=r.value);for(var B=[],te=0;te<t.length;te++)B=B.concat(A({array:t,arrayIndex:te,value:t[te],valueSpec:L,style:u,styleSpec:h,key:g+"["+te+"]"}));return B}function bf(e){var t=e.key,r=e.value,u=e.valueSpec,h=mi(r);return h==="number"&&r!=r&&(h="NaN"),h!=="number"?[new ht(t,r,"number expected, "+h+" found")]:"minimum"in u&&r<u.minimum?[new ht(t,r,r+" is less than the minimum value "+u.minimum)]:"maximum"in u&&r>u.maximum?[new ht(t,r,r+" is greater than the maximum value "+u.maximum)]:[]}function xf(e){var t,r,u,h=e.valueSpec,g=Nr(e.value.type),A={},L=g!=="categorical"&&e.value.property===void 0,B=!L,te=mi(e.value.stops)==="array"&&mi(e.value.stops[0])==="array"&&mi(e.value.stops[0][0])==="object",pe=ru({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(St){if(g==="identity")return[new ht(St.key,St.value,'identity function may not have a "stops" property')];var xt=[],Gt=St.value;return xt=xt.concat(Gc({key:St.key,value:Gt,valueSpec:St.valueSpec,style:St.style,styleSpec:St.styleSpec,arrayElementValidator:Se})),mi(Gt)==="array"&&Gt.length===0&&xt.push(new ht(St.key,Gt,"array must have at least one stop")),xt},default:function(St){return Yo({key:St.key,value:St.value,valueSpec:h,style:St.style,styleSpec:St.styleSpec})}}});return g==="identity"&&L&&pe.push(new ht(e.key,e.value,'missing required property "property"')),g==="identity"||e.value.stops||pe.push(new ht(e.key,e.value,'missing required property "stops"')),g==="exponential"&&e.valueSpec.expression&&!bc(e.valueSpec)&&pe.push(new ht(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(B&&!tu(e.valueSpec)?pe.push(new ht(e.key,e.value,"property functions not supported")):L&&!nc(e.valueSpec)&&pe.push(new ht(e.key,e.value,"zoom functions not supported"))),g!=="categorical"&&!te||e.value.property!==void 0||pe.push(new ht(e.key,e.value,'"property" property is required')),pe;function Se(it){var St=[],xt=it.value,Gt=it.key;if(mi(xt)!=="array")return[new ht(Gt,xt,"array expected, "+mi(xt)+" found")];if(xt.length!==2)return[new ht(Gt,xt,"array length 2 expected, length "+xt.length+" found")];if(te){if(mi(xt[0])!=="object")return[new ht(Gt,xt,"object expected, "+mi(xt[0])+" found")];if(xt[0].zoom===void 0)return[new ht(Gt,xt,"object stop key must have zoom")];if(xt[0].value===void 0)return[new ht(Gt,xt,"object stop key must have value")];if(u&&u>Nr(xt[0].zoom))return[new ht(Gt,xt[0].zoom,"stop zoom values must appear in ascending order")];Nr(xt[0].zoom)!==u&&(u=Nr(xt[0].zoom),r=void 0,A={}),St=St.concat(ru({key:Gt+"[0]",value:xt[0],valueSpec:{zoom:{}},style:it.style,styleSpec:it.styleSpec,objectElementValidators:{zoom:bf,value:Me}}))}else St=St.concat(Me({key:Gt+"[0]",value:xt[0],valueSpec:{},style:it.style,styleSpec:it.styleSpec},xt));return ac(qr(xt[1]))?St.concat([new ht(Gt+"[1]",xt[1],"expressions are not allowed in function stops.")]):St.concat(Yo({key:Gt+"[1]",value:xt[1],valueSpec:h,style:it.style,styleSpec:it.styleSpec}))}function Me(it,St){var xt=mi(it.value),Gt=Nr(it.value),Bt=it.value!==null?it.value:St;if(t){if(xt!==t)return[new ht(it.key,Bt,xt+" stop domain type must match previous stop domain type "+t)]}else t=xt;if(xt!=="number"&&xt!=="string"&&xt!=="boolean")return[new ht(it.key,Bt,"stop domain value must be a number, string, or boolean")];if(xt!=="number"&&g!=="categorical"){var ar="number expected, "+xt+" found";return tu(h)&&g===void 0&&(ar+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ht(it.key,Bt,ar)]}return g!=="categorical"||xt!=="number"||isFinite(Gt)&&Math.floor(Gt)===Gt?g!=="categorical"&&xt==="number"&&r!==void 0&&Gt<r?[new ht(it.key,Bt,"stop domain values must appear in ascending order")]:(r=Gt,g==="categorical"&&Gt in A?[new ht(it.key,Bt,"stop domain values must be unique")]:(A[Gt]=!0,[])):[new ht(it.key,Bt,"integer expected, found "+Gt)]}}function Il(e){var t=(e.expressionContext==="property"?Vc:No)(qr(e.value),e.valueSpec);if(t.result==="error")return t.value.map(function(u){return new ht(""+e.key+u.key,e.value,u.message)});var r=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!r.outputDefined())return[new ht(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!ws(r))return[new ht(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!ws(r))return[new ht(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!_o(r,["zoom","feature-state"]))return[new ht(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!Bu(r))return[new ht(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ic(e){var t=e.key,r=e.value,u=e.valueSpec,h=[];return Array.isArray(u.values)?u.values.indexOf(Nr(r))===-1&&h.push(new ht(t,r,"expected one of ["+u.values.join(", ")+"], "+JSON.stringify(r)+" found")):Object.keys(u.values).indexOf(Nr(r))===-1&&h.push(new ht(t,r,"expected one of ["+Object.keys(u.values).join(", ")+"], "+JSON.stringify(r)+" found")),h}function Zi(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,r=e.slice(1);t<r.length;t+=1){var u=r[t];if(!Zi(u)&&typeof u!="boolean")return!1}return!0;default:return!0}}Rl.deserialize=function(e){return new Rl(e._parameters,e._specification)},Rl.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var Dl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Gu(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};Zi(e)||(e=Nl(e));var t=No(e,Dl);if(t.result==="error")throw new Error(t.value.map(function(r){return r.key+": "+r.message}).join(", "));return{filter:function(u,h,g){return t.value.evaluate(u,h,{},g)},needGeometry:function r(u){if(!Array.isArray(u))return!1;if(u[0]==="within")return!0;for(var h=1;h<u.length;h++)if(r(u[h]))return!0;return!1}(e)}}function Ef(e,t){return e<t?-1:e>t?1:0}function Nl(e){if(!e)return!0;var t,r=e[0];return e.length<=1?r!=="any":r==="=="?oc(e[1],e[2],"=="):r==="!="?Tc(oc(e[1],e[2],"==")):r==="<"||r===">"||r==="<="||r===">="?oc(e[1],e[2],r):r==="any"?(t=e.slice(1),["any"].concat(t.map(Nl))):r==="all"?["all"].concat(e.slice(1).map(Nl)):r==="none"?["all"].concat(e.slice(1).map(Nl).map(Tc)):r==="in"?Wf(e[1],e.slice(2)):r==="!in"?Tc(Wf(e[1],e.slice(2))):r==="has"?Df(e[1]):r==="!has"?Tc(Df(e[1])):r!=="within"||e}function oc(e,t,r){switch(e){case"$type":return["filter-type-"+r,t];case"$id":return["filter-id-"+r,t];default:return["filter-"+r,e,t]}}function Wf(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(r){return typeof r!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(Ef)]]:["filter-in-small",e,["literal",t]]}}function Df(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Tc(e){return["!",e]}function kl(e){return Zi(qr(e.value))?Il(qt({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(r){var u=r.value,h=r.key;if(mi(u)!=="array")return[new ht(h,u,"array expected, "+mi(u)+" found")];var g,A=r.styleSpec,L=[];if(u.length<1)return[new ht(h,u,"filter array must have at least 1 element")];switch(L=L.concat(ic({key:h+"[0]",value:u[0],valueSpec:A.filter_operator,style:r.style,styleSpec:r.styleSpec})),Nr(u[0])){case"<":case"<=":case">":case">=":u.length>=2&&Nr(u[1])==="$type"&&L.push(new ht(h,u,'"$type" cannot be use with operator "'+u[0]+'"'));case"==":case"!=":u.length!==3&&L.push(new ht(h,u,'filter array for operator "'+u[0]+'" must have 3 elements'));case"in":case"!in":u.length>=2&&(g=mi(u[1]))!=="string"&&L.push(new ht(h+"[1]",u[1],"string expected, "+g+" found"));for(var B=2;B<u.length;B++)g=mi(u[B]),Nr(u[1])==="$type"?L=L.concat(ic({key:h+"["+B+"]",value:u[B],valueSpec:A.geometry_type,style:r.style,styleSpec:r.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&L.push(new ht(h+"["+B+"]",u[B],"string, number, or boolean expected, "+g+" found"));break;case"any":case"all":case"none":for(var te=1;te<u.length;te++)L=L.concat(t({key:h+"["+te+"]",value:u[te],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":g=mi(u[1]),u.length!==2?L.push(new ht(h,u,'filter array for "'+u[0]+'" operator must have 2 elements')):g!=="string"&&L.push(new ht(h+"[1]",u[1],"string expected, "+g+" found"));break;case"within":g=mi(u[1]),u.length!==2?L.push(new ht(h,u,'filter array for "'+u[0]+'" operator must have 2 elements')):g!=="object"&&L.push(new ht(h+"[1]",u[1],"object expected, "+g+" found"))}return L}(e)}function _c(e,t){var r=e.key,u=e.style,h=e.styleSpec,g=e.value,A=e.objectKey,L=h[t+"_"+e.layerType];if(!L)return[];var B=A.match(/^(.*)-transition$/);if(t==="paint"&&B&&L[B[1]]&&L[B[1]].transition)return Yo({key:r,value:g,valueSpec:h.transition,style:u,styleSpec:h});var te,pe=e.valueSpec||L[A];if(!pe)return[new ht(r,g,'unknown property "'+A+'"')];if(mi(g)==="string"&&tu(pe)&&!pe.tokens&&(te=/^{([^}]+)}$/.exec(g)))return[new ht(r,g,'"'+A+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(te[1])+" }`.")];var Se=[];return e.layerType==="symbol"&&(A==="text-field"&&u&&!u.glyphs&&Se.push(new ht(r,g,'use of "text-field" requires a style "glyphs" property')),A==="text-font"&&xc(qr(g))&&Nr(g.type)==="identity"&&Se.push(new ht(r,g,'"text-font" does not support identity functions'))),Se.concat(Yo({key:e.key,value:g,valueSpec:pe,style:u,styleSpec:h,expressionContext:"property",propertyType:t,propertyKey:A}))}function wu(e){return _c(e,"paint")}function Ns(e){return _c(e,"layout")}function il(e){var t=[],r=e.value,u=e.key,h=e.style,g=e.styleSpec;r.type||r.ref||t.push(new ht(u,r,'either "type" or "ref" is required'));var A,L=Nr(r.type),B=Nr(r.ref);if(r.id)for(var te=Nr(r.id),pe=0;pe<e.arrayIndex;pe++){var Se=h.layers[pe];Nr(Se.id)===te&&t.push(new ht(u,r.id,'duplicate layer id "'+r.id+'", previously used at line '+Se.id.__line__))}if("ref"in r)["type","source","source-layer","filter","layout"].forEach(function(St){St in r&&t.push(new ht(u,r[St],'"'+St+'" is prohibited for ref layers'))}),h.layers.forEach(function(St){Nr(St.id)===B&&(A=St)}),A?A.ref?t.push(new ht(u,r.ref,"ref cannot reference another ref layer")):L=Nr(A.type):t.push(new ht(u,r.ref,'ref layer "'+B+'" not found'));else if(L!=="background")if(r.source){var Me=h.sources&&h.sources[r.source],it=Me&&Nr(Me.type);Me?it==="vector"&&L==="raster"?t.push(new ht(u,r.source,'layer "'+r.id+'" requires a raster source')):it==="raster"&&L!=="raster"?t.push(new ht(u,r.source,'layer "'+r.id+'" requires a vector source')):it!=="vector"||r["source-layer"]?it==="raster-dem"&&L!=="hillshade"?t.push(new ht(u,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):L!=="line"||!r.paint||!r.paint["line-gradient"]||it==="geojson"&&Me.lineMetrics||t.push(new ht(u,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new ht(u,r,'layer "'+r.id+'" must specify a "source-layer"')):t.push(new ht(u,r.source,'source "'+r.source+'" not found'))}else t.push(new ht(u,r,'missing required property "source"'));return t=t.concat(ru({key:u,value:r,valueSpec:g.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Yo({key:u+".type",value:r.type,valueSpec:g.layer.type,style:e.style,styleSpec:e.styleSpec,object:r,objectKey:"type"})},filter:kl,layout:function(xt){return ru({layer:r,key:xt.key,value:xt.value,style:xt.style,styleSpec:xt.styleSpec,objectElementValidators:{"*":function(Bt){return Ns(qt({layerType:L},Bt))}}})},paint:function(xt){return ru({layer:r,key:xt.key,value:xt.value,style:xt.style,styleSpec:xt.styleSpec,objectElementValidators:{"*":function(Bt){return wu(qt({layerType:L},Bt))}}})}}}))}function Tl(e){var t=e.value,r=e.key,u=mi(t);return u!=="string"?[new ht(r,t,"string expected, "+u+" found")]:[]}var sc={promoteId:function(t){var r=t.key,u=t.value;if(mi(u)==="string")return Tl({key:r,value:u});var h=[];for(var g in u)h.push.apply(h,Tl({key:r+"."+g,value:u[g]}));return h}};function Bi(e){var t=e.value,r=e.key,u=e.styleSpec,h=e.style;if(!t.type)return[new ht(r,t,'"type" is required')];var g,A=Nr(t.type);switch(A){case"vector":case"raster":case"raster-dem":return ru({key:r,value:t,valueSpec:u["source_"+A.replace("-","_")],style:e.style,styleSpec:u,objectElementValidators:sc});case"geojson":if(g=ru({key:r,value:t,valueSpec:u.source_geojson,style:h,styleSpec:u,objectElementValidators:sc}),t.cluster)for(var L in t.clusterProperties){var B=t.clusterProperties[L],te=B[0],pe=typeof te=="string"?[te,["accumulated"],["get",L]]:te;g.push.apply(g,Il({key:r+"."+L+".map",value:B[1],expressionContext:"cluster-map"})),g.push.apply(g,Il({key:r+"."+L+".reduce",value:pe,expressionContext:"cluster-reduce"}))}return g;case"video":return ru({key:r,value:t,valueSpec:u.source_video,style:h,styleSpec:u});case"image":return ru({key:r,value:t,valueSpec:u.source_image,style:h,styleSpec:u});case"canvas":return[new ht(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ic({key:r+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:h,styleSpec:u})}}function vu(e){var t=e.value,r=e.styleSpec,u=r.light,h=e.style,g=[],A=mi(t);if(t===void 0)return g;if(A!=="object")return g.concat([new ht("light",t,"object expected, "+A+" found")]);for(var L in t){var B=L.match(/^(.*)-transition$/);g=g.concat(B&&u[B[1]]&&u[B[1]].transition?Yo({key:L,value:t[L],valueSpec:r.transition,style:h,styleSpec:r}):u[L]?Yo({key:L,value:t[L],valueSpec:u[L],style:h,styleSpec:r}):[new ht(L,t[L],'unknown property "'+L+'"')])}return g}var ol={"*":function(){return[]},array:Gc,boolean:function(t){var r=t.value,u=t.key,h=mi(r);return h!=="boolean"?[new ht(u,r,"boolean expected, "+h+" found")]:[]},number:bf,color:function(t){var r=t.key,u=t.value,h=mi(u);return h!=="string"?[new ht(r,u,"color expected, "+h+" found")]:Ia(u)===null?[new ht(r,u,'color expected, "'+u+'" found')]:[]},constants:Qt,enum:ic,filter:kl,function:xf,layer:il,object:ru,source:Bi,light:vu,string:Tl,formatted:function(t){return Tl(t).length===0?[]:Il(t)},resolvedImage:function(t){return Tl(t).length===0?[]:Il(t)}};function Yo(e){var t=e.value,r=e.valueSpec,u=e.styleSpec;return r.expression&&xc(Nr(t))?xf(e):r.expression&&ac(qr(t))?Il(e):r.type&&ol[r.type]?ol[r.type](e):ru(qt({},e,{valueSpec:r.type?u[r.type]:r}))}function ei(e){var t=e.value,r=e.key,u=Tl(e);return u.length||(t.indexOf("{fontstack}")===-1&&u.push(new ht(r,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&u.push(new ht(r,t,'"glyphs" url must include a "{range}" token'))),u}function $a(e,t){t===void 0&&(t=He);var r=[];return r=r.concat(Yo({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:ei,"*":function(){return[]}}})),e.constants&&(r=r.concat(Qt({key:"constants",value:e.constants,style:e,styleSpec:t}))),Hu(r)}function Hu(e){return[].concat(e).sort(function(t,r){return t.line-r.line})}function ti(e){return function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return Hu(e.apply(this,t))}}$a.source=ti(Bi),$a.light=ti(vu),$a.layer=ti(il),$a.filter=ti(kl),$a.paintProperty=ti(wu),$a.layoutProperty=ti(Ns);var Xa=$a,Tf=Xa.light,_f=Xa.paintProperty,Ko=Xa.layoutProperty;function Wu(e,t){var r=!1;if(t&&t.length)for(var u=0,h=t;u<h.length;u+=1)e.fire(new at(new Error(h[u].message))),r=!0;return r}var gs=ks;function ks(e,t,r){var u=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var h=new Int32Array(this.arrayBuffer);e=h[0],this.d=(t=h[1])+2*(r=h[2]);for(var g=0;g<this.d*this.d;g++){var A=h[3+g],L=h[3+g+1];u.push(A===L?null:h.subarray(A,L))}var B=h[3+u.length+1];this.keys=h.subarray(h[3+u.length],B),this.bboxes=h.subarray(B),this.insert=this._insertReadonly}else{this.d=t+2*r;for(var te=0;te<this.d*this.d;te++)u.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;var pe=r/t*e;this.min=-pe,this.max=e+pe}ks.prototype.insert=function(e,t,r,u,h){this._forEachCell(t,r,u,h,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(u),this.bboxes.push(h)},ks.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},ks.prototype._insertCell=function(e,t,r,u,h,g){this.cells[h].push(g)},ks.prototype.query=function(e,t,r,u,h){var g=this.min,A=this.max;if(e<=g&&t<=g&&A<=r&&A<=u&&!h)return Array.prototype.slice.call(this.keys);var L=[];return this._forEachCell(e,t,r,u,this._queryCell,L,{},h),L},ks.prototype._queryCell=function(e,t,r,u,h,g,A,L){var B=this.cells[h];if(B!==null)for(var te=this.keys,pe=this.bboxes,Se=0;Se<B.length;Se++){var Me=B[Se];if(A[Me]===void 0){var it=4*Me;(L?L(pe[it+0],pe[it+1],pe[it+2],pe[it+3]):e<=pe[it+2]&&t<=pe[it+3]&&r>=pe[it+0]&&u>=pe[it+1])?(A[Me]=!0,g.push(te[Me])):A[Me]=!1}}},ks.prototype._forEachCell=function(e,t,r,u,h,g,A,L){for(var B=this._convertToCellCoord(e),te=this._convertToCellCoord(t),pe=this._convertToCellCoord(r),Se=this._convertToCellCoord(u),Me=B;Me<=pe;Me++)for(var it=te;it<=Se;it++){var St=this.d*it+Me;if((!L||L(this._convertFromCellCoord(Me),this._convertFromCellCoord(it),this._convertFromCellCoord(Me+1),this._convertFromCellCoord(it+1)))&&h.call(this,e,t,r,u,St,g,A,L))return}},ks.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},ks.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},ks.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,r=0,u=0;u<this.cells.length;u++)r+=this.cells[u].length;var h=new Int32Array(t+r+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;for(var g=t,A=0;A<e.length;A++){var L=e[A];h[3+A]=g,h.set(L,g),g+=L.length}return h[3+e.length]=g,h.set(this.keys,g),h[3+e.length+1]=g+=this.keys.length,h.set(this.bboxes,g),g+=this.bboxes.length,h.buffer};var ys=Y.ImageData,$o=Y.ImageBitmap,Zu={};function xn(e,t,r){r===void 0&&(r={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),Zu[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}for(var bs in xn("Object",Object),gs.serialize=function(e,t){var r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}},gs.deserialize=function(e){return new gs(e.buffer)},xn("Grid",gs),xn("Color",Ln),xn("Error",Error),xn("ResolvedImage",Oo),xn("StylePropertyFunction",Rl),xn("StyleExpression",Os,{omit:["_evaluator"]}),xn("ZoomDependentExpression",El),xn("ZoomConstantExpression",Ll),xn("CompoundExpression",Eo,{omit:["_evaluate"]}),pu)pu[bs]._classRegistryKey||xn("Expression_"+bs,pu[bs]);function nu(e){return e&&typeof ArrayBuffer!="undefined"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function Sc(e){return $o&&e instanceof $o}function Ou(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(nu(e)||Sc(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var r=e;return t&&t.push(r.buffer),r}if(e instanceof ys)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var u=[],h=0,g=e;h<g.length;h+=1)u.push(Ou(g[h],t));return u}if(typeof e=="object"){var A=e.constructor,L=A._classRegistryKey;if(!L)throw new Error("can't serialize object of unregistered class");var B=A.serialize?A.serialize(e,t):{};if(!A.serialize){for(var te in e)if(e.hasOwnProperty(te)&&!(Zu[L].omit.indexOf(te)>=0)){var pe=e[te];B[te]=Zu[L].shallow.indexOf(te)>=0?pe:Ou(pe,t)}e instanceof Error&&(B.message=e.message)}if(B.$name)throw new Error("$name property is reserved for worker serialization logic.");return L!=="Object"&&(B.$name=L),B}throw new Error("can't serialize object of type "+typeof e)}function Mu(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||nu(e)||Sc(e)||ArrayBuffer.isView(e)||e instanceof ys)return e;if(Array.isArray(e))return e.map(Mu);if(typeof e=="object"){var t=e.$name||"Object",r=Zu[t].klass;if(!r)throw new Error("can't deserialize unregistered class "+t);if(r.deserialize)return r.deserialize(e);for(var u=Object.create(r.prototype),h=0,g=Object.keys(e);h<g.length;h+=1){var A=g[h];if(A!=="$name"){var L=e[A];u[A]=Zu[t].shallow.indexOf(A)>=0?L:Mu(L)}}return u}throw new Error("can't deserialize object of type "+typeof e)}var gu=function(){this.first=!0};gu.prototype.update=function(e,t){var r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))};var Zr={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function vi(e){for(var t=0,r=e;t<r.length;t+=1)if(Hc(r[t].charCodeAt(0)))return!0;return!1}function Hc(e){return!(e!==746&&e!==747&&(e<4352||!(Zr["Bopomofo Extended"](e)||Zr.Bopomofo(e)||Zr["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||Zr["CJK Compatibility Ideographs"](e)||Zr["CJK Compatibility"](e)||Zr["CJK Radicals Supplement"](e)||Zr["CJK Strokes"](e)||!(!Zr["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||Zr["CJK Unified Ideographs Extension A"](e)||Zr["CJK Unified Ideographs"](e)||Zr["Enclosed CJK Letters and Months"](e)||Zr["Hangul Compatibility Jamo"](e)||Zr["Hangul Jamo Extended-A"](e)||Zr["Hangul Jamo Extended-B"](e)||Zr["Hangul Jamo"](e)||Zr["Hangul Syllables"](e)||Zr.Hiragana(e)||Zr["Ideographic Description Characters"](e)||Zr.Kanbun(e)||Zr["Kangxi Radicals"](e)||Zr["Katakana Phonetic Extensions"](e)||Zr.Katakana(e)&&e!==12540||!(!Zr["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!Zr["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||Zr["Unified Canadian Aboriginal Syllabics"](e)||Zr["Unified Canadian Aboriginal Syllabics Extended"](e)||Zr["Vertical Forms"](e)||Zr["Yijing Hexagram Symbols"](e)||Zr["Yi Syllables"](e)||Zr["Yi Radicals"](e))))}function Wc(e){return!(Hc(e)||function(t){return!!(Zr["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Zr["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Zr["Letterlike Symbols"](t)||Zr["Number Forms"](t)||Zr["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Zr["Control Pictures"](t)&&t!==9251||Zr["Optical Character Recognition"](t)||Zr["Enclosed Alphanumerics"](t)||Zr["Geometric Shapes"](t)||Zr["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Zr["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Zr["CJK Symbols and Punctuation"](t)||Zr.Katakana(t)||Zr["Private Use Area"](t)||Zr["CJK Compatibility Forms"](t)||Zr["Small Form Variants"](t)||Zr["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(e))}function sl(e){return e>=1424&&e<=2303||Zr["Arabic Presentation Forms-A"](e)||Zr["Arabic Presentation Forms-B"](e)}function Pu(e,t){return!(!t&&sl(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||Zr.Khmer(e))}function Ms(e){for(var t=0,r=e;t<r.length;t+=1)if(sl(r[t].charCodeAt(0)))return!0;return!1}var as=null,wi="unavailable",js=null,sf=function(t){t&&typeof t=="string"&&t.indexOf("NetworkError")>-1&&(wi="error"),as&&as(t)};function ul(){jl.fire(new me("pluginStateChange",{pluginStatus:wi,pluginURL:js}))}var jl=new bt,uf=function(){return wi},uc=function(){if(wi!=="deferred"||!js)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");wi="loading",ul(),js&&Zn({url:js},function(t){t?sf(t):(wi="loaded",ul())})},uo={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return wi==="loaded"||uo.applyArabicShaping!=null},isLoading:function(){return wi==="loading"},setState:function(t){wi=t.pluginStatus,js=t.pluginURL},isParsed:function(){return uo.applyArabicShaping!=null&&uo.processBidirectionalText!=null&&uo.processStyledBidirectionalText!=null},getPluginURL:function(){return js}},ci=function(t,r){this.zoom=t,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new gu,this.transition={})};ci.prototype.isSupportedScript=function(e){return function(t,r){for(var u=0,h=t;u<h.length;u+=1)if(!Pu(h[u].charCodeAt(0),r))return!1;return!0}(e,uo.isLoaded())},ci.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},ci.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}};var mo=function(t,r){this.property=t,this.value=r,this.expression=function(u,h){if(xc(u))return new Rl(u,h);if(ac(u)){var g=Vc(u,h);if(g.result==="error")throw new Error(g.value.map(function(L){return L.key+": "+L.message}).join(", "));return g.value}var A=u;return typeof u=="string"&&h.type==="color"&&(A=Ln.parse(u)),{kind:"constant",evaluate:function(){return A}}}(r===void 0?t.specification.default:r,t.specification)};mo.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},mo.prototype.possiblyEvaluate=function(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)};var ll=function(t){this.property=t,this.value=new mo(t,void 0)};ll.prototype.transitioned=function(e,t){return new Ps(this.property,this.value,t,je({},e.transition,this.transition),e.now)},ll.prototype.untransitioned=function(){return new Ps(this.property,this.value,null,{},0)};var gi=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};gi.prototype.getValue=function(e){return Ue(this._values[e].value.value)},gi.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new ll(this._values[e].property)),this._values[e].value=new mo(this._values[e].property,t===null?void 0:Ue(t))},gi.prototype.getTransition=function(e){return Ue(this._values[e].transition)},gi.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new ll(this._values[e].property)),this._values[e].transition=Ue(t)||void 0},gi.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var u=r[t],h=this.getValue(u);h!==void 0&&(e[u]=h);var g=this.getTransition(u);g!==void 0&&(e[u+"-transition"]=g)}return e},gi.prototype.transitioned=function(e,t){for(var r=new cl(this._properties),u=0,h=Object.keys(this._values);u<h.length;u+=1){var g=h[u];r._values[g]=this._values[g].transitioned(e,t._values[g])}return r},gi.prototype.untransitioned=function(){for(var e=new cl(this._properties),t=0,r=Object.keys(this._values);t<r.length;t+=1){var u=r[t];e._values[u]=this._values[u].untransitioned()}return e};var Ps=function(t,r,u,h,g){this.property=t,this.value=r,this.begin=g+h.delay||0,this.end=this.begin+h.duration||0,t.specification.transition&&(h.delay||h.duration)&&(this.prior=u)};Ps.prototype.possiblyEvaluate=function(e,t,r){var u=e.now||0,h=this.value.possiblyEvaluate(e,t,r),g=this.prior;if(g){if(u>this.end)return this.prior=null,h;if(this.value.isDataDriven())return this.prior=null,h;if(u<this.begin)return g.possiblyEvaluate(e,t,r);var A=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(g.possiblyEvaluate(e,t,r),h,function(L){if(L<=0)return 0;if(L>=1)return 1;var B=L*L,te=B*L;return 4*(L<.5?te:3*(L-B)+te-.75)}(A))}return h};var cl=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};cl.prototype.possiblyEvaluate=function(e,t,r){for(var u=new _l(this._properties),h=0,g=Object.keys(this._values);h<g.length;h+=1){var A=g[h];u._values[A]=this._values[A].possiblyEvaluate(e,t,r)}return u},cl.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var au=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};au.prototype.getValue=function(e){return Ue(this._values[e].value)},au.prototype.setValue=function(e,t){this._values[e]=new mo(this._values[e].property,t===null?void 0:Ue(t))},au.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var u=r[t],h=this.getValue(u);h!==void 0&&(e[u]=h)}return e},au.prototype.possiblyEvaluate=function(e,t,r){for(var u=new _l(this._properties),h=0,g=Object.keys(this._values);h<g.length;h+=1){var A=g[h];u._values[A]=this._values[A].possiblyEvaluate(e,t,r)}return u};var ko=function(t,r,u){this.property=t,this.value=r,this.parameters=u};ko.prototype.isConstant=function(){return this.value.kind==="constant"},ko.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},ko.prototype.evaluate=function(e,t,r,u){return this.property.evaluate(this.value,this.parameters,e,t,r,u)};var _l=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};_l.prototype.get=function(e){return this._values[e]};var Qn=function(t){this.specification=t};Qn.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},Qn.prototype.interpolate=function(e,t,r){var u=hu[this.specification.type];return u?u(e,t,r):e};var ua=function(t,r){this.specification=t,this.overrides=r};ua.prototype.possiblyEvaluate=function(e,t,r,u){return new ko(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(t,null,{},r,u)}:e.expression,t)},ua.prototype.interpolate=function(e,t,r){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new ko(this,{kind:"constant",value:void 0},e.parameters);var u=hu[this.specification.type];return u?new ko(this,{kind:"constant",value:u(e.value.value,t.value.value,r)},e.parameters):e},ua.prototype.evaluate=function(e,t,r,u,h,g){return e.kind==="constant"?e.value:e.evaluate(t,r,u,h,g)};var lo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,u,h,g){if(r.value===void 0)return new ko(this,{kind:"constant",value:void 0},u);if(r.expression.kind==="constant"){var A=r.expression.evaluate(u,null,{},h,g),L=r.property.specification.type==="resolvedImage"&&typeof A!="string"?A.name:A,B=this._calculate(L,L,L,u);return new ko(this,{kind:"constant",value:B},u)}if(r.expression.kind==="camera"){var te=this._calculate(r.expression.evaluate({zoom:u.zoom-1}),r.expression.evaluate({zoom:u.zoom}),r.expression.evaluate({zoom:u.zoom+1}),u);return new ko(this,{kind:"constant",value:te},u)}return new ko(this,r.expression,u)},t.prototype.evaluate=function(r,u,h,g,A,L){if(r.kind==="source"){var B=r.evaluate(u,h,g,A,L);return this._calculate(B,B,B,u)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(u.zoom)-1},h,g),r.evaluate({zoom:Math.floor(u.zoom)},h,g),r.evaluate({zoom:Math.floor(u.zoom)+1},h,g),u):r.value},t.prototype._calculate=function(r,u,h,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:r,to:u}:{from:h,to:u}},t.prototype.interpolate=function(r){return r},t}(ua),zl=function(t){this.specification=t};zl.prototype.possiblyEvaluate=function(e,t,r,u){if(e.value!==void 0){if(e.expression.kind==="constant"){var h=e.expression.evaluate(t,null,{},r,u);return this._calculate(h,h,h,t)}return this._calculate(e.expression.evaluate(new ci(Math.floor(t.zoom-1),t)),e.expression.evaluate(new ci(Math.floor(t.zoom),t)),e.expression.evaluate(new ci(Math.floor(t.zoom+1),t)),t)}},zl.prototype._calculate=function(e,t,r,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}},zl.prototype.interpolate=function(e){return e};var zs=function(t){this.specification=t};zs.prototype.possiblyEvaluate=function(e,t,r,u){return!!e.expression.evaluate(t,null,{},r,u)},zs.prototype.interpolate=function(){return!1};var Di=function(t){for(var r in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var u=t[r];u.specification.overridable&&this.overridableProperties.push(r);var h=this.defaultPropertyValues[r]=new mo(u,void 0),g=this.defaultTransitionablePropertyValues[r]=new ll(u);this.defaultTransitioningPropertyValues[r]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=h.possiblyEvaluate({})}};xn("DataDrivenProperty",ua),xn("DataConstantProperty",Qn),xn("CrossFadedDataDrivenProperty",lo),xn("CrossFadedProperty",zl),xn("ColorRampProperty",zs);var is=function(e){function t(r,u){if(e.call(this),this.id=r.id,this.type=r.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},r.type!=="custom"&&(this.metadata=(r=r).metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),u.layout&&(this._unevaluatedLayout=new au(u.layout)),u.paint)){for(var h in this._transitionablePaint=new gi(u.paint),r.paint)this.setPaintProperty(h,r.paint[h],{validate:!1});for(var g in r.layout)this.setLayoutProperty(g,r.layout[g],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new _l(u.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)},t.prototype.setLayoutProperty=function(r,u,h){h===void 0&&(h={}),u!=null&&this._validate(Ko,"layers."+this.id+".layout."+r,r,u,h)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,u):this.visibility=u)},t.prototype.getPaintProperty=function(r){return _t(r,"-transition")?this._transitionablePaint.getTransition(r.slice(0,-"-transition".length)):this._transitionablePaint.getValue(r)},t.prototype.setPaintProperty=function(r,u,h){if(h===void 0&&(h={}),u!=null&&this._validate(_f,"layers."+this.id+".paint."+r,r,u,h))return!1;if(_t(r,"-transition"))return this._transitionablePaint.setTransition(r.slice(0,-"-transition".length),u||void 0),!1;var g=this._transitionablePaint._values[r],A=g.property.specification["property-type"]==="cross-faded-data-driven",L=g.value.isDataDriven(),B=g.value;this._transitionablePaint.setValue(r,u),this._handleSpecialPaintPropertyUpdate(r);var te=this._transitionablePaint._values[r].value;return te.isDataDriven()||L||A||this._handleOverridablePaintPropertyUpdate(r,B,te)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){},t.prototype._handleOverridablePaintPropertyUpdate=function(r,u,h){return!1},t.prototype.isHidden=function(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"},t.prototype.updateTransitions=function(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(r,u){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,u)},t.prototype.serialize=function(){var r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),ke(r,function(u,h){return!(u===void 0||h==="layout"&&!Object.keys(u).length||h==="paint"&&!Object.keys(u).length)})},t.prototype._validate=function(r,u,h,g,A){return A===void 0&&(A={}),(!A||A.validate!==!1)&&Wu(this,r.call(Xa,{key:u,layerType:this.type,objectKey:h,value:g,styleSpec:He,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var r in this.paint._values){var u=this.paint.get(r);if(u instanceof ko&&tu(u.property.specification)&&(u.value.kind==="source"||u.value.kind==="composite")&&u.value.isStateDependent)return!0}return!1},t}(bt),Zc={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Fs=function(t,r){this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},_i=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Si(e,t){t===void 0&&(t=1);var r=0,u=0;return{members:e.map(function(h){var g=Zc[h.type].BYTES_PER_ELEMENT,A=r=Xu(r,Math.max(t,g)),L=h.components||1;return u=Math.max(u,g),r+=g*L,{name:h.name,type:h.type,components:L,offset:A}}),size:Xu(r,Math.max(u,t)),alignment:t}}function Xu(e,t){return Math.ceil(e/t)*t}_i.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},_i.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},_i.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},_i.prototype.clear=function(){this.length=0},_i.prototype.resize=function(e){this.reserve(e),this.length=e},_i.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},_i.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var yu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u){var h=this.length;return this.resize(h+1),this.emplace(h,r,u)},t.prototype.emplace=function(r,u,h){var g=2*r;return this.int16[g+0]=u,this.int16[g+1]=h,r},t}(_i);yu.prototype.bytesPerElement=4,xn("StructArrayLayout2i4",yu);var Fl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h,g){var A=this.length;return this.resize(A+1),this.emplace(A,r,u,h,g)},t.prototype.emplace=function(r,u,h,g,A){var L=4*r;return this.int16[L+0]=u,this.int16[L+1]=h,this.int16[L+2]=g,this.int16[L+3]=A,r},t}(_i);Fl.prototype.bytesPerElement=8,xn("StructArrayLayout4i8",Fl);var lc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h,g,A,L){var B=this.length;return this.resize(B+1),this.emplace(B,r,u,h,g,A,L)},t.prototype.emplace=function(r,u,h,g,A,L,B){var te=6*r;return this.int16[te+0]=u,this.int16[te+1]=h,this.int16[te+2]=g,this.int16[te+3]=A,this.int16[te+4]=L,this.int16[te+5]=B,r},t}(_i);lc.prototype.bytesPerElement=12,xn("StructArrayLayout2i4i12",lc);var Lu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h,g,A,L){var B=this.length;return this.resize(B+1),this.emplace(B,r,u,h,g,A,L)},t.prototype.emplace=function(r,u,h,g,A,L,B){var te=4*r,pe=8*r;return this.int16[te+0]=u,this.int16[te+1]=h,this.uint8[pe+4]=g,this.uint8[pe+5]=A,this.uint8[pe+6]=L,this.uint8[pe+7]=B,r},t}(_i);Lu.prototype.bytesPerElement=8,xn("StructArrayLayout2i4ub8",Lu);var os=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u){var h=this.length;return this.resize(h+1),this.emplace(h,r,u)},t.prototype.emplace=function(r,u,h){var g=2*r;return this.float32[g+0]=u,this.float32[g+1]=h,r},t}(_i);os.prototype.bytesPerElement=8,xn("StructArrayLayout2f8",os);var Yu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h,g,A,L,B,te,pe,Se){var Me=this.length;return this.resize(Me+1),this.emplace(Me,r,u,h,g,A,L,B,te,pe,Se)},t.prototype.emplace=function(r,u,h,g,A,L,B,te,pe,Se,Me){var it=10*r;return this.uint16[it+0]=u,this.uint16[it+1]=h,this.uint16[it+2]=g,this.uint16[it+3]=A,this.uint16[it+4]=L,this.uint16[it+5]=B,this.uint16[it+6]=te,this.uint16[it+7]=pe,this.uint16[it+8]=Se,this.uint16[it+9]=Me,r},t}(_i);Yu.prototype.bytesPerElement=20,xn("StructArrayLayout10ui20",Yu);var bu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h,g,A,L,B,te,pe,Se,Me,it){var St=this.length;return this.resize(St+1),this.emplace(St,r,u,h,g,A,L,B,te,pe,Se,Me,it)},t.prototype.emplace=function(r,u,h,g,A,L,B,te,pe,Se,Me,it,St){var xt=12*r;return this.int16[xt+0]=u,this.int16[xt+1]=h,this.int16[xt+2]=g,this.int16[xt+3]=A,this.uint16[xt+4]=L,this.uint16[xt+5]=B,this.uint16[xt+6]=te,this.uint16[xt+7]=pe,this.int16[xt+8]=Se,this.int16[xt+9]=Me,this.int16[xt+10]=it,this.int16[xt+11]=St,r},t}(_i);bu.prototype.bytesPerElement=24,xn("StructArrayLayout4i4ui4i24",bu);var Sf=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h){var g=this.length;return this.resize(g+1),this.emplace(g,r,u,h)},t.prototype.emplace=function(r,u,h,g){var A=3*r;return this.float32[A+0]=u,this.float32[A+1]=h,this.float32[A+2]=g,r},t}(_i);Sf.prototype.bytesPerElement=12,xn("StructArrayLayout3f12",Sf);var Ul=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var u=this.length;return this.resize(u+1),this.emplace(u,r)},t.prototype.emplace=function(r,u){return this.uint32[1*r+0]=u,r},t}(_i);Ul.prototype.bytesPerElement=4,xn("StructArrayLayout1ul4",Ul);var Xc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h,g,A,L,B,te,pe){var Se=this.length;return this.resize(Se+1),this.emplace(Se,r,u,h,g,A,L,B,te,pe)},t.prototype.emplace=function(r,u,h,g,A,L,B,te,pe,Se){var Me=10*r,it=5*r;return this.int16[Me+0]=u,this.int16[Me+1]=h,this.int16[Me+2]=g,this.int16[Me+3]=A,this.int16[Me+4]=L,this.int16[Me+5]=B,this.uint32[it+3]=te,this.uint16[Me+8]=pe,this.uint16[Me+9]=Se,r},t}(_i);Xc.prototype.bytesPerElement=20,xn("StructArrayLayout6i1ul2ui20",Xc);var lf=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h,g,A,L){var B=this.length;return this.resize(B+1),this.emplace(B,r,u,h,g,A,L)},t.prototype.emplace=function(r,u,h,g,A,L,B){var te=6*r;return this.int16[te+0]=u,this.int16[te+1]=h,this.int16[te+2]=g,this.int16[te+3]=A,this.int16[te+4]=L,this.int16[te+5]=B,r},t}(_i);lf.prototype.bytesPerElement=12,xn("StructArrayLayout2i2i2i12",lf);var iu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h,g,A){var L=this.length;return this.resize(L+1),this.emplace(L,r,u,h,g,A)},t.prototype.emplace=function(r,u,h,g,A,L){var B=4*r,te=8*r;return this.float32[B+0]=u,this.float32[B+1]=h,this.float32[B+2]=g,this.int16[te+6]=A,this.int16[te+7]=L,r},t}(_i);iu.prototype.bytesPerElement=16,xn("StructArrayLayout2f1f2i16",iu);var Sl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h,g){var A=this.length;return this.resize(A+1),this.emplace(A,r,u,h,g)},t.prototype.emplace=function(r,u,h,g,A){var L=12*r,B=3*r;return this.uint8[L+0]=u,this.uint8[L+1]=h,this.float32[B+1]=g,this.float32[B+2]=A,r},t}(_i);Sl.prototype.bytesPerElement=12,xn("StructArrayLayout2ub2f12",Sl);var xu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h){var g=this.length;return this.resize(g+1),this.emplace(g,r,u,h)},t.prototype.emplace=function(r,u,h,g){var A=3*r;return this.uint16[A+0]=u,this.uint16[A+1]=h,this.uint16[A+2]=g,r},t}(_i);xu.prototype.bytesPerElement=6,xn("StructArrayLayout3ui6",xu);var cc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h,g,A,L,B,te,pe,Se,Me,it,St,xt,Gt,Bt,ar){var hr=this.length;return this.resize(hr+1),this.emplace(hr,r,u,h,g,A,L,B,te,pe,Se,Me,it,St,xt,Gt,Bt,ar)},t.prototype.emplace=function(r,u,h,g,A,L,B,te,pe,Se,Me,it,St,xt,Gt,Bt,ar,hr){var Tr=24*r,Fr=12*r,Ir=48*r;return this.int16[Tr+0]=u,this.int16[Tr+1]=h,this.uint16[Tr+2]=g,this.uint16[Tr+3]=A,this.uint32[Fr+2]=L,this.uint32[Fr+3]=B,this.uint32[Fr+4]=te,this.uint16[Tr+10]=pe,this.uint16[Tr+11]=Se,this.uint16[Tr+12]=Me,this.float32[Fr+7]=it,this.float32[Fr+8]=St,this.uint8[Ir+36]=xt,this.uint8[Ir+37]=Gt,this.uint8[Ir+38]=Bt,this.uint32[Fr+10]=ar,this.int16[Tr+22]=hr,r},t}(_i);cc.prototype.bytesPerElement=48,xn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",cc);var Ru=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h,g,A,L,B,te,pe,Se,Me,it,St,xt,Gt,Bt,ar,hr,Tr,Fr,Ir,hn,yn,Un,Jn,Dn,In,_a){var sa=this.length;return this.resize(sa+1),this.emplace(sa,r,u,h,g,A,L,B,te,pe,Se,Me,it,St,xt,Gt,Bt,ar,hr,Tr,Fr,Ir,hn,yn,Un,Jn,Dn,In,_a)},t.prototype.emplace=function(r,u,h,g,A,L,B,te,pe,Se,Me,it,St,xt,Gt,Bt,ar,hr,Tr,Fr,Ir,hn,yn,Un,Jn,Dn,In,_a,sa){var Yn=34*r,si=17*r;return this.int16[Yn+0]=u,this.int16[Yn+1]=h,this.int16[Yn+2]=g,this.int16[Yn+3]=A,this.int16[Yn+4]=L,this.int16[Yn+5]=B,this.int16[Yn+6]=te,this.int16[Yn+7]=pe,this.uint16[Yn+8]=Se,this.uint16[Yn+9]=Me,this.uint16[Yn+10]=it,this.uint16[Yn+11]=St,this.uint16[Yn+12]=xt,this.uint16[Yn+13]=Gt,this.uint16[Yn+14]=Bt,this.uint16[Yn+15]=ar,this.uint16[Yn+16]=hr,this.uint16[Yn+17]=Tr,this.uint16[Yn+18]=Fr,this.uint16[Yn+19]=Ir,this.uint16[Yn+20]=hn,this.uint16[Yn+21]=yn,this.uint16[Yn+22]=Un,this.uint32[si+12]=Jn,this.float32[si+13]=Dn,this.float32[si+14]=In,this.float32[si+15]=_a,this.float32[si+16]=sa,r},t}(_i);Ru.prototype.bytesPerElement=68,xn("StructArrayLayout8i15ui1ul4f68",Ru);var fl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var u=this.length;return this.resize(u+1),this.emplace(u,r)},t.prototype.emplace=function(r,u){return this.float32[1*r+0]=u,r},t}(_i);fl.prototype.bytesPerElement=4,xn("StructArrayLayout1f4",fl);var hl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h){var g=this.length;return this.resize(g+1),this.emplace(g,r,u,h)},t.prototype.emplace=function(r,u,h,g){var A=3*r;return this.int16[A+0]=u,this.int16[A+1]=h,this.int16[A+2]=g,r},t}(_i);hl.prototype.bytesPerElement=6,xn("StructArrayLayout3i6",hl);var Ls=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h){var g=this.length;return this.resize(g+1),this.emplace(g,r,u,h)},t.prototype.emplace=function(r,u,h,g){var A=4*r;return this.uint32[2*r+0]=u,this.uint16[A+2]=h,this.uint16[A+3]=g,r},t}(_i);Ls.prototype.bytesPerElement=8,xn("StructArrayLayout1ul2ui8",Ls);var Bl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u){var h=this.length;return this.resize(h+1),this.emplace(h,r,u)},t.prototype.emplace=function(r,u,h){var g=2*r;return this.uint16[g+0]=u,this.uint16[g+1]=h,r},t}(_i);Bl.prototype.bytesPerElement=4,xn("StructArrayLayout2ui4",Bl);var Yc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var u=this.length;return this.resize(u+1),this.emplace(u,r)},t.prototype.emplace=function(r,u){return this.uint16[1*r+0]=u,r},t}(_i);Yc.prototype.bytesPerElement=2,xn("StructArrayLayout1ui2",Yc);var Vl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h,g){var A=this.length;return this.resize(A+1),this.emplace(A,r,u,h,g)},t.prototype.emplace=function(r,u,h,g,A){var L=4*r;return this.float32[L+0]=u,this.float32[L+1]=h,this.float32[L+2]=g,this.float32[L+3]=A,r},t}(_i);Vl.prototype.bytesPerElement=16,xn("StructArrayLayout4f16",Vl);var s=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},r.x1.get=function(){return this._structArray.int16[this._pos2+2]},r.y1.get=function(){return this._structArray.int16[this._pos2+3]},r.x2.get=function(){return this._structArray.int16[this._pos2+4]},r.y2.get=function(){return this._structArray.int16[this._pos2+5]},r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.anchorPoint.get=function(){return new re(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,r),t}(Fs);s.prototype.size=20;var a=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new s(this,r)},t}(Xc);xn("CollisionBoxArray",a);var n=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},r.segment.get=function(){return this._structArray.uint16[this._pos2+10]},r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},r.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},r.placedOrientation.set=function(u){this._structArray.uint8[this._pos1+37]=u},r.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},r.hidden.set=function(u){this._structArray.uint8[this._pos1+38]=u},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},r.crossTileID.set=function(u){this._structArray.uint32[this._pos4+10]=u},r.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,r),t}(Fs);n.prototype.size=48;var l=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new n(this,r)},t}(cc);xn("PlacedSymbolArray",l);var b=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},r.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},r.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},r.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},r.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},r.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},r.key.get=function(){return this._structArray.uint16[this._pos2+8]},r.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},r.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},r.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},r.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},r.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},r.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},r.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},r.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},r.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},r.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},r.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},r.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},r.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},r.crossTileID.set=function(u){this._structArray.uint32[this._pos4+12]=u},r.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},r.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},r.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},r.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,r),t}(Fs);b.prototype.size=68;var O=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new b(this,r)},t}(Ru);xn("SymbolInstanceArray",O);var R=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(r){return this.float32[1*r+0]},t}(fl);xn("GlyphOffsetArray",R);var j=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(r){return this.int16[3*r+0]},t.prototype.gety=function(r){return this.int16[3*r+1]},t.prototype.gettileUnitDistanceFromAnchor=function(r){return this.int16[3*r+2]},t}(hl);xn("SymbolLineVertexArray",j);var ue=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,r),t}(Fs);ue.prototype.size=8;var Te=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new ue(this,r)},t}(Ls);xn("FeatureIndexArray",Te);var Ye=Si([{name:"a_pos",components:2,type:"Int16"}],4).members,qe=function(t){t===void 0&&(t=[]),this.segments=t};function tt(e,t){return 256*(e=we(Math.floor(e),0,255))+we(Math.floor(t),0,255)}qe.prototype.prepareSegment=function(e,t,r,u){var h=this.segments[this.segments.length-1];return e>qe.MAX_VERTEX_ARRAY_LENGTH&&Le("Max vertices per segment is "+qe.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!h||h.vertexLength+e>qe.MAX_VERTEX_ARRAY_LENGTH||h.sortKey!==u)&&(h={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},u!==void 0&&(h.sortKey=u),this.segments.push(h)),h},qe.prototype.get=function(){return this.segments},qe.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var r=t[e];for(var u in r.vaos)r.vaos[u].destroy()}},qe.simpleSegment=function(e,t,r,u){return new qe([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:u,vaos:{},sortKey:0}])},qe.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,xn("SegmentVector",qe);var Dt=Si([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Rt=Z(function(e){e.exports=function(t,r){var u,h,g,A,L,B,te,pe;for(h=t.length-(u=3&t.length),g=r,L=3432918353,B=461845907,pe=0;pe<h;)te=255&t.charCodeAt(pe)|(255&t.charCodeAt(++pe))<<8|(255&t.charCodeAt(++pe))<<16|(255&t.charCodeAt(++pe))<<24,++pe,g=27492+(65535&(A=5*(65535&(g=(g^=te=(65535&(te=(te=(65535&te)*L+(((te>>>16)*L&65535)<<16)&4294967295)<<15|te>>>17))*B+(((te>>>16)*B&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(A>>>16)&65535)<<16);switch(te=0,u){case 3:te^=(255&t.charCodeAt(pe+2))<<16;case 2:te^=(255&t.charCodeAt(pe+1))<<8;case 1:g^=te=(65535&(te=(te=(65535&(te^=255&t.charCodeAt(pe)))*L+(((te>>>16)*L&65535)<<16)&4294967295)<<15|te>>>17))*B+(((te>>>16)*B&65535)<<16)&4294967295}return g^=t.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0}}),Wt=Z(function(e){e.exports=function(t,r){for(var u,h=t.length,g=r^h,A=0;h>=4;)u=1540483477*(65535&(u=255&t.charCodeAt(A)|(255&t.charCodeAt(++A))<<8|(255&t.charCodeAt(++A))<<16|(255&t.charCodeAt(++A))<<24))+((1540483477*(u>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),h-=4,++A;switch(h){case 3:g^=(255&t.charCodeAt(A+2))<<16;case 2:g^=(255&t.charCodeAt(A+1))<<8;case 1:g=1540483477*(65535&(g^=255&t.charCodeAt(A)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0}}),kt=Rt,zt=Wt;kt.murmur3=Rt,kt.murmur2=zt;var nr=function(){this.ids=[],this.positions=[],this.indexed=!1};nr.prototype.add=function(e,t,r,u){this.ids.push(Cr(e)),this.positions.push(t,r,u)},nr.prototype.getPositions=function(e){for(var t=Cr(e),r=0,u=this.ids.length-1;r<u;){var h=r+u>>1;this.ids[h]>=t?u=h:r=h+1}for(var g=[];this.ids[r]===t;)g.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return g},nr.serialize=function(e,t){var r=new Float64Array(e.ids),u=new Uint32Array(e.positions);return function h(g,A,L,B){for(;L<B;){for(var te=g[L+B>>1],pe=L-1,Se=B+1;;){do pe++;while(g[pe]<te);do Se--;while(g[Se]>te);if(pe>=Se)break;pr(g,pe,Se),pr(A,3*pe,3*Se),pr(A,3*pe+1,3*Se+1),pr(A,3*pe+2,3*Se+2)}Se-L<B-Se?(h(g,A,L,Se),L=Se+1):(h(g,A,Se+1,B),B=Se)}}(r,u,0,r.length-1),t&&t.push(r.buffer,u.buffer),{ids:r,positions:u}},nr.deserialize=function(e){var t=new nr;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var Jt=Math.pow(2,53)-1;function Cr(e){var t=+e;return!isNaN(t)&&t<=Jt?t:kt(String(e))}function pr(e,t,r){var u=e[t];e[t]=e[r],e[r]=u}xn("FeaturePositionMap",nr);var _r=function(t,r){this.gl=t.gl,this.location=r},wr=function(e){function t(r,u){e.call(this,r,u),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))},t}(_r),Hr=function(e){function t(r,u){e.call(this,r,u),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))},t}(_r),Yr=function(e){function t(r,u){e.call(this,r,u),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))},t}(_r),un=function(e){function t(r,u){e.call(this,r,u),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))},t}(_r),_n=function(e){function t(r,u){e.call(this,r,u),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))},t}(_r),ia=function(e){function t(r,u){e.call(this,r,u),this.current=Ln.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))},t}(_r),pa=new Float32Array(16),ya=function(e){function t(r,u){e.call(this,r,u),this.current=pa}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(var u=1;u<16;u++)if(r[u]!==this.current[u]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}},t}(_r);function Pa(e){return[tt(255*e.r,255*e.g),tt(255*e.b,255*e.a)]}var Pn=function(t,r,u){this.value=t,this.uniformNames=r.map(function(h){return"u_"+h}),this.type=u};Pn.prototype.setUniform=function(e,t,r){e.set(r.constantOr(this.value))},Pn.prototype.getBinding=function(e,t,r){return this.type==="color"?new ia(e,t):new Hr(e,t)};var ga=function(t,r){this.uniformNames=r.map(function(u){return"u_"+u}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};ga.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},ga.prototype.setUniform=function(e,t,r,u){var h=u==="u_pattern_to"?this.patternTo:u==="u_pattern_from"?this.patternFrom:u==="u_pixel_ratio_to"?this.pixelRatioTo:u==="u_pixel_ratio_from"?this.pixelRatioFrom:null;h&&e.set(h)},ga.prototype.getBinding=function(e,t,r){return r.substr(0,9)==="u_pattern"?new _n(e,t):new Hr(e,t)};var aa=function(t,r,u,h){this.expression=t,this.type=u,this.maxValue=0,this.paintVertexAttributes=r.map(function(g){return{name:"a_"+g,type:"Float32",components:u==="color"?2:1,offset:0}}),this.paintVertexArray=new h};aa.prototype.populatePaintArray=function(e,t,r,u,h){var g=this.paintVertexArray.length,A=this.expression.evaluate(new ci(0),t,{},u,[],h);this.paintVertexArray.resize(e),this._setPaintValue(g,e,A)},aa.prototype.updatePaintArray=function(e,t,r,u){var h=this.expression.evaluate({zoom:0},r,u);this._setPaintValue(e,t,h)},aa.prototype._setPaintValue=function(e,t,r){if(this.type==="color")for(var u=Pa(r),h=e;h<t;h++)this.paintVertexArray.emplace(h,u[0],u[1]);else{for(var g=e;g<t;g++)this.paintVertexArray.emplace(g,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}},aa.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},aa.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var zn=function(t,r,u,h,g,A){this.expression=t,this.uniformNames=r.map(function(L){return"u_"+L+"_t"}),this.type=u,this.useIntegerZoom=h,this.zoom=g,this.maxValue=0,this.paintVertexAttributes=r.map(function(L){return{name:"a_"+L,type:"Float32",components:u==="color"?4:2,offset:0}}),this.paintVertexArray=new A};zn.prototype.populatePaintArray=function(e,t,r,u,h){var g=this.expression.evaluate(new ci(this.zoom),t,{},u,[],h),A=this.expression.evaluate(new ci(this.zoom+1),t,{},u,[],h),L=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(L,e,g,A)},zn.prototype.updatePaintArray=function(e,t,r,u){var h=this.expression.evaluate({zoom:this.zoom},r,u),g=this.expression.evaluate({zoom:this.zoom+1},r,u);this._setPaintValue(e,t,h,g)},zn.prototype._setPaintValue=function(e,t,r,u){if(this.type==="color")for(var h=Pa(r),g=Pa(u),A=e;A<t;A++)this.paintVertexArray.emplace(A,h[0],h[1],g[0],g[1]);else{for(var L=e;L<t;L++)this.paintVertexArray.emplace(L,r,u);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(u))}},zn.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},zn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},zn.prototype.setUniform=function(e,t){var r=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,u=we(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(u)},zn.prototype.getBinding=function(e,t,r){return new Hr(e,t)};var Ca=function(t,r,u,h,g,A){this.expression=t,this.type=r,this.useIntegerZoom=u,this.zoom=h,this.layerId=A,this.zoomInPaintVertexArray=new g,this.zoomOutPaintVertexArray=new g};Ca.prototype.populatePaintArray=function(e,t,r){var u=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(u,e,t.patterns&&t.patterns[this.layerId],r)},Ca.prototype.updatePaintArray=function(e,t,r,u,h){this._setPaintValues(e,t,r.patterns&&r.patterns[this.layerId],h)},Ca.prototype._setPaintValues=function(e,t,r,u){if(u&&r){var h=u[r.min],g=u[r.mid],A=u[r.max];if(h&&g&&A)for(var L=e;L<t;L++)this.zoomInPaintVertexArray.emplace(L,g.tl[0],g.tl[1],g.br[0],g.br[1],h.tl[0],h.tl[1],h.br[0],h.br[1],g.pixelRatio,h.pixelRatio),this.zoomOutPaintVertexArray.emplace(L,g.tl[0],g.tl[1],g.br[0],g.br[1],A.tl[0],A.tl[1],A.br[0],A.br[1],g.pixelRatio,A.pixelRatio)}},Ca.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,Dt.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,Dt.members,this.expression.isStateDependent))},Ca.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var qn=function(t,r,u){this.binders={},this._buffers=[];var h=[];for(var g in t.paint._values)if(u(g)){var A=t.paint.get(g);if(A instanceof ko&&tu(A.property.specification)){var L=Ja(g,t.type),B=A.value,te=A.property.specification.type,pe=A.property.useIntegerZoom,Se=A.property.specification["property-type"],Me=Se==="cross-faded"||Se==="cross-faded-data-driven";if(B.kind==="constant")this.binders[g]=Me?new ga(B.value,L):new Pn(B.value,L,te),h.push("/u_"+g);else if(B.kind==="source"||Me){var it=co(g,te,"source");this.binders[g]=Me?new Ca(B,te,pe,r,it,t.id):new aa(B,L,te,it),h.push("/a_"+g)}else{var St=co(g,te,"composite");this.binders[g]=new zn(B,L,te,pe,r,St),h.push("/z_"+g)}}}this.cacheKey=h.sort().join("")};qn.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof aa||t instanceof zn?t.maxValue:0},qn.prototype.populatePaintArrays=function(e,t,r,u,h){for(var g in this.binders){var A=this.binders[g];(A instanceof aa||A instanceof zn||A instanceof Ca)&&A.populatePaintArray(e,t,r,u,h)}},qn.prototype.setConstantPatternPositions=function(e,t){for(var r in this.binders){var u=this.binders[r];u instanceof ga&&u.setConstantPatternPositions(e,t)}},qn.prototype.updatePaintArrays=function(e,t,r,u,h){var g=!1;for(var A in e)for(var L=0,B=t.getPositions(A);L<B.length;L+=1){var te=B[L],pe=r.feature(te.index);for(var Se in this.binders){var Me=this.binders[Se];if((Me instanceof aa||Me instanceof zn||Me instanceof Ca)&&Me.expression.isStateDependent===!0){var it=u.paint.get(Se);Me.expression=it.value,Me.updatePaintArray(te.start,te.end,pe,e[A],h),g=!0}}}return g},qn.prototype.defines=function(){var e=[];for(var t in this.binders){var r=this.binders[t];(r instanceof Pn||r instanceof ga)&&e.push.apply(e,r.uniformNames.map(function(u){return"#define HAS_UNIFORM_"+u}))}return e},qn.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof aa||r instanceof zn)for(var u=0;u<r.paintVertexAttributes.length;u++)e.push(r.paintVertexAttributes[u].name);else if(r instanceof Ca)for(var h=0;h<Dt.members.length;h++)e.push(Dt.members[h].name)}return e},qn.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof Pn||r instanceof ga||r instanceof zn)for(var u=0,h=r.uniformNames;u<h.length;u+=1)e.push(h[u])}return e},qn.prototype.getPaintVertexBuffers=function(){return this._buffers},qn.prototype.getUniforms=function(e,t){var r=[];for(var u in this.binders){var h=this.binders[u];if(h instanceof Pn||h instanceof ga||h instanceof zn)for(var g=0,A=h.uniformNames;g<A.length;g+=1){var L=A[g];if(t[L]){var B=h.getBinding(e,t[L],L);r.push({name:L,property:u,binding:B})}}}return r},qn.prototype.setUniforms=function(e,t,r,u){for(var h=0,g=t;h<g.length;h+=1){var A=g[h],L=A.name,B=A.property;this.binders[B].setUniform(A.binding,u,r.get(B),L)}},qn.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var r=this.binders[t];if(e&&r instanceof Ca){var u=e.fromScale===2?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;u&&this._buffers.push(u)}else(r instanceof aa||r instanceof zn)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}},qn.prototype.upload=function(e){for(var t in this.binders){var r=this.binders[t];(r instanceof aa||r instanceof zn||r instanceof Ca)&&r.upload(e)}this.updatePaintBuffers()},qn.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof aa||t instanceof zn||t instanceof Ca)&&t.destroy()}};var wa=function(t,r,u){u===void 0&&(u=function(){return!0}),this.programConfigurations={};for(var h=0,g=t;h<g.length;h+=1){var A=g[h];this.programConfigurations[A.id]=new qn(A,r,u)}this.needsUpload=!1,this._featureMap=new nr,this._bufferOffset=0};function Ja(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function co(e,t,r){var u={color:{source:os,composite:Vl},number:{source:fl,composite:os}},h=function(g){return{"line-pattern":{source:Yu,composite:Yu},"fill-pattern":{source:Yu,composite:Yu},"fill-extrusion-pattern":{source:Yu,composite:Yu}}[g]}(e);return h&&h[r]||u[t][r]}wa.prototype.populatePaintArrays=function(e,t,r,u,h,g){for(var A in this.programConfigurations)this.programConfigurations[A].populatePaintArrays(e,t,u,h,g);t.id!==void 0&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},wa.prototype.updatePaintArrays=function(e,t,r,u){for(var h=0,g=r;h<g.length;h+=1){var A=g[h];this.needsUpload=this.programConfigurations[A.id].updatePaintArrays(e,this._featureMap,t,A,u)||this.needsUpload}},wa.prototype.get=function(e){return this.programConfigurations[e]},wa.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},wa.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},xn("ConstantBinder",Pn),xn("CrossFadedConstantBinder",ga),xn("SourceExpressionBinder",aa),xn("CrossFadedCompositeBinder",Ca),xn("CompositeExpressionBinder",zn),xn("ProgramConfiguration",qn,{omit:["_buffers"]}),xn("ProgramConfigurationSet",wa);var $i=Math.pow(2,14)-1,Vi=-$i-1;function fi(e){for(var t=8192/e.extent,r=e.loadGeometry(),u=0;u<r.length;u++)for(var h=r[u],g=0;g<h.length;g++){var A=h[g],L=Math.round(A.x*t),B=Math.round(A.y*t);A.x=we(L,Vi,$i),A.y=we(B,Vi,$i),(L<A.x||L>A.x+1||B<A.y||B>A.y+1)&&Le("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return r}function Ji(e,t,r,u,h){e.emplaceBack(2*t+(u+1)/2,2*r+(h+1)/2)}var Lo=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new yu,this.indexArray=new xu,this.segments=new qe,this.programConfigurations=new wa(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};function Iu(e,t){for(var r=0;r<e.length;r++)if(Du(t,e[r]))return!0;for(var u=0;u<t.length;u++)if(Du(e,t[u]))return!0;return!!ss(e,t)}function Us(e,t,r){return!!Du(e,t)||!!Eu(t,e,r)}function Bs(e,t){if(e.length===1)return Gl(t,e[0]);for(var r=0;r<t.length;r++)for(var u=t[r],h=0;h<u.length;h++)if(Du(e,u[h]))return!0;for(var g=0;g<e.length;g++)if(Gl(t,e[g]))return!0;for(var A=0;A<t.length;A++)if(ss(e,t[A]))return!0;return!1}function Jo(e,t,r){if(e.length>1){if(ss(e,t))return!0;for(var u=0;u<t.length;u++)if(Eu(t[u],e,r))return!0}for(var h=0;h<e.length;h++)if(Eu(e[h],t,r))return!0;return!1}function ss(e,t){if(e.length===0||t.length===0)return!1;for(var r=0;r<e.length-1;r++)for(var u=e[r],h=e[r+1],g=0;g<t.length-1;g++)if(Al(u,h,t[g],t[g+1]))return!0;return!1}function Al(e,t,r,u){return ut(e,r,u)!==ut(t,r,u)&&ut(e,t,r)!==ut(e,t,u)}function Eu(e,t,r){var u=r*r;if(t.length===1)return e.distSqr(t[0])<u;for(var h=1;h<t.length;h++)if(dl(e,t[h-1],t[h])<u)return!0;return!1}function dl(e,t,r){var u=t.distSqr(r);if(u===0)return e.distSqr(t);var h=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/u;return e.distSqr(h<0?t:h>1?r:r.sub(t)._mult(h)._add(t))}function Gl(e,t){for(var r,u,h,g=!1,A=0;A<e.length;A++)for(var L=0,B=(r=e[A]).length-1;L<r.length;B=L++)(u=r[L]).y>t.y!=(h=r[B]).y>t.y&&t.x<(h.x-u.x)*(t.y-u.y)/(h.y-u.y)+u.x&&(g=!g);return g}function Du(e,t){for(var r=!1,u=0,h=e.length-1;u<e.length;h=u++){var g=e[u],A=e[h];g.y>t.y!=A.y>t.y&&t.x<(A.x-g.x)*(t.y-g.y)/(A.y-g.y)+g.x&&(r=!r)}return r}function Kc(e,t,r){var u=r[0],h=r[2];if(e.x<u.x&&t.x<u.x||e.x>h.x&&t.x>h.x||e.y<u.y&&t.y<u.y||e.y>h.y&&t.y>h.y)return!1;var g=ut(e,t,r[0]);return g!==ut(e,t,r[1])||g!==ut(e,t,r[2])||g!==ut(e,t,r[3])}function Ku(e,t,r){var u=t.paint.get(e).value;return u.kind==="constant"?u.value:r.programConfigurations.get(t.id).getMaxValue(e)}function eo(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Rs(e,t,r,u,h){if(!t[0]&&!t[1])return e;var g=re.convert(t)._mult(h);r==="viewport"&&g._rotate(-u);for(var A=[],L=0;L<e.length;L++)A.push(e[L].sub(g));return A}Lo.prototype.populate=function(e,t,r){var u=this.layers[0],h=[],g=null;u.type==="circle"&&(g=u.layout.get("circle-sort-key"));for(var A=0,L=e;A<L.length;A+=1){var B=L[A],te=B.feature,pe=B.id,Se=B.index,Me=B.sourceLayerIndex,it=this.layers[0]._featureFilter.needGeometry,St={type:te.type,id:pe,properties:te.properties,geometry:it?fi(te):[]};if(this.layers[0]._featureFilter.filter(new ci(this.zoom),St,r)){it||(St.geometry=fi(te));var xt=g?g.evaluate(St,{},r):void 0;h.push({id:pe,properties:te.properties,type:te.type,sourceLayerIndex:Me,index:Se,geometry:St.geometry,patterns:{},sortKey:xt})}}g&&h.sort(function(hn,yn){return hn.sortKey-yn.sortKey});for(var Gt=0,Bt=h;Gt<Bt.length;Gt+=1){var ar=Bt[Gt],hr=ar.geometry,Tr=ar.index,Fr=ar.sourceLayerIndex,Ir=e[Tr].feature;this.addFeature(ar,hr,Tr,r),t.featureIndex.insert(Ir,hr,Tr,Fr,this.index)}},Lo.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Lo.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Lo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Lo.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ye),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Lo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Lo.prototype.addFeature=function(e,t,r,u){for(var h=0,g=t;h<g.length;h+=1)for(var A=0,L=g[h];A<L.length;A+=1){var B=L[A],te=B.x,pe=B.y;if(!(te<0||te>=8192||pe<0||pe>=8192)){var Se=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),Me=Se.vertexLength;Ji(this.layoutVertexArray,te,pe,-1,-1),Ji(this.layoutVertexArray,te,pe,1,-1),Ji(this.layoutVertexArray,te,pe,1,1),Ji(this.layoutVertexArray,te,pe,-1,1),this.indexArray.emplaceBack(Me,Me+1,Me+2),this.indexArray.emplaceBack(Me,Me+3,Me+2),Se.vertexLength+=4,Se.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},u)},xn("CircleBucket",Lo,{omit:["layers"]});var Hl=new Di({"circle-sort-key":new ua(He.layout_circle["circle-sort-key"])}),fc={paint:new Di({"circle-radius":new ua(He.paint_circle["circle-radius"]),"circle-color":new ua(He.paint_circle["circle-color"]),"circle-blur":new ua(He.paint_circle["circle-blur"]),"circle-opacity":new ua(He.paint_circle["circle-opacity"]),"circle-translate":new Qn(He.paint_circle["circle-translate"]),"circle-translate-anchor":new Qn(He.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Qn(He.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Qn(He.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ua(He.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ua(He.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ua(He.paint_circle["circle-stroke-opacity"])}),layout:Hl},Xi=typeof Float32Array!="undefined"?Float32Array:Array;function jo(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function xs(e,t,r){var u=t[0],h=t[1],g=t[2],A=t[3],L=t[4],B=t[5],te=t[6],pe=t[7],Se=t[8],Me=t[9],it=t[10],St=t[11],xt=t[12],Gt=t[13],Bt=t[14],ar=t[15],hr=r[0],Tr=r[1],Fr=r[2],Ir=r[3];return e[0]=hr*u+Tr*L+Fr*Se+Ir*xt,e[1]=hr*h+Tr*B+Fr*Me+Ir*Gt,e[2]=hr*g+Tr*te+Fr*it+Ir*Bt,e[3]=hr*A+Tr*pe+Fr*St+Ir*ar,e[4]=(hr=r[4])*u+(Tr=r[5])*L+(Fr=r[6])*Se+(Ir=r[7])*xt,e[5]=hr*h+Tr*B+Fr*Me+Ir*Gt,e[6]=hr*g+Tr*te+Fr*it+Ir*Bt,e[7]=hr*A+Tr*pe+Fr*St+Ir*ar,e[8]=(hr=r[8])*u+(Tr=r[9])*L+(Fr=r[10])*Se+(Ir=r[11])*xt,e[9]=hr*h+Tr*B+Fr*Me+Ir*Gt,e[10]=hr*g+Tr*te+Fr*it+Ir*Bt,e[11]=hr*A+Tr*pe+Fr*St+Ir*ar,e[12]=(hr=r[12])*u+(Tr=r[13])*L+(Fr=r[14])*Se+(Ir=r[15])*xt,e[13]=hr*h+Tr*B+Fr*Me+Ir*Gt,e[14]=hr*g+Tr*te+Fr*it+Ir*Bt,e[15]=hr*A+Tr*pe+Fr*St+Ir*ar,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,r=arguments.length;r--;)t+=e[r]*e[r];return Math.sqrt(t)});var to,Vs=xs;function ro(e,t,r){var u=t[0],h=t[1],g=t[2],A=t[3];return e[0]=r[0]*u+r[4]*h+r[8]*g+r[12]*A,e[1]=r[1]*u+r[5]*h+r[9]*g+r[13]*A,e[2]=r[2]*u+r[6]*h+r[10]*g+r[14]*A,e[3]=r[3]*u+r[7]*h+r[11]*g+r[15]*A,e}to=new Xi(3),Xi!=Float32Array&&(to[0]=0,to[1]=0,to[2]=0),function(){var e=new Xi(4);Xi!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var $u=(function(){var e=new Xi(2);Xi!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(r){e.call(this,r,fc)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new Lo(r)},t.prototype.queryRadius=function(r){var u=r;return Ku("circle-radius",this,u)+Ku("circle-stroke-width",this,u)+eo(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(r,u,h,g,A,L,B,te){for(var pe=Rs(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),L.angle,B),Se=this.paint.get("circle-radius").evaluate(u,h)+this.paint.get("circle-stroke-width").evaluate(u,h),Me=this.paint.get("circle-pitch-alignment")==="map",it=Me?pe:function(hn,yn){return hn.map(function(Un){return pl(Un,yn)})}(pe,te),St=Me?Se*B:Se,xt=0,Gt=g;xt<Gt.length;xt+=1)for(var Bt=0,ar=Gt[xt];Bt<ar.length;Bt+=1){var hr=ar[Bt],Tr=Me?hr:pl(hr,te),Fr=St,Ir=ro([],[hr.x,hr.y,0,1],te);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Fr*=Ir[3]/L.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Fr*=L.cameraToCenterDistance/Ir[3]),Us(it,Tr,Fr))return!0}return!1},t}(is));function pl(e,t){var r=ro([],[e.x,e.y,0,1],t);return new re(r[0]/r[3],r[1]/r[3])}var ml=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Lo);function Ac(e,t,r,u){var h=t.width,g=t.height;if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==h*g*r)throw new RangeError("mismatched image size")}else u=new Uint8Array(h*g*r);return e.width=h,e.height=g,e.data=u,e}function Ju(e,t,r){var u=t.width,h=t.height;if(u!==e.width||h!==e.height){var g=Ac({},{width:u,height:h},r);Wl(e,g,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,u),height:Math.min(e.height,h)},r),e.width=u,e.height=h,e.data=g.data}}function Wl(e,t,r,u,h,g){if(h.width===0||h.height===0)return t;if(h.width>e.width||h.height>e.height||r.x>e.width-h.width||r.y>e.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>t.width||h.height>t.height||u.x>t.width-h.width||u.y>t.height-h.height)throw new RangeError("out of range destination coordinates for image copy");for(var A=e.data,L=t.data,B=0;B<h.height;B++)for(var te=((r.y+B)*e.width+r.x)*g,pe=((u.y+B)*t.width+u.x)*g,Se=0;Se<h.width*g;Se++)L[pe+Se]=A[te+Se];return t}xn("HeatmapBucket",ml,{omit:["layers"]});var Uo=function(t,r){Ac(this,t,1,r)};Uo.prototype.resize=function(e){Ju(this,e,1)},Uo.prototype.clone=function(){return new Uo({width:this.width,height:this.height},new Uint8Array(this.data))},Uo.copy=function(e,t,r,u,h){Wl(e,t,r,u,h,1)};var vo=function(t,r){Ac(this,t,4,r)};vo.prototype.resize=function(e){Ju(this,e,4)},vo.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},vo.prototype.clone=function(){return new vo({width:this.width,height:this.height},new Uint8Array(this.data))},vo.copy=function(e,t,r,u,h){Wl(e,t,r,u,h,4)},xn("AlphaImage",Uo),xn("RGBAImage",vo);var $c={paint:new Di({"heatmap-radius":new ua(He.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ua(He.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Qn(He.paint_heatmap["heatmap-intensity"]),"heatmap-color":new zs(He.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Qn(He.paint_heatmap["heatmap-opacity"])})};function Zl(e){var t={},r=e.resolution||256,u=e.clips?e.clips.length:1,h=e.image||new vo({width:r,height:u}),g=function(xt,Gt,Bt){t[e.evaluationKey]=Bt;var ar=e.expression.evaluate(t);h.data[xt+Gt+0]=Math.floor(255*ar.r/ar.a),h.data[xt+Gt+1]=Math.floor(255*ar.g/ar.a),h.data[xt+Gt+2]=Math.floor(255*ar.b/ar.a),h.data[xt+Gt+3]=Math.floor(255*ar.a)};if(e.clips)for(var A=0,L=0;A<u;++A,L+=4*r)for(var B=0,te=0;B<r;B++,te+=4){var pe=B/(r-1),Se=e.clips[A];g(L,te,Se.start*(1-pe)+Se.end*pe)}else for(var Me=0,it=0;Me<r;Me++,it+=4)g(0,it,Me/(r-1));return h}var Jc=function(e){function t(r){e.call(this,r,$c),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new ml(r)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="heatmap-color"&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=Zl({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},t}(is),Es={paint:new Di({"hillshade-illumination-direction":new Qn(He.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Qn(He.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Qn(He.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Qn(He.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Qn(He.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Qn(He.paint_hillshade["hillshade-accent-color"])})},cf=function(e){function t(r){e.call(this,r,Es)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},t}(is),Nf=Si([{name:"a_pos",components:2,type:"Int16"}],4).members,ff=Nu,Zf=Nu;function Nu(e,t,r){r=r||2;var u,h,g,A,L,B,te,pe=t&&t.length,Se=pe?t[0]*r:e.length,Me=hf(e,0,Se,r,!0),it=[];if(!Me||Me.next===Me.prev)return it;if(pe&&(Me=function(xt,Gt,Bt,ar){var hr,Tr,Fr,Ir=[];for(hr=0,Tr=Gt.length;hr<Tr;hr++)(Fr=hf(xt,Gt[hr]*ar,hr<Tr-1?Gt[hr+1]*ar:xt.length,ar,!1))===Fr.next&&(Fr.steiner=!0),Ir.push($f(Fr));for(Ir.sort(wc),hr=0;hr<Ir.length;hr++)Yf(Ir[hr],Bt),Bt=Xl(Bt,Bt.next);return Bt}(e,t,Me,r)),e.length>80*r){u=g=e[0],h=A=e[1];for(var St=r;St<Se;St+=r)(L=e[St])<u&&(u=L),(B=e[St+1])<h&&(h=B),L>g&&(g=L),B>A&&(A=B);te=(te=Math.max(g-u,A-h))!==0?1/te:0}return vl(Me,it,r,u,h,te),it}function hf(e,t,r,u,h){var g,A;if(h===Cf(e,t,r,u)>0)for(g=t;g<r;g+=u)A=Pc(g,e[g],e[g+1],A);else for(g=r-u;g>=t;g-=u)A=Pc(g,e[g],e[g+1],A);return A&&hc(A,A.next)&&(Lc(A),A=A.next),A}function Xl(e,t){if(!e)return e;t||(t=e);var r,u=e;do if(r=!1,u.steiner||!hc(u,u.next)&&go(u.prev,u,u.next)!==0)u=u.next;else{if(Lc(u),(u=t=u.prev)===u.next)break;r=!0}while(r||u!==t);return t}function vl(e,t,r,u,h,g,A){if(e){!A&&g&&function(pe,Se,Me,it){var St=pe;do St.z===null&&(St.z=kf(St.x,St.y,Se,Me,it)),St.prevZ=St.prev,St.nextZ=St.next,St=St.next;while(St!==pe);St.prevZ.nextZ=null,St.prevZ=null,function(xt){var Gt,Bt,ar,hr,Tr,Fr,Ir,hn,yn=1;do{for(Bt=xt,xt=null,Tr=null,Fr=0;Bt;){for(Fr++,ar=Bt,Ir=0,Gt=0;Gt<yn&&(Ir++,ar=ar.nextZ);Gt++);for(hn=yn;Ir>0||hn>0&&ar;)Ir!==0&&(hn===0||!ar||Bt.z<=ar.z)?(hr=Bt,Bt=Bt.nextZ,Ir--):(hr=ar,ar=ar.nextZ,hn--),Tr?Tr.nextZ=hr:xt=hr,hr.prevZ=Tr,Tr=hr;Bt=ar}Tr.nextZ=null,yn*=2}while(Fr>1)}(St)}(e,u,h,g);for(var L,B,te=e;e.prev!==e.next;)if(L=e.prev,B=e.next,g?Af(e,u,h,g):Qc(e))t.push(L.i/r),t.push(e.i/r),t.push(B.i/r),Lc(e),e=B.next,te=B.next;else if((e=B)===te){A?A===1?vl(e=Xf(Xl(e),t,r),t,r,u,h,g,2):A===2&&Cc(e,t,r,u,h,g):vl(Xl(e),t,r,u,h,g,1);break}}}function Qc(e){var t=e.prev,r=e,u=e.next;if(go(t,r,u)>=0)return!1;for(var h=e.next.next;h!==e.prev;){if(qc(t.x,t.y,r.x,r.y,u.x,u.y,h.x,h.y)&&go(h.prev,h,h.next)>=0)return!1;h=h.next}return!0}function Af(e,t,r,u){var h=e.prev,g=e,A=e.next;if(go(h,g,A)>=0)return!1;for(var L=h.x>g.x?h.x>A.x?h.x:A.x:g.x>A.x?g.x:A.x,B=h.y>g.y?h.y>A.y?h.y:A.y:g.y>A.y?g.y:A.y,te=kf(h.x<g.x?h.x<A.x?h.x:A.x:g.x<A.x?g.x:A.x,h.y<g.y?h.y<A.y?h.y:A.y:g.y<A.y?g.y:A.y,t,r,u),pe=kf(L,B,t,r,u),Se=e.prevZ,Me=e.nextZ;Se&&Se.z>=te&&Me&&Me.z<=pe;){if(Se!==e.prev&&Se!==e.next&&qc(h.x,h.y,g.x,g.y,A.x,A.y,Se.x,Se.y)&&go(Se.prev,Se,Se.next)>=0)return!1;if(Se=Se.prevZ,Me!==e.prev&&Me!==e.next&&qc(h.x,h.y,g.x,g.y,A.x,A.y,Me.x,Me.y)&&go(Me.prev,Me,Me.next)>=0)return!1;Me=Me.nextZ}for(;Se&&Se.z>=te;){if(Se!==e.prev&&Se!==e.next&&qc(h.x,h.y,g.x,g.y,A.x,A.y,Se.x,Se.y)&&go(Se.prev,Se,Se.next)>=0)return!1;Se=Se.prevZ}for(;Me&&Me.z<=pe;){if(Me!==e.prev&&Me!==e.next&&qc(h.x,h.y,g.x,g.y,A.x,A.y,Me.x,Me.y)&&go(Me.prev,Me,Me.next)>=0)return!1;Me=Me.nextZ}return!0}function Xf(e,t,r){var u=e;do{var h=u.prev,g=u.next.next;!hc(h,g)&&df(h,u,u.next,g)&&Mc(h,g)&&Mc(g,h)&&(t.push(h.i/r),t.push(u.i/r),t.push(g.i/r),Lc(u),Lc(u.next),u=e=g),u=u.next}while(u!==e);return Xl(u)}function Cc(e,t,r,u,h,g){var A=e;do{for(var L=A.next.next;L!==A.prev;){if(A.i!==L.i&&fh(A,L)){var B=ku(A,L);return A=Xl(A,A.next),B=Xl(B,B.next),vl(A,t,r,u,h,g),void vl(B,t,r,u,h,g)}L=L.next}A=A.next}while(A!==e)}function wc(e,t){return e.x-t.x}function Yf(e,t){if(t=function(u,h){var g,A=h,L=u.x,B=u.y,te=-1/0;do{if(B<=A.y&&B>=A.next.y&&A.next.y!==A.y){var pe=A.x+(B-A.y)*(A.next.x-A.x)/(A.next.y-A.y);if(pe<=L&&pe>te){if(te=pe,pe===L){if(B===A.y)return A;if(B===A.next.y)return A.next}g=A.x<A.next.x?A:A.next}}A=A.next}while(A!==h);if(!g)return null;if(L===te)return g;var Se,Me=g,it=g.x,St=g.y,xt=1/0;A=g;do L>=A.x&&A.x>=it&&L!==A.x&&qc(B<St?L:te,B,it,St,B<St?te:L,B,A.x,A.y)&&(Se=Math.abs(B-A.y)/(L-A.x),Mc(A,u)&&(Se<xt||Se===xt&&(A.x>g.x||A.x===g.x&&Kf(g,A)))&&(g=A,xt=Se)),A=A.next;while(A!==Me);return g}(e,t)){var r=ku(t,e);Xl(t,t.next),Xl(r,r.next)}}function Kf(e,t){return go(e.prev,e,t.prev)<0&&go(t.next,e,e.next)<0}function kf(e,t,r,u,h){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*h)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-u)*h)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function $f(e){var t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function qc(e,t,r,u,h,g,A,L){return(h-A)*(t-L)-(e-A)*(g-L)>=0&&(e-A)*(u-L)-(r-A)*(t-L)>=0&&(r-A)*(g-L)-(h-A)*(u-L)>=0}function fh(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(r,u){var h=r;do{if(h.i!==r.i&&h.next.i!==r.i&&h.i!==u.i&&h.next.i!==u.i&&df(h,h.next,r,u))return!0;h=h.next}while(h!==r);return!1}(e,t)&&(Mc(e,t)&&Mc(t,e)&&function(r,u){var h=r,g=!1,A=(r.x+u.x)/2,L=(r.y+u.y)/2;do h.y>L!=h.next.y>L&&h.next.y!==h.y&&A<(h.next.x-h.x)*(L-h.y)/(h.next.y-h.y)+h.x&&(g=!g),h=h.next;while(h!==r);return g}(e,t)&&(go(e.prev,e,t.prev)||go(e,t.prev,t))||hc(e,t)&&go(e.prev,e,e.next)>0&&go(t.prev,t,t.next)>0)}function go(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function hc(e,t){return e.x===t.x&&e.y===t.y}function df(e,t,r,u){var h=Oc(go(e,t,r)),g=Oc(go(e,t,u)),A=Oc(go(r,u,e)),L=Oc(go(r,u,t));return h!==g&&A!==L||!(h!==0||!Yl(e,r,t))||!(g!==0||!Yl(e,u,t))||!(A!==0||!Yl(r,e,u))||!(L!==0||!Yl(r,t,u))}function Yl(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function Oc(e){return e>0?1:e<0?-1:0}function Mc(e,t){return go(e.prev,e,e.next)<0?go(e,t,e.next)>=0&&go(e,e.prev,t)>=0:go(e,t,e.prev)<0||go(e,e.next,t)<0}function ku(e,t){var r=new pf(e.i,e.x,e.y),u=new pf(t.i,t.x,t.y),h=e.next,g=t.prev;return e.next=t,t.prev=e,r.next=h,h.prev=r,u.next=r,r.prev=u,g.next=u,u.prev=g,u}function Pc(e,t,r,u){var h=new pf(e,t,r);return u?(h.next=u.next,h.prev=u,u.next.prev=h,u.next=h):(h.prev=h,h.next=h),h}function Lc(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function pf(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Cf(e,t,r,u){for(var h=0,g=t,A=r-u;g<r;g+=u)h+=(e[A]-e[g])*(e[g+1]+e[A+1]),A=g;return h}function jf(e,t,r,u,h){!function g(A,L,B,te,pe){for(;te>B;){if(te-B>600){var Se=te-B+1,Me=L-B+1,it=Math.log(Se),St=.5*Math.exp(2*it/3),xt=.5*Math.sqrt(it*St*(Se-St)/Se)*(Me-Se/2<0?-1:1);g(A,L,Math.max(B,Math.floor(L-Me*St/Se+xt)),Math.min(te,Math.floor(L+(Se-Me)*St/Se+xt)),pe)}var Gt=A[L],Bt=B,ar=te;for(dc(A,B,L),pe(A[te],Gt)>0&&dc(A,B,te);Bt<ar;){for(dc(A,Bt,ar),Bt++,ar--;pe(A[Bt],Gt)<0;)Bt++;for(;pe(A[ar],Gt)>0;)ar--}pe(A[B],Gt)===0?dc(A,B,ar):dc(A,++ar,te),ar<=L&&(B=ar+1),L<=ar&&(te=ar-1)}}(e,t,r||0,u||e.length-1,h||Kl)}function dc(e,t,r){var u=e[t];e[t]=e[r],e[r]=u}function Kl(e,t){return e<t?-1:e>t?1:0}function ne(e,t){var r=e.length;if(r<=1)return[e];for(var u,h,g=[],A=0;A<r;A++){var L=Vt(e[A]);L!==0&&(e[A].area=Math.abs(L),h===void 0&&(h=L<0),h===L<0?(u&&g.push(u),u=[e[A]]):u.push(e[A]))}if(u&&g.push(u),t>1)for(var B=0;B<g.length;B++)g[B].length<=t||(jf(g[B],t,1,g[B].length-1,se),g[B]=g[B].slice(0,t));return g}function se(e,t){return t.area-e.area}function k(e,t,r){for(var u=r.patternDependencies,h=!1,g=0,A=t;g<A.length;g+=1){var L=A[g].paint.get(e+"-pattern");L.isConstant()||(h=!0);var B=L.constantOr(null);B&&(h=!0,u[B.to]=!0,u[B.from]=!0)}return h}function G(e,t,r,u,h){for(var g=h.patternDependencies,A=0,L=t;A<L.length;A+=1){var B=L[A],te=B.paint.get(e+"-pattern").value;if(te.kind!=="constant"){var pe=te.evaluate({zoom:u-1},r,{},h.availableImages),Se=te.evaluate({zoom:u},r,{},h.availableImages),Me=te.evaluate({zoom:u+1},r,{},h.availableImages);Se=Se&&Se.name?Se.name:Se,Me=Me&&Me.name?Me.name:Me,g[pe=pe&&pe.name?pe.name:pe]=!0,g[Se]=!0,g[Me]=!0,r.patterns[B.id]={min:pe,mid:Se,max:Me}}}return r}Nu.deviation=function(e,t,r,u){var h=t&&t.length,g=Math.abs(Cf(e,0,h?t[0]*r:e.length,r));if(h)for(var A=0,L=t.length;A<L;A++)g-=Math.abs(Cf(e,t[A]*r,A<L-1?t[A+1]*r:e.length,r));var B=0;for(A=0;A<u.length;A+=3){var te=u[A]*r,pe=u[A+1]*r,Se=u[A+2]*r;B+=Math.abs((e[te]-e[Se])*(e[pe+1]-e[te+1])-(e[te]-e[pe])*(e[Se+1]-e[te+1]))}return g===0&&B===0?0:Math.abs((B-g)/g)},Nu.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},u=0,h=0;h<e.length;h++){for(var g=0;g<e[h].length;g++)for(var A=0;A<t;A++)r.vertices.push(e[h][g][A]);h>0&&r.holes.push(u+=e[h-1].length)}return r},ff.default=Zf;var _e=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new yu,this.indexArray=new xu,this.indexArray2=new Bl,this.programConfigurations=new wa(t.layers,t.zoom),this.segments=new qe,this.segments2=new qe,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};_e.prototype.populate=function(e,t,r){this.hasPattern=k("fill",this.layers,t);for(var u=this.layers[0].layout.get("fill-sort-key"),h=[],g=0,A=e;g<A.length;g+=1){var L=A[g],B=L.feature,te=L.id,pe=L.index,Se=L.sourceLayerIndex,Me=this.layers[0]._featureFilter.needGeometry,it={type:B.type,id:te,properties:B.properties,geometry:Me?fi(B):[]};if(this.layers[0]._featureFilter.filter(new ci(this.zoom),it,r)){Me||(it.geometry=fi(B));var St=u?u.evaluate(it,{},r,t.availableImages):void 0;h.push({id:te,properties:B.properties,type:B.type,sourceLayerIndex:Se,index:pe,geometry:it.geometry,patterns:{},sortKey:St})}}u&&h.sort(function(Ir,hn){return Ir.sortKey-hn.sortKey});for(var xt=0,Gt=h;xt<Gt.length;xt+=1){var Bt=Gt[xt],ar=Bt.geometry,hr=Bt.index,Tr=Bt.sourceLayerIndex;if(this.hasPattern){var Fr=G("fill",this.layers,Bt,this.zoom,t);this.patternFeatures.push(Fr)}else this.addFeature(Bt,ar,hr,r,{});t.featureIndex.insert(e[hr].feature,ar,hr,Tr,this.index)}},_e.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},_e.prototype.addFeatures=function(e,t,r){for(var u=0,h=this.patternFeatures;u<h.length;u+=1){var g=h[u];this.addFeature(g,g.geometry,g.index,t,r)}},_e.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},_e.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},_e.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Nf),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},_e.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},_e.prototype.addFeature=function(e,t,r,u,h){for(var g=0,A=ne(t,500);g<A.length;g+=1){for(var L=A[g],B=0,te=0,pe=L;te<pe.length;te+=1)B+=pe[te].length;for(var Se=this.segments.prepareSegment(B,this.layoutVertexArray,this.indexArray),Me=Se.vertexLength,it=[],St=[],xt=0,Gt=L;xt<Gt.length;xt+=1){var Bt=Gt[xt];if(Bt.length!==0){Bt!==L[0]&&St.push(it.length/2);var ar=this.segments2.prepareSegment(Bt.length,this.layoutVertexArray,this.indexArray2),hr=ar.vertexLength;this.layoutVertexArray.emplaceBack(Bt[0].x,Bt[0].y),this.indexArray2.emplaceBack(hr+Bt.length-1,hr),it.push(Bt[0].x),it.push(Bt[0].y);for(var Tr=1;Tr<Bt.length;Tr++)this.layoutVertexArray.emplaceBack(Bt[Tr].x,Bt[Tr].y),this.indexArray2.emplaceBack(hr+Tr-1,hr+Tr),it.push(Bt[Tr].x),it.push(Bt[Tr].y);ar.vertexLength+=Bt.length,ar.primitiveLength+=Bt.length}}for(var Fr=ff(it,St),Ir=0;Ir<Fr.length;Ir+=3)this.indexArray.emplaceBack(Me+Fr[Ir],Me+Fr[Ir+1],Me+Fr[Ir+2]);Se.vertexLength+=B,Se.primitiveLength+=Fr.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,h,u)},xn("FillBucket",_e,{omit:["layers","patternFeatures"]});var ot=new Di({"fill-sort-key":new ua(He.layout_fill["fill-sort-key"])}),Xt={paint:new Di({"fill-antialias":new Qn(He.paint_fill["fill-antialias"]),"fill-opacity":new ua(He.paint_fill["fill-opacity"]),"fill-color":new ua(He.paint_fill["fill-color"]),"fill-outline-color":new ua(He.paint_fill["fill-outline-color"]),"fill-translate":new Qn(He.paint_fill["fill-translate"]),"fill-translate-anchor":new Qn(He.paint_fill["fill-translate-anchor"]),"fill-pattern":new lo(He.paint_fill["fill-pattern"])}),layout:ot},rr=function(e){function t(r){e.call(this,r,Xt)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,u){e.prototype.recalculate.call(this,r,u);var h=this.paint._values["fill-outline-color"];h.value.kind==="constant"&&h.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(r){return new _e(r)},t.prototype.queryRadius=function(){return eo(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(r,u,h,g,A,L,B){return Bs(Rs(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),L.angle,B),g)},t.prototype.isTileClipped=function(){return!0},t}(is),tr=Si([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Dr=tn;function tn(e,t,r,u,h){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=u,this._values=h,e.readFields(Vn,this,t)}function Vn(e,t,r){e==1?t.id=r.readVarint():e==2?function(u,h){for(var g=u.readVarint()+u.pos;u.pos<g;){var A=h._keys[u.readVarint()],L=h._values[u.readVarint()];h.properties[A]=L}}(r,t):e==3?t.type=r.readVarint():e==4&&(t._geometry=r.pos)}function ta(e){for(var t,r,u=0,h=0,g=e.length,A=g-1;h<g;A=h++)u+=((r=e[A]).x-(t=e[h]).x)*(t.y+r.y);return u}tn.types=["Unknown","Point","LineString","Polygon"],tn.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,u=1,h=0,g=0,A=0,L=[];e.pos<r;){if(h<=0){var B=e.readVarint();u=7&B,h=B>>3}if(h--,u===1||u===2)g+=e.readSVarint(),A+=e.readSVarint(),u===1&&(t&&L.push(t),t=[]),t.push(new re(g,A));else{if(u!==7)throw new Error("unknown command "+u);t&&t.push(t[0].clone())}}return t&&L.push(t),L},tn.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,u=0,h=0,g=0,A=1/0,L=-1/0,B=1/0,te=-1/0;e.pos<t;){if(u<=0){var pe=e.readVarint();r=7&pe,u=pe>>3}if(u--,r===1||r===2)(h+=e.readSVarint())<A&&(A=h),h>L&&(L=h),(g+=e.readSVarint())<B&&(B=g),g>te&&(te=g);else if(r!==7)throw new Error("unknown command "+r)}return[A,B,L,te]},tn.prototype.toGeoJSON=function(e,t,r){var u,h,g=this.extent*Math.pow(2,r),A=this.extent*e,L=this.extent*t,B=this.loadGeometry(),te=tn.types[this.type];function pe(it){for(var St=0;St<it.length;St++){var xt=it[St];it[St]=[360*(xt.x+A)/g-180,360/Math.PI*Math.atan(Math.exp((180-360*(xt.y+L)/g)*Math.PI/180))-90]}}switch(this.type){case 1:var Se=[];for(u=0;u<B.length;u++)Se[u]=B[u][0];pe(B=Se);break;case 2:for(u=0;u<B.length;u++)pe(B[u]);break;case 3:for(B=function(it){var St=it.length;if(St<=1)return[it];for(var xt,Gt,Bt=[],ar=0;ar<St;ar++){var hr=ta(it[ar]);hr!==0&&(Gt===void 0&&(Gt=hr<0),Gt===hr<0?(xt&&Bt.push(xt),xt=[it[ar]]):xt.push(it[ar]))}return xt&&Bt.push(xt),Bt}(B),u=0;u<B.length;u++)for(h=0;h<B[u].length;h++)pe(B[u][h])}B.length===1?B=B[0]:te="Multi"+te;var Me={type:"Feature",geometry:{type:te,coordinates:B},properties:this.properties};return"id"in this&&(Me.id=this.id),Me};var oa=Ya;function Ya(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(za,this,t),this.length=this._features.length}function za(e,t,r){e===15?t.version=r.readVarint():e===1?t.name=r.readString():e===5?t.extent=r.readVarint():e===2?t._features.push(r.pos):e===3?t._keys.push(r.readString()):e===4&&t._values.push(function(u){for(var h=null,g=u.readVarint()+u.pos;u.pos<g;){var A=u.readVarint()>>3;h=A===1?u.readString():A===2?u.readFloat():A===3?u.readDouble():A===4?u.readVarint64():A===5?u.readVarint():A===6?u.readSVarint():A===7?u.readBoolean():null}return h}(r))}function Ni(e,t,r){if(e===3){var u=new oa(r,r.readVarint()+r.pos);u.length&&(t[u.name]=u)}}Ya.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new Dr(this._pbf,t,this.extent,this._keys,this._values)};var Fa={VectorTile:function(t,r){this.layers=t.readFields(Ni,{},r)},VectorTileFeature:Dr,VectorTileLayer:oa},Gi=Fa.VectorTileFeature.types,Qo=Math.pow(2,13);function Qi(e,t,r,u,h,g,A,L){e.emplaceBack(t,r,2*Math.floor(u*Qo)+A,h*Qo*2,g*Qo*2,Math.round(L))}var oi=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new lc,this.indexArray=new xu,this.programConfigurations=new wa(t.layers,t.zoom),this.segments=new qe,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};function Ts(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}oi.prototype.populate=function(e,t,r){this.features=[],this.hasPattern=k("fill-extrusion",this.layers,t);for(var u=0,h=e;u<h.length;u+=1){var g=h[u],A=g.feature,L=g.id,B=g.index,te=g.sourceLayerIndex,pe=this.layers[0]._featureFilter.needGeometry,Se={type:A.type,id:L,properties:A.properties,geometry:pe?fi(A):[]};if(this.layers[0]._featureFilter.filter(new ci(this.zoom),Se,r)){var Me={id:L,sourceLayerIndex:te,index:B,geometry:pe?Se.geometry:fi(A),properties:A.properties,type:A.type,patterns:{}};this.hasPattern?this.features.push(G("fill-extrusion",this.layers,Me,this.zoom,t)):this.addFeature(Me,Me.geometry,B,r,{}),t.featureIndex.insert(A,Me.geometry,B,te,this.index,!0)}}},oi.prototype.addFeatures=function(e,t,r){for(var u=0,h=this.features;u<h.length;u+=1){var g=h[u];this.addFeature(g,g.geometry,g.index,t,r)}},oi.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},oi.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},oi.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},oi.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,tr),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},oi.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},oi.prototype.addFeature=function(e,t,r,u,h){for(var g=0,A=ne(t,500);g<A.length;g+=1){for(var L=A[g],B=0,te=0,pe=L;te<pe.length;te+=1)B+=pe[te].length;for(var Se=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),Me=0,it=L;Me<it.length;Me+=1){var St=it[Me];if(St.length!==0&&!((si=St).every(function(Ma){return Ma.x<0})||si.every(function(Ma){return Ma.x>8192})||si.every(function(Ma){return Ma.y<0})||si.every(function(Ma){return Ma.y>8192})))for(var xt=0,Gt=0;Gt<St.length;Gt++){var Bt=St[Gt];if(Gt>=1){var ar=St[Gt-1];if(!Ts(Bt,ar)){Se.vertexLength+4>qe.MAX_VERTEX_ARRAY_LENGTH&&(Se=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var hr=Bt.sub(ar)._perp()._unit(),Tr=ar.dist(Bt);xt+Tr>32768&&(xt=0),Qi(this.layoutVertexArray,Bt.x,Bt.y,hr.x,hr.y,0,0,xt),Qi(this.layoutVertexArray,Bt.x,Bt.y,hr.x,hr.y,0,1,xt),Qi(this.layoutVertexArray,ar.x,ar.y,hr.x,hr.y,0,0,xt+=Tr),Qi(this.layoutVertexArray,ar.x,ar.y,hr.x,hr.y,0,1,xt);var Fr=Se.vertexLength;this.indexArray.emplaceBack(Fr,Fr+2,Fr+1),this.indexArray.emplaceBack(Fr+1,Fr+2,Fr+3),Se.vertexLength+=4,Se.primitiveLength+=2}}}}if(Se.vertexLength+B>qe.MAX_VERTEX_ARRAY_LENGTH&&(Se=this.segments.prepareSegment(B,this.layoutVertexArray,this.indexArray)),Gi[e.type]==="Polygon"){for(var Ir=[],hn=[],yn=Se.vertexLength,Un=0,Jn=L;Un<Jn.length;Un+=1){var Dn=Jn[Un];if(Dn.length!==0){Dn!==L[0]&&hn.push(Ir.length/2);for(var In=0;In<Dn.length;In++){var _a=Dn[In];Qi(this.layoutVertexArray,_a.x,_a.y,0,0,1,1,0),Ir.push(_a.x),Ir.push(_a.y)}}}for(var sa=ff(Ir,hn),Yn=0;Yn<sa.length;Yn+=3)this.indexArray.emplaceBack(yn+sa[Yn],yn+sa[Yn+2],yn+sa[Yn+1]);Se.primitiveLength+=sa.length/3,Se.vertexLength+=B}}var si;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,h,u)},xn("FillExtrusionBucket",oi,{omit:["layers","features"]});var ki={paint:new Di({"fill-extrusion-opacity":new Qn(He["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ua(He["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Qn(He["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Qn(He["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new lo(He["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ua(He["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ua(He["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Qn(He["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},yo=function(e){function t(r){e.call(this,r,ki)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new oi(r)},t.prototype.queryRadius=function(){return eo(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(r,u,h,g,A,L,B,te){var pe=Rs(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),L.angle,B),Se=this.paint.get("fill-extrusion-height").evaluate(u,h),Me=this.paint.get("fill-extrusion-base").evaluate(u,h),it=function(xt,Gt,Bt,ar){for(var hr=[],Tr=0,Fr=xt;Tr<Fr.length;Tr+=1){var Ir=Fr[Tr],hn=[Ir.x,Ir.y,0,1];ro(hn,hn,Gt),hr.push(new re(hn[0]/hn[3],hn[1]/hn[3]))}return hr}(pe,te),St=function(xt,Gt,Bt,ar){for(var hr=[],Tr=[],Fr=ar[8]*Gt,Ir=ar[9]*Gt,hn=ar[10]*Gt,yn=ar[11]*Gt,Un=ar[8]*Bt,Jn=ar[9]*Bt,Dn=ar[10]*Bt,In=ar[11]*Bt,_a=0,sa=xt;_a<sa.length;_a+=1){for(var Yn=[],si=[],Ma=0,zi=sa[_a];Ma<zi.length;Ma+=1){var da=zi[Ma],ui=da.x,wo=da.y,Wo=ar[0]*ui+ar[4]*wo+ar[12],lu=ar[1]*ui+ar[5]*wo+ar[13],Mi=ar[2]*ui+ar[6]*wo+ar[14],Ss=ar[3]*ui+ar[7]*wo+ar[15],zo=Mi+hn,cs=Ss+yn,qu=Wo+Un,Is=lu+Jn,gl=Mi+Dn,Tu=Ss+In,fs=new re((Wo+Fr)/cs,(lu+Ir)/cs);fs.z=zo/cs,Yn.push(fs);var zu=new re(qu/Tu,Is/Tu);zu.z=gl/Tu,si.push(zu)}hr.push(Yn),Tr.push(si)}return[hr,Tr]}(g,Me,Se,te);return function(xt,Gt,Bt){var ar=1/0;Bs(Bt,Gt)&&(ar=yi(Bt,Gt[0]));for(var hr=0;hr<Gt.length;hr++)for(var Tr=Gt[hr],Fr=xt[hr],Ir=0;Ir<Tr.length-1;Ir++){var hn=Tr[Ir],yn=[hn,Tr[Ir+1],Fr[Ir+1],Fr[Ir],hn];Iu(Bt,yn)&&(ar=Math.min(ar,yi(Bt,yn)))}return ar!==1/0&&ar}(St[0],St[1],it)},t}(is);function us(e,t){return e.x*t.x+e.y*t.y}function yi(e,t){if(e.length===1){for(var r,u=0,h=t[u++];!r||h.equals(r);)if(!(r=t[u++]))return 1/0;for(;u<t.length;u++){var g=t[u],A=e[0],L=r.sub(h),B=g.sub(h),te=A.sub(h),pe=us(L,L),Se=us(L,B),Me=us(B,B),it=us(te,L),St=us(te,B),xt=pe*Me-Se*Se,Gt=(Me*it-Se*St)/xt,Bt=(pe*St-Se*it)/xt,ar=h.z*(1-Gt-Bt)+r.z*Gt+g.z*Bt;if(isFinite(ar))return ar}return 1/0}for(var hr=1/0,Tr=0,Fr=t;Tr<Fr.length;Tr+=1)hr=Math.min(hr,Fr[Tr].z);return hr}var fo=Si([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Ta=Si([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,Ro=Fa.VectorTileFeature.types,pc=Math.cos(Math.PI/180*37.5),zf=Math.pow(2,14)/.5,Gs=function(t){var r=this;this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(u){return u.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(u){r.gradients[u.id]={}}),this.layoutVertexArray=new Lu,this.layoutVertexArray2=new os,this.indexArray=new xu,this.programConfigurations=new wa(t.layers,t.zoom),this.segments=new qe,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(u){return u.isStateDependent()}).map(function(u){return u.id})};Gs.prototype.populate=function(e,t,r){this.hasPattern=k("line",this.layers,t);for(var u=this.layers[0].layout.get("line-sort-key"),h=[],g=0,A=e;g<A.length;g+=1){var L=A[g],B=L.feature,te=L.id,pe=L.index,Se=L.sourceLayerIndex,Me=this.layers[0]._featureFilter.needGeometry,it={type:B.type,id:te,properties:B.properties,geometry:Me?fi(B):[]};if(this.layers[0]._featureFilter.filter(new ci(this.zoom),it,r)){Me||(it.geometry=fi(B));var St=u?u.evaluate(it,{},r):void 0;h.push({id:te,properties:B.properties,type:B.type,sourceLayerIndex:Se,index:pe,geometry:it.geometry,patterns:{},sortKey:St})}}u&&h.sort(function(Ir,hn){return Ir.sortKey-hn.sortKey});for(var xt=0,Gt=h;xt<Gt.length;xt+=1){var Bt=Gt[xt],ar=Bt.geometry,hr=Bt.index,Tr=Bt.sourceLayerIndex;if(this.hasPattern){var Fr=G("line",this.layers,Bt,this.zoom,t);this.patternFeatures.push(Fr)}else this.addFeature(Bt,ar,hr,r,{});t.featureIndex.insert(e[hr].feature,ar,hr,Tr,this.index)}},Gs.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Gs.prototype.addFeatures=function(e,t,r){for(var u=0,h=this.patternFeatures;u<h.length;u+=1){var g=h[u];this.addFeature(g,g.geometry,g.index,t,r)}},Gs.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Gs.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Gs.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Ta)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,fo),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Gs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Gs.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},Gs.prototype.addFeature=function(e,t,r,u,h){var g=this.layers[0].layout,A=g.get("line-join").evaluate(e,{}),L=g.get("line-cap"),B=g.get("line-miter-limit"),te=g.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var pe=0,Se=t;pe<Se.length;pe+=1)this.addLine(Se[pe],e,A,L,B,te);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,h,u)},Gs.prototype.addLine=function(e,t,r,u,h,g){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var A=0;A<e.length-1;A++)this.totalDistance+=e[A].dist(e[A+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var L=Ro[t.type]==="Polygon",B=e.length;B>=2&&e[B-1].equals(e[B-2]);)B--;for(var te=0;te<B-1&&e[te].equals(e[te+1]);)te++;if(!(B<(L?3:2))){r==="bevel"&&(h=1.05);var pe,Se=this.overscaling<=16?122880/(512*this.overscaling):0,Me=this.segments.prepareSegment(10*B,this.layoutVertexArray,this.indexArray),it=void 0,St=void 0,xt=void 0,Gt=void 0;this.e1=this.e2=-1,L&&(Gt=e[te].sub(pe=e[B-2])._unit()._perp());for(var Bt=te;Bt<B;Bt++)if(!(St=Bt===B-1?L?e[te+1]:void 0:e[Bt+1])||!e[Bt].equals(St)){Gt&&(xt=Gt),pe&&(it=pe),pe=e[Bt],Gt=St?St.sub(pe)._unit()._perp():xt;var ar=(xt=xt||Gt).add(Gt);ar.x===0&&ar.y===0||ar._unit();var hr=xt.x*Gt.x+xt.y*Gt.y,Tr=ar.x*Gt.x+ar.y*Gt.y,Fr=Tr!==0?1/Tr:1/0,Ir=2*Math.sqrt(2-2*Tr),hn=Tr<pc&&it&&St,yn=xt.x*Gt.y-xt.y*Gt.x>0;if(hn&&Bt>te){var Un=pe.dist(it);if(Un>2*Se){var Jn=pe.sub(pe.sub(it)._mult(Se/Un)._round());this.updateDistance(it,Jn),this.addCurrentVertex(Jn,xt,0,0,Me),it=Jn}}var Dn=it&&St,In=Dn?r:L?"butt":u;if(Dn&&In==="round"&&(Fr<g?In="miter":Fr<=2&&(In="fakeround")),In==="miter"&&Fr>h&&(In="bevel"),In==="bevel"&&(Fr>2&&(In="flipbevel"),Fr<h&&(In="miter")),it&&this.updateDistance(it,pe),In==="miter")ar._mult(Fr),this.addCurrentVertex(pe,ar,0,0,Me);else if(In==="flipbevel"){if(Fr>100)ar=Gt.mult(-1);else{var _a=Fr*xt.add(Gt).mag()/xt.sub(Gt).mag();ar._perp()._mult(_a*(yn?-1:1))}this.addCurrentVertex(pe,ar,0,0,Me),this.addCurrentVertex(pe,ar.mult(-1),0,0,Me)}else if(In==="bevel"||In==="fakeround"){var sa=-Math.sqrt(Fr*Fr-1),Yn=yn?sa:0,si=yn?0:sa;if(it&&this.addCurrentVertex(pe,xt,Yn,si,Me),In==="fakeround")for(var Ma=Math.round(180*Ir/Math.PI/20),zi=1;zi<Ma;zi++){var da=zi/Ma;if(da!==.5){var ui=da-.5;da+=da*ui*(da-1)*((1.0904+hr*(hr*(3.55645-1.43519*hr)-3.2452))*ui*ui+(.848013+hr*(.215638*hr-1.06021)))}var wo=Gt.sub(xt)._mult(da)._add(xt)._unit()._mult(yn?-1:1);this.addHalfVertex(pe,wo.x,wo.y,!1,yn,0,Me)}St&&this.addCurrentVertex(pe,Gt,-Yn,-si,Me)}else if(In==="butt")this.addCurrentVertex(pe,ar,0,0,Me);else if(In==="square"){var Wo=it?1:-1;this.addCurrentVertex(pe,ar,Wo,Wo,Me)}else In==="round"&&(it&&(this.addCurrentVertex(pe,xt,0,0,Me),this.addCurrentVertex(pe,xt,1,1,Me,!0)),St&&(this.addCurrentVertex(pe,Gt,-1,-1,Me,!0),this.addCurrentVertex(pe,Gt,0,0,Me)));if(hn&&Bt<B-1){var lu=pe.dist(St);if(lu>2*Se){var Mi=pe.add(St.sub(pe)._mult(Se/lu)._round());this.updateDistance(pe,Mi),this.addCurrentVertex(Mi,Gt,0,0,Me),pe=Mi}}}}},Gs.prototype.addCurrentVertex=function(e,t,r,u,h,g){g===void 0&&(g=!1);var A=t.y*u-t.x,L=-t.y-t.x*u;this.addHalfVertex(e,t.x+t.y*r,t.y-t.x*r,g,!1,r,h),this.addHalfVertex(e,A,L,g,!0,-u,h),this.distance>zf/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,t,r,u,h,g))},Gs.prototype.addHalfVertex=function(e,t,r,u,h,g,A){var L=.5*(this.lineClips?this.scaledDistance*(zf-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(u?1:0),(e.y<<1)+(h?1:0),Math.round(63*t)+128,Math.round(63*r)+128,1+(g===0?0:g<0?-1:1)|(63&L)<<2,L>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var B=A.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,B),A.primitiveLength++),h?this.e2=B:this.e1=B},Gs.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Gs.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},xn("LineBucket",Gs,{omit:["layers","patternFeatures"]});var ah=new Di({"line-cap":new Qn(He.layout_line["line-cap"]),"line-join":new ua(He.layout_line["line-join"]),"line-miter-limit":new Qn(He.layout_line["line-miter-limit"]),"line-round-limit":new Qn(He.layout_line["line-round-limit"]),"line-sort-key":new ua(He.layout_line["line-sort-key"])}),Fh={paint:new Di({"line-opacity":new ua(He.paint_line["line-opacity"]),"line-color":new ua(He.paint_line["line-color"]),"line-translate":new Qn(He.paint_line["line-translate"]),"line-translate-anchor":new Qn(He.paint_line["line-translate-anchor"]),"line-width":new ua(He.paint_line["line-width"]),"line-gap-width":new ua(He.paint_line["line-gap-width"]),"line-offset":new ua(He.paint_line["line-offset"]),"line-blur":new ua(He.paint_line["line-blur"]),"line-dasharray":new zl(He.paint_line["line-dasharray"]),"line-pattern":new lo(He.paint_line["line-pattern"]),"line-gradient":new zs(He.paint_line["line-gradient"])}),layout:ah},Ff=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,u){return u=new ci(Math.floor(u.zoom),{now:u.now,fadeDuration:u.fadeDuration,zoomHistory:u.zoomHistory,transition:u.transition}),e.prototype.possiblyEvaluate.call(this,r,u)},t.prototype.evaluate=function(r,u,h,g){return u=je({},u,{zoom:Math.floor(u.zoom)}),e.prototype.evaluate.call(this,r,u,h,g)},t}(ua))(Fh.paint.properties["line-width"].specification);Ff.useIntegerZoom=!0;var wf=function(e){function t(r){e.call(this,r,Fh),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Su,this.gradientVersion=(this.gradientVersion+1)%Fe)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(r,u){e.prototype.recalculate.call(this,r,u),this.paint._values["line-floorwidth"]=Ff.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)},t.prototype.createBucket=function(r){return new Gs(r)},t.prototype.queryRadius=function(r){var u=r,h=Jf(Ku("line-width",this,u),Ku("line-gap-width",this,u)),g=Ku("line-offset",this,u);return h/2+Math.abs(g)+eo(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(r,u,h,g,A,L,B){var te=Rs(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),L.angle,B),pe=B/2*Jf(this.paint.get("line-width").evaluate(u,h),this.paint.get("line-gap-width").evaluate(u,h)),Se=this.paint.get("line-offset").evaluate(u,h);return Se&&(g=function(Me,it){for(var St=[],xt=new re(0,0),Gt=0;Gt<Me.length;Gt++){for(var Bt=Me[Gt],ar=[],hr=0;hr<Bt.length;hr++){var Tr=Bt[hr],Fr=Bt[hr+1],Ir=hr===0?xt:Tr.sub(Bt[hr-1])._unit()._perp(),hn=hr===Bt.length-1?xt:Fr.sub(Tr)._unit()._perp(),yn=Ir._add(hn)._unit();yn._mult(1/(yn.x*hn.x+yn.y*hn.y)),ar.push(yn._mult(it)._add(Tr))}St.push(ar)}return St}(g,Se*B)),function(Me,it,St){for(var xt=0;xt<it.length;xt++){var Gt=it[xt];if(Me.length>=3){for(var Bt=0;Bt<Gt.length;Bt++)if(Du(Me,Gt[Bt]))return!0}if(Jo(Me,Gt,St))return!0}return!1}(te,g,pe)},t.prototype.isTileClipped=function(){return!0},t}(is);function Jf(e,t){return t>0?t+2*e:e}var Th=Si([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),_h=Si([{name:"a_projected_pos",components:3,type:"Float32"}],4),Of=(Si([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Si([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Qf=(Si([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Si([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),qf=Si([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Sh(e,t,r){return e.sections.forEach(function(u){u.text=function(h,g,A){var L=g.layout.get("text-transform").evaluate(A,{});return L==="uppercase"?h=h.toLocaleUpperCase():L==="lowercase"&&(h=h.toLocaleLowerCase()),uo.applyArabicShaping&&(h=uo.applyArabicShaping(h)),h}(u.text,t,r)}),e}Si([{name:"triangle",components:3,type:"Uint16"}]),Si([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Si([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Si([{type:"Float32",name:"offsetX"}]),Si([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var eh={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},mf=function(t,r,u,h,g){var A,L,B=8*g-h-1,te=(1<<B)-1,pe=te>>1,Se=-7,Me=u?g-1:0,it=u?-1:1,St=t[r+Me];for(Me+=it,A=St&(1<<-Se)-1,St>>=-Se,Se+=B;Se>0;A=256*A+t[r+Me],Me+=it,Se-=8);for(L=A&(1<<-Se)-1,A>>=-Se,Se+=h;Se>0;L=256*L+t[r+Me],Me+=it,Se-=8);if(A===0)A=1-pe;else{if(A===te)return L?NaN:1/0*(St?-1:1);L+=Math.pow(2,h),A-=pe}return(St?-1:1)*L*Math.pow(2,A-h)},hh=function(t,r,u,h,g,A){var L,B,te,pe=8*A-g-1,Se=(1<<pe)-1,Me=Se>>1,it=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,St=h?0:A-1,xt=h?1:-1,Gt=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(B=isNaN(r)?1:0,L=Se):(L=Math.floor(Math.log(r)/Math.LN2),r*(te=Math.pow(2,-L))<1&&(L--,te*=2),(r+=L+Me>=1?it/te:it*Math.pow(2,1-Me))*te>=2&&(L++,te/=2),L+Me>=Se?(B=0,L=Se):L+Me>=1?(B=(r*te-1)*Math.pow(2,g),L+=Me):(B=r*Math.pow(2,Me-1)*Math.pow(2,g),L=0));g>=8;t[u+St]=255&B,St+=xt,B/=256,g-=8);for(L=L<<g|B,pe+=g;pe>0;t[u+St]=255&L,St+=xt,L/=256,pe-=8);t[u+St-xt]|=128*Gt},ih=fe;function fe(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}fe.Varint=0,fe.Fixed64=1,fe.Bytes=2,fe.Fixed32=5;var ze=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function Pt(e){return e.type===fe.Bytes?e.readVarint()+e.pos:e.pos+1}function gr(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function kr(e,t,r){var u=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(u);for(var h=r.pos-1;h>=e;h--)r.buf[h+u]=r.buf[h]}function Or(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function xr(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function Wr(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function on(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function rn(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function Qr(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function cn(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function Sn(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function fn(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function Kr(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function br(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function mr(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function Jr(e,t,r){e===1&&r.readMessage(wn,t)}function wn(e,t,r){if(e===3){var u=r.readMessage(Lr,{}),h=u.width,g=u.height,A=u.left,L=u.top,B=u.advance;t.push({id:u.id,bitmap:new Uo({width:h+6,height:g+6},u.bitmap),metrics:{width:h,height:g,left:A,top:L,advance:B}})}}function Lr(e,t,r){e===1?t.id=r.readVarint():e===2?t.bitmap=r.readBytes():e===3?t.width=r.readVarint():e===4?t.height=r.readVarint():e===5?t.left=r.readSVarint():e===6?t.top=r.readSVarint():e===7&&(t.advance=r.readVarint())}function Xn(e){for(var t=0,r=0,u=0,h=e;u<h.length;u+=1){var g=h[u];t+=g.w*g.h,r=Math.max(r,g.w)}e.sort(function(xt,Gt){return Gt.h-xt.h});for(var A=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}],L=0,B=0,te=0,pe=e;te<pe.length;te+=1)for(var Se=pe[te],Me=A.length-1;Me>=0;Me--){var it=A[Me];if(!(Se.w>it.w||Se.h>it.h)){if(Se.x=it.x,Se.y=it.y,B=Math.max(B,Se.y+Se.h),L=Math.max(L,Se.x+Se.w),Se.w===it.w&&Se.h===it.h){var St=A.pop();Me<A.length&&(A[Me]=St)}else Se.h===it.h?(it.x+=Se.w,it.w-=Se.w):Se.w===it.w?(it.y+=Se.h,it.h-=Se.h):(A.push({x:it.x+Se.w,y:it.y,w:it.w-Se.w,h:Se.h}),it.y+=Se.h,it.h-=Se.h);break}}return{w:L,h:B,fill:t/(L*B)||0}}fe.prototype={destroy:function(){this.buf=null},readFields:function(t,r,u){for(u=u||this.length;this.pos<u;){var h=this.readVarint(),g=h>>3,A=this.pos;this.type=7&h,t(g,r,this),this.pos===A&&this.skip(h)}return r},readMessage:function(t,r){return this.readFields(t,r,this.readVarint()+this.pos)},readFixed32:function(){var t=Kr(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=mr(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Kr(this.buf,this.pos)+4294967296*Kr(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=Kr(this.buf,this.pos)+4294967296*mr(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=mf(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=mf(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var r,u,h=this.buf;return r=127&(u=h[this.pos++]),u<128?r:(r|=(127&(u=h[this.pos++]))<<7,u<128?r:(r|=(127&(u=h[this.pos++]))<<14,u<128?r:(r|=(127&(u=h[this.pos++]))<<21,u<128?r:function(g,A,L){var B,te,pe=L.buf;if(B=(112&(te=pe[L.pos++]))>>4,te<128)return gr(g,B,A);if(B|=(127&(te=pe[L.pos++]))<<3,te<128)return gr(g,B,A);if(B|=(127&(te=pe[L.pos++]))<<10,te<128)return gr(g,B,A);if(B|=(127&(te=pe[L.pos++]))<<17,te<128)return gr(g,B,A);if(B|=(127&(te=pe[L.pos++]))<<24,te<128)return gr(g,B,A);if(B|=(1&(te=pe[L.pos++]))<<31,te<128)return gr(g,B,A);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(u=h[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,r=this.pos;return this.pos=t,t-r>=12&&ze?function(u,h,g){return ze.decode(u.subarray(h,g))}(this.buf,r,t):function(u,h,g){for(var A="",L=h;L<g;){var B,te,pe,Se=u[L],Me=null,it=Se>239?4:Se>223?3:Se>191?2:1;if(L+it>g)break;it===1?Se<128&&(Me=Se):it===2?(192&(B=u[L+1]))==128&&(Me=(31&Se)<<6|63&B)<=127&&(Me=null):it===3?(te=u[L+2],(192&(B=u[L+1]))==128&&(192&te)==128&&((Me=(15&Se)<<12|(63&B)<<6|63&te)<=2047||Me>=55296&&Me<=57343)&&(Me=null)):it===4&&(te=u[L+2],pe=u[L+3],(192&(B=u[L+1]))==128&&(192&te)==128&&(192&pe)==128&&((Me=(15&Se)<<18|(63&B)<<12|(63&te)<<6|63&pe)<=65535||Me>=1114112)&&(Me=null)),Me===null?(Me=65533,it=1):Me>65535&&(Me-=65536,A+=String.fromCharCode(Me>>>10&1023|55296),Me=56320|1023&Me),A+=String.fromCharCode(Me),L+=it}return A}(this.buf,r,t)},readBytes:function(){var t=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,t);return this.pos=t,r},readPackedVarint:function(t,r){if(this.type!==fe.Bytes)return t.push(this.readVarint(r));var u=Pt(this);for(t=t||[];this.pos<u;)t.push(this.readVarint(r));return t},readPackedSVarint:function(t){if(this.type!==fe.Bytes)return t.push(this.readSVarint());var r=Pt(this);for(t=t||[];this.pos<r;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==fe.Bytes)return t.push(this.readBoolean());var r=Pt(this);for(t=t||[];this.pos<r;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==fe.Bytes)return t.push(this.readFloat());var r=Pt(this);for(t=t||[];this.pos<r;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==fe.Bytes)return t.push(this.readDouble());var r=Pt(this);for(t=t||[];this.pos<r;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==fe.Bytes)return t.push(this.readFixed32());var r=Pt(this);for(t=t||[];this.pos<r;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==fe.Bytes)return t.push(this.readSFixed32());var r=Pt(this);for(t=t||[];this.pos<r;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==fe.Bytes)return t.push(this.readFixed64());var r=Pt(this);for(t=t||[];this.pos<r;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==fe.Bytes)return t.push(this.readSFixed64());var r=Pt(this);for(t=t||[];this.pos<r;)t.push(this.readSFixed64());return t},skip:function(t){var r=7&t;if(r===fe.Varint)for(;this.buf[this.pos++]>127;);else if(r===fe.Bytes)this.pos=this.readVarint()+this.pos;else if(r===fe.Fixed32)this.pos+=4;else{if(r!==fe.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(t,r){this.writeVarint(t<<3|r)},realloc:function(t){for(var r=this.length||16;r<this.pos+t;)r*=2;if(r!==this.length){var u=new Uint8Array(r);u.set(this.buf),this.buf=u,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),br(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),br(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),br(this.buf,-1&t,this.pos),br(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),br(this.buf,-1&t,this.pos),br(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(r,u){var h,g;if(r>=0?(h=r%4294967296|0,g=r/4294967296|0):(g=~(-r/4294967296),4294967295^(h=~(-r%4294967296))?h=h+1|0:(h=0,g=g+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),function(A,L,B){B.buf[B.pos++]=127&A|128,A>>>=7,B.buf[B.pos++]=127&A|128,A>>>=7,B.buf[B.pos++]=127&A|128,A>>>=7,B.buf[B.pos++]=127&A|128,B.buf[B.pos]=127&(A>>>=7)}(h,0,u),function(A,L){var B=(7&A)<<4;L.buf[L.pos++]|=B|((A>>>=3)?128:0),A&&(L.buf[L.pos++]=127&A|((A>>>=7)?128:0),A&&(L.buf[L.pos++]=127&A|((A>>>=7)?128:0),A&&(L.buf[L.pos++]=127&A|((A>>>=7)?128:0),A&&(L.buf[L.pos++]=127&A|((A>>>=7)?128:0),A&&(L.buf[L.pos++]=127&A)))))}(g,u)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var r=this.pos;this.pos=function(h,g,A){for(var L,B,te=0;te<g.length;te++){if((L=g.charCodeAt(te))>55295&&L<57344){if(!B){L>56319||te+1===g.length?(h[A++]=239,h[A++]=191,h[A++]=189):B=L;continue}if(L<56320){h[A++]=239,h[A++]=191,h[A++]=189,B=L;continue}L=B-55296<<10|L-56320|65536,B=null}else B&&(h[A++]=239,h[A++]=191,h[A++]=189,B=null);L<128?h[A++]=L:(L<2048?h[A++]=L>>6|192:(L<65536?h[A++]=L>>12|224:(h[A++]=L>>18|240,h[A++]=L>>12&63|128),h[A++]=L>>6&63|128),h[A++]=63&L|128)}return A}(this.buf,t,this.pos);var u=this.pos-r;u>=128&&kr(r,u,this),this.pos=r-1,this.writeVarint(u),this.pos+=u},writeFloat:function(t){this.realloc(4),hh(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),hh(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var r=t.length;this.writeVarint(r),this.realloc(r);for(var u=0;u<r;u++)this.buf[this.pos++]=t[u]},writeRawMessage:function(t,r){this.pos++;var u=this.pos;t(r,this);var h=this.pos-u;h>=128&&kr(u,h,this),this.pos=u-1,this.writeVarint(h),this.pos+=h},writeMessage:function(t,r,u){this.writeTag(t,fe.Bytes),this.writeRawMessage(r,u)},writePackedVarint:function(t,r){r.length&&this.writeMessage(t,Or,r)},writePackedSVarint:function(t,r){r.length&&this.writeMessage(t,xr,r)},writePackedBoolean:function(t,r){r.length&&this.writeMessage(t,rn,r)},writePackedFloat:function(t,r){r.length&&this.writeMessage(t,Wr,r)},writePackedDouble:function(t,r){r.length&&this.writeMessage(t,on,r)},writePackedFixed32:function(t,r){r.length&&this.writeMessage(t,Qr,r)},writePackedSFixed32:function(t,r){r.length&&this.writeMessage(t,cn,r)},writePackedFixed64:function(t,r){r.length&&this.writeMessage(t,Sn,r)},writePackedSFixed64:function(t,r){r.length&&this.writeMessage(t,fn,r)},writeBytesField:function(t,r){this.writeTag(t,fe.Bytes),this.writeBytes(r)},writeFixed32Field:function(t,r){this.writeTag(t,fe.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(t,r){this.writeTag(t,fe.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(t,r){this.writeTag(t,fe.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(t,r){this.writeTag(t,fe.Fixed64),this.writeSFixed64(r)},writeVarintField:function(t,r){this.writeTag(t,fe.Varint),this.writeVarint(r)},writeSVarintField:function(t,r){this.writeTag(t,fe.Varint),this.writeSVarint(r)},writeStringField:function(t,r){this.writeTag(t,fe.Bytes),this.writeString(r)},writeFloatField:function(t,r){this.writeTag(t,fe.Fixed32),this.writeFloat(r)},writeDoubleField:function(t,r){this.writeTag(t,fe.Fixed64),this.writeDouble(r)},writeBooleanField:function(t,r){this.writeVarintField(t,Boolean(r))}};var $r=function(t,r){var u=r.pixelRatio,h=r.version,g=r.stretchX,A=r.stretchY,L=r.content;this.paddedRect=t,this.pixelRatio=u,this.stretchX=g,this.stretchY=A,this.content=L,this.version=h},zr={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};zr.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},zr.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},zr.tlbr.get=function(){return this.tl.concat(this.br)},zr.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties($r.prototype,zr);var Ur=function(t,r){var u={},h={};this.haveRenderCallbacks=[];var g=[];this.addImages(t,u,g),this.addImages(r,h,g);var A=Xn(g),L=new vo({width:A.w||1,height:A.h||1});for(var B in t){var te=t[B],pe=u[B].paddedRect;vo.copy(te.data,L,{x:0,y:0},{x:pe.x+1,y:pe.y+1},te.data)}for(var Se in r){var Me=r[Se],it=h[Se].paddedRect,St=it.x+1,xt=it.y+1,Gt=Me.data.width,Bt=Me.data.height;vo.copy(Me.data,L,{x:0,y:0},{x:St,y:xt},Me.data),vo.copy(Me.data,L,{x:0,y:Bt-1},{x:St,y:xt-1},{width:Gt,height:1}),vo.copy(Me.data,L,{x:0,y:0},{x:St,y:xt+Bt},{width:Gt,height:1}),vo.copy(Me.data,L,{x:Gt-1,y:0},{x:St-1,y:xt},{width:1,height:Bt}),vo.copy(Me.data,L,{x:0,y:0},{x:St+Gt,y:xt},{width:1,height:Bt})}this.image=L,this.iconPositions=u,this.patternPositions=h};Ur.prototype.addImages=function(e,t,r){for(var u in e){var h=e[u],g={x:0,y:0,w:h.data.width+2,h:h.data.height+2};r.push(g),t[u]=new $r(g,h),h.hasRenderCallback&&this.haveRenderCallbacks.push(u)}},Ur.prototype.patchUpdatedImages=function(e,t){for(var r in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)},Ur.prototype.patchUpdatedImage=function(e,t,r){if(e&&t&&e.version!==t.version){e.version=t.version;var u=e.tl;r.update(t.data,void 0,{x:u[0],y:u[1]})}},xn("ImagePosition",$r),xn("ImageAtlas",Ur);var Gr={horizontal:1,vertical:2,horizontalOnly:3},Wn=function(){this.scale=1,this.fontStack="",this.imageName=null};Wn.forText=function(e,t){var r=new Wn;return r.scale=e||1,r.fontStack=t,r},Wn.forImage=function(e){var t=new Wn;return t.imageName=e,t};var $n=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function sn(e,t,r,u,h,g,A,L,B,te,pe,Se,Me,it,St,xt){var Gt,Bt=$n.fromFeature(e,h);Se===Gr.vertical&&Bt.verticalizePunctuation();var ar=uo.processBidirectionalText,hr=uo.processStyledBidirectionalText;if(ar&&Bt.sections.length===1){Gt=[];for(var Tr=0,Fr=ar(Bt.toString(),Ea(Bt,te,g,t,u,it,St));Tr<Fr.length;Tr+=1){var Ir=Fr[Tr],hn=new $n;hn.text=Ir,hn.sections=Bt.sections;for(var yn=0;yn<Ir.length;yn++)hn.sectionIndex.push(0);Gt.push(hn)}}else if(hr){Gt=[];for(var Un=0,Jn=hr(Bt.text,Bt.sectionIndex,Ea(Bt,te,g,t,u,it,St));Un<Jn.length;Un+=1){var Dn=Jn[Un],In=new $n;In.text=Dn[0],In.sectionIndex=Dn[1],In.sections=Bt.sections,Gt.push(In)}}else Gt=function(Yn,si){for(var Ma=[],zi=Yn.text,da=0,ui=0,wo=si;ui<wo.length;ui+=1){var Wo=wo[ui];Ma.push(Yn.substring(da,Wo)),da=Wo}return da<zi.length&&Ma.push(Yn.substring(da,zi.length)),Ma}(Bt,Ea(Bt,te,g,t,u,it,St));var _a=[],sa={positionedLines:_a,text:Bt.toString(),top:pe[1],bottom:pe[1],left:pe[0],right:pe[0],writingMode:Se,iconsInText:!1,verticalizable:!1};return function(Yn,si,Ma,zi,da,ui,wo,Wo,lu,Mi,Ss,zo){for(var cs=0,qu=-17,Is=0,gl=0,Tu=Wo==="right"?1:Wo==="left"?0:.5,fs=0,zu=0,di=da;zu<di.length;zu+=1){var Pi=di[zu];Pi.trim();var no=Pi.getMaxScale(),Li=24*(no-1),el={positionedGlyphs:[],lineOffset:0};Yn.positionedLines[fs]=el;var Ws=el.positionedGlyphs,po=0;if(Pi.length()){for(var Zs=0;Zs<Pi.length();Zs++){var ao=Pi.getSection(Zs),As=Pi.getSectionIndex(Zs),Dc=Pi.getCharCode(Zs),Lf=0,Nc=null,_u=null,Bf=null,nh=24,Vf=!(lu===Gr.horizontal||!Ss&&!Hc(Dc)||Ss&&(nn[Dc]||(sh=Dc,Zr.Arabic(sh)||Zr["Arabic Supplement"](sh)||Zr["Arabic Extended-A"](sh)||Zr["Arabic Presentation Forms-A"](sh)||Zr["Arabic Presentation Forms-B"](sh))));if(ao.imageName){var Ch=zi[ao.imageName];if(!Ch)continue;Bf=ao.imageName,Yn.iconsInText=Yn.iconsInText||!0,_u=Ch.paddedRect;var Gf=Ch.displaySize;ao.scale=24*ao.scale/zo,Lf=Li+(24-Gf[1]*ao.scale),nh=(Nc={width:Gf[0],height:Gf[1],left:1,top:-3,advance:Vf?Gf[1]:Gf[0]}).advance;var wh=Vf?Gf[0]*ao.scale-24*no:Gf[1]*ao.scale-24*no;wh>0&&wh>po&&(po=wh)}else{var Oh=Ma[ao.fontStack],ph=Oh&&Oh[Dc];if(ph&&ph.rect)_u=ph.rect,Nc=ph.metrics;else{var oh=si[ao.fontStack],Mh=oh&&oh[Dc];if(!Mh)continue;Nc=Mh.metrics}Lf=24*(no-ao.scale)}Vf?(Yn.verticalizable=!0,Ws.push({glyph:Dc,imageName:Bf,x:cs,y:qu+Lf,vertical:Vf,scale:ao.scale,fontStack:ao.fontStack,sectionIndex:As,metrics:Nc,rect:_u}),cs+=nh*ao.scale+Mi):(Ws.push({glyph:Dc,imageName:Bf,x:cs,y:qu+Lf,vertical:Vf,scale:ao.scale,fontStack:ao.fontStack,sectionIndex:As,metrics:Nc,rect:_u}),cs+=Nc.advance*ao.scale+Mi)}Ws.length!==0&&(Is=Math.max(cs-Mi,Is),bi(Ws,0,Ws.length-1,Tu,po)),cs=0;var Kh=ui*no+po;el.lineOffset=Math.max(po,Li),qu+=Kh,gl=Math.max(Kh,gl),++fs}else qu+=ui,++fs}var sh,Ph=qu- -17,td=Da(wo),Lh=td.horizontalAlign,uh=td.verticalAlign;(function(Rh,Uh,mh,Ih,Bh,Vh,vh,Dh,Nh){var kh,Gh=(Uh-mh)*Bh;kh=Vh!==vh?-Dh*Ih- -17:(-Ih*Nh+.5)*vh;for(var gh=0,jh=Rh;gh<jh.length;gh+=1)for(var yh=0,bh=jh[gh].positionedGlyphs;yh<bh.length;yh+=1){var zh=bh[yh];zh.x+=Gh,zh.y+=kh}})(Yn.positionedLines,Tu,Lh,uh,Is,gl,ui,Ph,da.length),Yn.top+=-uh*Ph,Yn.bottom=Yn.top+Ph,Yn.left+=-Lh*Is,Yn.right=Yn.left+Is}(sa,t,r,u,Gt,A,L,B,Se,te,Me,xt),!function(Yn){for(var si=0,Ma=Yn;si<Ma.length;si+=1)if(Ma[si].positionedGlyphs.length!==0)return!1;return!0}(_a)&&sa}$n.fromFeature=function(e,t){for(var r=new $n,u=0;u<e.sections.length;u++){var h=e.sections[u];h.image?r.addImageSection(h):r.addTextSection(h,t)}return r},$n.prototype.length=function(){return this.text.length},$n.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},$n.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},$n.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},$n.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",r=0;r<e.length;r++){var u=e.charCodeAt(r+1)||null,h=e.charCodeAt(r-1)||null;t+=u&&Wc(u)&&!eh[e[r+1]]||h&&Wc(h)&&!eh[e[r-1]]||!eh[e[r]]?e[r]:eh[e[r]]}return t}(this.text)},$n.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&nn[this.text.charCodeAt(t)];t++)e++;for(var r=this.text.length,u=this.text.length-1;u>=0&&u>=e&&nn[this.text.charCodeAt(u)];u--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)},$n.prototype.substring=function(e,t){var r=new $n;return r.text=this.text.substring(e,t),r.sectionIndex=this.sectionIndex.slice(e,t),r.sections=this.sections,r},$n.prototype.toString=function(){return this.text},$n.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,r){return Math.max(t,e.sections[r].scale)},0)},$n.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(Wn.forText(e.scale,e.fontStack||t));for(var r=this.sections.length-1,u=0;u<e.text.length;++u)this.sectionIndex.push(r)},$n.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(t.length!==0){var r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(Wn.forImage(t)),this.sectionIndex.push(this.sections.length-1)):Le("Reached maximum number of images 6401")}else Le("Can't add FormattedSection with an empty image.")},$n.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var nn={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Rr={};function ba(e,t,r,u,h,g){if(t.imageName){var A=u[t.imageName];return A?A.displaySize[0]*t.scale*24/g+h:0}var L=r[t.fontStack],B=L&&L[e];return B?B.metrics.advance*t.scale+h:0}function La(e,t,r,u){var h=Math.pow(e-t,2);return u?e<t?h/2:2*h:h+Math.abs(r)*r}function Fn(e,t,r){var u=0;return e===10&&(u-=1e4),r&&(u+=150),e!==40&&e!==65288||(u+=50),t!==41&&t!==65289||(u+=50),u}function Ua(e,t,r,u,h,g){for(var A=null,L=La(t,r,h,g),B=0,te=u;B<te.length;B+=1){var pe=te[B],Se=La(t-pe.x,r,h,g)+pe.badness;Se<=L&&(A=pe,L=Se)}return{index:e,x:t,priorBreak:A,badness:L}}function Ea(e,t,r,u,h,g,A){if(g!=="point")return[];if(!e)return[];for(var L,B=[],te=function(Gt,Bt,ar,hr,Tr,Fr){for(var Ir=0,hn=0;hn<Gt.length();hn++){var yn=Gt.getSection(hn);Ir+=ba(Gt.getCharCode(hn),yn,hr,Tr,Bt,Fr)}return Ir/Math.max(1,Math.ceil(Ir/ar))}(e,t,r,u,h,A),pe=e.text.indexOf("\u200B")>=0,Se=0,Me=0;Me<e.length();Me++){var it=e.getSection(Me),St=e.getCharCode(Me);if(nn[St]||(Se+=ba(St,it,u,h,t,A)),Me<e.length()-1){var xt=!((L=St)<11904||!(Zr["Bopomofo Extended"](L)||Zr.Bopomofo(L)||Zr["CJK Compatibility Forms"](L)||Zr["CJK Compatibility Ideographs"](L)||Zr["CJK Compatibility"](L)||Zr["CJK Radicals Supplement"](L)||Zr["CJK Strokes"](L)||Zr["CJK Symbols and Punctuation"](L)||Zr["CJK Unified Ideographs Extension A"](L)||Zr["CJK Unified Ideographs"](L)||Zr["Enclosed CJK Letters and Months"](L)||Zr["Halfwidth and Fullwidth Forms"](L)||Zr.Hiragana(L)||Zr["Ideographic Description Characters"](L)||Zr["Kangxi Radicals"](L)||Zr["Katakana Phonetic Extensions"](L)||Zr.Katakana(L)||Zr["Vertical Forms"](L)||Zr["Yi Radicals"](L)||Zr["Yi Syllables"](L)));(Rr[St]||xt||it.imageName)&&B.push(Ua(Me+1,Se,te,B,Fn(St,e.getCharCode(Me+1),xt&&pe),!1))}}return function Gt(Bt){return Bt?Gt(Bt.priorBreak).concat(Bt.index):[]}(Ua(e.length(),Se,te,B,0,!0))}function Da(e){var t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function bi(e,t,r,u,h){if(u||h)for(var g=e[r],A=(e[r].x+g.metrics.advance*g.scale)*u,L=t;L<=r;L++)e[L].x-=A,e[L].y+=h}function Bo(e,t,r,u,h,g){var A,L=e.image;if(L.content){var B=L.content,te=L.pixelRatio||1;A=[B[0]/te,B[1]/te,L.displaySize[0]-B[2]/te,L.displaySize[1]-B[3]/te]}var pe,Se,Me,it,St=t.left*g,xt=t.right*g;r==="width"||r==="both"?(it=h[0]+St-u[3],Se=h[0]+xt+u[1]):Se=(it=h[0]+(St+xt-L.displaySize[0])/2)+L.displaySize[0];var Gt=t.top*g,Bt=t.bottom*g;return r==="height"||r==="both"?(pe=h[1]+Gt-u[0],Me=h[1]+Bt+u[2]):Me=(pe=h[1]+(Gt+Bt-L.displaySize[1])/2)+L.displaySize[1],{image:L,top:pe,right:Se,bottom:Me,left:it,collisionPadding:A}}Rr[10]=!0,Rr[32]=!0,Rr[38]=!0,Rr[40]=!0,Rr[41]=!0,Rr[43]=!0,Rr[45]=!0,Rr[47]=!0,Rr[173]=!0,Rr[183]=!0,Rr[8203]=!0,Rr[8208]=!0,Rr[8211]=!0,Rr[8231]=!0;var So=function(e){function t(r,u,h,g){e.call(this,r,u),this.angle=h,g!==void 0&&(this.segment=g)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(re);function Ba(e,t){var r=t.expression;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new ci(e+1))};if(r.kind==="source")return{kind:"source"};for(var u=r.zoomStops,h=r.interpolationType,g=0;g<u.length&&u[g]<=e;)g++;for(var A=g=Math.max(0,g-1);A<u.length&&u[A]<e+1;)A++;A=Math.min(u.length-1,A);var L=u[g],B=u[A];return r.kind==="composite"?{kind:"composite",minZoom:L,maxZoom:B,interpolationType:h}:{kind:"camera",minZoom:L,maxZoom:B,minSize:r.evaluate(new ci(L)),maxSize:r.evaluate(new ci(B)),interpolationType:h}}function qo(e,t,r){var u=t.uSize,h=r.lowerSize;return e.kind==="source"?h/128:e.kind==="composite"?ka(h/128,r.upperSize/128,t.uSizeT):u}function ji(e,t){var r=0,u=0;if(e.kind==="constant")u=e.layoutSize;else if(e.kind!=="source"){var h=e.interpolationType,g=h?we(Ci.interpolationFactor(h,t,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?u=ka(e.minSize,e.maxSize,g):r=g}return{uSizeT:r,uSize:u}}xn("Anchor",So);var _s=Object.freeze({__proto__:null,getSizeData:Ba,evaluateSizeForFeature:qo,evaluateSizeForZoom:ji,SIZE_PACK_FACTOR:128});function es(e,t,r,u,h){if(t.segment===void 0)return!0;for(var g=t,A=t.segment+1,L=0;L>-r/2;){if(--A<0)return!1;L-=e[A].dist(g),g=e[A]}L+=e[A].dist(e[A+1]),A++;for(var B=[],te=0;L<r/2;){var pe=e[A],Se=e[A+1];if(!Se)return!1;var Me=e[A-1].angleTo(pe)-pe.angleTo(Se);for(Me=Math.abs((Me+3*Math.PI)%(2*Math.PI)-Math.PI),B.push({distance:L,angleDelta:Me}),te+=Me;L-B[0].distance>u;)te-=B.shift().angleDelta;if(te>h)return!1;A++,L+=pe.dist(Se)}return!0}function Vo(e){for(var t=0,r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function ts(e,t,r){return e?.6*t*r:0}function Hs(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function Go(e,t,r,u,h,g){for(var A=ts(r,h,g),L=Hs(r,u)*g,B=0,te=Vo(e)/2,pe=0;pe<e.length-1;pe++){var Se=e[pe],Me=e[pe+1],it=Se.dist(Me);if(B+it>te){var St=(te-B)/it,xt=ka(Se.x,Me.x,St),Gt=ka(Se.y,Me.y,St),Bt=new So(xt,Gt,Me.angleTo(Se),pe);return Bt._round(),!A||es(e,Bt,L,A,t)?Bt:void 0}B+=it}}function ra(e,t,r,u,h,g,A,L,B){var te=ts(u,g,A),pe=Hs(u,h),Se=pe*A,Me=e[0].x===0||e[0].x===B||e[0].y===0||e[0].y===B;return t-Se<t/4&&(t=Se+t/4),function it(St,xt,Gt,Bt,ar,hr,Tr,Fr,Ir){for(var hn=hr/2,yn=Vo(St),Un=0,Jn=xt-Gt,Dn=[],In=0;In<St.length-1;In++){for(var _a=St[In],sa=St[In+1],Yn=_a.dist(sa),si=sa.angleTo(_a);Jn+Gt<Un+Yn;){var Ma=((Jn+=Gt)-Un)/Yn,zi=ka(_a.x,sa.x,Ma),da=ka(_a.y,sa.y,Ma);if(zi>=0&&zi<Ir&&da>=0&&da<Ir&&Jn-hn>=0&&Jn+hn<=yn){var ui=new So(zi,da,si,In);ui._round(),Bt&&!es(St,ui,hr,Bt,ar)||Dn.push(ui)}}Un+=Yn}return Fr||Dn.length||Tr||(Dn=it(St,Un/2,Gt,Bt,ar,hr,Tr,!0,Ir)),Dn}(e,Me?t/2*L%t:(pe/2+2*g)*A*L%t,t,te,r,Se,Me,!1,B)}function ou(e,t,r,u,h){for(var g=[],A=0;A<e.length;A++)for(var L=e[A],B=void 0,te=0;te<L.length-1;te++){var pe=L[te],Se=L[te+1];pe.x<t&&Se.x<t||(pe.x<t?pe=new re(t,pe.y+(t-pe.x)/(Se.x-pe.x)*(Se.y-pe.y))._round():Se.x<t&&(Se=new re(t,pe.y+(t-pe.x)/(Se.x-pe.x)*(Se.y-pe.y))._round()),pe.y<r&&Se.y<r||(pe.y<r?pe=new re(pe.x+(r-pe.y)/(Se.y-pe.y)*(Se.x-pe.x),r)._round():Se.y<r&&(Se=new re(pe.x+(r-pe.y)/(Se.y-pe.y)*(Se.x-pe.x),r)._round()),pe.x>=u&&Se.x>=u||(pe.x>=u?pe=new re(u,pe.y+(u-pe.x)/(Se.x-pe.x)*(Se.y-pe.y))._round():Se.x>=u&&(Se=new re(u,pe.y+(u-pe.x)/(Se.x-pe.x)*(Se.y-pe.y))._round()),pe.y>=h&&Se.y>=h||(pe.y>=h?pe=new re(pe.x+(h-pe.y)/(Se.y-pe.y)*(Se.x-pe.x),h)._round():Se.y>=h&&(Se=new re(pe.x+(h-pe.y)/(Se.y-pe.y)*(Se.x-pe.x),h)._round()),B&&pe.equals(B[B.length-1])||g.push(B=[pe]),B.push(Se)))))}return g}function hi(e,t,r,u){var h=[],g=e.image,A=g.pixelRatio,L=g.paddedRect.w-2,B=g.paddedRect.h-2,te=e.right-e.left,pe=e.bottom-e.top,Se=g.stretchX||[[0,L]],Me=g.stretchY||[[0,B]],it=function(da,ui){return da+ui[1]-ui[0]},St=Se.reduce(it,0),xt=Me.reduce(it,0),Gt=L-St,Bt=B-xt,ar=0,hr=St,Tr=0,Fr=xt,Ir=0,hn=Gt,yn=0,Un=Bt;if(g.content&&u){var Jn=g.content;ar=En(Se,0,Jn[0]),Tr=En(Me,0,Jn[1]),hr=En(Se,Jn[0],Jn[2]),Fr=En(Me,Jn[1],Jn[3]),Ir=Jn[0]-ar,yn=Jn[1]-Tr,hn=Jn[2]-Jn[0]-hr,Un=Jn[3]-Jn[1]-Fr}var Dn=function(da,ui,wo,Wo){var lu=Va(da.stretch-ar,hr,te,e.left),Mi=Ao(da.fixed-Ir,hn,da.stretch,St),Ss=Va(ui.stretch-Tr,Fr,pe,e.top),zo=Ao(ui.fixed-yn,Un,ui.stretch,xt),cs=Va(wo.stretch-ar,hr,te,e.left),qu=Ao(wo.fixed-Ir,hn,wo.stretch,St),Is=Va(Wo.stretch-Tr,Fr,pe,e.top),gl=Ao(Wo.fixed-yn,Un,Wo.stretch,xt),Tu=new re(lu,Ss),fs=new re(cs,Ss),zu=new re(cs,Is),di=new re(lu,Is),Pi=new re(Mi/A,zo/A),no=new re(qu/A,gl/A),Li=t*Math.PI/180;if(Li){var el=Math.sin(Li),Ws=Math.cos(Li),po=[Ws,-el,el,Ws];Tu._matMult(po),fs._matMult(po),di._matMult(po),zu._matMult(po)}var Zs=da.stretch+da.fixed,ao=ui.stretch+ui.fixed;return{tl:Tu,tr:fs,bl:di,br:zu,tex:{x:g.paddedRect.x+1+Zs,y:g.paddedRect.y+1+ao,w:wo.stretch+wo.fixed-Zs,h:Wo.stretch+Wo.fixed-ao},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Pi,pixelOffsetBR:no,minFontScaleX:hn/A/te,minFontScaleY:Un/A/pe,isSDF:r}};if(u&&(g.stretchX||g.stretchY))for(var In=xa(Se,Gt,St),_a=xa(Me,Bt,xt),sa=0;sa<In.length-1;sa++)for(var Yn=In[sa],si=In[sa+1],Ma=0;Ma<_a.length-1;Ma++)h.push(Dn(Yn,_a[Ma],si,_a[Ma+1]));else h.push(Dn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:L+1},{fixed:0,stretch:B+1}));return h}function En(e,t,r){for(var u=0,h=0,g=e;h<g.length;h+=1){var A=g[h];u+=Math.max(t,Math.min(r,A[1]))-Math.max(t,Math.min(r,A[0]))}return u}function xa(e,t,r){for(var u=[{fixed:-1,stretch:0}],h=0,g=e;h<g.length;h+=1){var A=g[h],L=A[0],B=A[1],te=u[u.length-1];u.push({fixed:L-te.stretch,stretch:te.stretch}),u.push({fixed:L-te.stretch,stretch:te.stretch+(B-L)})}return u.push({fixed:t+1,stretch:r}),u}function Va(e,t,r,u){return e/t*r+u}function Ao(e,t,r,u){return e-t*r/u}var su=function(t,r,u,h,g,A,L,B,te,pe){if(this.boxStartIndex=t.length,te){var Se=A.top,Me=A.bottom,it=A.collisionPadding;it&&(Se-=it[1],Me+=it[3]);var St=Me-Se;St>0&&(St=Math.max(10,St),this.circleDiameter=St)}else{var xt=A.top*L-B,Gt=A.bottom*L+B,Bt=A.left*L-B,ar=A.right*L+B,hr=A.collisionPadding;if(hr&&(Bt-=hr[0]*L,xt-=hr[1]*L,ar+=hr[2]*L,Gt+=hr[3]*L),pe){var Tr=new re(Bt,xt),Fr=new re(ar,xt),Ir=new re(Bt,Gt),hn=new re(ar,Gt),yn=pe*Math.PI/180;Tr._rotate(yn),Fr._rotate(yn),Ir._rotate(yn),hn._rotate(yn),Bt=Math.min(Tr.x,Fr.x,Ir.x,hn.x),ar=Math.max(Tr.x,Fr.x,Ir.x,hn.x),xt=Math.min(Tr.y,Fr.y,Ir.y,hn.y),Gt=Math.max(Tr.y,Fr.y,Ir.y,hn.y)}t.emplaceBack(r.x,r.y,Bt,xt,ar,Gt,u,h,g)}this.boxEndIndex=t.length},$l=function(t,r){if(t===void 0&&(t=[]),r===void 0&&(r=Ot),this.data=t,this.length=this.data.length,this.compare=r,this.length>0)for(var u=(this.length>>1)-1;u>=0;u--)this._down(u)};function Ot(e,t){return e<t?-1:e>t?1:0}function Er(e,t,r){t===void 0&&(t=1),r===void 0&&(r=!1);for(var u=1/0,h=1/0,g=-1/0,A=-1/0,L=e[0],B=0;B<L.length;B++){var te=L[B];(!B||te.x<u)&&(u=te.x),(!B||te.y<h)&&(h=te.y),(!B||te.x>g)&&(g=te.x),(!B||te.y>A)&&(A=te.y)}var pe=Math.min(g-u,A-h),Se=pe/2,Me=new $l([],yr);if(pe===0)return new re(u,h);for(var it=u;it<g;it+=pe)for(var St=h;St<A;St+=pe)Me.push(new Cn(it+Se,St+Se,Se,e));for(var xt=function(ar){for(var hr=0,Tr=0,Fr=0,Ir=ar[0],hn=0,yn=Ir.length,Un=yn-1;hn<yn;Un=hn++){var Jn=Ir[hn],Dn=Ir[Un],In=Jn.x*Dn.y-Dn.x*Jn.y;Tr+=(Jn.x+Dn.x)*In,Fr+=(Jn.y+Dn.y)*In,hr+=3*In}return new Cn(Tr/hr,Fr/hr,0,ar)}(e),Gt=Me.length;Me.length;){var Bt=Me.pop();(Bt.d>xt.d||!xt.d)&&(xt=Bt,r&&console.log("found best %d after %d probes",Math.round(1e4*Bt.d)/1e4,Gt)),Bt.max-xt.d<=t||(Me.push(new Cn(Bt.p.x-(Se=Bt.h/2),Bt.p.y-Se,Se,e)),Me.push(new Cn(Bt.p.x+Se,Bt.p.y-Se,Se,e)),Me.push(new Cn(Bt.p.x-Se,Bt.p.y+Se,Se,e)),Me.push(new Cn(Bt.p.x+Se,Bt.p.y+Se,Se,e)),Gt+=4)}return r&&(console.log("num probes: "+Gt),console.log("best distance: "+xt.d)),xt.p}function yr(e,t){return t.max-e.max}function Cn(e,t,r,u){this.p=new re(e,t),this.h=r,this.d=function(h,g){for(var A=!1,L=1/0,B=0;B<g.length;B++)for(var te=g[B],pe=0,Se=te.length,Me=Se-1;pe<Se;Me=pe++){var it=te[pe],St=te[Me];it.y>h.y!=St.y>h.y&&h.x<(St.x-it.x)*(h.y-it.y)/(St.y-it.y)+it.x&&(A=!A),L=Math.min(L,dl(h,it,St))}return(A?1:-1)*Math.sqrt(L)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}$l.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},$l.prototype.pop=function(){if(this.length!==0){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},$l.prototype.peek=function(){return this.data[0]},$l.prototype._up=function(e){for(var t=this.data,r=this.compare,u=t[e];e>0;){var h=e-1>>1,g=t[h];if(r(u,g)>=0)break;t[e]=g,e=h}t[e]=u},$l.prototype._down=function(e){for(var t=this.data,r=this.compare,u=this.length>>1,h=t[e];e<u;){var g=1+(e<<1),A=t[g],L=g+1;if(L<this.length&&r(t[L],A)<0&&(g=L,A=t[L]),r(A,h)>=0)break;t[e]=A,e=g}t[e]=h};var Oa=Number.POSITIVE_INFINITY;function v(e,t){return t[1]!==Oa?function(r,u,h){var g=0,A=0;switch(u=Math.abs(u),h=Math.abs(h),r){case"top-right":case"top-left":case"top":A=h-7;break;case"bottom-right":case"bottom-left":case"bottom":A=7-h}switch(r){case"top-right":case"bottom-right":case"right":g=-u;break;case"top-left":case"bottom-left":case"left":g=u}return[g,A]}(e,t[0],t[1]):function(r,u){var h=0,g=0;u<0&&(u=0);var A=u/Math.sqrt(2);switch(r){case"top-right":case"top-left":g=A-7;break;case"bottom-right":case"bottom-left":g=7-A;break;case"bottom":g=7-u;break;case"top":g=u-7}switch(r){case"top-right":case"bottom-right":h=-A;break;case"top-left":case"bottom-left":h=A;break;case"left":h=u;break;case"right":h=-u}return[h,g]}(e,t[0])}function f(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function c(e,t,r,u,h,g,A,L,B,te,pe,Se,Me,it,St){var xt=function(Tr,Fr,Ir,hn,yn,Un,Jn,Dn){for(var In=hn.layout.get("text-rotate").evaluate(Un,{})*Math.PI/180,_a=[],sa=0,Yn=Fr.positionedLines;sa<Yn.length;sa+=1)for(var si=Yn[sa],Ma=0,zi=si.positionedGlyphs;Ma<zi.length;Ma+=1){var da=zi[Ma];if(da.rect){var ui=da.rect||{},wo=4,Wo=!0,lu=1,Mi=0,Ss=(yn||Dn)&&da.vertical,zo=da.metrics.advance*da.scale/2;if(Dn&&Fr.verticalizable&&(Mi=si.lineOffset/2-(da.imageName?-(24-da.metrics.width*da.scale)/2:24*(da.scale-1))),da.imageName){var cs=Jn[da.imageName];Wo=cs.sdf,wo=1/(lu=cs.pixelRatio)}var qu=yn?[da.x+zo,da.y]:[0,0],Is=yn?[0,0]:[da.x+zo+Ir[0],da.y+Ir[1]-Mi],gl=[0,0];Ss&&(gl=Is,Is=[0,0]);var Tu=(da.metrics.left-wo)*da.scale-zo+Is[0],fs=(-da.metrics.top-wo)*da.scale+Is[1],zu=Tu+ui.w*da.scale/lu,di=fs+ui.h*da.scale/lu,Pi=new re(Tu,fs),no=new re(zu,fs),Li=new re(Tu,di),el=new re(zu,di);if(Ss){var Ws=new re(-zo,zo- -17),po=-Math.PI/2,Zs=12-zo,ao=new re(22-Zs,-(da.imageName?Zs:0)),As=new(Function.prototype.bind.apply(re,[null].concat(gl)));Pi._rotateAround(po,Ws)._add(ao)._add(As),no._rotateAround(po,Ws)._add(ao)._add(As),Li._rotateAround(po,Ws)._add(ao)._add(As),el._rotateAround(po,Ws)._add(ao)._add(As)}if(In){var Dc=Math.sin(In),Lf=Math.cos(In),Nc=[Lf,-Dc,Dc,Lf];Pi._matMult(Nc),no._matMult(Nc),Li._matMult(Nc),el._matMult(Nc)}var _u=new re(0,0),Bf=new re(0,0);_a.push({tl:Pi,tr:no,bl:Li,br:el,tex:ui,writingMode:Fr.writingMode,glyphOffset:qu,sectionIndex:da.sectionIndex,isSDF:Wo,pixelOffsetTL:_u,pixelOffsetBR:Bf,minFontScaleX:0,minFontScaleY:0})}}return _a}(0,r,L,h,g,A,u,e.allowVerticalPlacement),Gt=e.textSizeData,Bt=null;Gt.kind==="source"?(Bt=[128*h.layout.get("text-size").evaluate(A,{})])[0]>32640&&Le(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):Gt.kind==="composite"&&((Bt=[128*it.compositeTextSizes[0].evaluate(A,{},St),128*it.compositeTextSizes[1].evaluate(A,{},St)])[0]>32640||Bt[1]>32640)&&Le(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,xt,Bt,L,g,A,te,t,B.lineStartIndex,B.lineLength,Me,St);for(var ar=0,hr=pe;ar<hr.length;ar+=1)Se[hr[ar]]=e.text.placedSymbolArray.length-1;return 4*xt.length}function p(e){for(var t in e)return e[t];return null}function y(e,t,r,u){var h=e.compareText;if(t in h){for(var g=h[t],A=g.length-1;A>=0;A--)if(u.dist(g[A])<r)return!0}else h[t]=[];return h[t].push(u),!1}var P=Fa.VectorTileFeature.types,N=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ee(e,t,r,u,h,g,A,L,B,te,pe,Se,Me){var it=L?Math.min(32640,Math.round(L[0])):0,St=L?Math.min(32640,Math.round(L[1])):0;e.emplaceBack(t,r,Math.round(32*u),Math.round(32*h),g,A,(it<<1)+(B?1:0),St,16*te,16*pe,256*Se,256*Me)}function V(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}function J(e){for(var t=0,r=e.sections;t<r.length;t+=1)if(Ms(r[t].text))return!0;return!1}var he=function(t){this.layoutVertexArray=new bu,this.indexArray=new xu,this.programConfigurations=t,this.segments=new qe,this.dynamicLayoutVertexArray=new Sf,this.opacityVertexArray=new Ul,this.placedSymbolArray=new l};he.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},he.prototype.upload=function(e,t,r,u){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Th.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,_h.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,N,!0),this.opacityVertexBuffer.itemSize=1),(r||u)&&this.programConfigurations.upload(e))},he.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},xn("SymbolBuffers",he);var We=function(t,r,u){this.layoutVertexArray=new t,this.layoutAttributes=r,this.indexArray=new u,this.segments=new qe,this.collisionVertexArray=new Sl};We.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Of.members,!0)},We.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},xn("CollisionBuffers",We);var De=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(A){return A.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=jo([]),this.placementViewportMatrix=jo([]);var r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Ba(this.zoom,r["text-size"]),this.iconSizeData=Ba(this.zoom,r["icon-size"]);var u=this.layers[0].layout,h=u.get("symbol-sort-key"),g=u.get("symbol-z-order");this.sortFeaturesByKey=g!=="viewport-y"&&h.constantOr(1)!==void 0,this.sortFeaturesByY=(g==="viewport-y"||g==="auto"&&!this.sortFeaturesByKey)&&(u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement")),u.get("symbol-placement")==="point"&&(this.writingModes=u.get("text-writing-mode").map(function(A){return Gr[A]})),this.stateDependentLayerIds=this.layers.filter(function(A){return A.isStateDependent()}).map(function(A){return A.id}),this.sourceID=t.sourceID};De.prototype.createArrays=function(){this.text=new he(new wa(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new he(new wa(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new R,this.lineVertexArray=new j,this.symbolInstances=new O},De.prototype.calculateGlyphDependencies=function(e,t,r,u,h){for(var g=0;g<e.length;g++)if(t[e.charCodeAt(g)]=!0,(r||u)&&h){var A=eh[e.charAt(g)];A&&(t[A.charCodeAt(0)]=!0)}},De.prototype.populate=function(e,t,r){var u=this.layers[0],h=u.layout,g=h.get("text-font"),A=h.get("text-field"),L=h.get("icon-image"),B=(A.value.kind!=="constant"||A.value.value instanceof qa&&!A.value.value.isEmpty()||A.value.value.toString().length>0)&&(g.value.kind!=="constant"||g.value.value.length>0),te=L.value.kind!=="constant"||!!L.value.value||Object.keys(L.parameters).length>0,pe=h.get("symbol-sort-key");if(this.features=[],B||te){for(var Se=t.iconDependencies,Me=t.glyphDependencies,it=t.availableImages,St=new ci(this.zoom),xt=0,Gt=e;xt<Gt.length;xt+=1){var Bt=Gt[xt],ar=Bt.feature,hr=Bt.id,Tr=Bt.index,Fr=Bt.sourceLayerIndex,Ir=u._featureFilter.needGeometry,hn={type:ar.type,id:hr,properties:ar.properties,geometry:Ir?fi(ar):[]};if(u._featureFilter.filter(St,hn,r)){Ir||(hn.geometry=fi(ar));var yn=void 0;if(B){var Un=u.getValueAndResolveTokens("text-field",hn,r,it),Jn=qa.factory(Un);J(Jn)&&(this.hasRTLText=!0),(!this.hasRTLText||uf()==="unavailable"||this.hasRTLText&&uo.isParsed())&&(yn=Sh(Jn,u,hn))}var Dn=void 0;if(te){var In=u.getValueAndResolveTokens("icon-image",hn,r,it);Dn=In instanceof Oo?In:Oo.fromString(In)}if(yn||Dn){var _a=this.sortFeaturesByKey?pe.evaluate(hn,{},r):void 0,sa={id:hr,text:yn,icon:Dn,index:Tr,sourceLayerIndex:Fr,geometry:fi(ar),properties:ar.properties,type:P[ar.type],sortKey:_a};if(this.features.push(sa),Dn&&(Se[Dn.name]=!0),yn){var Yn=g.evaluate(hn,{},r).join(","),si=h.get("text-rotation-alignment")==="map"&&h.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Gr.vertical)>=0;for(var Ma=0,zi=yn.sections;Ma<zi.length;Ma+=1){var da=zi[Ma];if(da.image)Se[da.image.name]=!0;else{var ui=vi(yn.toString()),wo=da.fontStack||Yn,Wo=Me[wo]=Me[wo]||{};this.calculateGlyphDependencies(da.text,Wo,si,this.allowVerticalPlacement,ui)}}}}}}h.get("symbol-placement")==="line"&&(this.features=function(lu){var Mi={},Ss={},zo=[],cs=0;function qu(po){zo.push(lu[po]),cs++}function Is(po,Zs,ao){var As=Ss[po];return delete Ss[po],Ss[Zs]=As,zo[As].geometry[0].pop(),zo[As].geometry[0]=zo[As].geometry[0].concat(ao[0]),As}function gl(po,Zs,ao){var As=Mi[Zs];return delete Mi[Zs],Mi[po]=As,zo[As].geometry[0].shift(),zo[As].geometry[0]=ao[0].concat(zo[As].geometry[0]),As}function Tu(po,Zs,ao){var As=ao?Zs[0][Zs[0].length-1]:Zs[0][0];return po+":"+As.x+":"+As.y}for(var fs=0;fs<lu.length;fs++){var zu=lu[fs],di=zu.geometry,Pi=zu.text?zu.text.toString():null;if(Pi){var no=Tu(Pi,di),Li=Tu(Pi,di,!0);if(no in Ss&&Li in Mi&&Ss[no]!==Mi[Li]){var el=gl(no,Li,di),Ws=Is(no,Li,zo[el].geometry);delete Mi[no],delete Ss[Li],Ss[Tu(Pi,zo[Ws].geometry,!0)]=Ws,zo[el].geometry=null}else no in Ss?Is(no,Li,di):Li in Mi?gl(no,Li,di):(qu(fs),Mi[no]=cs-1,Ss[Li]=cs-1)}else qu(fs)}return zo.filter(function(po){return po.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(lu,Mi){return lu.sortKey-Mi.sortKey})}},De.prototype.update=function(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r))},De.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},De.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},De.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},De.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},De.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},De.prototype.addToLineVertexArray=function(e,t){var r=this.lineVertexArray.length;if(e.segment!==void 0){for(var u=e.dist(t[e.segment+1]),h=e.dist(t[e.segment]),g={},A=e.segment+1;A<t.length;A++)g[A]={x:t[A].x,y:t[A].y,tileUnitDistanceFromAnchor:u},A<t.length-1&&(u+=t[A+1].dist(t[A]));for(var L=e.segment||0;L>=0;L--)g[L]={x:t[L].x,y:t[L].y,tileUnitDistanceFromAnchor:h},L>0&&(h+=t[L-1].dist(t[L]));for(var B=0;B<t.length;B++){var te=g[B];this.lineVertexArray.emplaceBack(te.x,te.y,te.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},De.prototype.addSymbols=function(e,t,r,u,h,g,A,L,B,te,pe,Se){for(var Me=e.indexArray,it=e.layoutVertexArray,St=e.segments.prepareSegment(4*t.length,it,Me,g.sortKey),xt=this.glyphOffsetArray.length,Gt=St.vertexLength,Bt=this.allowVerticalPlacement&&A===Gr.vertical?Math.PI/2:0,ar=g.text&&g.text.sections,hr=0;hr<t.length;hr++){var Tr=t[hr],Fr=Tr.tl,Ir=Tr.tr,hn=Tr.bl,yn=Tr.br,Un=Tr.tex,Jn=Tr.pixelOffsetTL,Dn=Tr.pixelOffsetBR,In=Tr.minFontScaleX,_a=Tr.minFontScaleY,sa=Tr.glyphOffset,Yn=Tr.isSDF,si=Tr.sectionIndex,Ma=St.vertexLength,zi=sa[1];ee(it,L.x,L.y,Fr.x,zi+Fr.y,Un.x,Un.y,r,Yn,Jn.x,Jn.y,In,_a),ee(it,L.x,L.y,Ir.x,zi+Ir.y,Un.x+Un.w,Un.y,r,Yn,Dn.x,Jn.y,In,_a),ee(it,L.x,L.y,hn.x,zi+hn.y,Un.x,Un.y+Un.h,r,Yn,Jn.x,Dn.y,In,_a),ee(it,L.x,L.y,yn.x,zi+yn.y,Un.x+Un.w,Un.y+Un.h,r,Yn,Dn.x,Dn.y,In,_a),V(e.dynamicLayoutVertexArray,L,Bt),Me.emplaceBack(Ma,Ma+1,Ma+2),Me.emplaceBack(Ma+1,Ma+2,Ma+3),St.vertexLength+=4,St.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(sa[0]),hr!==t.length-1&&si===t[hr+1].sectionIndex||e.programConfigurations.populatePaintArrays(it.length,g,g.index,{},Se,ar&&ar[si])}e.placedSymbolArray.emplaceBack(L.x,L.y,xt,this.glyphOffsetArray.length-xt,Gt,B,te,L.segment,r?r[0]:0,r?r[1]:0,u[0],u[1],A,0,!1,0,pe)},De.prototype._addCollisionDebugVertex=function(e,t,r,u,h,g){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,u,h,Math.round(g.x),Math.round(g.y))},De.prototype.addCollisionDebugVertices=function(e,t,r,u,h,g,A){var L=h.segments.prepareSegment(4,h.layoutVertexArray,h.indexArray),B=L.vertexLength,te=h.layoutVertexArray,pe=h.collisionVertexArray,Se=A.anchorX,Me=A.anchorY;this._addCollisionDebugVertex(te,pe,g,Se,Me,new re(e,t)),this._addCollisionDebugVertex(te,pe,g,Se,Me,new re(r,t)),this._addCollisionDebugVertex(te,pe,g,Se,Me,new re(r,u)),this._addCollisionDebugVertex(te,pe,g,Se,Me,new re(e,u)),L.vertexLength+=4;var it=h.indexArray;it.emplaceBack(B,B+1),it.emplaceBack(B+1,B+2),it.emplaceBack(B+2,B+3),it.emplaceBack(B+3,B),L.primitiveLength+=4},De.prototype.addDebugCollisionBoxes=function(e,t,r,u){for(var h=e;h<t;h++){var g=this.collisionBoxArray.get(h);this.addCollisionDebugVertices(g.x1,g.y1,g.x2,g.y2,u?this.textCollisionBox:this.iconCollisionBox,g.anchorPoint,r)}},De.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new We(lf,Qf.members,Bl),this.iconCollisionBox=new We(lf,Qf.members,Bl);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},De.prototype._deserializeCollisionBoxesForSymbol=function(e,t,r,u,h,g,A,L,B){for(var te={},pe=t;pe<r;pe++){var Se=e.get(pe);te.textBox={x1:Se.x1,y1:Se.y1,x2:Se.x2,y2:Se.y2,anchorPointX:Se.anchorPointX,anchorPointY:Se.anchorPointY},te.textFeatureIndex=Se.featureIndex;break}for(var Me=u;Me<h;Me++){var it=e.get(Me);te.verticalTextBox={x1:it.x1,y1:it.y1,x2:it.x2,y2:it.y2,anchorPointX:it.anchorPointX,anchorPointY:it.anchorPointY},te.verticalTextFeatureIndex=it.featureIndex;break}for(var St=g;St<A;St++){var xt=e.get(St);te.iconBox={x1:xt.x1,y1:xt.y1,x2:xt.x2,y2:xt.y2,anchorPointX:xt.anchorPointX,anchorPointY:xt.anchorPointY},te.iconFeatureIndex=xt.featureIndex;break}for(var Gt=L;Gt<B;Gt++){var Bt=e.get(Gt);te.verticalIconBox={x1:Bt.x1,y1:Bt.y1,x2:Bt.x2,y2:Bt.y2,anchorPointX:Bt.anchorPointX,anchorPointY:Bt.anchorPointY},te.verticalIconFeatureIndex=Bt.featureIndex;break}return te},De.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}},De.prototype.hasTextData=function(){return this.text.segments.get().length>0},De.prototype.hasIconData=function(){return this.icon.segments.get().length>0},De.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},De.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},De.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},De.prototype.addIndicesForPlacedSymbol=function(e,t){for(var r=e.placedSymbolArray.get(t),u=r.vertexStartIndex+4*r.numGlyphs,h=r.vertexStartIndex;h<u;h+=4)e.indexArray.emplaceBack(h,h+1,h+2),e.indexArray.emplaceBack(h+1,h+2,h+3)},De.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var t=Math.sin(e),r=Math.cos(e),u=[],h=[],g=[],A=0;A<this.symbolInstances.length;++A){g.push(A);var L=this.symbolInstances.get(A);u.push(0|Math.round(t*L.anchorX+r*L.anchorY)),h.push(L.featureIndex)}return g.sort(function(B,te){return u[B]-u[te]||h[te]-h[B]}),g},De.prototype.addToSortKeyRanges=function(e,t){var r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},De.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var r=0,u=this.symbolInstanceIndexes;r<u.length;r+=1){var h=this.symbolInstances.get(u[r]);this.featureSortOrder.push(h.featureIndex),[h.rightJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.leftJustifiedTextSymbolIndex].forEach(function(g,A,L){g>=0&&L.indexOf(g)===A&&t.addIndicesForPlacedSymbol(t.text,g)}),h.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,h.verticalPlacedTextSymbolIndex),h.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.placedIconSymbolIndex),h.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},xn("SymbolBucket",De,{omit:["layers","collisionBoxArray","features","compareText"]}),De.MAX_GLYPHS=65535,De.addDynamicAttributes=V;var It=new Di({"symbol-placement":new Qn(He.layout_symbol["symbol-placement"]),"symbol-spacing":new Qn(He.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Qn(He.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ua(He.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Qn(He.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Qn(He.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Qn(He.layout_symbol["icon-ignore-placement"]),"icon-optional":new Qn(He.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Qn(He.layout_symbol["icon-rotation-alignment"]),"icon-size":new ua(He.layout_symbol["icon-size"]),"icon-text-fit":new Qn(He.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Qn(He.layout_symbol["icon-text-fit-padding"]),"icon-image":new ua(He.layout_symbol["icon-image"]),"icon-rotate":new ua(He.layout_symbol["icon-rotate"]),"icon-padding":new Qn(He.layout_symbol["icon-padding"]),"icon-keep-upright":new Qn(He.layout_symbol["icon-keep-upright"]),"icon-offset":new ua(He.layout_symbol["icon-offset"]),"icon-anchor":new ua(He.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Qn(He.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Qn(He.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Qn(He.layout_symbol["text-rotation-alignment"]),"text-field":new ua(He.layout_symbol["text-field"]),"text-font":new ua(He.layout_symbol["text-font"]),"text-size":new ua(He.layout_symbol["text-size"]),"text-max-width":new ua(He.layout_symbol["text-max-width"]),"text-line-height":new Qn(He.layout_symbol["text-line-height"]),"text-letter-spacing":new ua(He.layout_symbol["text-letter-spacing"]),"text-justify":new ua(He.layout_symbol["text-justify"]),"text-radial-offset":new ua(He.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Qn(He.layout_symbol["text-variable-anchor"]),"text-anchor":new ua(He.layout_symbol["text-anchor"]),"text-max-angle":new Qn(He.layout_symbol["text-max-angle"]),"text-writing-mode":new Qn(He.layout_symbol["text-writing-mode"]),"text-rotate":new ua(He.layout_symbol["text-rotate"]),"text-padding":new Qn(He.layout_symbol["text-padding"]),"text-keep-upright":new Qn(He.layout_symbol["text-keep-upright"]),"text-transform":new ua(He.layout_symbol["text-transform"]),"text-offset":new ua(He.layout_symbol["text-offset"]),"text-allow-overlap":new Qn(He.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Qn(He.layout_symbol["text-ignore-placement"]),"text-optional":new Qn(He.layout_symbol["text-optional"])}),Kt={paint:new Di({"icon-opacity":new ua(He.paint_symbol["icon-opacity"]),"icon-color":new ua(He.paint_symbol["icon-color"]),"icon-halo-color":new ua(He.paint_symbol["icon-halo-color"]),"icon-halo-width":new ua(He.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ua(He.paint_symbol["icon-halo-blur"]),"icon-translate":new Qn(He.paint_symbol["icon-translate"]),"icon-translate-anchor":new Qn(He.paint_symbol["icon-translate-anchor"]),"text-opacity":new ua(He.paint_symbol["text-opacity"]),"text-color":new ua(He.paint_symbol["text-color"],{runtimeType:Kn,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new ua(He.paint_symbol["text-halo-color"]),"text-halo-width":new ua(He.paint_symbol["text-halo-width"]),"text-halo-blur":new ua(He.paint_symbol["text-halo-blur"]),"text-translate":new Qn(He.paint_symbol["text-translate"]),"text-translate-anchor":new Qn(He.paint_symbol["text-translate-anchor"])}),layout:It},Ht=function(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Tn,this.defaultValue=t};Ht.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},Ht.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},Ht.prototype.outputDefined=function(){return!1},Ht.prototype.serialize=function(){return null},xn("FormatSectionOverride",Ht,{omit:["defaultValue"]});var fr=function(e){function t(r){e.call(this,r,Kt)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,u){if(e.prototype.recalculate.call(this,r,u),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var h=this.layout.get("text-writing-mode");if(h){for(var g=[],A=0,L=h;A<L.length;A+=1){var B=L[A];g.indexOf(B)<0&&g.push(B)}this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(r,u,h,g){var A=this.layout.get(r).evaluate(u,{},h,g),L=this._unevaluatedLayout._values[r];return L.isDataDriven()||ac(L.value)||!A?A:function(B,te){return te.replace(/{([^{}]+)}/g,function(pe,Se){return Se in B?String(B[Se]):""})}(u.properties,A)},t.prototype.createBucket=function(r){return new De(r)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var r=0,u=Kt.paint.overridableProperties;r<u.length;r+=1){var h=u[r];if(t.hasPaintOverride(this.layout,h)){var g,A=this.paint.get(h),L=new Ht(A),B=new Os(L,A.property.specification);g=A.value.kind==="constant"||A.value.kind==="source"?new Ll("source",B):new El("composite",B,A.value.zoomStops,A.value._interpolationType),this.paint._values[h]=new ko(A.property,g,A.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(r,u,h){return!(!this.layout||u.isDataDriven()||h.isDataDriven())&&t.hasPaintOverride(this.layout,r)},t.hasPaintOverride=function(r,u){var h=r.get("text-field"),g=Kt.paint.properties[u],A=!1,L=function(Se){for(var Me=0,it=Se;Me<it.length;Me+=1)if(g.overrides&&g.overrides.hasOverride(it[Me]))return void(A=!0)};if(h.value.kind==="constant"&&h.value.value instanceof qa)L(h.value.value.sections);else if(h.value.kind==="source"){var B=function pe(Se){A||(Se instanceof oo&&fa(Se.value)===An?L(Se.value.sections):Se instanceof li?L(Se.sections):Se.eachChild(pe))},te=h.value;te._styleExpression&&B(te._styleExpression.expression)}return A},t}(is),Sr={paint:new Di({"background-color":new Qn(He.paint_background["background-color"]),"background-pattern":new zl(He.paint_background["background-pattern"]),"background-opacity":new Qn(He.paint_background["background-opacity"])})},ln=function(e){function t(r){e.call(this,r,Sr)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(is),jr={paint:new Di({"raster-opacity":new Qn(He.paint_raster["raster-opacity"]),"raster-hue-rotate":new Qn(He.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Qn(He.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Qn(He.paint_raster["raster-brightness-max"]),"raster-saturation":new Qn(He.paint_raster["raster-saturation"]),"raster-contrast":new Qn(He.paint_raster["raster-contrast"]),"raster-resampling":new Qn(He.paint_raster["raster-resampling"]),"raster-fade-duration":new Qn(He.paint_raster["raster-fade-duration"])})},an=function(e){function t(r){e.call(this,r,jr)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(is),pn=function(e){function t(r){e.call(this,r,{}),this.implementation=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},t.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},t.prototype.onRemove=function(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},t}(is),Gn={circle:$u,heatmap:Jc,hillshade:cf,fill:rr,"fill-extrusion":yo,line:wf,symbol:fr,background:ln,raster:an},la=Y.HTMLImageElement,ma=Y.HTMLCanvasElement,Oi=Y.HTMLVideoElement,Ga=Y.ImageData,Co=Y.ImageBitmap,ho=function(t,r,u,h){this.context=t,this.format=u,this.texture=t.gl.createTexture(),this.update(r,h)};ho.prototype.update=function(e,t,r){var u=e.width,h=e.height,g=!(this.size&&this.size[0]===u&&this.size[1]===h||r),A=this.context,L=A.gl;if(this.useMipmap=Boolean(t&&t.useMipmap),L.bindTexture(L.TEXTURE_2D,this.texture),A.pixelStoreUnpackFlipY.set(!1),A.pixelStoreUnpack.set(1),A.pixelStoreUnpackPremultiplyAlpha.set(this.format===L.RGBA&&(!t||t.premultiply!==!1)),g)this.size=[u,h],e instanceof la||e instanceof ma||e instanceof Oi||e instanceof Ga||Co&&e instanceof Co?L.texImage2D(L.TEXTURE_2D,0,this.format,this.format,L.UNSIGNED_BYTE,e):L.texImage2D(L.TEXTURE_2D,0,this.format,u,h,0,this.format,L.UNSIGNED_BYTE,e.data);else{var B=r||{x:0,y:0},te=B.x,pe=B.y;e instanceof la||e instanceof ma||e instanceof Oi||e instanceof Ga||Co&&e instanceof Co?L.texSubImage2D(L.TEXTURE_2D,0,te,pe,L.RGBA,L.UNSIGNED_BYTE,e):L.texSubImage2D(L.TEXTURE_2D,0,te,pe,u,h,L.RGBA,L.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&L.generateMipmap(L.TEXTURE_2D)},ho.prototype.bind=function(e,t,r){var u=this.context.gl;u.bindTexture(u.TEXTURE_2D,this.texture),r!==u.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=u.LINEAR),e!==this.filter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,e),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,r||e),this.filter=e),t!==this.wrap&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,t),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,t),this.wrap=t)},ho.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},ho.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var ju=function(t){var r=this;this._callback=t,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){r._triggered=!1,r._callback()})};ju.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},ju.prototype.remove=function(){delete this._channel,this._callback=function(){}};var ls=function(t,r,u){this.target=t,this.parent=r,this.mapId=u,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Et(["receive","process"],this),this.invoker=new ju(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Zt()?t:Y};function Jl(e,t,r){var u=2*Math.PI*6378137/256/Math.pow(2,r);return[e*u-2*Math.PI*6378137/2,t*u-2*Math.PI*6378137/2]}ls.prototype.send=function(e,t,r,u,h){var g=this;h===void 0&&(h=!1);var A=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[A]=r);var L=Q(this.globalScope)?void 0:[];return this.target.postMessage({id:A,type:e,hasCallback:!!r,targetMapId:u,mustQueue:h,sourceMapId:this.mapId,data:Ou(t,L)},L),{cancel:function(){r&&delete g.callbacks[A],g.target.postMessage({id:A,type:"<cancel>",targetMapId:u,sourceMapId:g.mapId})}}},ls.prototype.receive=function(e){var t=e.data,r=t.id;if(r&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[r];var u=this.cancelCallbacks[r];delete this.cancelCallbacks[r],u&&u()}else Zt()||t.mustQueue?(this.tasks[r]=t,this.taskQueue.push(r),this.invoker.trigger()):this.processTask(r,t)},ls.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},ls.prototype.processTask=function(e,t){var r=this;if(t.type==="<response>"){var u=this.callbacks[e];delete this.callbacks[e],u&&(t.error?u(Mu(t.error)):u(null,Mu(t.data)))}else{var h=!1,g=Q(this.globalScope)?void 0:[],A=t.hasCallback?function(pe,Se){h=!0,delete r.cancelCallbacks[e],r.target.postMessage({id:e,type:"<response>",sourceMapId:r.mapId,error:pe?Ou(pe):null,data:Ou(Se,g)},g)}:function(pe){h=!0},L=null,B=Mu(t.data);if(this.parent[t.type])L=this.parent[t.type](t.sourceMapId,B,A);else if(this.parent.getWorkerSource){var te=t.type.split(".");L=this.parent.getWorkerSource(t.sourceMapId,te[0],B.source)[te[1]](B,A)}else A(new Error("Could not find function "+t.type));!h&&L&&L.cancel&&(this.cancelCallbacks[e]=L.cancel)}},ls.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Io=function(t,r){t&&(r?this.setSouthWest(t).setNorthEast(r):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};Io.prototype.setNorthEast=function(e){return this._ne=e instanceof xi?new xi(e.lng,e.lat):xi.convert(e),this},Io.prototype.setSouthWest=function(e){return this._sw=e instanceof xi?new xi(e.lng,e.lat):xi.convert(e),this},Io.prototype.extend=function(e){var t,r,u=this._sw,h=this._ne;if(e instanceof xi)t=e,r=e;else{if(!(e instanceof Io))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Io.convert(e)):this.extend(xi.convert(e)):this;if(r=e._ne,!(t=e._sw)||!r)return this}return u||h?(u.lng=Math.min(t.lng,u.lng),u.lat=Math.min(t.lat,u.lat),h.lng=Math.max(r.lng,h.lng),h.lat=Math.max(r.lat,h.lat)):(this._sw=new xi(t.lng,t.lat),this._ne=new xi(r.lng,r.lat)),this},Io.prototype.getCenter=function(){return new xi((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Io.prototype.getSouthWest=function(){return this._sw},Io.prototype.getNorthEast=function(){return this._ne},Io.prototype.getNorthWest=function(){return new xi(this.getWest(),this.getNorth())},Io.prototype.getSouthEast=function(){return new xi(this.getEast(),this.getSouth())},Io.prototype.getWest=function(){return this._sw.lng},Io.prototype.getSouth=function(){return this._sw.lat},Io.prototype.getEast=function(){return this._ne.lng},Io.prototype.getNorth=function(){return this._ne.lat},Io.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Io.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Io.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Io.prototype.contains=function(e){var t=xi.convert(e),r=t.lng,u=t.lat,h=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&h},Io.convert=function(e){return!e||e instanceof Io?e:new Io(e)};var xi=function(t,r){if(isNaN(t)||isNaN(r))throw new Error("Invalid LngLat object: ("+t+", "+r+")");if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};xi.prototype.wrap=function(){return new xi(pt(this.lng,-180,180),this.lat)},xi.prototype.toArray=function(){return[this.lng,this.lat]},xi.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},xi.prototype.distanceTo=function(e){var t=Math.PI/180,r=this.lat*t,u=e.lat*t,h=Math.sin(r)*Math.sin(u)+Math.cos(r)*Math.cos(u)*Math.cos((e.lng-this.lng)*t);return 63710088e-1*Math.acos(Math.min(h,1))},xi.prototype.toBounds=function(e){e===void 0&&(e=0);var t=360*e/40075017,r=t/Math.cos(Math.PI/180*this.lat);return new Io(new xi(this.lng-r,this.lat-t),new xi(this.lng+r,this.lat+t))},xi.convert=function(e){if(e instanceof xi)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new xi(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new xi(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var vf=2*Math.PI*63710088e-1;function Qu(e){return vf*Math.cos(e*Math.PI/180)}function Mf(e){return(180+e)/360}function mc(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Cl(e,t){return e/Qu(t)}function Rc(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var Ic=function(t,r,u){u===void 0&&(u=0),this.x=+t,this.y=+r,this.z=+u};Ic.fromLngLat=function(e,t){t===void 0&&(t=0);var r=xi.convert(e);return new Ic(Mf(r.lng),mc(r.lat),Cl(t,r.lat))},Ic.prototype.toLngLat=function(){return new xi(360*this.x-180,Rc(this.y))},Ic.prototype.toAltitude=function(){return this.z*Qu(Rc(this.y))},Ic.prototype.meterInMercatorCoordinateUnits=function(){return 1/vf*(e=Rc(this.y),1/Math.cos(e*Math.PI/180));var e};var Hi=function(t,r,u){this.z=t,this.x=r,this.y=u,this.key=Pf(0,t,t,r,u)};Hi.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},Hi.prototype.url=function(e,t){var r,u,h,g,A,L=(u=this.y,h=this.z,g=Jl(256*(r=this.x),256*(u=Math.pow(2,h)-u-1),h),A=Jl(256*(r+1),256*(u+1),h),g[0]+","+g[1]+","+A[0]+","+A[1]),B=function(te,pe,Se){for(var Me,it="",St=te;St>0;St--)it+=(pe&(Me=1<<St-1)?1:0)+(Se&Me?2:0);return it}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(t==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",B).replace("{bbox-epsg-3857}",L)},Hi.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new re(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},Hi.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var wl=function(t,r){this.wrap=t,this.canonical=r,this.key=Pf(t,r.z,r.z,r.x,r.y)},Ho=function(t,r,u,h,g){this.overscaledZ=t,this.wrap=r,this.canonical=new Hi(u,+h,+g),this.key=Pf(r,t,u,h,g)};function Pf(e,t,r,u,h){(e*=2)<0&&(e=-1*e-1);var g=1<<r;return(g*g*e+g*h+u).toString(36)+r.toString(36)+t.toString(36)}Ho.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},Ho.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new Ho(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ho(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},Ho.prototype.calculateScaledKey=function(e,t){var r=this.canonical.z-e;return e>this.canonical.z?Pf(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):Pf(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)},Ho.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},Ho.prototype.children=function(e){if(this.overscaledZ>=e)return[new Ho(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,r=2*this.canonical.x,u=2*this.canonical.y;return[new Ho(t,this.wrap,t,r,u),new Ho(t,this.wrap,t,r+1,u),new Ho(t,this.wrap,t,r,u+1),new Ho(t,this.wrap,t,r+1,u+1)]},Ho.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},Ho.prototype.wrapped=function(){return new Ho(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Ho.prototype.unwrapTo=function(e){return new Ho(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},Ho.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Ho.prototype.toUnwrapped=function(){return new wl(this.wrap,this.canonical)},Ho.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Ho.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new Ic(e.x-this.wrap,e.y))},xn("CanonicalTileID",Hi),xn("OverscaledTileID",Ho,{omit:["posMatrix"]});var gf=function(t,r,u){if(this.uid=t,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return Le('"'+u+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=r.height;var h=this.dim=r.height-2;this.data=new Uint32Array(r.data.buffer),this.encoding=u||"mapbox";for(var g=0;g<h;g++)this.data[this._idx(-1,g)]=this.data[this._idx(0,g)],this.data[this._idx(h,g)]=this.data[this._idx(h-1,g)],this.data[this._idx(g,-1)]=this.data[this._idx(g,0)],this.data[this._idx(g,h)]=this.data[this._idx(g,h-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(h,-1)]=this.data[this._idx(h-1,0)],this.data[this._idx(-1,h)]=this.data[this._idx(0,h-1)],this.data[this._idx(h,h)]=this.data[this._idx(h-1,h-1)]};gf.prototype.get=function(e,t){var r=new Uint8Array(this.data.buffer),u=4*this._idx(e,t);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(r[u],r[u+1],r[u+2])},gf.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},gf.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},gf.prototype._unpackMapbox=function(e,t,r){return(256*e*256+256*t+r)/10-1e4},gf.prototype._unpackTerrarium=function(e,t,r){return 256*e+t+r/256-32768},gf.prototype.getPixels=function(){return new vo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},gf.prototype.backfillBorder=function(e,t,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var u=t*this.dim,h=t*this.dim+this.dim,g=r*this.dim,A=r*this.dim+this.dim;switch(t){case-1:u=h-1;break;case 1:h=u+1}switch(r){case-1:g=A-1;break;case 1:A=g+1}for(var L=-t*this.dim,B=-r*this.dim,te=g;te<A;te++)for(var pe=u;pe<h;pe++)this.data[this._idx(pe,te)]=e.data[this._idx(pe+L,te+B)]},xn("DEMData",gf);var Ol=function(t){this._stringToNumber={},this._numberToString=[];for(var r=0;r<t.length;r++){var u=t[r];this._stringToNumber[u]=r,this._numberToString[r]=u}};Ol.prototype.encode=function(e){return this._stringToNumber[e]},Ol.prototype.decode=function(e){return this._numberToString[e]};var Uf=function(t,r,u,h,g){this.type="Feature",this._vectorTileFeature=t,t._z=r,t._x=u,t._y=h,this.properties=t.properties,this.id=g},Yh={geometry:{configurable:!0}};Yh.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Yh.geometry.set=function(e){this._geometry=e},Uf.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)t!=="_geometry"&&t!=="_vectorTileFeature"&&(e[t]=this[t]);return e},Object.defineProperties(Uf.prototype,Yh);var Ah=function(){this.state={},this.stateChanges={},this.deletedStates={}};Ah.prototype.updateState=function(e,t,r){var u=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},je(this.stateChanges[e][u],r),this.deletedStates[e]===null)for(var h in this.deletedStates[e]={},this.state[e])h!==u&&(this.deletedStates[e][h]=null);else if(this.deletedStates[e]&&this.deletedStates[e][u]===null)for(var g in this.deletedStates[e][u]={},this.state[e][u])r[g]||(this.deletedStates[e][u][g]=null);else for(var A in r)this.deletedStates[e]&&this.deletedStates[e][u]&&this.deletedStates[e][u][A]===null&&delete this.deletedStates[e][u][A]},Ah.prototype.removeFeatureState=function(e,t,r){if(this.deletedStates[e]!==null){var u=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&t!==void 0)this.deletedStates[e][u]!==null&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][r]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][u])for(r in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][r]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}},Ah.prototype.getState=function(e,t){var r=String(t),u=je({},(this.state[e]||{})[r],(this.stateChanges[e]||{})[r]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var h=this.deletedStates[e][t];if(h===null)return{};for(var g in h)delete u[g]}return u},Ah.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},Ah.prototype.coalesceChanges=function(e,t){var r={};for(var u in this.stateChanges){this.state[u]=this.state[u]||{};var h={};for(var g in this.stateChanges[u])this.state[u][g]||(this.state[u][g]={}),je(this.state[u][g],this.stateChanges[u][g]),h[g]=this.state[u][g];r[u]=h}for(var A in this.deletedStates){this.state[A]=this.state[A]||{};var L={};if(this.deletedStates[A]===null)for(var B in this.state[A])L[B]={},this.state[A][B]={};else for(var te in this.deletedStates[A]){if(this.deletedStates[A][te]===null)this.state[A][te]={};else for(var pe=0,Se=Object.keys(this.deletedStates[A][te]);pe<Se.length;pe+=1)delete this.state[A][te][Se[pe]];L[te]=this.state[A][te]}r[A]=r[A]||{},je(r[A],L)}if(this.stateChanges={},this.deletedStates={},Object.keys(r).length!==0)for(var Me in e)e[Me].setFeatureState(r,t)};var th=function(t,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new gs(8192,16,0),this.grid3D=new gs(8192,16,0),this.featureIndexArray=new Te,this.promoteId=r};function sd(e,t,r,u,h){return Ne(e,function(g,A){var L=t instanceof _l?t.get(A):null;return L&&L.evaluate?L.evaluate(r,u,h):L})}function ud(e){for(var t=1/0,r=1/0,u=-1/0,h=-1/0,g=0,A=e;g<A.length;g+=1){var L=A[g];t=Math.min(t,L.x),r=Math.min(r,L.y),u=Math.max(u,L.x),h=Math.max(h,L.y)}return{minX:t,minY:r,maxX:u,maxY:h}}function ld(e,t){return t-e}th.prototype.insert=function(e,t,r,u,h,g){var A=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,u,h);for(var L=g?this.grid3D:this.grid,B=0;B<t.length;B++){for(var te=t[B],pe=[1/0,1/0,-1/0,-1/0],Se=0;Se<te.length;Se++){var Me=te[Se];pe[0]=Math.min(pe[0],Me.x),pe[1]=Math.min(pe[1],Me.y),pe[2]=Math.max(pe[2],Me.x),pe[3]=Math.max(pe[3],Me.y)}pe[0]<8192&&pe[1]<8192&&pe[2]>=0&&pe[3]>=0&&L.insert(A,pe[0],pe[1],pe[2],pe[3])}},th.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Fa.VectorTile(new ih(this.rawTileData)).layers,this.sourceLayerCoder=new Ol(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},th.prototype.query=function(e,t,r,u){var h=this;this.loadVTLayers();for(var g=e.params||{},A=8192/e.tileSize/e.scale,L=Gu(g.filter),B=e.queryGeometry,te=e.queryPadding*A,pe=ud(B),Se=this.grid.query(pe.minX-te,pe.minY-te,pe.maxX+te,pe.maxY+te),Me=ud(e.cameraQueryGeometry),it=this.grid3D.query(Me.minX-te,Me.minY-te,Me.maxX+te,Me.maxY+te,function(Tr,Fr,Ir,hn){return function(yn,Un,Jn,Dn,In){for(var _a=0,sa=yn;_a<sa.length;_a+=1){var Yn=sa[_a];if(Un<=Yn.x&&Jn<=Yn.y&&Dn>=Yn.x&&In>=Yn.y)return!0}var si=[new re(Un,Jn),new re(Un,In),new re(Dn,In),new re(Dn,Jn)];if(yn.length>2){for(var Ma=0,zi=si;Ma<zi.length;Ma+=1)if(Du(yn,zi[Ma]))return!0}for(var da=0;da<yn.length-1;da++)if(Kc(yn[da],yn[da+1],si))return!0;return!1}(e.cameraQueryGeometry,Tr-te,Fr-te,Ir+te,hn+te)}),St=0,xt=it;St<xt.length;St+=1)Se.push(xt[St]);Se.sort(ld);for(var Gt,Bt={},ar=function(Fr){var Ir=Se[Fr];if(Ir!==Gt){Gt=Ir;var hn=h.featureIndexArray.get(Ir),yn=null;h.loadMatchingFeature(Bt,hn.bucketIndex,hn.sourceLayerIndex,hn.featureIndex,L,g.layers,g.availableImages,t,r,u,function(Un,Jn,Dn){return yn||(yn=fi(Un)),Jn.queryIntersectsFeature(B,Un,Dn,yn,h.z,e.transform,A,e.pixelPosMatrix)})}},hr=0;hr<Se.length;hr++)ar(hr);return Bt},th.prototype.loadMatchingFeature=function(e,t,r,u,h,g,A,L,B,te,pe){var Se=this.bucketLayerIDs[t];if(!g||function(hn,yn){for(var Un=0;Un<hn.length;Un++)if(yn.indexOf(hn[Un])>=0)return!0;return!1}(g,Se)){var Me=this.sourceLayerCoder.decode(r),it=this.vtLayers[Me].feature(u);if(h.filter(new ci(this.tileID.overscaledZ),it))for(var St=this.getId(it,Me),xt=0;xt<Se.length;xt++){var Gt=Se[xt];if(!(g&&g.indexOf(Gt)<0)){var Bt=L[Gt];if(Bt){var ar={};St!==void 0&&te&&(ar=te.getState(Bt.sourceLayer||"_geojsonTileLayer",St));var hr=B[Gt];hr.paint=sd(hr.paint,Bt.paint,it,ar,A),hr.layout=sd(hr.layout,Bt.layout,it,ar,A);var Tr=!pe||pe(it,Bt,ar);if(Tr){var Fr=new Uf(it,this.z,this.x,this.y,St);Fr.layer=hr;var Ir=e[Gt];Ir===void 0&&(Ir=e[Gt]=[]),Ir.push({featureIndex:u,feature:Fr,intersectionZ:Tr})}}}}}},th.prototype.lookupSymbolFeatures=function(e,t,r,u,h,g,A,L){var B={};this.loadVTLayers();for(var te=Gu(h),pe=0,Se=e;pe<Se.length;pe+=1)this.loadMatchingFeature(B,r,u,Se[pe],te,g,A,L,t);return B},th.prototype.hasLayer=function(e){for(var t=0,r=this.bucketLayerIDs;t<r.length;t+=1)for(var u=0,h=r[t];u<h.length;u+=1)if(e===h[u])return!0;return!1},th.prototype.getId=function(e,t){var r=e.id;return this.promoteId&&typeof(r=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[t]])=="boolean"&&(r=Number(r)),r},xn("FeatureIndex",th,{omit:["rawTileData","sourceLayerCoder"]});var uu=function(t,r){this.tileID=t,this.uid=Xe(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};uu.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<be.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},uu.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},uu.prototype.loadVectorData=function(e,t,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var u in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(te,pe){var Se={};if(!pe)return Se;for(var Me=function(){var Gt=St[it],Bt=Gt.layerIds.map(function(Tr){return pe.getLayer(Tr)}).filter(Boolean);if(Bt.length!==0){Gt.layers=Bt,Gt.stateDependentLayerIds&&(Gt.stateDependentLayers=Gt.stateDependentLayerIds.map(function(Tr){return Bt.filter(function(Fr){return Fr.id===Tr})[0]}));for(var ar=0,hr=Bt;ar<hr.length;ar+=1)Se[hr[ar].id]=Gt}},it=0,St=te;it<St.length;it+=1)Me();return Se}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var h=this.buckets[u];if(h instanceof De){if(this.hasSymbolBuckets=!0,!r)break;h.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var g in this.buckets){var A=this.buckets[g];if(A instanceof De&&A.hasRTLText){this.hasRTLText=!0,uo.isLoading()||uo.isLoaded()||uf()!=="deferred"||uc();break}}for(var L in this.queryPadding=0,this.buckets){var B=this.buckets[L];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(L).queryRadius(B))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new a},uu.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},uu.prototype.getBucket=function(e){return this.buckets[e.id]},uu.prototype.upload=function(e){for(var t in this.buckets){var r=this.buckets[t];r.uploadPending()&&r.upload(e)}var u=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ho(e,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ho(e,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)},uu.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},uu.prototype.queryRenderedFeatures=function(e,t,r,u,h,g,A,L,B,te){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:u,cameraQueryGeometry:h,scale:g,tileSize:this.tileSize,pixelPosMatrix:te,transform:L,params:A,queryPadding:this.queryPadding*B},e,t,r):{}},uu.prototype.querySourceFeatures=function(e,t){var r=this.latestFeatureIndex;if(r&&r.rawTileData){var u=r.loadVTLayers(),h=t?t.sourceLayer:"",g=u._geojsonTileLayer||u[h];if(g)for(var A=Gu(t&&t.filter),L=this.tileID.canonical,B=L.z,te=L.x,pe=L.y,Se={z:B,x:te,y:pe},Me=0;Me<g.length;Me++){var it=g.feature(Me);if(A.filter(new ci(this.tileID.overscaledZ),it)){var St=r.getId(it,h),xt=new Uf(it,B,te,pe,St);xt.tile=Se,e.push(xt)}}}},uu.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},uu.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},uu.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var r=ir(e.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var u=Date.now(),h=!1;if(this.expirationTime>u)h=!1;else if(t)if(this.expirationTime<t)h=!0;else{var g=this.expirationTime-t;g?this.expirationTime=u+Math.max(g,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},uu.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},uu.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var r=this.latestFeatureIndex.loadVTLayers();for(var u in this.buckets)if(t.style.hasLayer(u)){var h=this.buckets[u],g=h.layers[0].sourceLayer||"_geojsonTileLayer",A=r[g],L=e[g];if(A&&L&&Object.keys(L).length!==0){h.update(L,A,this.imageAtlas&&this.imageAtlas.patternPositions||{});var B=t&&t.style&&t.style.getLayer(u);B&&(this.queryPadding=Math.max(this.queryPadding,B.queryRadius(h)))}}}},uu.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},uu.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<be.now()},uu.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},uu.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=be.now()+e},uu.prototype.setDependencies=function(e,t){for(var r={},u=0,h=t;u<h.length;u+=1)r[h[u]]=!0;this.dependencies[e]=r},uu.prototype.hasDependency=function(e,t){for(var r=0,u=e;r<u.length;r+=1){var h=this.dependencies[u[r]];if(h){for(var g=0,A=t;g<A.length;g+=1)if(h[A[g]])return!0}}return!1};var rh=Y.performance,dh=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},rh.mark(this._marks.start)};dh.prototype.finish=function(){rh.mark(this._marks.end);var e=rh.getEntriesByName(this._marks.measure);return e.length===0&&(rh.measure(this._marks.measure,this._marks.start,this._marks.end),e=rh.getEntriesByName(this._marks.measure),rh.clearMarks(this._marks.start),rh.clearMarks(this._marks.end),rh.clearMeasures(this._marks.measure)),e},o.Actor=ls,o.AlphaImage=Uo,o.CanonicalTileID=Hi,o.CollisionBoxArray=a,o.Color=Ln,o.DEMData=gf,o.DataConstantProperty=Qn,o.DictionaryCoder=Ol,o.EXTENT=8192,o.ErrorEvent=at,o.EvaluationParameters=ci,o.Event=me,o.Evented=bt,o.FeatureIndex=th,o.FillBucket=_e,o.FillExtrusionBucket=oi,o.ImageAtlas=Ur,o.ImagePosition=$r,o.LineBucket=Gs,o.LngLat=xi,o.LngLatBounds=Io,o.MercatorCoordinate=Ic,o.ONE_EM=24,o.OverscaledTileID=Ho,o.Point=re,o.Point$1=re,o.Properties=Di,o.Protobuf=ih,o.RGBAImage=vo,o.RequestManager=I,o.RequestPerformance=dh,o.ResourceType=Vr,o.SegmentVector=qe,o.SourceFeatureState=Ah,o.StructArrayLayout1ui2=Yc,o.StructArrayLayout2f1f2i16=iu,o.StructArrayLayout2i4=yu,o.StructArrayLayout3ui6=xu,o.StructArrayLayout4i8=Fl,o.SymbolBucket=De,o.Texture=ho,o.Tile=uu,o.Transitionable=gi,o.Uniform1f=Hr,o.Uniform1i=wr,o.Uniform2f=Yr,o.Uniform3f=un,o.Uniform4f=_n,o.UniformColor=ia,o.UniformMatrix4f=ya,o.UnwrappedTileID=wl,o.ValidationError=ht,o.WritingMode=Gr,o.ZoomHistory=gu,o.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},o.addDynamicAttributes=V,o.asyncAll=function(e,t,r){if(!e.length)return r(null,[]);var u=e.length,h=new Array(e.length),g=null;e.forEach(function(A,L){t(A,function(B,te){B&&(g=B),h[L]=te,--u==0&&r(g,h)})})},o.bezier=Ze,o.bindAll=Et,o.browser=be,o.cacheEntryPossiblyAdded=function(e){++Ft>vt&&(e.getActor().send("enforceCacheSizeLimit",Ct),Ft=0)},o.clamp=we,o.clearTileCache=function(e){var t=Y.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},o.clipLine=ou,o.clone=function(e){var t=new Xi(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},o.clone$1=Ue,o.clone$2=function(e){var t=new Xi(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},o.collisionCircleLayout=qf,o.config=xe,o.create=function(){var e=new Xi(16);return Xi!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},o.create$1=function(){var e=new Xi(9);return Xi!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},o.create$2=function(){var e=new Xi(4);return Xi!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},o.createCommonjsModule=Z,o.createExpression=No,o.createLayout=Si,o.createStyleLayer=function(e){return e.type==="custom"?new pn(e):new Gn[e.type](e)},o.cross=function(e,t,r){var u=t[0],h=t[1],g=t[2],A=r[0],L=r[1],B=r[2];return e[0]=h*B-g*L,e[1]=g*A-u*B,e[2]=u*L-h*A,e},o.deepEqual=function e(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(var u=0;u<t.length;u++)if(!e(t[u],r[u]))return!1;return!0}if(typeof t=="object"&&t!==null&&r!==null){if(typeof r!="object")return!1;if(Object.keys(t).length!==Object.keys(r).length)return!1;for(var h in t)if(!e(t[h],r[h]))return!1;return!0}return t===r},o.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},o.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},o.ease=ye,o.emitValidationErrors=Wu,o.endsWith=_t,o.enforceCacheSizeLimit=function(e){Oe(),Ke&&Ke.then(function(t){t.keys().then(function(r){for(var u=0;u<r.length-e;u++)t.delete(r[u])})})},o.evaluateSizeForFeature=qo,o.evaluateSizeForZoom=ji,o.evaluateVariableOffset=v,o.evented=jl,o.extend=je,o.featureFilter=Gu,o.filterObject=ke,o.fromRotation=function(e,t){var r=Math.sin(t),u=Math.cos(t);return e[0]=u,e[1]=r,e[2]=0,e[3]=-r,e[4]=u,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},o.getAnchorAlignment=Da,o.getAnchorJustification=f,o.getArrayBuffer=Zn,o.getImage=F,o.getJSON=function(e,t){return ha(je(e,{type:"json"}),t)},o.getRTLTextPluginStatus=uf,o.getReferrer=Nn,o.getVideo=function(e,t){var r,u,h=Y.document.createElement("video");h.muted=!0,h.onloadstart=function(){t(null,h)};for(var g=0;g<e.length;g++){var A=Y.document.createElement("source");r=e[g],u=void 0,(u=Y.document.createElement("a")).href=r,(u.protocol!==Y.document.location.protocol||u.host!==Y.document.location.host)&&(h.crossOrigin="Anonymous"),A.src=e[g],h.appendChild(A)}return{cancel:function(){}}},o.identity=jo,o.invert=function(e,t){var r=t[0],u=t[1],h=t[2],g=t[3],A=t[4],L=t[5],B=t[6],te=t[7],pe=t[8],Se=t[9],Me=t[10],it=t[11],St=t[12],xt=t[13],Gt=t[14],Bt=t[15],ar=r*L-u*A,hr=r*B-h*A,Tr=r*te-g*A,Fr=u*B-h*L,Ir=u*te-g*L,hn=h*te-g*B,yn=pe*xt-Se*St,Un=pe*Gt-Me*St,Jn=pe*Bt-it*St,Dn=Se*Gt-Me*xt,In=Se*Bt-it*xt,_a=Me*Bt-it*Gt,sa=ar*_a-hr*In+Tr*Dn+Fr*Jn-Ir*Un+hn*yn;return sa?(e[0]=(L*_a-B*In+te*Dn)*(sa=1/sa),e[1]=(h*In-u*_a-g*Dn)*sa,e[2]=(xt*hn-Gt*Ir+Bt*Fr)*sa,e[3]=(Me*Ir-Se*hn-it*Fr)*sa,e[4]=(B*Jn-A*_a-te*Un)*sa,e[5]=(r*_a-h*Jn+g*Un)*sa,e[6]=(Gt*Tr-St*hn-Bt*hr)*sa,e[7]=(pe*hn-Me*Tr+it*hr)*sa,e[8]=(A*In-L*Jn+te*yn)*sa,e[9]=(u*Jn-r*In-g*yn)*sa,e[10]=(St*Ir-xt*Tr+Bt*ar)*sa,e[11]=(Se*Tr-pe*Ir-it*ar)*sa,e[12]=(L*Un-A*Dn-B*yn)*sa,e[13]=(r*Dn-u*Un+h*yn)*sa,e[14]=(xt*hr-St*Fr-Gt*ar)*sa,e[15]=(pe*Fr-Se*hr+Me*ar)*sa,e):null},o.isChar=Zr,o.isMapboxURL=q,o.keysDifference=function(e,t){var r=[];for(var u in e)u in t||r.push(u);return r},o.makeRequest=ha,o.mapObject=Ne,o.mercatorXfromLng=Mf,o.mercatorYfromLat=mc,o.mercatorZfromAltitude=Cl,o.mul=Vs,o.multiply=xs,o.mvt=Fa,o.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},o.normalize=function(e,t){var r=t[0],u=t[1],h=t[2],g=r*r+u*u+h*h;return g>0&&(g=1/Math.sqrt(g)),e[0]=t[0]*g,e[1]=t[1]*g,e[2]=t[2]*g,e},o.number=ka,o.offscreenCanvasSupported=vr,o.ortho=function(e,t,r,u,h,g,A){var L=1/(t-r),B=1/(u-h),te=1/(g-A);return e[0]=-2*L,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*B,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*te,e[11]=0,e[12]=(t+r)*L,e[13]=(h+u)*B,e[14]=(A+g)*te,e[15]=1,e},o.parseGlyphPBF=function(e){return new ih(e).readFields(Jr,[])},o.pbf=ih,o.performSymbolLayout=function(e,t,r,u,h,g,A){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var L=e.layers[0].layout,B=e.layers[0]._unevaluatedLayout._values,te={};if(e.textSizeData.kind==="composite"){var pe=e.textSizeData,Se=pe.maxZoom;te.compositeTextSizes=[B["text-size"].possiblyEvaluate(new ci(pe.minZoom),A),B["text-size"].possiblyEvaluate(new ci(Se),A)]}if(e.iconSizeData.kind==="composite"){var Me=e.iconSizeData,it=Me.maxZoom;te.compositeIconSizes=[B["icon-size"].possiblyEvaluate(new ci(Me.minZoom),A),B["icon-size"].possiblyEvaluate(new ci(it),A)]}te.layoutTextSize=B["text-size"].possiblyEvaluate(new ci(e.zoom+1),A),te.layoutIconSize=B["icon-size"].possiblyEvaluate(new ci(e.zoom+1),A),te.textMaxSize=B["text-size"].possiblyEvaluate(new ci(18));for(var St=24*L.get("text-line-height"),xt=L.get("text-rotation-alignment")==="map"&&L.get("symbol-placement")!=="point",Gt=L.get("text-keep-upright"),Bt=L.get("text-size"),ar=function(){var Ir=Tr[hr],hn=L.get("text-font").evaluate(Ir,{},A).join(","),yn=Bt.evaluate(Ir,{},A),Un=te.layoutTextSize.evaluate(Ir,{},A),Jn=te.layoutIconSize.evaluate(Ir,{},A),Dn={horizontal:{},vertical:void 0},In=Ir.text,_a=[0,0];if(In){var sa=In.toString(),Yn=24*L.get("text-letter-spacing").evaluate(Ir,{},A),si=function(di){for(var Pi=0,no=di;Pi<no.length;Pi+=1)if(Li=no[Pi].charCodeAt(0),Zr.Arabic(Li)||Zr["Arabic Supplement"](Li)||Zr["Arabic Extended-A"](Li)||Zr["Arabic Presentation Forms-A"](Li)||Zr["Arabic Presentation Forms-B"](Li))return!1;var Li;return!0}(sa)?Yn:0,Ma=L.get("text-anchor").evaluate(Ir,{},A),zi=L.get("text-variable-anchor");if(!zi){var da=L.get("text-radial-offset").evaluate(Ir,{},A);_a=da?v(Ma,[24*da,Oa]):L.get("text-offset").evaluate(Ir,{},A).map(function(di){return 24*di})}var ui=xt?"center":L.get("text-justify").evaluate(Ir,{},A),wo=L.get("symbol-placement"),Wo=wo==="point"?24*L.get("text-max-width").evaluate(Ir,{},A):0,lu=function(){e.allowVerticalPlacement&&vi(sa)&&(Dn.vertical=sn(In,t,r,h,hn,Wo,St,Ma,"left",si,_a,Gr.vertical,!0,wo,Un,yn))};if(!xt&&zi){for(var Mi=ui==="auto"?zi.map(function(di){return f(di)}):[ui],Ss=!1,zo=0;zo<Mi.length;zo++){var cs=Mi[zo];if(!Dn.horizontal[cs])if(Ss)Dn.horizontal[cs]=Dn.horizontal[0];else{var qu=sn(In,t,r,h,hn,Wo,St,"center",cs,si,_a,Gr.horizontal,!1,wo,Un,yn);qu&&(Dn.horizontal[cs]=qu,Ss=qu.positionedLines.length===1)}}lu()}else{ui==="auto"&&(ui=f(Ma));var Is=sn(In,t,r,h,hn,Wo,St,Ma,ui,si,_a,Gr.horizontal,!1,wo,Un,yn);Is&&(Dn.horizontal[ui]=Is),lu(),vi(sa)&&xt&&Gt&&(Dn.vertical=sn(In,t,r,h,hn,Wo,St,Ma,ui,si,_a,Gr.vertical,!1,wo,Un,yn))}}var gl=void 0,Tu=!1;if(Ir.icon&&Ir.icon.name){var fs=u[Ir.icon.name];fs&&(gl=function(di,Pi,no){var Li=Da(no),el=Pi[0]-di.displaySize[0]*Li.horizontalAlign,Ws=Pi[1]-di.displaySize[1]*Li.verticalAlign;return{image:di,top:Ws,bottom:Ws+di.displaySize[1],left:el,right:el+di.displaySize[0]}}(h[Ir.icon.name],L.get("icon-offset").evaluate(Ir,{},A),L.get("icon-anchor").evaluate(Ir,{},A)),Tu=fs.sdf,e.sdfIcons===void 0?e.sdfIcons=fs.sdf:e.sdfIcons!==fs.sdf&&Le("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(fs.pixelRatio!==e.pixelRatio||L.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var zu=p(Dn.horizontal)||Dn.vertical;e.iconsInText=!!zu&&zu.iconsInText,(zu||gl)&&function(di,Pi,no,Li,el,Ws,po,Zs,ao,As,Dc){var Lf=Ws.textMaxSize.evaluate(Pi,{});Lf===void 0&&(Lf=po);var Nc,_u=di.layers[0].layout,Bf=_u.get("icon-offset").evaluate(Pi,{},Dc),nh=p(no.horizontal),Vf=po/24,Ch=di.tilePixelRatio*Vf,Gf=di.tilePixelRatio*Lf/24,wh=di.tilePixelRatio*Zs,Oh=di.tilePixelRatio*_u.get("symbol-spacing"),ph=_u.get("text-padding")*di.tilePixelRatio,oh=_u.get("icon-padding")*di.tilePixelRatio,Mh=_u.get("text-max-angle")/180*Math.PI,Kh=_u.get("text-rotation-alignment")==="map"&&_u.get("symbol-placement")!=="point",sh=_u.get("icon-rotation-alignment")==="map"&&_u.get("symbol-placement")!=="point",Ph=_u.get("symbol-placement"),td=Oh/2,Lh=_u.get("icon-text-fit");Li&&Lh!=="none"&&(di.allowVerticalPlacement&&no.vertical&&(Nc=Bo(Li,no.vertical,Lh,_u.get("icon-text-fit-padding"),Bf,Vf)),nh&&(Li=Bo(Li,nh,Lh,_u.get("icon-text-fit-padding"),Bf,Vf)));var uh=function(cd,Hh){Hh.x<0||Hh.x>=8192||Hh.y<0||Hh.y>=8192||function(hs,yf,fd,Hf,Qh,id,qh,d,S,_,x,C,M,U,ie,ve,Be,Lt,$t,Pr,Mr,mn,On,Mn,Sa){var Ha,ri,Ka,ni,io,Aa=hs.addToLineVertexArray(yf,fd),Do=0,rs=0,Xs=0,Wa=0,ds=-1,Fo=-1,yl={},Wh=kt(""),lh=0,ch=0;if(d._unevaluatedLayout.getValue("text-radial-offset")===void 0?(lh=(Ha=d.layout.get("text-offset").evaluate(Mr,{},Mn).map(function(Ed){return 24*Ed}))[0],ch=Ha[1]):(lh=24*d.layout.get("text-radial-offset").evaluate(Mr,{},Mn),ch=Oa),hs.allowVerticalPlacement&&Hf.vertical){var Eh=d.layout.get("text-rotate").evaluate(Mr,{},Mn)+90;ni=new su(S,yf,_,x,C,Hf.vertical,M,U,ie,Eh),qh&&(io=new su(S,yf,_,x,C,qh,Be,Lt,ie,Eh))}if(Qh){var ef=d.layout.get("icon-rotate").evaluate(Mr,{}),hd=d.layout.get("icon-text-fit")!=="none",dd=hi(Qh,ef,On,hd),od=qh?hi(qh,ef,On,hd):void 0;Ka=new su(S,yf,_,x,C,Qh,Be,Lt,!1,ef),Do=4*dd.length;var pd=hs.iconSizeData,Zh=null;pd.kind==="source"?(Zh=[128*d.layout.get("icon-size").evaluate(Mr,{})])[0]>32640&&Le(hs.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):pd.kind==="composite"&&((Zh=[128*mn.compositeIconSizes[0].evaluate(Mr,{},Mn),128*mn.compositeIconSizes[1].evaluate(Mr,{},Mn)])[0]>32640||Zh[1]>32640)&&Le(hs.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),hs.addSymbols(hs.icon,dd,Zh,Pr,$t,Mr,!1,yf,Aa.lineStartIndex,Aa.lineLength,-1,Mn),ds=hs.icon.placedSymbolArray.length-1,od&&(rs=4*od.length,hs.addSymbols(hs.icon,od,Zh,Pr,$t,Mr,Gr.vertical,yf,Aa.lineStartIndex,Aa.lineLength,-1,Mn),Fo=hs.icon.placedSymbolArray.length-1)}for(var md in Hf.horizontal){var ed=Hf.horizontal[md];if(!ri){Wh=kt(ed.text);var yd=d.layout.get("text-rotate").evaluate(Mr,{},Mn);ri=new su(S,yf,_,x,C,ed,M,U,ie,yd)}var vd=ed.positionedLines.length===1;if(Xs+=c(hs,yf,ed,id,d,ie,Mr,ve,Aa,Hf.vertical?Gr.horizontal:Gr.horizontalOnly,vd?Object.keys(Hf.horizontal):[md],yl,ds,mn,Mn),vd)break}Hf.vertical&&(Wa+=c(hs,yf,Hf.vertical,id,d,ie,Mr,ve,Aa,Gr.vertical,["vertical"],yl,Fo,mn,Mn));var Ra=ri?ri.boxStartIndex:hs.collisionBoxArray.length,Yi=ri?ri.boxEndIndex:hs.collisionBoxArray.length,ai=ni?ni.boxStartIndex:hs.collisionBoxArray.length,Rn=ni?ni.boxEndIndex:hs.collisionBoxArray.length,kc=Ka?Ka.boxStartIndex:hs.collisionBoxArray.length,ps=Ka?Ka.boxEndIndex:hs.collisionBoxArray.length,tf=io?io.boxStartIndex:hs.collisionBoxArray.length,rf=io?io.boxEndIndex:hs.collisionBoxArray.length,Ql=-1,Xh=function(bd,Td){return bd&&bd.circleDiameter?Math.max(bd.circleDiameter,Td):Td};Ql=Xh(ri,Ql),Ql=Xh(ni,Ql),Ql=Xh(Ka,Ql);var xd=(Ql=Xh(io,Ql))>-1?1:0;xd&&(Ql*=Sa/24),hs.glyphOffsetArray.length>=De.MAX_GLYPHS&&Le("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Mr.sortKey!==void 0&&hs.addToSortKeyRanges(hs.symbolInstances.length,Mr.sortKey),hs.symbolInstances.emplaceBack(yf.x,yf.y,yl.right>=0?yl.right:-1,yl.center>=0?yl.center:-1,yl.left>=0?yl.left:-1,yl.vertical||-1,ds,Fo,Wh,Ra,Yi,ai,Rn,kc,ps,tf,rf,_,Xs,Wa,Do,rs,xd,0,M,lh,ch,Ql)}(di,Hh,cd,no,Li,el,Nc,di.layers[0],di.collisionBoxArray,Pi.index,Pi.sourceLayerIndex,di.index,Ch,ph,Kh,ao,wh,oh,sh,Bf,Pi,Ws,As,Dc,po)};if(Ph==="line")for(var Rh=0,Uh=ou(Pi.geometry,0,0,8192,8192);Rh<Uh.length;Rh+=1)for(var mh=Uh[Rh],Ih=0,Bh=ra(mh,Oh,Mh,no.vertical||nh,Li,24,Gf,di.overscaling,8192);Ih<Bh.length;Ih+=1){var Vh=Bh[Ih];nh&&y(di,nh.text,td,Vh)||uh(mh,Vh)}else if(Ph==="line-center")for(var vh=0,Dh=Pi.geometry;vh<Dh.length;vh+=1){var Nh=Dh[vh];if(Nh.length>1){var kh=Go(Nh,Mh,no.vertical||nh,Li,24,Gf);kh&&uh(Nh,kh)}}else if(Pi.type==="Polygon")for(var Gh=0,gh=ne(Pi.geometry,0);Gh<gh.length;Gh+=1){var jh=gh[Gh],yh=Er(jh,16);uh(jh[0],new So(yh.x,yh.y,0))}else if(Pi.type==="LineString")for(var bh=0,zh=Pi.geometry;bh<zh.length;bh+=1){var xh=zh[bh];uh(xh,new So(xh[0].x,xh[0].y,0))}else if(Pi.type==="Point")for(var $h=0,rd=Pi.geometry;$h<rd.length;$h+=1)for(var Jh=0,nd=rd[$h];Jh<nd.length;Jh+=1){var ad=nd[Jh];uh([ad],new So(ad.x,ad.y,0))}}(e,Ir,Dn,gl,u,te,Un,Jn,_a,Tu,A)},hr=0,Tr=e.features;hr<Tr.length;hr+=1)ar();g&&e.generateCollisionDebugBuffers()},o.perspective=function(e,t,r,u,h){var g,A=1/Math.tan(t/2);return e[0]=A/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=A,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,h!=null&&h!==1/0?(e[10]=(h+u)*(g=1/(u-h)),e[14]=2*h*u*g):(e[10]=-1,e[14]=-2*u),e},o.pick=function(e,t){for(var r={},u=0;u<t.length;u++){var h=t[u];h in e&&(r[h]=e[h])}return r},o.plugin=uo,o.polygonIntersectsPolygon=Iu,o.postMapLoadEvent=mt,o.postTurnstileEvent=sr,o.potpack=Xn,o.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.register=xn,o.registerForPluginStateChange=function(e){return e({pluginStatus:wi,pluginURL:js}),jl.on("pluginStateChange",e),e},o.renderColorRamp=Zl,o.rotate=function(e,t,r){var u=t[0],h=t[1],g=t[2],A=t[3],L=Math.sin(r),B=Math.cos(r);return e[0]=u*B+g*L,e[1]=h*B+A*L,e[2]=u*-L+g*B,e[3]=h*-L+A*B,e},o.rotateX=function(e,t,r){var u=Math.sin(r),h=Math.cos(r),g=t[4],A=t[5],L=t[6],B=t[7],te=t[8],pe=t[9],Se=t[10],Me=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=g*h+te*u,e[5]=A*h+pe*u,e[6]=L*h+Se*u,e[7]=B*h+Me*u,e[8]=te*h-g*u,e[9]=pe*h-A*u,e[10]=Se*h-L*u,e[11]=Me*h-B*u,e},o.rotateZ=function(e,t,r){var u=Math.sin(r),h=Math.cos(r),g=t[0],A=t[1],L=t[2],B=t[3],te=t[4],pe=t[5],Se=t[6],Me=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=g*h+te*u,e[1]=A*h+pe*u,e[2]=L*h+Se*u,e[3]=B*h+Me*u,e[4]=te*h-g*u,e[5]=pe*h-A*u,e[6]=Se*h-L*u,e[7]=Me*h-B*u,e},o.scale=function(e,t,r){var u=r[0],h=r[1],g=r[2];return e[0]=t[0]*u,e[1]=t[1]*u,e[2]=t[2]*u,e[3]=t[3]*u,e[4]=t[4]*h,e[5]=t[5]*h,e[6]=t[6]*h,e[7]=t[7]*h,e[8]=t[8]*g,e[9]=t[9]*g,e[10]=t[10]*g,e[11]=t[11]*g,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},o.scale$1=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},o.scale$2=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},o.setCacheLimits=function(e,t){Ct=e,vt=t},o.setRTLTextPlugin=function(e,t,r){if(r===void 0&&(r=!1),wi==="deferred"||wi==="loading"||wi==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");js=be.resolveURL(e),wi="deferred",as=t,ul(),r||uc()},o.sphericalToCartesian=function(e){var t=e[0],r=e[1],u=e[2];return r+=90,r*=Math.PI/180,u*=Math.PI/180,{x:t*Math.cos(r)*Math.sin(u),y:t*Math.sin(r)*Math.sin(u),z:t*Math.cos(u)}},o.sqrLen=function(e){var t=e[0],r=e[1];return t*t+r*r},o.styleSpec=He,o.sub=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},o.symbolSize=_s,o.transformMat3=function(e,t,r){var u=t[0],h=t[1],g=t[2];return e[0]=u*r[0]+h*r[3]+g*r[6],e[1]=u*r[1]+h*r[4]+g*r[7],e[2]=u*r[2]+h*r[5]+g*r[8],e},o.transformMat4=ro,o.translate=function(e,t,r){var u,h,g,A,L,B,te,pe,Se,Me,it,St,xt=r[0],Gt=r[1],Bt=r[2];return t===e?(e[12]=t[0]*xt+t[4]*Gt+t[8]*Bt+t[12],e[13]=t[1]*xt+t[5]*Gt+t[9]*Bt+t[13],e[14]=t[2]*xt+t[6]*Gt+t[10]*Bt+t[14],e[15]=t[3]*xt+t[7]*Gt+t[11]*Bt+t[15]):(h=t[1],g=t[2],A=t[3],L=t[4],B=t[5],te=t[6],pe=t[7],Se=t[8],Me=t[9],it=t[10],St=t[11],e[0]=u=t[0],e[1]=h,e[2]=g,e[3]=A,e[4]=L,e[5]=B,e[6]=te,e[7]=pe,e[8]=Se,e[9]=Me,e[10]=it,e[11]=St,e[12]=u*xt+L*Gt+Se*Bt+t[12],e[13]=h*xt+B*Gt+Me*Bt+t[13],e[14]=g*xt+te*Gt+it*Bt+t[14],e[15]=A*xt+pe*Gt+St*Bt+t[15]),e},o.triggerPluginCompletionEvent=sf,o.uniqueId=Xe,o.validateCustomStyleLayer=function(e){var t=[],r=e.id;return r===void 0&&t.push({message:"layers."+r+': missing required property "id"'}),e.render===void 0&&t.push({message:"layers."+r+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&t.push({message:"layers."+r+': property "renderingMode" must be either "2d" or "3d"'}),t},o.validateLight=Tf,o.validateStyle=Xa,o.values=function(e){var t=[];for(var r in e)t.push(e[r]);return t},o.vectorTile=Fa,o.version="1.12.0",o.warnOnce=Le,o.webpSupported=Ve,o.window=Y,o.wrap=pt}),z(["./shared"],function(o){"use strict";function Z(F){var W=typeof F;if(W==="number"||W==="boolean"||W==="string"||F==null)return JSON.stringify(F);if(Array.isArray(F)){for(var le="[",me=0,at=F;me<at.length;me+=1)le+=Z(at[me])+",";return le+"]"}for(var bt=Object.keys(F).sort(),He="{",ht=0;ht<bt.length;ht++)He+=JSON.stringify(bt[ht])+":"+Z(F[bt[ht]])+",";return He+"}"}function D(F){for(var W="",le=0,me=o.refProperties;le<me.length;le+=1)W+="/"+Z(F[me[le]]);return W}var K=function(W){this.keyCache={},W&&this.replace(W)};K.prototype.replace=function(F){this._layerConfigs={},this._layers={},this.update(F,[])},K.prototype.update=function(F,W){for(var le=this,me=0,at=F;me<at.length;me+=1){var bt=at[me];this._layerConfigs[bt.id]=bt;var He=this._layers[bt.id]=o.createStyleLayer(bt);He._featureFilter=o.featureFilter(He.filter),this.keyCache[bt.id]&&delete this.keyCache[bt.id]}for(var ht=0,Qt=W;ht<Qt.length;ht+=1){var qt=Qt[ht];delete this.keyCache[qt],delete this._layerConfigs[qt],delete this._layers[qt]}this.familiesBySource={};for(var Nr=0,qr=function(Kn,gn){for(var ur={},kn=0;kn<Kn.length;kn++){var An=gn&&gn[Kn[kn].id]||D(Kn[kn]);gn&&(gn[Kn[kn].id]=An);var Za=ur[An];Za||(Za=ur[An]=[]),Za.push(Kn[kn])}var ea=[];for(var ca in ur)ea.push(ur[ca]);return ea}(o.values(this._layerConfigs),this.keyCache);Nr<qr.length;Nr+=1){var or=qr[Nr].map(function(Kn){return le._layers[Kn.id]}),Br=or[0];if(Br.visibility!=="none"){var Tn=Br.source||"",dr=this.familiesBySource[Tn];dr||(dr=this.familiesBySource[Tn]={});var Xr=Br.sourceLayer||"_geojsonTileLayer",dn=dr[Xr];dn||(dn=dr[Xr]=[]),dn.push(or)}}};var re=function(W){var le={},me=[];for(var at in W){var bt=W[at],He=le[at]={};for(var ht in bt){var Qt=bt[+ht];if(Qt&&Qt.bitmap.width!==0&&Qt.bitmap.height!==0){var qt={x:0,y:0,w:Qt.bitmap.width+2,h:Qt.bitmap.height+2};me.push(qt),He[ht]={rect:qt,metrics:Qt.metrics}}}}var Nr=o.potpack(me),qr=new o.AlphaImage({width:Nr.w||1,height:Nr.h||1});for(var or in W){var Br=W[or];for(var Tn in Br){var dr=Br[+Tn];if(dr&&dr.bitmap.width!==0&&dr.bitmap.height!==0){var Xr=le[or][Tn].rect;o.AlphaImage.copy(dr.bitmap,qr,{x:0,y:0},{x:Xr.x+1,y:Xr.y+1},dr.bitmap)}}}this.image=qr,this.positions=le};o.register("GlyphAtlas",re);var de=function(W){this.tileID=new o.OverscaledTileID(W.tileID.overscaledZ,W.tileID.wrap,W.tileID.canonical.z,W.tileID.canonical.x,W.tileID.canonical.y),this.uid=W.uid,this.zoom=W.zoom,this.pixelRatio=W.pixelRatio,this.tileSize=W.tileSize,this.source=W.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=W.showCollisionBoxes,this.collectResourceTiming=!!W.collectResourceTiming,this.returnDependencies=!!W.returnDependencies,this.promoteId=W.promoteId};function Y(F,W,le){for(var me=new o.EvaluationParameters(W),at=0,bt=F;at<bt.length;at+=1)bt[at].recalculate(me,le)}function Fe(F,W){var le=o.getArrayBuffer(F.request,function(me,at,bt,He){me?W(me):at&&W(null,{vectorTile:new o.vectorTile.VectorTile(new o.pbf(at)),rawData:at,cacheControl:bt,expires:He})});return function(){le.cancel(),W()}}de.prototype.parse=function(F,W,le,me,at){var bt=this;this.status="parsing",this.data=F,this.collisionBoxArray=new o.CollisionBoxArray;var He=new o.DictionaryCoder(Object.keys(F.layers).sort()),ht=new o.FeatureIndex(this.tileID,this.promoteId);ht.bucketLayerIDs=[];var Qt,qt,Nr,qr,or={},Br={featureIndex:ht,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:le},Tn=W.familiesBySource[this.source];for(var dr in Tn){var Xr=F.layers[dr];if(Xr){Xr.version===1&&o.warnOnce('Vector tile source "'+this.source+'" layer "'+dr+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var dn=He.encode(dr),Kn=[],gn=0;gn<Xr.length;gn++){var ur=Xr.feature(gn),kn=ht.getId(ur,dr);Kn.push({feature:ur,id:kn,index:gn,sourceLayerIndex:dn})}for(var An=0,Za=Tn[dr];An<Za.length;An+=1){var ea=Za[An],ca=ea[0];ca.minzoom&&this.zoom<Math.floor(ca.minzoom)||ca.maxzoom&&this.zoom>=ca.maxzoom||ca.visibility!=="none"&&(Y(ea,this.zoom,le),(or[ca.id]=ca.createBucket({index:ht.bucketLayerIDs.length,layers:ea,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:dn,sourceID:this.source})).populate(Kn,Br,this.tileID.canonical),ht.bucketLayerIDs.push(ea.map(function(Ia){return Ia.id})))}}}var bo=o.mapObject(Br.glyphDependencies,function(Ia){return Object.keys(Ia).map(Number)});Object.keys(bo).length?me.send("getGlyphs",{uid:this.uid,stacks:bo},function(Ia,Ln){Qt||(Qt=Ia,qt=Ln,ii.call(bt))}):qt={};var Ri=Object.keys(Br.iconDependencies);Ri.length?me.send("getImages",{icons:Ri,source:this.source,tileID:this.tileID,type:"icons"},function(Ia,Ln){Qt||(Qt=Ia,Nr=Ln,ii.call(bt))}):Nr={};var va=Object.keys(Br.patternDependencies);function ii(){if(Qt)return at(Qt);if(qt&&Nr&&qr){var Ia=new re(qt),Ln=new o.ImageAtlas(Nr,qr);for(var Ei in or){var Wi=or[Ei];Wi instanceof o.SymbolBucket?(Y(Wi.layers,this.zoom,le),o.performSymbolLayout(Wi,qt,Ia.positions,Nr,Ln.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Wi.hasPattern&&(Wi instanceof o.LineBucket||Wi instanceof o.FillBucket||Wi instanceof o.FillExtrusionBucket)&&(Y(Wi.layers,this.zoom,le),Wi.addFeatures(Br,this.tileID.canonical,Ln.patternPositions))}this.status="done",at(null,{buckets:o.values(or).filter(function(qa){return!qa.isEmpty()}),featureIndex:ht,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ia.image,imageAtlas:Ln,glyphMap:this.returnDependencies?qt:null,iconMap:this.returnDependencies?Nr:null,glyphPositions:this.returnDependencies?Ia.positions:null})}}va.length?me.send("getImages",{icons:va,source:this.source,tileID:this.tileID,type:"patterns"},function(Ia,Ln){Qt||(Qt=Ia,qr=Ln,ii.call(bt))}):qr={},ii.call(this)};var Ze=function(W,le,me,at){this.actor=W,this.layerIndex=le,this.availableImages=me,this.loadVectorData=at||Fe,this.loading={},this.loaded={}};Ze.prototype.loadTile=function(F,W){var le=this,me=F.uid;this.loading||(this.loading={});var at=!!(F&&F.request&&F.request.collectResourceTiming)&&new o.RequestPerformance(F.request),bt=this.loading[me]=new de(F);bt.abort=this.loadVectorData(F,function(He,ht){if(delete le.loading[me],He||!ht)return bt.status="done",le.loaded[me]=bt,W(He);var Qt=ht.rawData,qt={};ht.expires&&(qt.expires=ht.expires),ht.cacheControl&&(qt.cacheControl=ht.cacheControl);var Nr={};if(at){var qr=at.finish();qr&&(Nr.resourceTiming=JSON.parse(JSON.stringify(qr)))}bt.vectorTile=ht.vectorTile,bt.parse(ht.vectorTile,le.layerIndex,le.availableImages,le.actor,function(or,Br){if(or||!Br)return W(or);W(null,o.extend({rawTileData:Qt.slice(0)},Br,qt,Nr))}),le.loaded=le.loaded||{},le.loaded[me]=bt})},Ze.prototype.reloadTile=function(F,W){var le=this,me=this.loaded,at=F.uid,bt=this;if(me&&me[at]){var He=me[at];He.showCollisionBoxes=F.showCollisionBoxes;var ht=function(qt,Nr){var qr=He.reloadCallback;qr&&(delete He.reloadCallback,He.parse(He.vectorTile,bt.layerIndex,le.availableImages,bt.actor,qr)),W(qt,Nr)};He.status==="parsing"?He.reloadCallback=ht:He.status==="done"&&(He.vectorTile?He.parse(He.vectorTile,this.layerIndex,this.availableImages,this.actor,ht):ht())}},Ze.prototype.abortTile=function(F,W){var le=this.loading,me=F.uid;le&&le[me]&&le[me].abort&&(le[me].abort(),delete le[me]),W()},Ze.prototype.removeTile=function(F,W){var le=this.loaded,me=F.uid;le&&le[me]&&delete le[me],W()};var ye=o.window.ImageBitmap,we=function(){this.loaded={}};function pt(F,W){if(F.length!==0){je(F[0],W);for(var le=1;le<F.length;le++)je(F[le],!W)}}function je(F,W){for(var le=0,me=0,at=F.length,bt=at-1;me<at;bt=me++)le+=(F[me][0]-F[bt][0])*(F[bt][1]+F[me][1]);le>=0!=!!W&&F.reverse()}we.prototype.loadTile=function(F,W){var le=F.uid,me=F.encoding,at=F.rawImageData,bt=ye&&at instanceof ye?this.getImageData(at):at,He=new o.DEMData(le,bt,me);this.loaded=this.loaded||{},this.loaded[le]=He,W(null,He)},we.prototype.getImageData=function(F){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(F.width,F.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=F.width,this.offscreenCanvas.height=F.height,this.offscreenCanvasContext.drawImage(F,0,0,F.width,F.height);var W=this.offscreenCanvasContext.getImageData(-1,-1,F.width+2,F.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new o.RGBAImage({width:W.width,height:W.height},W.data)},we.prototype.removeTile=function(F){var W=this.loaded,le=F.uid;W&&W[le]&&delete W[le]};var Tt=o.vectorTile.VectorTileFeature.prototype.toGeoJSON,Xe=function(W){this._feature=W,this.extent=o.EXTENT,this.type=W.type,this.properties=W.tags,"id"in W&&!isNaN(W.id)&&(this.id=parseInt(W.id,10))};Xe.prototype.loadGeometry=function(){if(this._feature.type===1){for(var F=[],W=0,le=this._feature.geometry;W<le.length;W+=1){var me=le[W];F.push([new o.Point$1(me[0],me[1])])}return F}for(var at=[],bt=0,He=this._feature.geometry;bt<He.length;bt+=1){for(var ht=[],Qt=0,qt=He[bt];Qt<qt.length;Qt+=1){var Nr=qt[Qt];ht.push(new o.Point$1(Nr[0],Nr[1]))}at.push(ht)}return at},Xe.prototype.toGeoJSON=function(F,W,le){return Tt.call(this,F,W,le)};var gt=function(W){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.EXTENT,this.length=W.length,this._features=W};gt.prototype.feature=function(F){return new Xe(this._features[F])};var Je=o.vectorTile.VectorTileFeature,Et=_t;function _t(F,W){this.options=W||{},this.features=F,this.length=F.length}function Ne(F,W){this.id=typeof F.id=="number"?F.id:void 0,this.type=F.type,this.rawGeometry=F.type===1?[F.geometry]:F.geometry,this.properties=F.tags,this.extent=W||4096}_t.prototype.feature=function(F){return new Ne(this.features[F],this.options.extent)},Ne.prototype.loadGeometry=function(){var F=this.rawGeometry;this.geometry=[];for(var W=0;W<F.length;W++){for(var le=F[W],me=[],at=0;at<le.length;at++)me.push(new o.Point$1(le[at][0],le[at][1]));this.geometry.push(me)}return this.geometry},Ne.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var F=this.geometry,W=1/0,le=-1/0,me=1/0,at=-1/0,bt=0;bt<F.length;bt++)for(var He=F[bt],ht=0;ht<He.length;ht++){var Qt=He[ht];W=Math.min(W,Qt.x),le=Math.max(le,Qt.x),me=Math.min(me,Qt.y),at=Math.max(at,Qt.y)}return[W,me,le,at]},Ne.prototype.toGeoJSON=Je.prototype.toGeoJSON;var ke=st,Ue=Et;function st(F){var W=new o.pbf;return function(le,me){for(var at in le.layers)me.writeMessage(3,Le,le.layers[at])}(F,W),W.finish()}function Le(F,W){var le;W.writeVarintField(15,F.version||1),W.writeStringField(1,F.name||""),W.writeVarintField(5,F.extent||4096);var me={keys:[],values:[],keycache:{},valuecache:{}};for(le=0;le<F.length;le++)me.feature=F.feature(le),W.writeMessage(2,ut,me);var at=me.keys;for(le=0;le<at.length;le++)W.writeStringField(3,at[le]);var bt=me.values;for(le=0;le<bt.length;le++)W.writeMessage(4,Q,bt[le])}function ut(F,W){var le=F.feature;le.id!==void 0&&W.writeVarintField(1,le.id),W.writeMessage(2,Vt,F),W.writeVarintField(3,le.type),W.writeMessage(4,oe,le)}function Vt(F,W){var le=F.feature,me=F.keys,at=F.values,bt=F.keycache,He=F.valuecache;for(var ht in le.properties){var Qt=bt[ht];Qt===void 0&&(me.push(ht),bt[ht]=Qt=me.length-1),W.writeVarint(Qt);var qt=le.properties[ht],Nr=typeof qt;Nr!=="string"&&Nr!=="boolean"&&Nr!=="number"&&(qt=JSON.stringify(qt));var qr=Nr+":"+qt,or=He[qr];or===void 0&&(at.push(qt),He[qr]=or=at.length-1),W.writeVarint(or)}}function Zt(F,W){return(W<<3)+(7&F)}function ir(F){return F<<1^F>>31}function oe(F,W){for(var le=F.loadGeometry(),me=F.type,at=0,bt=0,He=le.length,ht=0;ht<He;ht++){var Qt=le[ht],qt=1;me===1&&(qt=Qt.length),W.writeVarint(Zt(1,qt));for(var Nr=me===3?Qt.length-1:Qt.length,qr=0;qr<Nr;qr++){qr===1&&me!==1&&W.writeVarint(Zt(2,Nr-1));var or=Qt[qr].x-at,Br=Qt[qr].y-bt;W.writeVarint(ir(or)),W.writeVarint(ir(Br)),at+=or,bt+=Br}me===3&&W.writeVarint(Zt(7,1))}}function Q(F,W){var le=typeof F;le==="string"?W.writeStringField(1,F):le==="boolean"?W.writeBooleanField(7,F):le==="number"&&(F%1!=0?W.writeDoubleField(3,F):F<0?W.writeSVarintField(6,F):W.writeVarintField(5,F))}function H(F,W,le,me){Ce(F,le,me),Ce(W,2*le,2*me),Ce(W,2*le+1,2*me+1)}function Ce(F,W,le){var me=F[W];F[W]=F[le],F[le]=me}function Ee(F,W,le,me){var at=F-le,bt=W-me;return at*at+bt*bt}ke.fromVectorTileJs=st,ke.fromGeojsonVt=function(F,W){W=W||{};var le={};for(var me in F)le[me]=new Et(F[me].features,W),le[me].name=me,le[me].version=W.version,le[me].extent=W.extent;return st({layers:le})},ke.GeoJSONWrapper=Ue;var Ae=function(W){return W[0]},ge=function(W){return W[1]},rt=function(W,le,me,at,bt){le===void 0&&(le=Ae),me===void 0&&(me=ge),at===void 0&&(at=64),bt===void 0&&(bt=Float64Array),this.nodeSize=at,this.points=W;for(var He=W.length<65536?Uint16Array:Uint32Array,ht=this.ids=new He(W.length),Qt=this.coords=new bt(2*W.length),qt=0;qt<W.length;qt++)ht[qt]=qt,Qt[2*qt]=le(W[qt]),Qt[2*qt+1]=me(W[qt]);!function Nr(qr,or,Br,Tn,dr,Xr){if(!(dr-Tn<=Br)){var dn=Tn+dr>>1;!function Kn(gn,ur,kn,An,Za,ea){for(;Za>An;){if(Za-An>600){var ca=Za-An+1,bo=kn-An+1,Ri=Math.log(ca),va=.5*Math.exp(2*Ri/3),ii=.5*Math.sqrt(Ri*va*(ca-va)/ca)*(bo-ca/2<0?-1:1);Kn(gn,ur,kn,Math.max(An,Math.floor(kn-bo*va/ca+ii)),Math.min(Za,Math.floor(kn+(ca-bo)*va/ca+ii)),ea)}var Ia=ur[2*kn+ea],Ln=An,Ei=Za;for(H(gn,ur,An,kn),ur[2*Za+ea]>Ia&&H(gn,ur,An,Za);Ln<Ei;){for(H(gn,ur,Ln,Ei),Ln++,Ei--;ur[2*Ln+ea]<Ia;)Ln++;for(;ur[2*Ei+ea]>Ia;)Ei--}ur[2*An+ea]===Ia?H(gn,ur,An,Ei):H(gn,ur,++Ei,Za),Ei<=kn&&(An=Ei+1),kn<=Ei&&(Za=Ei-1)}}(qr,or,dn,Tn,dr,Xr%2),Nr(qr,or,Br,Tn,dn-1,Xr+1),Nr(qr,or,Br,dn+1,dr,Xr+1)}}(ht,Qt,at,0,ht.length-1,0)};rt.prototype.range=function(F,W,le,me){return function(at,bt,He,ht,Qt,qt,Nr){for(var qr,or,Br=[0,at.length-1,0],Tn=[];Br.length;){var dr=Br.pop(),Xr=Br.pop(),dn=Br.pop();if(Xr-dn<=Nr)for(var Kn=dn;Kn<=Xr;Kn++)or=bt[2*Kn+1],(qr=bt[2*Kn])>=He&&qr<=Qt&&or>=ht&&or<=qt&&Tn.push(at[Kn]);else{var gn=Math.floor((dn+Xr)/2);or=bt[2*gn+1],(qr=bt[2*gn])>=He&&qr<=Qt&&or>=ht&&or<=qt&&Tn.push(at[gn]);var ur=(dr+1)%2;(dr===0?He<=qr:ht<=or)&&(Br.push(dn),Br.push(gn-1),Br.push(ur)),(dr===0?Qt>=qr:qt>=or)&&(Br.push(gn+1),Br.push(Xr),Br.push(ur))}}return Tn}(this.ids,this.coords,F,W,le,me,this.nodeSize)},rt.prototype.within=function(F,W,le){return function(me,at,bt,He,ht,Qt){for(var qt=[0,me.length-1,0],Nr=[],qr=ht*ht;qt.length;){var or=qt.pop(),Br=qt.pop(),Tn=qt.pop();if(Br-Tn<=Qt)for(var dr=Tn;dr<=Br;dr++)Ee(at[2*dr],at[2*dr+1],bt,He)<=qr&&Nr.push(me[dr]);else{var Xr=Math.floor((Tn+Br)/2),dn=at[2*Xr],Kn=at[2*Xr+1];Ee(dn,Kn,bt,He)<=qr&&Nr.push(me[Xr]);var gn=(or+1)%2;(or===0?bt-ht<=dn:He-ht<=Kn)&&(qt.push(Tn),qt.push(Xr-1),qt.push(gn)),(or===0?bt+ht>=dn:He+ht>=Kn)&&(qt.push(Xr+1),qt.push(Br),qt.push(gn))}}return Nr}(this.ids,this.coords,F,W,le,this.nodeSize)};var Yt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(W){return W}},At=function(W){this.options=w(Object.create(Yt),W),this.trees=new Array(this.options.maxZoom+1)};function be(F,W,le,me,at){return{x:F,y:W,zoom:1/0,id:le,parentId:-1,numPoints:me,properties:at}}function xe(F,W){var le=F.geometry.coordinates,me=le[1];return{x:Pe(le[0]),y:dt(me),zoom:1/0,index:W,parentId:-1}}function Ve(F){return{type:"Feature",id:F.id,properties:lt(F),geometry:{type:"Point",coordinates:[(me=F.x,360*(me-.5)),(W=F.y,le=(180-360*W)*Math.PI/180,360*Math.atan(Math.exp(le))/Math.PI-90)]}};var W,le,me}function lt(F){var W=F.numPoints,le=W>=1e4?Math.round(W/1e3)+"k":W>=1e3?Math.round(W/100)/10+"k":W;return w(w({},F.properties),{cluster:!0,cluster_id:F.id,point_count:W,point_count_abbreviated:le})}function Pe(F){return F/360+.5}function dt(F){var W=Math.sin(F*Math.PI/180),le=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return le<0?0:le>1?1:le}function w(F,W){for(var le in W)F[le]=W[le];return F}function I(F){return F.x}function q(F){return F.y}function ce(F,W,le,me,at,bt){var He=at-le,ht=bt-me;if(He!==0||ht!==0){var Qt=((F-le)*He+(W-me)*ht)/(He*He+ht*ht);Qt>1?(le=at,me=bt):Qt>0&&(le+=He*Qt,me+=ht*Qt)}return(He=F-le)*He+(ht=W-me)*ht}function Ge(F,W,le,me){var at={id:F===void 0?null:F,type:W,geometry:le,tags:me,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(bt){var He=bt.geometry,ht=bt.type;if(ht==="Point"||ht==="MultiPoint"||ht==="LineString")$e(bt,He);else if(ht==="Polygon"||ht==="MultiLineString")for(var Qt=0;Qt<He.length;Qt++)$e(bt,He[Qt]);else if(ht==="MultiPolygon")for(Qt=0;Qt<He.length;Qt++)for(var qt=0;qt<He[Qt].length;qt++)$e(bt,He[Qt][qt])}(at),at}function $e(F,W){for(var le=0;le<W.length;le+=3)F.minX=Math.min(F.minX,W[le]),F.minY=Math.min(F.minY,W[le+1]),F.maxX=Math.max(F.maxX,W[le]),F.maxY=Math.max(F.maxY,W[le+1])}function yt(F,W,le,me){if(W.geometry){var at=W.geometry.coordinates,bt=W.geometry.type,He=Math.pow(le.tolerance/((1<<le.maxZoom)*le.extent),2),ht=[],Qt=W.id;if(le.promoteId?Qt=W.properties[le.promoteId]:le.generateId&&(Qt=me||0),bt==="Point")nt(at,ht);else if(bt==="MultiPoint")for(var qt=0;qt<at.length;qt++)nt(at[qt],ht);else if(bt==="LineString")Nt(at,ht,He,!1);else if(bt==="MultiLineString"){if(le.lineMetrics){for(qt=0;qt<at.length;qt++)Nt(at[qt],ht=[],He,!1),F.push(Ge(Qt,"LineString",ht,W.properties));return}$(at,ht,He,!1)}else if(bt==="Polygon")$(at,ht,He,!0);else{if(bt!=="MultiPolygon"){if(bt==="GeometryCollection"){for(qt=0;qt<W.geometry.geometries.length;qt++)yt(F,{id:Qt,geometry:W.geometry.geometries[qt],properties:W.properties},le,me);return}throw new Error("Input data is not a valid GeoJSON object.")}for(qt=0;qt<at.length;qt++){var Nr=[];$(at[qt],Nr,He,!0),ht.push(Nr)}}F.push(Ge(Qt,bt,ht,W.properties))}}function nt(F,W){W.push(Ke(F[0])),W.push(ae(F[1])),W.push(0)}function Nt(F,W,le,me){for(var at,bt,He=0,ht=0;ht<F.length;ht++){var Qt=Ke(F[ht][0]),qt=ae(F[ht][1]);W.push(Qt),W.push(qt),W.push(0),ht>0&&(He+=me?(at*qt-Qt*bt)/2:Math.sqrt(Math.pow(Qt-at,2)+Math.pow(qt-bt,2))),at=Qt,bt=qt}var Nr=W.length-3;W[2]=1,function qr(or,Br,Tn,dr){for(var Xr,dn=dr,Kn=Tn-Br>>1,gn=Tn-Br,ur=or[Br],kn=or[Br+1],An=or[Tn],Za=or[Tn+1],ea=Br+3;ea<Tn;ea+=3){var ca=ce(or[ea],or[ea+1],ur,kn,An,Za);if(ca>dn)Xr=ea,dn=ca;else if(ca===dn){var bo=Math.abs(ea-Kn);bo<gn&&(Xr=ea,gn=bo)}}dn>dr&&(Xr-Br>3&&qr(or,Br,Xr,dr),or[Xr+2]=dn,Tn-Xr>3&&qr(or,Xr,Tn,dr))}(W,0,Nr,le),W[Nr+2]=1,W.size=Math.abs(He),W.start=0,W.end=W.size}function $(F,W,le,me){for(var at=0;at<F.length;at++){var bt=[];Nt(F[at],bt,le,me),W.push(bt)}}function Ke(F){return F/360+.5}function ae(F){var W=Math.sin(F*Math.PI/180),le=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return le<0?0:le>1?1:le}function et(F,W,le,me,at,bt,He,ht){if(me/=W,bt>=(le/=W)&&He<me)return F;if(He<le||bt>=me)return null;for(var Qt=[],qt=0;qt<F.length;qt++){var Nr=F[qt],qr=Nr.geometry,or=Nr.type,Br=at===0?Nr.minX:Nr.minY,Tn=at===0?Nr.maxX:Nr.maxY;if(Br>=le&&Tn<me)Qt.push(Nr);else if(!(Tn<le||Br>=me)){var dr=[];if(or==="Point"||or==="MultiPoint")jt(qr,dr,le,me,at);else if(or==="LineString")sr(qr,dr,le,me,at,!1,ht.lineMetrics);else if(or==="MultiLineString")mt(qr,dr,le,me,at,!1);else if(or==="Polygon")mt(qr,dr,le,me,at,!0);else if(or==="MultiPolygon")for(var Xr=0;Xr<qr.length;Xr++){var dn=[];mt(qr[Xr],dn,le,me,at,!0),dn.length&&dr.push(dn)}if(dr.length){if(ht.lineMetrics&&or==="LineString"){for(Xr=0;Xr<dr.length;Xr++)Qt.push(Ge(Nr.id,or,dr[Xr],Nr.tags));continue}or!=="LineString"&&or!=="MultiLineString"||(dr.length===1?(or="LineString",dr=dr[0]):or="MultiLineString"),or!=="Point"&&or!=="MultiPoint"||(or=dr.length===3?"Point":"MultiPoint"),Qt.push(Ge(Nr.id,or,dr,Nr.tags))}}}return Qt.length?Qt:null}function jt(F,W,le,me,at){for(var bt=0;bt<F.length;bt+=3){var He=F[bt+at];He>=le&&He<=me&&(W.push(F[bt]),W.push(F[bt+1]),W.push(F[bt+2]))}}function sr(F,W,le,me,at,bt,He){for(var ht,Qt,qt=ft(F),Nr=at===0?vt:Oe,qr=F.start,or=0;or<F.length-3;or+=3){var Br=F[or],Tn=F[or+1],dr=F[or+2],Xr=F[or+3],dn=F[or+4],Kn=at===0?Br:Tn,gn=at===0?Xr:dn,ur=!1;He&&(ht=Math.sqrt(Math.pow(Br-Xr,2)+Math.pow(Tn-dn,2))),Kn<le?gn>le&&(Qt=Nr(qt,Br,Tn,Xr,dn,le),He&&(qt.start=qr+ht*Qt)):Kn>me?gn<me&&(Qt=Nr(qt,Br,Tn,Xr,dn,me),He&&(qt.start=qr+ht*Qt)):Ct(qt,Br,Tn,dr),gn<le&&Kn>=le&&(Qt=Nr(qt,Br,Tn,Xr,dn,le),ur=!0),gn>me&&Kn<=me&&(Qt=Nr(qt,Br,Tn,Xr,dn,me),ur=!0),!bt&&ur&&(He&&(qt.end=qr+ht*Qt),W.push(qt),qt=ft(F)),He&&(qr+=ht)}var kn=F.length-3;Br=F[kn],Tn=F[kn+1],dr=F[kn+2],(Kn=at===0?Br:Tn)>=le&&Kn<=me&&Ct(qt,Br,Tn,dr),kn=qt.length-3,bt&&kn>=3&&(qt[kn]!==qt[0]||qt[kn+1]!==qt[1])&&Ct(qt,qt[0],qt[1],qt[2]),qt.length&&W.push(qt)}function ft(F){var W=[];return W.size=F.size,W.start=F.start,W.end=F.end,W}function mt(F,W,le,me,at,bt){for(var He=0;He<F.length;He++)sr(F[He],W,le,me,at,bt,!1)}function Ct(F,W,le,me){F.push(W),F.push(le),F.push(me)}function vt(F,W,le,me,at,bt){var He=(bt-W)/(me-W);return F.push(bt),F.push(le+(at-le)*He),F.push(1),He}function Oe(F,W,le,me,at,bt){var He=(bt-le)/(at-le);return F.push(W+(me-W)*He),F.push(bt),F.push(1),He}function ct(F,W){for(var le=[],me=0;me<F.length;me++){var at,bt=F[me],He=bt.type;if(He==="Point"||He==="MultiPoint"||He==="LineString")at=Qe(bt.geometry,W);else if(He==="MultiLineString"||He==="Polygon"){at=[];for(var ht=0;ht<bt.geometry.length;ht++)at.push(Qe(bt.geometry[ht],W))}else if(He==="MultiPolygon")for(at=[],ht=0;ht<bt.geometry.length;ht++){for(var Qt=[],qt=0;qt<bt.geometry[ht].length;qt++)Qt.push(Qe(bt.geometry[ht][qt],W));at.push(Qt)}le.push(Ge(bt.id,He,at,bt.tags))}return le}function Qe(F,W){var le=[];le.size=F.size,F.start!==void 0&&(le.start=F.start,le.end=F.end);for(var me=0;me<F.length;me+=3)le.push(F[me]+W,F[me+1],F[me+2]);return le}function Ft(F,W){if(F.transformed)return F;var le,me,at,bt=1<<F.z,He=F.x,ht=F.y;for(le=0;le<F.features.length;le++){var Qt=F.features[le],qt=Qt.geometry,Nr=Qt.type;if(Qt.geometry=[],Nr===1)for(me=0;me<qt.length;me+=2)Qt.geometry.push(vr(qt[me],qt[me+1],W,bt,He,ht));else for(me=0;me<qt.length;me++){var qr=[];for(at=0;at<qt[me].length;at+=2)qr.push(vr(qt[me][at],qt[me][at+1],W,bt,He,ht));Qt.geometry.push(qr)}}return F.transformed=!0,F}function vr(F,W,le,me,at,bt){return[Math.round(le*(F*me-at)),Math.round(le*(W*me-bt))]}function Vr(F,W,le,me,at){for(var bt=W===at.maxZoom?0:at.tolerance/((1<<W)*at.extent),He={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:le,y:me,z:W,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ht=0;ht<F.length;ht++){He.numFeatures++,lr(He,F[ht],bt,at);var Qt=F[ht].minX,qt=F[ht].minY,Nr=F[ht].maxX,qr=F[ht].maxY;Qt<He.minX&&(He.minX=Qt),qt<He.minY&&(He.minY=qt),Nr>He.maxX&&(He.maxX=Nr),qr>He.maxY&&(He.maxY=qr)}return He}function lr(F,W,le,me){var at=W.geometry,bt=W.type,He=[];if(bt==="Point"||bt==="MultiPoint")for(var ht=0;ht<at.length;ht+=3)He.push(at[ht]),He.push(at[ht+1]),F.numPoints++,F.numSimplified++;else if(bt==="LineString")Nn(He,at,F,le,!1,!1);else if(bt==="MultiLineString"||bt==="Polygon")for(ht=0;ht<at.length;ht++)Nn(He,at[ht],F,le,bt==="Polygon",ht===0);else if(bt==="MultiPolygon")for(var Qt=0;Qt<at.length;Qt++){var qt=at[Qt];for(ht=0;ht<qt.length;ht++)Nn(He,qt[ht],F,le,!0,ht===0)}if(He.length){var Nr=W.tags||null;if(bt==="LineString"&&me.lineMetrics){for(var qr in Nr={},W.tags)Nr[qr]=W.tags[qr];Nr.mapbox_clip_start=at.start/at.size,Nr.mapbox_clip_end=at.end/at.size}var or={geometry:He,type:bt==="Polygon"||bt==="MultiPolygon"?3:bt==="LineString"||bt==="MultiLineString"?2:1,tags:Nr};W.id!==null&&(or.id=W.id),F.features.push(or)}}function Nn(F,W,le,me,at,bt){var He=me*me;if(me>0&&W.size<(at?He:me))le.numPoints+=W.length/3;else{for(var ht=[],Qt=0;Qt<W.length;Qt+=3)(me===0||W[Qt+2]>He)&&(le.numSimplified++,ht.push(W[Qt]),ht.push(W[Qt+1])),le.numPoints++;at&&function(qt,Nr){for(var qr=0,or=0,Br=qt.length,Tn=Br-2;or<Br;Tn=or,or+=2)qr+=(qt[or]-qt[Tn])*(qt[or+1]+qt[Tn+1]);if(qr>0===Nr)for(or=0,Br=qt.length;or<Br/2;or+=2){var dr=qt[or],Xr=qt[or+1];qt[or]=qt[Br-2-or],qt[or+1]=qt[Br-1-or],qt[Br-2-or]=dr,qt[Br-1-or]=Xr}}(ht,bt),F.push(ht)}}function vn(F,W){var le=(W=this.options=function(at,bt){for(var He in bt)at[He]=bt[He];return at}(Object.create(this.options),W)).debug;if(le&&console.time("preprocess data"),W.maxZoom<0||W.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(W.promoteId&&W.generateId)throw new Error("promoteId and generateId cannot be used together.");var me=function(at,bt){var He=[];if(at.type==="FeatureCollection")for(var ht=0;ht<at.features.length;ht++)yt(He,at.features[ht],bt,ht);else yt(He,at.type==="Feature"?at:{geometry:at},bt);return He}(F,W);this.tiles={},this.tileCoords=[],le&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",W.indexMaxZoom,W.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(me=function(at,bt){var He=bt.buffer/bt.extent,ht=at,Qt=et(at,1,-1-He,He,0,-1,2,bt),qt=et(at,1,1-He,2+He,0,-1,2,bt);return(Qt||qt)&&(ht=et(at,1,-He,1+He,0,-1,2,bt)||[],Qt&&(ht=ct(Qt,1).concat(ht)),qt&&(ht=ht.concat(ct(qt,-1)))),ht}(me,W)).length&&this.splitTile(me,0,0,0),le&&(me.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function na(F,W,le){return 32*((1<<F)*le+W)+F}function ha(F,W){var le=F.tileID.canonical;if(!this._geoJSONIndex)return W(null,null);var me=this._geoJSONIndex.getTile(le.z,le.x,le.y);if(!me)return W(null,null);var at=new gt(me.features),bt=ke(at);bt.byteOffset===0&&bt.byteLength===bt.buffer.byteLength||(bt=new Uint8Array(bt)),W(null,{vectorTile:at,rawData:bt.buffer})}At.prototype.load=function(F){var W=this.options,le=W.log,me=W.minZoom,at=W.maxZoom,bt=W.nodeSize;le&&console.time("total time");var He="prepare "+F.length+" points";le&&console.time(He),this.points=F;for(var ht=[],Qt=0;Qt<F.length;Qt++)F[Qt].geometry&&ht.push(xe(F[Qt],Qt));this.trees[at+1]=new rt(ht,I,q,bt,Float32Array),le&&console.timeEnd(He);for(var qt=at;qt>=me;qt--){var Nr=+Date.now();ht=this._cluster(ht,qt),this.trees[qt]=new rt(ht,I,q,bt,Float32Array),le&&console.log("z%d: %d clusters in %dms",qt,ht.length,+Date.now()-Nr)}return le&&console.timeEnd("total time"),this},At.prototype.getClusters=function(F,W){var le=((F[0]+180)%360+360)%360-180,me=Math.max(-90,Math.min(90,F[1])),at=F[2]===180?180:((F[2]+180)%360+360)%360-180,bt=Math.max(-90,Math.min(90,F[3]));if(F[2]-F[0]>=360)le=-180,at=180;else if(le>at){var He=this.getClusters([le,me,180,bt],W),ht=this.getClusters([-180,me,at,bt],W);return He.concat(ht)}for(var Qt=this.trees[this._limitZoom(W)],qt=[],Nr=0,qr=Qt.range(Pe(le),dt(bt),Pe(at),dt(me));Nr<qr.length;Nr+=1){var or=Qt.points[qr[Nr]];qt.push(or.numPoints?Ve(or):this.points[or.index])}return qt},At.prototype.getChildren=function(F){var W=this._getOriginId(F),le=this._getOriginZoom(F),me="No cluster with the specified id.",at=this.trees[le];if(!at)throw new Error(me);var bt=at.points[W];if(!bt)throw new Error(me);for(var He=this.options.radius/(this.options.extent*Math.pow(2,le-1)),ht=[],Qt=0,qt=at.within(bt.x,bt.y,He);Qt<qt.length;Qt+=1){var Nr=at.points[qt[Qt]];Nr.parentId===F&&ht.push(Nr.numPoints?Ve(Nr):this.points[Nr.index])}if(ht.length===0)throw new Error(me);return ht},At.prototype.getLeaves=function(F,W,le){var me=[];return this._appendLeaves(me,F,W=W||10,le=le||0,0),me},At.prototype.getTile=function(F,W,le){var me=this.trees[this._limitZoom(F)],at=Math.pow(2,F),bt=this.options,He=bt.radius/bt.extent,ht=(le-He)/at,Qt=(le+1+He)/at,qt={features:[]};return this._addTileFeatures(me.range((W-He)/at,ht,(W+1+He)/at,Qt),me.points,W,le,at,qt),W===0&&this._addTileFeatures(me.range(1-He/at,ht,1,Qt),me.points,at,le,at,qt),W===at-1&&this._addTileFeatures(me.range(0,ht,He/at,Qt),me.points,-1,le,at,qt),qt.features.length?qt:null},At.prototype.getClusterExpansionZoom=function(F){for(var W=this._getOriginZoom(F)-1;W<=this.options.maxZoom;){var le=this.getChildren(F);if(W++,le.length!==1)break;F=le[0].properties.cluster_id}return W},At.prototype._appendLeaves=function(F,W,le,me,at){for(var bt=0,He=this.getChildren(W);bt<He.length;bt+=1){var ht=He[bt],Qt=ht.properties;if(Qt&&Qt.cluster?at+Qt.point_count<=me?at+=Qt.point_count:at=this._appendLeaves(F,Qt.cluster_id,le,me,at):at<me?at++:F.push(ht),F.length===le)break}return at},At.prototype._addTileFeatures=function(F,W,le,me,at,bt){for(var He=0,ht=F;He<ht.length;He+=1){var Qt=W[ht[He]],qt=Qt.numPoints,Nr={type:1,geometry:[[Math.round(this.options.extent*(Qt.x*at-le)),Math.round(this.options.extent*(Qt.y*at-me))]],tags:qt?lt(Qt):this.points[Qt.index].properties},qr=void 0;qt?qr=Qt.id:this.options.generateId?qr=Qt.index:this.points[Qt.index].id&&(qr=this.points[Qt.index].id),qr!==void 0&&(Nr.id=qr),bt.features.push(Nr)}},At.prototype._limitZoom=function(F){return Math.max(this.options.minZoom,Math.min(+F,this.options.maxZoom+1))},At.prototype._cluster=function(F,W){for(var le=[],me=this.options,at=me.reduce,bt=me.minPoints,He=me.radius/(me.extent*Math.pow(2,W)),ht=0;ht<F.length;ht++){var Qt=F[ht];if(!(Qt.zoom<=W)){Qt.zoom=W;for(var qt=this.trees[W+1],Nr=qt.within(Qt.x,Qt.y,He),qr=Qt.numPoints||1,or=qr,Br=0,Tn=Nr;Br<Tn.length;Br+=1){var dr=qt.points[Tn[Br]];dr.zoom>W&&(or+=dr.numPoints||1)}if(or>=bt){for(var Xr=Qt.x*qr,dn=Qt.y*qr,Kn=at&&qr>1?this._map(Qt,!0):null,gn=(ht<<5)+(W+1)+this.points.length,ur=0,kn=Nr;ur<kn.length;ur+=1){var An=qt.points[kn[ur]];if(!(An.zoom<=W)){An.zoom=W;var Za=An.numPoints||1;Xr+=An.x*Za,dn+=An.y*Za,An.parentId=gn,at&&(Kn||(Kn=this._map(Qt,!0)),at(Kn,this._map(An)))}}Qt.parentId=gn,le.push(be(Xr/or,dn/or,gn,or,Kn))}else if(le.push(Qt),or>1)for(var ea=0,ca=Nr;ea<ca.length;ea+=1){var bo=qt.points[ca[ea]];bo.zoom<=W||(bo.zoom=W,le.push(bo))}}}return le},At.prototype._getOriginId=function(F){return F-this.points.length>>5},At.prototype._getOriginZoom=function(F){return(F-this.points.length)%32},At.prototype._map=function(F,W){if(F.numPoints)return W?w({},F.properties):F.properties;var le=this.points[F.index].properties,me=this.options.map(le);return W&&me===le?w({},me):me},vn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},vn.prototype.splitTile=function(F,W,le,me,at,bt,He){for(var ht=[F,W,le,me],Qt=this.options,qt=Qt.debug;ht.length;){me=ht.pop(),le=ht.pop(),W=ht.pop(),F=ht.pop();var Nr=1<<W,qr=na(W,le,me),or=this.tiles[qr];if(!or&&(qt>1&&console.time("creation"),or=this.tiles[qr]=Vr(F,W,le,me,Qt),this.tileCoords.push({z:W,x:le,y:me}),qt)){qt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",W,le,me,or.numFeatures,or.numPoints,or.numSimplified),console.timeEnd("creation"));var Br="z"+W;this.stats[Br]=(this.stats[Br]||0)+1,this.total++}if(or.source=F,at){if(W===Qt.maxZoom||W===at)continue;var Tn=1<<at-W;if(le!==Math.floor(bt/Tn)||me!==Math.floor(He/Tn))continue}else if(W===Qt.indexMaxZoom||or.numPoints<=Qt.indexMaxPoints)continue;if(or.source=null,F.length!==0){qt>1&&console.time("clipping");var dr,Xr,dn,Kn,gn,ur,kn=.5*Qt.buffer/Qt.extent,An=.5-kn,Za=.5+kn,ea=1+kn;dr=Xr=dn=Kn=null,gn=et(F,Nr,le-kn,le+Za,0,or.minX,or.maxX,Qt),ur=et(F,Nr,le+An,le+ea,0,or.minX,or.maxX,Qt),F=null,gn&&(dr=et(gn,Nr,me-kn,me+Za,1,or.minY,or.maxY,Qt),Xr=et(gn,Nr,me+An,me+ea,1,or.minY,or.maxY,Qt),gn=null),ur&&(dn=et(ur,Nr,me-kn,me+Za,1,or.minY,or.maxY,Qt),Kn=et(ur,Nr,me+An,me+ea,1,or.minY,or.maxY,Qt),ur=null),qt>1&&console.timeEnd("clipping"),ht.push(dr||[],W+1,2*le,2*me),ht.push(Xr||[],W+1,2*le,2*me+1),ht.push(dn||[],W+1,2*le+1,2*me),ht.push(Kn||[],W+1,2*le+1,2*me+1)}}},vn.prototype.getTile=function(F,W,le){var me=this.options,at=me.extent,bt=me.debug;if(F<0||F>24)return null;var He=1<<F,ht=na(F,W=(W%He+He)%He,le);if(this.tiles[ht])return Ft(this.tiles[ht],at);bt>1&&console.log("drilling down to z%d-%d-%d",F,W,le);for(var Qt,qt=F,Nr=W,qr=le;!Qt&&qt>0;)qt--,Nr=Math.floor(Nr/2),qr=Math.floor(qr/2),Qt=this.tiles[na(qt,Nr,qr)];return Qt&&Qt.source?(bt>1&&console.log("found parent tile z%d-%d-%d",qt,Nr,qr),bt>1&&console.time("drilling down"),this.splitTile(Qt.source,qt,Nr,qr,F,W,le),bt>1&&console.timeEnd("drilling down"),this.tiles[ht]?Ft(this.tiles[ht],at):null):null};var Zn=function(F){function W(le,me,at,bt){F.call(this,le,me,at,ha),bt&&(this.loadGeoJSON=bt)}return F&&(W.__proto__=F),(W.prototype=Object.create(F&&F.prototype)).constructor=W,W.prototype.loadData=function(le,me){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=me,this._pendingLoadDataParams=le,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},W.prototype._loadData=function(){var le=this;if(this._pendingCallback&&this._pendingLoadDataParams){var me=this._pendingCallback,at=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var bt=!!(at&&at.request&&at.request.collectResourceTiming)&&new o.RequestPerformance(at.request);this.loadGeoJSON(at,function(He,ht){if(He||!ht)return me(He);if(typeof ht!="object")return me(new Error("Input data given to '"+at.source+"' is not a valid GeoJSON object."));!function or(Br,Tn){var dr,Xr=Br&&Br.type;if(Xr==="FeatureCollection")for(dr=0;dr<Br.features.length;dr++)or(Br.features[dr],Tn);else if(Xr==="GeometryCollection")for(dr=0;dr<Br.geometries.length;dr++)or(Br.geometries[dr],Tn);else if(Xr==="Feature")or(Br.geometry,Tn);else if(Xr==="Polygon")pt(Br.coordinates,Tn);else if(Xr==="MultiPolygon")for(dr=0;dr<Br.coordinates.length;dr++)pt(Br.coordinates[dr],Tn);return Br}(ht,!0);try{if(at.filter){var Qt=o.createExpression(at.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Qt.result==="error")throw new Error(Qt.value.map(function(or){return or.key+": "+or.message}).join(", "));var qt=ht.features.filter(function(or){return Qt.value.evaluate({zoom:0},or)});ht={type:"FeatureCollection",features:qt}}le._geoJSONIndex=at.cluster?new At(function(or){var Br=or.superclusterOptions,Tn=or.clusterProperties;if(!Tn||!Br)return Br;for(var dr={},Xr={},dn={accumulated:null,zoom:0},Kn={properties:null},gn=Object.keys(Tn),ur=0,kn=gn;ur<kn.length;ur+=1){var An=kn[ur],Za=Tn[An],ea=Za[0],ca=o.createExpression(Za[1]),bo=o.createExpression(typeof ea=="string"?[ea,["accumulated"],["get",An]]:ea);dr[An]=ca.value,Xr[An]=bo.value}return Br.map=function(Ri){Kn.properties=Ri;for(var va={},ii=0,Ia=gn;ii<Ia.length;ii+=1){var Ln=Ia[ii];va[Ln]=dr[Ln].evaluate(dn,Kn)}return va},Br.reduce=function(Ri,va){Kn.properties=va;for(var ii=0,Ia=gn;ii<Ia.length;ii+=1){var Ln=Ia[ii];dn.accumulated=Ri[Ln],Ri[Ln]=Xr[Ln].evaluate(dn,Kn)}},Br}(at)).load(ht.features):function(or,Br){return new vn(or,Br)}(ht,at.geojsonVtOptions)}catch(or){return me(or)}le.loaded={};var Nr={};if(bt){var qr=bt.finish();qr&&(Nr.resourceTiming={},Nr.resourceTiming[at.source]=JSON.parse(JSON.stringify(qr)))}me(null,Nr)})}},W.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},W.prototype.reloadTile=function(le,me){var at=this.loaded;return at&&at[le.uid]?F.prototype.reloadTile.call(this,le,me):this.loadTile(le,me)},W.prototype.loadGeoJSON=function(le,me){if(le.request)o.getJSON(le.request,me);else{if(typeof le.data!="string")return me(new Error("Input data given to '"+le.source+"' is not a valid GeoJSON object."));try{return me(null,JSON.parse(le.data))}catch(at){return me(new Error("Input data given to '"+le.source+"' is not a valid GeoJSON object."))}}},W.prototype.removeSource=function(le,me){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),me()},W.prototype.getClusterExpansionZoom=function(le,me){try{me(null,this._geoJSONIndex.getClusterExpansionZoom(le.clusterId))}catch(at){me(at)}},W.prototype.getClusterChildren=function(le,me){try{me(null,this._geoJSONIndex.getChildren(le.clusterId))}catch(at){me(at)}},W.prototype.getClusterLeaves=function(le,me){try{me(null,this._geoJSONIndex.getLeaves(le.clusterId,le.limit,le.offset))}catch(at){me(at)}},W}(Ze),Hn=function(W){var le=this;this.self=W,this.actor=new o.Actor(W,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:Ze,geojson:Zn},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(me,at){if(le.workerSourceTypes[me])throw new Error('Worker source with name "'+me+'" already registered.');le.workerSourceTypes[me]=at},this.self.registerRTLTextPlugin=function(me){if(o.plugin.isParsed())throw new Error("RTL text plugin already registered.");o.plugin.applyArabicShaping=me.applyArabicShaping,o.plugin.processBidirectionalText=me.processBidirectionalText,o.plugin.processStyledBidirectionalText=me.processStyledBidirectionalText}};return Hn.prototype.setReferrer=function(F,W){this.referrer=W},Hn.prototype.setImages=function(F,W,le){for(var me in this.availableImages[F]=W,this.workerSources[F]){var at=this.workerSources[F][me];for(var bt in at)at[bt].availableImages=W}le()},Hn.prototype.setLayers=function(F,W,le){this.getLayerIndex(F).replace(W),le()},Hn.prototype.updateLayers=function(F,W,le){this.getLayerIndex(F).update(W.layers,W.removedIds),le()},Hn.prototype.loadTile=function(F,W,le){this.getWorkerSource(F,W.type,W.source).loadTile(W,le)},Hn.prototype.loadDEMTile=function(F,W,le){this.getDEMWorkerSource(F,W.source).loadTile(W,le)},Hn.prototype.reloadTile=function(F,W,le){this.getWorkerSource(F,W.type,W.source).reloadTile(W,le)},Hn.prototype.abortTile=function(F,W,le){this.getWorkerSource(F,W.type,W.source).abortTile(W,le)},Hn.prototype.removeTile=function(F,W,le){this.getWorkerSource(F,W.type,W.source).removeTile(W,le)},Hn.prototype.removeDEMTile=function(F,W){this.getDEMWorkerSource(F,W.source).removeTile(W)},Hn.prototype.removeSource=function(F,W,le){if(this.workerSources[F]&&this.workerSources[F][W.type]&&this.workerSources[F][W.type][W.source]){var me=this.workerSources[F][W.type][W.source];delete this.workerSources[F][W.type][W.source],me.removeSource!==void 0?me.removeSource(W,le):le()}},Hn.prototype.loadWorkerSource=function(F,W,le){try{this.self.importScripts(W.url),le()}catch(me){le(me.toString())}},Hn.prototype.syncRTLPluginState=function(F,W,le){try{o.plugin.setState(W);var me=o.plugin.getPluginURL();if(o.plugin.isLoaded()&&!o.plugin.isParsed()&&me!=null){this.self.importScripts(me);var at=o.plugin.isParsed();le(at?void 0:new Error("RTL Text Plugin failed to import scripts from "+me),at)}}catch(bt){le(bt.toString())}},Hn.prototype.getAvailableImages=function(F){var W=this.availableImages[F];return W||(W=[]),W},Hn.prototype.getLayerIndex=function(F){var W=this.layerIndexes[F];return W||(W=this.layerIndexes[F]=new K),W},Hn.prototype.getWorkerSource=function(F,W,le){var me=this;return this.workerSources[F]||(this.workerSources[F]={}),this.workerSources[F][W]||(this.workerSources[F][W]={}),this.workerSources[F][W][le]||(this.workerSources[F][W][le]=new this.workerSourceTypes[W]({send:function(bt,He,ht){me.actor.send(bt,He,ht,F)}},this.getLayerIndex(F),this.getAvailableImages(F))),this.workerSources[F][W][le]},Hn.prototype.getDEMWorkerSource=function(F,W){return this.demWorkerSources[F]||(this.demWorkerSources[F]={}),this.demWorkerSources[F][W]||(this.demWorkerSources[F][W]=new we),this.demWorkerSources[F][W]},Hn.prototype.enforceCacheSizeLimit=function(F,W){o.enforceCacheSizeLimit(W)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Hn(self)),Hn}),z(["./shared"],function(o){"use strict";var Z=o.createCommonjsModule(function(s){function a(b){return!n(b)}function n(b){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var R,j,ue=new Blob([""],{type:"text/javascript"}),Te=URL.createObjectURL(ue);try{j=new Worker(Te),R=!0}catch(Ye){R=!1}return j&&j.terminate(),URL.revokeObjectURL(Te),R}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var R=document.createElement("canvas");R.width=R.height=1;var j=R.getContext("2d");if(!j)return!1;var ue=j.getImageData(0,0,1,1);return ue&&ue.width===R.width}()?(l[O=b&&b.failIfMajorPerformanceCaveat]===void 0&&(l[O]=function(R){var j=function(Te){var Ye=document.createElement("canvas"),qe=Object.create(a.webGLContextAttributes);return qe.failIfMajorPerformanceCaveat=Te,Ye.probablySupportsContext?Ye.probablySupportsContext("webgl",qe)||Ye.probablySupportsContext("experimental-webgl",qe):Ye.supportsContext?Ye.supportsContext("webgl",qe)||Ye.supportsContext("experimental-webgl",qe):Ye.getContext("webgl",qe)||Ye.getContext("experimental-webgl",qe)}(R);if(!j)return!1;var ue=j.createShader(j.VERTEX_SHADER);return!(!ue||j.isContextLost())&&(j.shaderSource(ue,"void main() {}"),j.compileShader(ue),j.getShaderParameter(ue,j.COMPILE_STATUS)===!0)}(O)),l[O]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var O}s.exports?s.exports=a:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=a,window.mapboxgl.notSupportedReason=n);var l={};a.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),D={create:function(a,n,l){var b=o.window.document.createElement(a);return n!==void 0&&(b.className=n),l&&l.appendChild(b),b},createNS:function(a,n){return o.window.document.createElementNS(a,n)}},K=o.window.document&&o.window.document.documentElement.style;function re(s){if(!K)return s[0];for(var a=0;a<s.length;a++)if(s[a]in K)return s[a];return s[0]}var de,Y=re(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);D.disableDrag=function(){K&&Y&&(de=K[Y],K[Y]="none")},D.enableDrag=function(){K&&Y&&(K[Y]=de)};var Fe=re(["transform","WebkitTransform"]);D.setTransform=function(s,a){s.style[Fe]=a};var Ze=!1;try{var ye=Object.defineProperty({},"passive",{get:function(){Ze=!0}});o.window.addEventListener("test",ye,ye),o.window.removeEventListener("test",ye,ye)}catch(s){Ze=!1}D.addEventListener=function(s,a,n,l){l===void 0&&(l={}),s.addEventListener(a,n,"passive"in l&&Ze?l:l.capture)},D.removeEventListener=function(s,a,n,l){l===void 0&&(l={}),s.removeEventListener(a,n,"passive"in l&&Ze?l:l.capture)};var we=function s(a){a.preventDefault(),a.stopPropagation(),o.window.removeEventListener("click",s,!0)};function pt(s){var a=s.userImage;return!!(a&&a.render&&a.render())&&(s.data.replace(new Uint8Array(a.data.buffer)),!0)}D.suppressClick=function(){o.window.addEventListener("click",we,!0),o.window.setTimeout(function(){o.window.removeEventListener("click",we,!0)},0)},D.mousePos=function(s,a){var n=s.getBoundingClientRect();return new o.Point(a.clientX-n.left-s.clientLeft,a.clientY-n.top-s.clientTop)},D.touchPos=function(s,a){for(var n=s.getBoundingClientRect(),l=[],b=0;b<a.length;b++)l.push(new o.Point(a[b].clientX-n.left-s.clientLeft,a[b].clientY-n.top-s.clientTop));return l},D.mouseButton=function(s){return o.window.InstallTrigger!==void 0&&s.button===2&&s.ctrlKey&&o.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:s.button},D.remove=function(s){s.parentNode&&s.parentNode.removeChild(s)};var je=function(s){function a(){s.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.RGBAImage({width:1,height:1}),this.dirty=!0}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.isLoaded=function(){return this.loaded},a.prototype.setLoaded=function(n){if(this.loaded!==n&&(this.loaded=n,n)){for(var l=0,b=this.requestors;l<b.length;l+=1){var O=b[l];this._notify(O.ids,O.callback)}this.requestors=[]}},a.prototype.getImage=function(n){return this.images[n]},a.prototype.addImage=function(n,l){this._validate(n,l)&&(this.images[n]=l)},a.prototype._validate=function(n,l){var b=!0;return this._validateStretch(l.stretchX,l.data&&l.data.width)||(this.fire(new o.ErrorEvent(new Error('Image "'+n+'" has invalid "stretchX" value'))),b=!1),this._validateStretch(l.stretchY,l.data&&l.data.height)||(this.fire(new o.ErrorEvent(new Error('Image "'+n+'" has invalid "stretchY" value'))),b=!1),this._validateContent(l.content,l)||(this.fire(new o.ErrorEvent(new Error('Image "'+n+'" has invalid "content" value'))),b=!1),b},a.prototype._validateStretch=function(n,l){if(!n)return!0;for(var b=0,O=0,R=n;O<R.length;O+=1){var j=R[O];if(j[0]<b||j[1]<j[0]||l<j[1])return!1;b=j[1]}return!0},a.prototype._validateContent=function(n,l){return!(n&&(n.length!==4||n[0]<0||l.data.width<n[0]||n[1]<0||l.data.height<n[1]||n[2]<0||l.data.width<n[2]||n[3]<0||l.data.height<n[3]||n[2]<n[0]||n[3]<n[1]))},a.prototype.updateImage=function(n,l){l.version=this.images[n].version+1,this.images[n]=l,this.updatedImages[n]=!0},a.prototype.removeImage=function(n){var l=this.images[n];delete this.images[n],delete this.patterns[n],l.userImage&&l.userImage.onRemove&&l.userImage.onRemove()},a.prototype.listImages=function(){return Object.keys(this.images)},a.prototype.getImages=function(n,l){var b=!0;if(!this.isLoaded())for(var O=0,R=n;O<R.length;O+=1)this.images[R[O]]||(b=!1);this.isLoaded()||b?this._notify(n,l):this.requestors.push({ids:n,callback:l})},a.prototype._notify=function(n,l){for(var b={},O=0,R=n;O<R.length;O+=1){var j=R[O];this.images[j]||this.fire(new o.Event("styleimagemissing",{id:j}));var ue=this.images[j];ue?b[j]={data:ue.data.clone(),pixelRatio:ue.pixelRatio,sdf:ue.sdf,version:ue.version,stretchX:ue.stretchX,stretchY:ue.stretchY,content:ue.content,hasRenderCallback:Boolean(ue.userImage&&ue.userImage.render)}:o.warnOnce('Image "'+j+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}l(null,b)},a.prototype.getPixelSize=function(){var n=this.atlasImage;return{width:n.width,height:n.height}},a.prototype.getPattern=function(n){var l=this.patterns[n],b=this.getImage(n);if(!b)return null;if(l&&l.position.version===b.version)return l.position;if(l)l.position.version=b.version;else{var O={w:b.data.width+2,h:b.data.height+2,x:0,y:0},R=new o.ImagePosition(O,b);this.patterns[n]={bin:O,position:R}}return this._updatePatternAtlas(),this.patterns[n].position},a.prototype.bind=function(n){var l=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.Texture(n,this.atlasImage,l.RGBA),this.atlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE)},a.prototype._updatePatternAtlas=function(){var n=[];for(var l in this.patterns)n.push(this.patterns[l].bin);var b=o.potpack(n),O=b.w,R=b.h,j=this.atlasImage;for(var ue in j.resize({width:O||1,height:R||1}),this.patterns){var Te=this.patterns[ue].bin,Ye=Te.x+1,qe=Te.y+1,tt=this.images[ue].data,Dt=tt.width,Rt=tt.height;o.RGBAImage.copy(tt,j,{x:0,y:0},{x:Ye,y:qe},{width:Dt,height:Rt}),o.RGBAImage.copy(tt,j,{x:0,y:Rt-1},{x:Ye,y:qe-1},{width:Dt,height:1}),o.RGBAImage.copy(tt,j,{x:0,y:0},{x:Ye,y:qe+Rt},{width:Dt,height:1}),o.RGBAImage.copy(tt,j,{x:Dt-1,y:0},{x:Ye-1,y:qe},{width:1,height:Rt}),o.RGBAImage.copy(tt,j,{x:0,y:0},{x:Ye+Dt,y:qe},{width:1,height:Rt})}this.dirty=!0},a.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},a.prototype.dispatchRenderCallbacks=function(n){for(var l=0,b=n;l<b.length;l+=1){var O=b[l];if(!this.callbackDispatchedThisFrame[O]){this.callbackDispatchedThisFrame[O]=!0;var R=this.images[O];pt(R)&&this.updateImage(O,R)}}},a}(o.Evented),Tt=Je,Xe=Je,gt=1e20;function Je(s,a,n,l,b,O){this.fontSize=s||24,this.buffer=a===void 0?3:a,this.cutoff=l||.25,this.fontFamily=b||"sans-serif",this.fontWeight=O||"normal",this.radius=n||8;var R=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=R,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(R*R),this.gridInner=new Float64Array(R*R),this.f=new Float64Array(R),this.d=new Float64Array(R),this.z=new Float64Array(R+1),this.v=new Int16Array(R),this.middle=Math.round(R/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Et(s,a,n,l,b,O,R){for(var j=0;j<a;j++){for(var ue=0;ue<n;ue++)l[ue]=s[ue*a+j];for(_t(l,b,O,R,n),ue=0;ue<n;ue++)s[ue*a+j]=b[ue]}for(ue=0;ue<n;ue++){for(j=0;j<a;j++)l[j]=s[ue*a+j];for(_t(l,b,O,R,a),j=0;j<a;j++)s[ue*a+j]=Math.sqrt(b[j])}}function _t(s,a,n,l,b){n[0]=0,l[0]=-gt,l[1]=+gt;for(var O=1,R=0;O<b;O++){for(var j=(s[O]+O*O-(s[n[R]]+n[R]*n[R]))/(2*O-2*n[R]);j<=l[R];)R--,j=(s[O]+O*O-(s[n[R]]+n[R]*n[R]))/(2*O-2*n[R]);n[++R]=O,l[R]=j,l[R+1]=+gt}for(O=0,R=0;O<b;O++){for(;l[R+1]<O;)R++;a[O]=(O-n[R])*(O-n[R])+s[n[R]]}}Je.prototype.draw=function(s){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(s,this.buffer,this.middle);for(var a=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),l=0;l<this.size*this.size;l++){var b=a.data[4*l+3]/255;this.gridOuter[l]=b===1?0:b===0?gt:Math.pow(Math.max(0,.5-b),2),this.gridInner[l]=b===1?gt:b===0?0:Math.pow(Math.max(0,b-.5),2)}for(Et(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),Et(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),l=0;l<this.size*this.size;l++)n[l]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[l]-this.gridInner[l])/this.radius+this.cutoff))));return n},Tt.default=Xe;var Ne=function(a,n){this.requestManager=a,this.localIdeographFontFamily=n,this.entries={}};Ne.prototype.setURL=function(s){this.url=s},Ne.prototype.getGlyphs=function(s,a){var n=this,l=[];for(var b in s)for(var O=0,R=s[b];O<R.length;O+=1)l.push({stack:b,id:R[O]});o.asyncAll(l,function(j,ue){var Te=j.stack,Ye=j.id,qe=n.entries[Te];qe||(qe=n.entries[Te]={glyphs:{},requests:{},ranges:{}});var tt=qe.glyphs[Ye];if(tt===void 0){if(tt=n._tinySDF(qe,Te,Ye))return qe.glyphs[Ye]=tt,void ue(null,{stack:Te,id:Ye,glyph:tt});var Dt=Math.floor(Ye/256);if(256*Dt>65535)ue(new Error("glyphs > 65535 not supported"));else if(qe.ranges[Dt])ue(null,{stack:Te,id:Ye,glyph:tt});else{var Rt=qe.requests[Dt];Rt||(Rt=qe.requests[Dt]=[],Ne.loadGlyphRange(Te,Dt,n.url,n.requestManager,function(Wt,kt){if(kt){for(var zt in kt)n._doesCharSupportLocalGlyph(+zt)||(qe.glyphs[+zt]=kt[+zt]);qe.ranges[Dt]=!0}for(var nr=0,Jt=Rt;nr<Jt.length;nr+=1)(0,Jt[nr])(Wt,kt);delete qe.requests[Dt]})),Rt.push(function(Wt,kt){Wt?ue(Wt):kt&&ue(null,{stack:Te,id:Ye,glyph:kt[Ye]||null})})}}else ue(null,{stack:Te,id:Ye,glyph:tt})},function(j,ue){if(j)a(j);else if(ue){for(var Te={},Ye=0,qe=ue;Ye<qe.length;Ye+=1){var tt=qe[Ye],Dt=tt.stack,Rt=tt.id,Wt=tt.glyph;(Te[Dt]||(Te[Dt]={}))[Rt]=Wt&&{id:Wt.id,bitmap:Wt.bitmap.clone(),metrics:Wt.metrics}}a(null,Te)}})},Ne.prototype._doesCharSupportLocalGlyph=function(s){return!!this.localIdeographFontFamily&&(o.isChar["CJK Unified Ideographs"](s)||o.isChar["Hangul Syllables"](s)||o.isChar.Hiragana(s)||o.isChar.Katakana(s))},Ne.prototype._tinySDF=function(s,a,n){var l=this.localIdeographFontFamily;if(l&&this._doesCharSupportLocalGlyph(n)){var b=s.tinySDF;if(!b){var O="400";/bold/i.test(a)?O="900":/medium/i.test(a)?O="500":/light/i.test(a)&&(O="200"),b=s.tinySDF=new Ne.TinySDF(24,3,8,.25,l,O)}return{id:n,bitmap:new o.AlphaImage({width:30,height:30},b.draw(String.fromCharCode(n))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Ne.loadGlyphRange=function(s,a,n,l,b){var O=256*a,R=O+255,j=l.transformRequest(l.normalizeGlyphsURL(n).replace("{fontstack}",s).replace("{range}",O+"-"+R),o.ResourceType.Glyphs);o.getArrayBuffer(j,function(ue,Te){if(ue)b(ue);else if(Te){for(var Ye={},qe=0,tt=o.parseGlyphPBF(Te);qe<tt.length;qe+=1){var Dt=tt[qe];Ye[Dt.id]=Dt}b(null,Ye)}})},Ne.TinySDF=Tt;var ke=function(){this.specification=o.styleSpec.light.position};ke.prototype.possiblyEvaluate=function(s,a){return o.sphericalToCartesian(s.expression.evaluate(a))},ke.prototype.interpolate=function(s,a,n){return{x:o.number(s.x,a.x,n),y:o.number(s.y,a.y,n),z:o.number(s.z,a.z,n)}};var Ue=new o.Properties({anchor:new o.DataConstantProperty(o.styleSpec.light.anchor),position:new ke,color:new o.DataConstantProperty(o.styleSpec.light.color),intensity:new o.DataConstantProperty(o.styleSpec.light.intensity)}),st=function(s){function a(n){s.call(this),this._transitionable=new o.Transitionable(Ue),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getLight=function(){return this._transitionable.serialize()},a.prototype.setLight=function(n,l){if(l===void 0&&(l={}),!this._validate(o.validateLight,n,l))for(var b in n){var O=n[b];o.endsWith(b,"-transition")?this._transitionable.setTransition(b.slice(0,-"-transition".length),O):this._transitionable.setValue(b,O)}},a.prototype.updateTransitions=function(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)},a.prototype.hasTransition=function(){return this._transitioning.hasTransition()},a.prototype.recalculate=function(n){this.properties=this._transitioning.possiblyEvaluate(n)},a.prototype._validate=function(n,l,b){return(!b||b.validate!==!1)&&o.emitValidationErrors(this,n.call(o.validateStyle,o.extend({value:l,style:{glyphs:!0,sprite:!0},styleSpec:o.styleSpec})))},a}(o.Evented),Le=function(a,n){this.width=a,this.height=n,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};Le.prototype.getDash=function(s,a){var n=s.join(",")+String(a);return this.dashEntry[n]||(this.dashEntry[n]=this.addDash(s,a)),this.dashEntry[n]},Le.prototype.getDashRanges=function(s,a,n){var l=[],b=s.length%2==1?-s[s.length-1]*n:0,O=s[0]*n,R=!0;l.push({left:b,right:O,isDash:R,zeroLength:s[0]===0});for(var j=s[0],ue=1;ue<s.length;ue++){var Te=s[ue];l.push({left:b=j*n,right:O=(j+=Te)*n,isDash:R=!R,zeroLength:Te===0})}return l},Le.prototype.addRoundDash=function(s,a,n){for(var l=a/2,b=-n;b<=n;b++)for(var O=this.width*(this.nextRow+n+b),R=0,j=s[R],ue=0;ue<this.width;ue++){ue/j.right>1&&(j=s[++R]);var Te=Math.abs(ue-j.left),Ye=Math.abs(ue-j.right),qe=Math.min(Te,Ye),tt=void 0,Dt=b/n*(l+1);if(j.isDash){var Rt=l-Math.abs(Dt);tt=Math.sqrt(qe*qe+Rt*Rt)}else tt=l-Math.sqrt(qe*qe+Dt*Dt);this.data[O+ue]=Math.max(0,Math.min(255,tt+128))}},Le.prototype.addRegularDash=function(s){for(var a=s.length-1;a>=0;--a){var n=s[a],l=s[a+1];n.zeroLength?s.splice(a,1):l&&l.isDash===n.isDash&&(l.left=n.left,s.splice(a,1))}var b=s[0],O=s[s.length-1];b.isDash===O.isDash&&(b.left=O.left-this.width,O.right=b.right+this.width);for(var R=this.width*this.nextRow,j=0,ue=s[j],Te=0;Te<this.width;Te++){Te/ue.right>1&&(ue=s[++j]);var Ye=Math.abs(Te-ue.left),qe=Math.abs(Te-ue.right),tt=Math.min(Ye,qe);this.data[R+Te]=Math.max(0,Math.min(255,(ue.isDash?tt:-tt)+128))}},Le.prototype.addDash=function(s,a){var n=a?7:0,l=2*n+1;if(this.nextRow+l>this.height)return o.warnOnce("LineAtlas out of space"),null;for(var b=0,O=0;O<s.length;O++)b+=s[O];if(b!==0){var R=this.width/b,j=this.getDashRanges(s,this.width,R);a?this.addRoundDash(j,R,n):this.addRegularDash(j)}var ue={y:(this.nextRow+n+.5)/this.height,height:2*n/this.height,width:b};return this.nextRow+=l,this.dirty=!0,ue},Le.prototype.bind=function(s){var a=s.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))};var ut=function s(a,n){this.workerPool=a,this.actors=[],this.currentActor=0,this.id=o.uniqueId();for(var l=this.workerPool.acquire(this.id),b=0;b<l.length;b++){var O=new s.Actor(l[b],n,this.id);O.name="Worker "+b,this.actors.push(O)}};function Vt(s,a,n){var l=function(O,R){if(O)return n(O);if(R){var j=o.pick(o.extend(R,s),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);R.vector_layers&&(j.vectorLayers=R.vector_layers,j.vectorLayerIds=j.vectorLayers.map(function(ue){return ue.id})),j.tiles=a.canonicalizeTileset(j,s.url),n(null,j)}};return s.url?o.getJSON(a.transformRequest(a.normalizeSourceURL(s.url),o.ResourceType.Source),l):o.browser.frame(function(){return l(null,s)})}ut.prototype.broadcast=function(s,a,n){o.asyncAll(this.actors,function(l,b){l.send(s,a,b)},n=n||function(){})},ut.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},ut.prototype.remove=function(){this.actors.forEach(function(s){s.remove()}),this.actors=[],this.workerPool.release(this.id)},ut.Actor=o.Actor;var Zt=function(a,n,l){this.bounds=o.LngLatBounds.convert(this.validateBounds(a)),this.minzoom=n||0,this.maxzoom=l||24};Zt.prototype.validateBounds=function(s){return Array.isArray(s)&&s.length===4?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]},Zt.prototype.contains=function(s){var a=Math.pow(2,s.z),n=Math.floor(o.mercatorXfromLng(this.bounds.getWest())*a),l=Math.floor(o.mercatorYfromLat(this.bounds.getNorth())*a),b=Math.ceil(o.mercatorXfromLng(this.bounds.getEast())*a),O=Math.ceil(o.mercatorYfromLat(this.bounds.getSouth())*a);return s.x>=n&&s.x<b&&s.y>=l&&s.y<O};var ir=function(s){function a(n,l,b,O){if(s.call(this),this.id=n,this.dispatcher=b,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.extend(this,o.pick(l,["url","scheme","tileSize","promoteId"])),this._options=o.extend({type:"vector"},l),this._collectResourceTiming=l.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(O)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){var n=this;this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Vt(this._options,this.map._requestManager,function(l,b){n._tileJSONRequest=null,n._loaded=!0,l?n.fire(new o.ErrorEvent(l)):b&&(o.extend(n,b),b.bounds&&(n.tileBounds=new Zt(b.bounds,n.minzoom,n.maxzoom)),o.postTurnstileEvent(b.tiles,n.map._requestManager._customAccessToken),o.postMapLoadEvent(b.tiles,n.map._getMapId(),n.map._requestManager._skuToken,n.map._requestManager._customAccessToken),n.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})},a.prototype.loaded=function(){return this._loaded},a.prototype.hasTile=function(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.setSourceProperty=function(n){this._tileJSONRequest&&this._tileJSONRequest.cancel(),n(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},a.prototype.setTiles=function(n){var l=this;return this.setSourceProperty(function(){l._options.tiles=n}),this},a.prototype.setUrl=function(n){var l=this;return this.setSourceProperty(function(){l.url=n,l._options.url=n}),this},a.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},a.prototype.serialize=function(){return o.extend({},this._options)},a.prototype.loadTile=function(n,l){var b=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme)),O={request:this.map._requestManager.transformRequest(b,o.ResourceType.Tile),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:o.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function R(j,ue){return delete n.request,n.aborted?l(null):j&&j.status!==404?l(j):(ue&&ue.resourceTiming&&(n.resourceTiming=ue.resourceTiming),this.map._refreshExpiredTiles&&ue&&n.setExpiryData(ue),n.loadVectorData(ue,this.map.painter),o.cacheEntryPossiblyAdded(this.dispatcher),l(null),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}O.request.collectResourceTiming=this._collectResourceTiming,n.actor&&n.state!=="expired"?n.state==="loading"?n.reloadCallback=l:n.request=n.actor.send("reloadTile",O,R.bind(this)):(n.actor=this.dispatcher.getActor(),n.request=n.actor.send("loadTile",O,R.bind(this)))},a.prototype.abortTile=function(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id},void 0)},a.prototype.unloadTile=function(n){n.unloadVectorData(),n.actor&&n.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id},void 0)},a.prototype.hasTransition=function(){return!1},a}(o.Evented),oe=function(s){function a(n,l,b,O){s.call(this),this.id=n,this.dispatcher=b,this.setEventedParent(O),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.extend({type:"raster"},l),o.extend(this,o.pick(l,["url","scheme","tileSize"]))}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){var n=this;this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Vt(this._options,this.map._requestManager,function(l,b){n._tileJSONRequest=null,n._loaded=!0,l?n.fire(new o.ErrorEvent(l)):b&&(o.extend(n,b),b.bounds&&(n.tileBounds=new Zt(b.bounds,n.minzoom,n.maxzoom)),o.postTurnstileEvent(b.tiles),o.postMapLoadEvent(b.tiles,n.map._getMapId(),n.map._requestManager._skuToken),n.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})},a.prototype.loaded=function(){return this._loaded},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},a.prototype.serialize=function(){return o.extend({},this._options)},a.prototype.hasTile=function(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)},a.prototype.loadTile=function(n,l){var b=this,O=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);n.request=o.getImage(this.map._requestManager.transformRequest(O,o.ResourceType.Tile),function(R,j){if(delete n.request,n.aborted)n.state="unloaded",l(null);else if(R)n.state="errored",l(R);else if(j){b.map._refreshExpiredTiles&&n.setExpiryData(j),delete j.cacheControl,delete j.expires;var ue=b.map.painter.context,Te=ue.gl;n.texture=b.map.painter.getTileTexture(j.width),n.texture?n.texture.update(j,{useMipmap:!0}):(n.texture=new o.Texture(ue,j,Te.RGBA,{useMipmap:!0}),n.texture.bind(Te.LINEAR,Te.CLAMP_TO_EDGE,Te.LINEAR_MIPMAP_NEAREST),ue.extTextureFilterAnisotropic&&Te.texParameterf(Te.TEXTURE_2D,ue.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ue.extTextureFilterAnisotropicMax)),n.state="loaded",o.cacheEntryPossiblyAdded(b.dispatcher),l(null)}})},a.prototype.abortTile=function(n,l){n.request&&(n.request.cancel(),delete n.request),l()},a.prototype.unloadTile=function(n,l){n.texture&&this.map.painter.saveTileTexture(n.texture),l()},a.prototype.hasTransition=function(){return!1},a}(o.Evented),Q=function(s){function a(n,l,b,O){s.call(this,n,l,b,O),this.type="raster-dem",this.maxzoom=22,this._options=o.extend({type:"raster-dem"},l),this.encoding=l.encoding||"mapbox"}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},a.prototype.loadTile=function(n,l){var b=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function O(R,j){R&&(n.state="errored",l(R)),j&&(n.dem=j,n.needsHillshadePrepare=!0,n.state="loaded",l(null))}n.request=o.getImage(this.map._requestManager.transformRequest(b,o.ResourceType.Tile),function(R,j){if(delete n.request,n.aborted)n.state="unloaded",l(null);else if(R)n.state="errored",l(R);else if(j){this.map._refreshExpiredTiles&&n.setExpiryData(j),delete j.cacheControl,delete j.expires;var ue=o.window.ImageBitmap&&j instanceof o.window.ImageBitmap&&o.offscreenCanvasSupported()?j:o.browser.getImageData(j,1),Te={uid:n.uid,coord:n.tileID,source:this.id,rawImageData:ue,encoding:this.encoding};n.actor&&n.state!=="expired"||(n.actor=this.dispatcher.getActor(),n.actor.send("loadDEMTile",Te,O.bind(this)))}}.bind(this)),n.neighboringTiles=this._getNeighboringTiles(n.tileID)},a.prototype._getNeighboringTiles=function(n){var l=n.canonical,b=Math.pow(2,l.z),O=(l.x-1+b)%b,R=l.x===0?n.wrap-1:n.wrap,j=(l.x+1+b)%b,ue=l.x+1===b?n.wrap+1:n.wrap,Te={};return Te[new o.OverscaledTileID(n.overscaledZ,R,l.z,O,l.y).key]={backfilled:!1},Te[new o.OverscaledTileID(n.overscaledZ,ue,l.z,j,l.y).key]={backfilled:!1},l.y>0&&(Te[new o.OverscaledTileID(n.overscaledZ,R,l.z,O,l.y-1).key]={backfilled:!1},Te[new o.OverscaledTileID(n.overscaledZ,n.wrap,l.z,l.x,l.y-1).key]={backfilled:!1},Te[new o.OverscaledTileID(n.overscaledZ,ue,l.z,j,l.y-1).key]={backfilled:!1}),l.y+1<b&&(Te[new o.OverscaledTileID(n.overscaledZ,R,l.z,O,l.y+1).key]={backfilled:!1},Te[new o.OverscaledTileID(n.overscaledZ,n.wrap,l.z,l.x,l.y+1).key]={backfilled:!1},Te[new o.OverscaledTileID(n.overscaledZ,ue,l.z,j,l.y+1).key]={backfilled:!1}),Te},a.prototype.unloadTile=function(n){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&n.actor.send("removeDEMTile",{uid:n.uid,source:this.id})},a}(oe),H=function(s){function a(n,l,b,O){s.call(this),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=b.getActor(),this.setEventedParent(O),this._data=l.data,this._options=o.extend({},l),this._collectResourceTiming=l.collectResourceTiming,this._resourceTiming=[],l.maxzoom!==void 0&&(this.maxzoom=l.maxzoom),l.type&&(this.type=l.type),l.attribution&&(this.attribution=l.attribution),this.promoteId=l.promoteId;var R=o.EXTENT/this.tileSize;this.workerOptions=o.extend({source:this.id,cluster:l.cluster||!1,geojsonVtOptions:{buffer:(l.buffer!==void 0?l.buffer:128)*R,tolerance:(l.tolerance!==void 0?l.tolerance:.375)*R,extent:o.EXTENT,maxZoom:this.maxzoom,lineMetrics:l.lineMetrics||!1,generateId:l.generateId||!1},superclusterOptions:{maxZoom:l.clusterMaxZoom!==void 0?Math.min(l.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,l.clusterMinPoints||2),extent:o.EXTENT,radius:(l.clusterRadius||50)*R,log:!1,generateId:l.generateId||!1},clusterProperties:l.clusterProperties,filter:l.filter},l.workerOptions)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){var n=this;this.fire(new o.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(l){if(l)n.fire(new o.ErrorEvent(l));else{var b={dataType:"source",sourceDataType:"metadata"};n._collectResourceTiming&&n._resourceTiming&&n._resourceTiming.length>0&&(b.resourceTiming=n._resourceTiming,n._resourceTiming=[]),n.fire(new o.Event("data",b))}})},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.setData=function(n){var l=this;return this._data=n,this.fire(new o.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(b){if(b)l.fire(new o.ErrorEvent(b));else{var O={dataType:"source",sourceDataType:"content"};l._collectResourceTiming&&l._resourceTiming&&l._resourceTiming.length>0&&(O.resourceTiming=l._resourceTiming,l._resourceTiming=[]),l.fire(new o.Event("data",O))}}),this},a.prototype.getClusterExpansionZoom=function(n,l){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:n,source:this.id},l),this},a.prototype.getClusterChildren=function(n,l){return this.actor.send("geojson.getClusterChildren",{clusterId:n,source:this.id},l),this},a.prototype.getClusterLeaves=function(n,l,b,O){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:n,limit:l,offset:b},O),this},a.prototype._updateWorkerData=function(n){var l=this;this._loaded=!1;var b=o.extend({},this.workerOptions),O=this._data;typeof O=="string"?(b.request=this.map._requestManager.transformRequest(o.browser.resolveURL(O),o.ResourceType.Source),b.request.collectResourceTiming=this._collectResourceTiming):b.data=JSON.stringify(O),this.actor.send(this.type+".loadData",b,function(R,j){l._removed||j&&j.abandoned||(l._loaded=!0,j&&j.resourceTiming&&j.resourceTiming[l.id]&&(l._resourceTiming=j.resourceTiming[l.id].slice(0)),l.actor.send(l.type+".coalesce",{source:b.source},null),n(R))})},a.prototype.loaded=function(){return this._loaded},a.prototype.loadTile=function(n,l){var b=this,O=n.actor?"reloadTile":"loadTile";n.actor=this.actor,n.request=this.actor.send(O,{type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:o.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(R,j){return delete n.request,n.unloadVectorData(),n.aborted?l(null):R?l(R):(n.loadVectorData(j,b.map.painter,O==="reloadTile"),l(null))})},a.prototype.abortTile=function(n){n.request&&(n.request.cancel(),delete n.request),n.aborted=!0},a.prototype.unloadTile=function(n){n.unloadVectorData(),this.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id})},a.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},a.prototype.serialize=function(){return o.extend({},this._options,{type:this.type,data:this._data})},a.prototype.hasTransition=function(){return!1},a}(o.Evented),Ce=o.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Ee=function(s){function a(n,l,b,O){s.call(this),this.id=n,this.dispatcher=b,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(O),this.options=l}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(n,l){var b=this;this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this.url=this.options.url,o.getImage(this.map._requestManager.transformRequest(this.url,o.ResourceType.Image),function(O,R){b._loaded=!0,O?b.fire(new o.ErrorEvent(O)):R&&(b.image=R,n&&(b.coordinates=n),l&&l(),b._finishLoading())})},a.prototype.loaded=function(){return this._loaded},a.prototype.updateImage=function(n){var l=this;return this.image&&n.url?(this.options.url=n.url,this.load(n.coordinates,function(){l.texture=null}),this):this},a.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})))},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.setCoordinates=function(n){var l=this;this.coordinates=n;var b=n.map(o.MercatorCoordinate.fromLngLat);this.tileID=function(R){for(var j=1/0,ue=1/0,Te=-1/0,Ye=-1/0,qe=0,tt=R;qe<tt.length;qe+=1){var Dt=tt[qe];j=Math.min(j,Dt.x),ue=Math.min(ue,Dt.y),Te=Math.max(Te,Dt.x),Ye=Math.max(Ye,Dt.y)}var Rt=Math.max(Te-j,Ye-ue),Wt=Math.max(0,Math.floor(-Math.log(Rt)/Math.LN2)),kt=Math.pow(2,Wt);return new o.CanonicalTileID(Wt,Math.floor((j+Te)/2*kt),Math.floor((ue+Ye)/2*kt))}(b),this.minzoom=this.maxzoom=this.tileID.z;var O=b.map(function(R){return l.tileID.getTilePoint(R)._round()});return this._boundsArray=new o.StructArrayLayout4i8,this._boundsArray.emplaceBack(O[0].x,O[0].y,0,0),this._boundsArray.emplaceBack(O[1].x,O[1].y,o.EXTENT,0),this._boundsArray.emplaceBack(O[3].x,O[3].y,0,o.EXTENT),this._boundsArray.emplaceBack(O[2].x,O[2].y,o.EXTENT,o.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})),this},a.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var n=this.map.painter.context,l=n.gl;for(var b in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,Ce.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new o.Texture(n,this.image,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE)),this.tiles){var O=this.tiles[b];O.state!=="loaded"&&(O.state="loaded",O.texture=this.texture)}}},a.prototype.loadTile=function(n,l){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},l(null)):(n.state="errored",l(null))},a.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},a.prototype.hasTransition=function(){return!1},a}(o.Evented),Ae=function(s){function a(n,l,b,O){s.call(this,n,l,b,O),this.roundZoom=!0,this.type="video",this.options=l}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){var n=this;this._loaded=!1;var l=this.options;this.urls=[];for(var b=0,O=l.urls;b<O.length;b+=1)this.urls.push(this.map._requestManager.transformRequest(O[b],o.ResourceType.Source).url);o.getVideo(this.urls,function(R,j){n._loaded=!0,R?n.fire(new o.ErrorEvent(R)):j&&(n.video=j,n.video.loop=!0,n.video.addEventListener("playing",function(){n.map.triggerRepaint()}),n.map&&n.video.play(),n._finishLoading())})},a.prototype.pause=function(){this.video&&this.video.pause()},a.prototype.play=function(){this.video&&this.video.play()},a.prototype.seek=function(n){if(this.video){var l=this.video.seekable;n<l.start(0)||n>l.end(0)?this.fire(new o.ErrorEvent(new o.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+l.start(0)+" and "+l.end(0)+"-second mark."))):this.video.currentTime=n}},a.prototype.getVideo=function(){return this.video},a.prototype.onAdd=function(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},a.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var n=this.map.painter.context,l=n.gl;for(var b in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,Ce.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,this.video)):(this.texture=new o.Texture(n,this.video,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE)),this.tiles){var O=this.tiles[b];O.state!=="loaded"&&(O.state="loaded",O.texture=this.texture)}}},a.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},a.prototype.hasTransition=function(){return this.video&&!this.video.paused},a}(Ee),ge=function(s){function a(n,l,b,O){s.call(this,n,l,b,O),l.coordinates?Array.isArray(l.coordinates)&&l.coordinates.length===4&&!l.coordinates.some(function(R){return!Array.isArray(R)||R.length!==2||R.some(function(j){return typeof j!="number"})})||this.fire(new o.ErrorEvent(new o.ValidationError("sources."+n,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.ErrorEvent(new o.ValidationError("sources."+n,null,'missing required property "coordinates"'))),l.animate&&typeof l.animate!="boolean"&&this.fire(new o.ErrorEvent(new o.ValidationError("sources."+n,null,'optional "animate" property must be a boolean value'))),l.canvas?typeof l.canvas=="string"||l.canvas instanceof o.window.HTMLCanvasElement||this.fire(new o.ErrorEvent(new o.ValidationError("sources."+n,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.ErrorEvent(new o.ValidationError("sources."+n,null,'missing required property "canvas"'))),this.options=l,this.animate=l.animate===void 0||l.animate}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof o.window.HTMLCanvasElement?this.options.canvas:o.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},a.prototype.getCanvas=function(){return this.canvas},a.prototype.onAdd=function(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()},a.prototype.onRemove=function(){this.pause()},a.prototype.prepare=function(){var n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var l=this.map.painter.context,b=l.gl;for(var O in this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,Ce.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.Texture(l,this.canvas,b.RGBA,{premultiply:!0}),this.tiles){var R=this.tiles[O];R.state!=="loaded"&&(R.state="loaded",R.texture=this.texture)}}},a.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},a.prototype.hasTransition=function(){return this._playing},a.prototype._hasInvalidDimensions=function(){for(var n=0,l=[this.canvas.width,this.canvas.height];n<l.length;n+=1){var b=l[n];if(isNaN(b)||b<=0)return!0}return!1},a}(Ee),rt={vector:ir,raster:oe,"raster-dem":Q,geojson:H,video:Ae,image:Ee,canvas:ge};function Yt(s,a){var n=o.identity([]);return o.translate(n,n,[1,1,0]),o.scale(n,n,[.5*s.width,.5*s.height,1]),o.multiply(n,n,s.calculatePosMatrix(a.toUnwrapped()))}function At(s,a,n,l,b,O){var R=function(Wt,kt,zt){if(Wt)for(var nr=0,Jt=Wt;nr<Jt.length;nr+=1){var Cr=kt[Jt[nr]];if(Cr&&Cr.source===zt&&Cr.type==="fill-extrusion")return!0}else for(var pr in kt){var _r=kt[pr];if(_r.source===zt&&_r.type==="fill-extrusion")return!0}return!1}(b&&b.layers,a,s.id),j=O.maxPitchScaleFactor(),ue=s.tilesIn(l,j,R);ue.sort(be);for(var Te=[],Ye=0,qe=ue;Ye<qe.length;Ye+=1){var tt=qe[Ye];Te.push({wrappedTileID:tt.tileID.wrapped().key,queryResults:tt.tile.queryRenderedFeatures(a,n,s._state,tt.queryGeometry,tt.cameraQueryGeometry,tt.scale,b,O,j,Yt(s.transform,tt.tileID))})}var Dt=function(Wt){for(var kt={},zt={},nr=0,Jt=Wt;nr<Jt.length;nr+=1){var Cr=Jt[nr],pr=Cr.queryResults,_r=Cr.wrappedTileID,wr=zt[_r]=zt[_r]||{};for(var Hr in pr)for(var Yr=pr[Hr],un=wr[Hr]=wr[Hr]||{},_n=kt[Hr]=kt[Hr]||[],ia=0,pa=Yr;ia<pa.length;ia+=1){var ya=pa[ia];un[ya.featureIndex]||(un[ya.featureIndex]=!0,_n.push(ya))}}return kt}(Te);for(var Rt in Dt)Dt[Rt].forEach(function(Wt){var kt=Wt.feature,zt=s.getFeatureState(kt.layer["source-layer"],kt.id);kt.source=kt.layer.source,kt.layer["source-layer"]&&(kt.sourceLayer=kt.layer["source-layer"]),kt.state=zt});return Dt}function be(s,a){var n=s.tileID,l=a.tileID;return n.overscaledZ-l.overscaledZ||n.canonical.y-l.canonical.y||n.wrap-l.wrap||n.canonical.x-l.canonical.x}var xe=function(a,n){this.max=a,this.onRemove=n,this.reset()};xe.prototype.reset=function(){for(var s in this.data)for(var a=0,n=this.data[s];a<n.length;a+=1){var l=n[a];l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value)}return this.data={},this.order=[],this},xe.prototype.add=function(s,a,n){var l=this,b=s.wrapped().key;this.data[b]===void 0&&(this.data[b]=[]);var O={value:a,timeout:void 0};if(n!==void 0&&(O.timeout=setTimeout(function(){l.remove(s,O)},n)),this.data[b].push(O),this.order.push(b),this.order.length>this.max){var R=this._getAndRemoveByKey(this.order[0]);R&&this.onRemove(R)}return this},xe.prototype.has=function(s){return s.wrapped().key in this.data},xe.prototype.getAndRemove=function(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null},xe.prototype._getAndRemoveByKey=function(s){var a=this.data[s].shift();return a.timeout&&clearTimeout(a.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),a.value},xe.prototype.getByKey=function(s){var a=this.data[s];return a?a[0].value:null},xe.prototype.get=function(s){return this.has(s)?this.data[s.wrapped().key][0].value:null},xe.prototype.remove=function(s,a){if(!this.has(s))return this;var n=s.wrapped().key,l=a===void 0?0:this.data[n].indexOf(a),b=this.data[n][l];return this.data[n].splice(l,1),b.timeout&&clearTimeout(b.timeout),this.data[n].length===0&&delete this.data[n],this.onRemove(b.value),this.order.splice(this.order.indexOf(n),1),this},xe.prototype.setMaxSize=function(s){for(this.max=s;this.order.length>this.max;){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},xe.prototype.filter=function(s){var a=[];for(var n in this.data)for(var l=0,b=this.data[n];l<b.length;l+=1){var O=b[l];s(O.value)||a.push(O)}for(var R=0,j=a;R<j.length;R+=1){var ue=j[R];this.remove(ue.value.tileID,ue)}};var Ve=function(a,n,l){this.context=a;var b=a.gl;this.buffer=b.createBuffer(),this.dynamicDraw=Boolean(l),this.context.unbindVAO(),a.bindElementBuffer.set(this.buffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer};Ve.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Ve.prototype.updateData=function(s){var a=this.context.gl;this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)},Ve.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var lt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Pe=function(a,n,l,b){this.length=n.length,this.attributes=l,this.itemSize=n.bytesPerElement,this.dynamicDraw=b,this.context=a;var O=a.gl;this.buffer=O.createBuffer(),a.bindVertexBuffer.set(this.buffer),O.bufferData(O.ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?O.DYNAMIC_DRAW:O.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer};Pe.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Pe.prototype.updateData=function(s){var a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,s.arrayBuffer)},Pe.prototype.enableAttributes=function(s,a){for(var n=0;n<this.attributes.length;n++){var l=a.attributes[this.attributes[n].name];l!==void 0&&s.enableVertexAttribArray(l)}},Pe.prototype.setVertexAttribPointers=function(s,a,n){for(var l=0;l<this.attributes.length;l++){var b=this.attributes[l],O=a.attributes[b.name];O!==void 0&&s.vertexAttribPointer(O,b.components,s[lt[b.type]],!1,this.itemSize,b.offset+this.itemSize*(n||0))}},Pe.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var dt=function(a){this.gl=a.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};dt.prototype.get=function(){return this.current},dt.prototype.set=function(s){},dt.prototype.getDefault=function(){return this.default},dt.prototype.setDefault=function(){this.set(this.default)};var w=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return o.Color.transparent},a.prototype.set=function(n){var l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)},a}(dt),I=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return 1},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)},a}(dt),q=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return 0},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)},a}(dt),ce=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return[!0,!0,!0,!0]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)},a}(dt),Ge=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!0},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)},a}(dt),$e=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return 255},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)},a}(dt),yt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},a.prototype.set=function(n){var l=this.current;(n.func!==l.func||n.ref!==l.ref||n.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)},a}(dt),nt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){var n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)},a}(dt),Nt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=n,this.dirty=!1}},a}(dt),$=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return[0,1]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)},a}(dt),Ke=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=n,this.dirty=!1}},a}(dt),ae=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.LESS},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)},a}(dt),et=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.BLEND):l.disable(l.BLEND),this.current=n,this.dirty=!1}},a}(dt),jt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){var n=this.gl;return[n.ONE,n.ZERO]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)},a}(dt),sr=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return o.Color.transparent},a.prototype.set=function(n){var l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)},a}(dt),ft=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.FUNC_ADD},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)},a}(dt),mt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=n,this.dirty=!1}},a}(dt),Ct=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.BACK},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)},a}(dt),vt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.CCW},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)},a}(dt),Oe=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)},a}(dt),ct=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.TEXTURE0},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)},a}(dt),Qe=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){var n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)},a}(dt),Ft=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,n),this.current=n,this.dirty=!1}},a}(dt),vr=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,n),this.current=n,this.dirty=!1}},a}(dt),Vr=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindTexture(l.TEXTURE_2D,n),this.current=n,this.dirty=!1}},a}(dt),lr=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}},a}(dt),Nn=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){var l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1},a}(dt),vn=function(s){function a(n){s.call(this,n),this.vao=n.extVertexArrayObject}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){this.vao&&(n!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(n),this.current=n,this.dirty=!1)},a}(dt),na=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return 4},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}},a}(dt),ha=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}},a}(dt),Zn=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}},a}(dt),Hn=function(s){function a(n,l){s.call(this,n),this.context=n,this.parent=l}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a}(dt),F=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.setDirty=function(){this.dirty=!0},a.prototype.set=function(n){if(n!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}},a}(Hn),W=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.set=function(n){if(n!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,n),this.current=n,this.dirty=!1}},a}(Hn),le=function(a,n,l,b){this.context=a,this.width=n,this.height=l;var O=this.framebuffer=a.gl.createFramebuffer();this.colorAttachment=new F(a,O),b&&(this.depthAttachment=new W(a,O))};le.prototype.destroy=function(){var s=this.context.gl,a=this.colorAttachment.get();if(a&&s.deleteTexture(a),this.depthAttachment){var n=this.depthAttachment.get();n&&s.deleteRenderbuffer(n)}s.deleteFramebuffer(this.framebuffer)};var me=function(a,n,l){this.func=a,this.mask=n,this.range=l};me.ReadOnly=!1,me.ReadWrite=!0,me.disabled=new me(519,me.ReadOnly,[0,1]);var at=function(a,n,l,b,O,R){this.test=a,this.ref=n,this.mask=l,this.fail=b,this.depthFail=O,this.pass=R};at.disabled=new at({func:519,mask:0},0,0,7680,7680,7680);var bt=function(a,n,l){this.blendFunction=a,this.blendColor=n,this.mask=l};bt.disabled=new bt(bt.Replace=[1,0],o.Color.transparent,[!1,!1,!1,!1]),bt.unblended=new bt(bt.Replace,o.Color.transparent,[!0,!0,!0,!0]),bt.alphaBlended=new bt([1,771],o.Color.transparent,[!0,!0,!0,!0]);var He=function(a,n,l){this.enable=a,this.mode=n,this.frontFace=l};He.disabled=new He(!1,1029,2305),He.backCCW=new He(!0,1029,2305);var ht=function(a){this.gl=a,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new w(this),this.clearDepth=new I(this),this.clearStencil=new q(this),this.colorMask=new ce(this),this.depthMask=new Ge(this),this.stencilMask=new $e(this),this.stencilFunc=new yt(this),this.stencilOp=new nt(this),this.stencilTest=new Nt(this),this.depthRange=new $(this),this.depthTest=new Ke(this),this.depthFunc=new ae(this),this.blend=new et(this),this.blendFunc=new jt(this),this.blendColor=new sr(this),this.blendEquation=new ft(this),this.cullFace=new mt(this),this.cullFaceSide=new Ct(this),this.frontFace=new vt(this),this.program=new Oe(this),this.activeTexture=new ct(this),this.viewport=new Qe(this),this.bindFramebuffer=new Ft(this),this.bindRenderbuffer=new vr(this),this.bindTexture=new Vr(this),this.bindVertexBuffer=new lr(this),this.bindElementBuffer=new Nn(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new vn(this),this.pixelStoreUnpack=new na(this),this.pixelStoreUnpackPremultiplyAlpha=new ha(this),this.pixelStoreUnpackFlipY=new Zn(this),this.extTextureFilterAnisotropic=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=a.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=a.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(a.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=a.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=a.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE)};ht.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},ht.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},ht.prototype.createIndexBuffer=function(s,a){return new Ve(this,s,a)},ht.prototype.createVertexBuffer=function(s,a,n){return new Pe(this,s,a,n)},ht.prototype.createRenderbuffer=function(s,a,n){var l=this.gl,b=l.createRenderbuffer();return this.bindRenderbuffer.set(b),l.renderbufferStorage(l.RENDERBUFFER,s,a,n),this.bindRenderbuffer.set(null),b},ht.prototype.createFramebuffer=function(s,a,n){return new le(this,s,a,n)},ht.prototype.clear=function(s){var a=s.color,n=s.depth,l=this.gl,b=0;a&&(b|=l.COLOR_BUFFER_BIT,this.clearColor.set(a),this.colorMask.set([!0,!0,!0,!0])),n!==void 0&&(b|=l.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),l.clear(b)},ht.prototype.setCullFace=function(s){s.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))},ht.prototype.setDepthMode=function(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)},ht.prototype.setStencilMode=function(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)},ht.prototype.setColorMode=function(s){o.deepEqual(s.blendFunction,bt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor)),this.colorMask.set(s.mask)},ht.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Qt=function(s){function a(n,l,b){var O=this;s.call(this),this.id=n,this.dispatcher=b,this.on("data",function(R){R.dataType==="source"&&R.sourceDataType==="metadata"&&(O._sourceLoaded=!0),O._sourceLoaded&&!O._paused&&R.dataType==="source"&&R.sourceDataType==="content"&&(O.reload(),O.transform&&O.update(O.transform))}),this.on("error",function(){O._sourceErrored=!0}),this._source=function(R,j,ue,Te){var Ye=new rt[j.type](R,j,ue,Te);if(Ye.id!==R)throw new Error("Expected Source id to be "+R+" instead of "+Ye.id);return o.bindAll(["load","abort","unload","serialize","prepare"],Ye),Ye}(n,l,b,this),this._tiles={},this._cache=new xe(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new o.SourceFeatureState}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.onAdd=function(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(n)},a.prototype.onRemove=function(n){this._source&&this._source.onRemove&&this._source.onRemove(n)},a.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(var n in this._tiles){var l=this._tiles[n];if(l.state!=="loaded"&&l.state!=="errored")return!1}return!0},a.prototype.getSource=function(){return this._source},a.prototype.pause=function(){this._paused=!0},a.prototype.resume=function(){if(this._paused){var n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform)}},a.prototype._loadTile=function(n,l){return this._source.loadTile(n,l)},a.prototype._unloadTile=function(n){if(this._source.unloadTile)return this._source.unloadTile(n,function(){})},a.prototype._abortTile=function(n){if(this._source.abortTile)return this._source.abortTile(n,function(){})},a.prototype.serialize=function(){return this._source.serialize()},a.prototype.prepare=function(n){for(var l in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var b=this._tiles[l];b.upload(n),b.prepare(this.map.style.imageManager)}},a.prototype.getIds=function(){return o.values(this._tiles).map(function(n){return n.tileID}).sort(qt).map(function(n){return n.key})},a.prototype.getRenderableIds=function(n){var l=this,b=[];for(var O in this._tiles)this._isIdRenderable(O,n)&&b.push(this._tiles[O]);return n?b.sort(function(R,j){var ue=R.tileID,Te=j.tileID,Ye=new o.Point(ue.canonical.x,ue.canonical.y)._rotate(l.transform.angle),qe=new o.Point(Te.canonical.x,Te.canonical.y)._rotate(l.transform.angle);return ue.overscaledZ-Te.overscaledZ||qe.y-Ye.y||qe.x-Ye.x}).map(function(R){return R.tileID.key}):b.map(function(R){return R.tileID}).sort(qt).map(function(R){return R.key})},a.prototype.hasRenderableParent=function(n){var l=this.findLoadedParent(n,0);return!!l&&this._isIdRenderable(l.tileID.key)},a.prototype._isIdRenderable=function(n,l){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(l||!this._tiles[n].holdingForFade())},a.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var n in this._cache.reset(),this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(n,"reloading")},a.prototype._reloadTile=function(n,l){var b=this._tiles[n];b&&(b.state!=="loading"&&(b.state=l),this._loadTile(b,this._tileLoaded.bind(this,b,n,l)))},a.prototype._tileLoaded=function(n,l,b,O){if(O)return n.state="errored",void(O.status!==404?this._source.fire(new o.ErrorEvent(O,{tile:n})):this.update(this.transform));n.timeAdded=o.browser.now(),b==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(l,n),this.getSource().type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),this._source.fire(new o.Event("data",{dataType:"source",tile:n,coord:n.tileID}))},a.prototype._backfillDEM=function(n){for(var l=this.getRenderableIds(),b=0;b<l.length;b++){var O=l[b];if(n.neighboringTiles&&n.neighboringTiles[O]){var R=this.getTileByID(O);j(n,R),j(R,n)}}function j(ue,Te){ue.needsHillshadePrepare=!0;var Ye=Te.tileID.canonical.x-ue.tileID.canonical.x,qe=Te.tileID.canonical.y-ue.tileID.canonical.y,tt=Math.pow(2,ue.tileID.canonical.z),Dt=Te.tileID.key;Ye===0&&qe===0||Math.abs(qe)>1||(Math.abs(Ye)>1&&(Math.abs(Ye+tt)===1?Ye+=tt:Math.abs(Ye-tt)===1&&(Ye-=tt)),Te.dem&&ue.dem&&(ue.dem.backfillBorder(Te.dem,Ye,qe),ue.neighboringTiles&&ue.neighboringTiles[Dt]&&(ue.neighboringTiles[Dt].backfilled=!0)))}},a.prototype.getTile=function(n){return this.getTileByID(n.key)},a.prototype.getTileByID=function(n){return this._tiles[n]},a.prototype._retainLoadedChildren=function(n,l,b,O){for(var R in this._tiles){var j=this._tiles[R];if(!(O[R]||!j.hasData()||j.tileID.overscaledZ<=l||j.tileID.overscaledZ>b)){for(var ue=j.tileID;j&&j.tileID.overscaledZ>l+1;){var Te=j.tileID.scaledTo(j.tileID.overscaledZ-1);(j=this._tiles[Te.key])&&j.hasData()&&(ue=Te)}for(var Ye=ue;Ye.overscaledZ>l;)if(n[(Ye=Ye.scaledTo(Ye.overscaledZ-1)).key]){O[ue.key]=ue;break}}}},a.prototype.findLoadedParent=function(n,l){if(n.key in this._loadedParentTiles){var b=this._loadedParentTiles[n.key];return b&&b.tileID.overscaledZ>=l?b:null}for(var O=n.overscaledZ-1;O>=l;O--){var R=n.scaledTo(O),j=this._getLoadedTile(R);if(j)return j}},a.prototype._getLoadedTile=function(n){var l=this._tiles[n.key];return l&&l.hasData()?l:this._cache.getByKey(n.wrapped().key)},a.prototype.updateCacheSize=function(n){var l=Math.ceil(n.width/this._source.tileSize)+1,b=Math.ceil(n.height/this._source.tileSize)+1,O=Math.floor(l*b*5),R=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,O):O;this._cache.setMaxSize(R)},a.prototype.handleWrapJump=function(n){var l=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,l){var b={};for(var O in this._tiles){var R=this._tiles[O];R.tileID=R.tileID.unwrapTo(R.tileID.wrap+l),b[R.tileID.key]=R}for(var j in this._tiles=b,this._timers)clearTimeout(this._timers[j]),delete this._timers[j];for(var ue in this._tiles)this._setTileReloadTimer(ue,this._tiles[ue])}},a.prototype.update=function(n){var l=this;if(this.transform=n,this._sourceLoaded&&!this._paused){var b;this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?b=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(wr){return new o.OverscaledTileID(wr.canonical.z,wr.wrap,wr.canonical.z,wr.canonical.x,wr.canonical.y)}):(b=n.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(b=b.filter(function(wr){return l._source.hasTile(wr)}))):b=[];var O=n.coveringZoomLevel(this._source),R=Math.max(O-a.maxOverzooming,this._source.minzoom),j=Math.max(O+a.maxUnderzooming,this._source.minzoom),ue=this._updateRetainedTiles(b,O);if(Nr(this._source.type)){for(var Te={},Ye={},qe=0,tt=Object.keys(ue);qe<tt.length;qe+=1){var Dt=tt[qe],Rt=ue[Dt],Wt=this._tiles[Dt];if(Wt&&!(Wt.fadeEndTime&&Wt.fadeEndTime<=o.browser.now())){var kt=this.findLoadedParent(Rt,R);kt&&(this._addTile(kt.tileID),Te[kt.tileID.key]=kt.tileID),Ye[Dt]=Rt}}for(var zt in this._retainLoadedChildren(Ye,O,j,ue),Te)ue[zt]||(this._coveredTiles[zt]=!0,ue[zt]=Te[zt])}for(var nr in ue)this._tiles[nr].clearFadeHold();for(var Jt=0,Cr=o.keysDifference(this._tiles,ue);Jt<Cr.length;Jt+=1){var pr=Cr[Jt],_r=this._tiles[pr];_r.hasSymbolBuckets&&!_r.holdingForFade()?_r.setHoldDuration(this.map._fadeDuration):_r.hasSymbolBuckets&&!_r.symbolFadeFinished()||this._removeTile(pr)}this._updateLoadedParentTileCache()}},a.prototype.releaseSymbolFadeTiles=function(){for(var n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(n)},a.prototype._updateRetainedTiles=function(n,l){for(var b={},O={},R=Math.max(l-a.maxOverzooming,this._source.minzoom),j=Math.max(l+a.maxUnderzooming,this._source.minzoom),ue={},Te=0,Ye=n;Te<Ye.length;Te+=1){var qe=Ye[Te],tt=this._addTile(qe);b[qe.key]=qe,tt.hasData()||l<this._source.maxzoom&&(ue[qe.key]=qe)}this._retainLoadedChildren(ue,l,j,b);for(var Dt=0,Rt=n;Dt<Rt.length;Dt+=1){var Wt=Rt[Dt],kt=this._tiles[Wt.key];if(!kt.hasData()){if(l+1>this._source.maxzoom){var zt=Wt.children(this._source.maxzoom)[0],nr=this.getTile(zt);if(nr&&nr.hasData()){b[zt.key]=zt;continue}}else{var Jt=Wt.children(this._source.maxzoom);if(b[Jt[0].key]&&b[Jt[1].key]&&b[Jt[2].key]&&b[Jt[3].key])continue}for(var Cr=kt.wasRequested(),pr=Wt.overscaledZ-1;pr>=R;--pr){var _r=Wt.scaledTo(pr);if(O[_r.key])break;if(O[_r.key]=!0,!(kt=this.getTile(_r))&&Cr&&(kt=this._addTile(_r)),kt&&(b[_r.key]=_r,Cr=kt.wasRequested(),kt.hasData()))break}}}return b},a.prototype._updateLoadedParentTileCache=function(){for(var n in this._loadedParentTiles={},this._tiles){for(var l=[],b=void 0,O=this._tiles[n].tileID;O.overscaledZ>0;){if(O.key in this._loadedParentTiles){b=this._loadedParentTiles[O.key];break}l.push(O.key);var R=O.scaledTo(O.overscaledZ-1);if(b=this._getLoadedTile(R))break;O=R}for(var j=0,ue=l;j<ue.length;j+=1)this._loadedParentTiles[ue[j]]=b}},a.prototype._addTile=function(n){var l=this._tiles[n.key];if(l)return l;(l=this._cache.getAndRemove(n))&&(this._setTileReloadTimer(n.key,l),l.tileID=n,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,l)));var b=Boolean(l);return b||(l=new o.Tile(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(l,this._tileLoaded.bind(this,l,n.key,l.state))),l?(l.uses++,this._tiles[n.key]=l,b||this._source.fire(new o.Event("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null},a.prototype._setTileReloadTimer=function(n,l){var b=this;n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);var O=l.getExpiryTimeout();O&&(this._timers[n]=setTimeout(function(){b._reloadTile(n,"expired"),delete b._timers[n]},O))},a.prototype._removeTile=function(n){var l=this._tiles[n];l&&(l.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),l.uses>0||(l.hasData()&&l.state!=="reloading"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))},a.prototype.clearTiles=function(){for(var n in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(n);this._cache.reset()},a.prototype.tilesIn=function(n,l,b){var O=this,R=[],j=this.transform;if(!j)return R;for(var ue=b?j.getCameraQueryGeometry(n):n,Te=n.map(function(pr){return j.pointCoordinate(pr)}),Ye=ue.map(function(pr){return j.pointCoordinate(pr)}),qe=this.getIds(),tt=1/0,Dt=1/0,Rt=-1/0,Wt=-1/0,kt=0,zt=Ye;kt<zt.length;kt+=1){var nr=zt[kt];tt=Math.min(tt,nr.x),Dt=Math.min(Dt,nr.y),Rt=Math.max(Rt,nr.x),Wt=Math.max(Wt,nr.y)}for(var Jt=function(_r){var wr=O._tiles[qe[_r]];if(!wr.holdingForFade()){var Hr=wr.tileID,Yr=Math.pow(2,j.zoom-wr.tileID.overscaledZ),un=l*wr.queryPadding*o.EXTENT/wr.tileSize/Yr,_n=[Hr.getTilePoint(new o.MercatorCoordinate(tt,Dt)),Hr.getTilePoint(new o.MercatorCoordinate(Rt,Wt))];if(_n[0].x-un<o.EXTENT&&_n[0].y-un<o.EXTENT&&_n[1].x+un>=0&&_n[1].y+un>=0){var ia=Te.map(function(ya){return Hr.getTilePoint(ya)}),pa=Ye.map(function(ya){return Hr.getTilePoint(ya)});R.push({tile:wr,tileID:Hr,queryGeometry:ia,cameraQueryGeometry:pa,scale:Yr})}}},Cr=0;Cr<qe.length;Cr++)Jt(Cr);return R},a.prototype.getVisibleCoordinates=function(n){for(var l=this,b=this.getRenderableIds(n).map(function(ue){return l._tiles[ue].tileID}),O=0,R=b;O<R.length;O+=1){var j=R[O];j.posMatrix=this.transform.calculatePosMatrix(j.toUnwrapped())}return b},a.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Nr(this._source.type))for(var n in this._tiles){var l=this._tiles[n];if(l.fadeEndTime!==void 0&&l.fadeEndTime>=o.browser.now())return!0}return!1},a.prototype.setFeatureState=function(n,l,b){this._state.updateState(n=n||"_geojsonTileLayer",l,b)},a.prototype.removeFeatureState=function(n,l,b){this._state.removeFeatureState(n=n||"_geojsonTileLayer",l,b)},a.prototype.getFeatureState=function(n,l){return this._state.getState(n=n||"_geojsonTileLayer",l)},a.prototype.setDependencies=function(n,l,b){var O=this._tiles[n];O&&O.setDependencies(l,b)},a.prototype.reloadTilesForDependencies=function(n,l){for(var b in this._tiles)this._tiles[b].hasDependency(n,l)&&this._reloadTile(b,"reloading");this._cache.filter(function(O){return!O.hasDependency(n,l)})},a}(o.Evented);function qt(s,a){var n=Math.abs(2*s.wrap)-+(s.wrap<0),l=Math.abs(2*a.wrap)-+(a.wrap<0);return s.overscaledZ-a.overscaledZ||l-n||a.canonical.y-s.canonical.y||a.canonical.x-s.canonical.x}function Nr(s){return s==="raster"||s==="image"||s==="video"}function qr(){return new o.window.Worker(Vl.workerUrl)}Qt.maxOverzooming=10,Qt.maxUnderzooming=3;var or="mapboxgl_preloaded_worker_pool",Br=function(){this.active={}};Br.prototype.acquire=function(s){if(!this.workers)for(this.workers=[];this.workers.length<Br.workerCount;)this.workers.push(new qr);return this.active[s]=!0,this.workers.slice()},Br.prototype.release=function(s){delete this.active[s],this.numActive()===0&&(this.workers.forEach(function(a){a.terminate()}),this.workers=null)},Br.prototype.isPreloaded=function(){return!!this.active[or]},Br.prototype.numActive=function(){return Object.keys(this.active).length};var Tn,dr=Math.floor(o.browser.hardwareConcurrency/2);function Xr(){return Tn||(Tn=new Br),Tn}function dn(s,a){var n={};for(var l in s)l!=="ref"&&(n[l]=s[l]);return o.refProperties.forEach(function(b){b in a&&(n[b]=a[b])}),n}function Kn(s){s=s.slice();for(var a=Object.create(null),n=0;n<s.length;n++)a[s[n].id]=s[n];for(var l=0;l<s.length;l++)"ref"in s[l]&&(s[l]=dn(s[l],a[s[l].ref]));return s}Br.workerCount=Math.max(Math.min(dr,6),1);var gn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function ur(s,a,n){n.push({command:gn.addSource,args:[s,a[s]]})}function kn(s,a,n){a.push({command:gn.removeSource,args:[s]}),n[s]=!0}function An(s,a,n,l){kn(s,n,l),ur(s,a,n)}function Za(s,a,n){var l;for(l in s[n])if(s[n].hasOwnProperty(l)&&l!=="data"&&!o.deepEqual(s[n][l],a[n][l]))return!1;for(l in a[n])if(a[n].hasOwnProperty(l)&&l!=="data"&&!o.deepEqual(s[n][l],a[n][l]))return!1;return!0}function ea(s,a,n,l,b,O){var R;for(R in a=a||{},s=s||{})s.hasOwnProperty(R)&&(o.deepEqual(s[R],a[R])||n.push({command:O,args:[l,R,a[R],b]}));for(R in a)a.hasOwnProperty(R)&&!s.hasOwnProperty(R)&&(o.deepEqual(s[R],a[R])||n.push({command:O,args:[l,R,a[R],b]}))}function ca(s){return s.id}function bo(s,a){return s[a.id]=a,s}var Ri=function(a,n){this.reset(a,n)};Ri.prototype.reset=function(s,a){this.points=s||[],this._distances=[0];for(var n=1;n<this.points.length;n++)this._distances[n]=this._distances[n-1]+this.points[n].dist(this.points[n-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Ri.prototype.lerp=function(s){if(this.points.length===1)return this.points[0];s=o.clamp(s,0,1);for(var a=1,n=this._distances[a],l=s*this.paddedLength+this.padding;n<l&&a<this._distances.length;)n=this._distances[++a];var b=a-1,O=this._distances[b],R=n-O,j=R>0?(l-O)/R:0;return this.points[b].mult(1-j).add(this.points[a].mult(j))};var va=function(a,n,l){var b=this.boxCells=[],O=this.circleCells=[];this.xCellCount=Math.ceil(a/l),this.yCellCount=Math.ceil(n/l);for(var R=0;R<this.xCellCount*this.yCellCount;R++)b.push([]),O.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=a,this.height=n,this.xScale=this.xCellCount/a,this.yScale=this.yCellCount/n,this.boxUid=0,this.circleUid=0};function ii(s,a,n,l,b){var O=o.create();return a?(o.scale(O,O,[1/b,1/b,1]),n||o.rotateZ(O,O,l.angle)):o.multiply(O,l.labelPlaneMatrix,s),O}function Ia(s,a,n,l,b){if(a){var O=o.clone(s);return o.scale(O,O,[b,b,1]),n||o.rotateZ(O,O,-l.angle),O}return l.glCoordMatrix}function Ln(s,a){var n=[s.x,s.y,0,1];Fu(n,n,a);var l=n[3];return{point:new o.Point(n[0]/l,n[1]/l),signedDistanceFromCamera:l}}function Ei(s,a){return .5+s/a*.5}function Wi(s,a){var n=s[0]/s[3],l=s[1]/s[3];return n>=-a[0]&&n<=a[0]&&l>=-a[1]&&l<=a[1]}function qa(s,a,n,l,b,O,R,j){var ue=l?s.textSizeData:s.iconSizeData,Te=o.evaluateSizeForZoom(ue,n.transform.zoom),Ye=[256/n.width*2+1,256/n.height*2+1],qe=l?s.text.dynamicLayoutVertexArray:s.icon.dynamicLayoutVertexArray;qe.clear();for(var tt=s.lineVertexArray,Dt=l?s.text.placedSymbolArray:s.icon.placedSymbolArray,Rt=n.transform.width/n.transform.height,Wt=!1,kt=0;kt<Dt.length;kt++){var zt=Dt.get(kt);if(zt.hidden||zt.writingMode===o.WritingMode.vertical&&!Wt)Na(zt.numGlyphs,qe);else{Wt=!1;var nr=[zt.anchorX,zt.anchorY,0,1];if(o.transformMat4(nr,nr,a),Wi(nr,Ye)){var Jt=Ei(n.transform.cameraToCenterDistance,nr[3]),Cr=o.evaluateSizeForFeature(ue,Te,zt),pr=R?Cr/Jt:Cr*Jt,_r=new o.Point(zt.anchorX,zt.anchorY),wr=Ln(_r,b).point,Hr={},Yr=cu(zt,pr,!1,j,a,b,O,s.glyphOffsetArray,tt,qe,wr,_r,Hr,Rt);Wt=Yr.useVertical,(Yr.notEnoughRoom||Wt||Yr.needsFlipping&&cu(zt,pr,!0,j,a,b,O,s.glyphOffsetArray,tt,qe,wr,_r,Hr,Rt).notEnoughRoom)&&Na(zt.numGlyphs,qe)}else Na(zt.numGlyphs,qe)}}l?s.text.dynamicLayoutVertexBuffer.updateData(qe):s.icon.dynamicLayoutVertexBuffer.updateData(qe)}function Oo(s,a,n,l,b,O,R,j,ue,Te,Ye){var qe=j.glyphStartIndex+j.numGlyphs,tt=j.lineStartIndex,Dt=j.lineStartIndex+j.lineLength,Rt=a.getoffsetX(j.glyphStartIndex),Wt=a.getoffsetX(qe-1),kt=Cs(s*Rt,n,l,b,O,R,j.segment,tt,Dt,ue,Te,Ye);if(!kt)return null;var zt=Cs(s*Wt,n,l,b,O,R,j.segment,tt,Dt,ue,Te,Ye);return zt?{first:kt,last:zt}:null}function Ml(s,a,n,l){return s===o.WritingMode.horizontal&&Math.abs(n.y-a.y)>Math.abs(n.x-a.x)*l?{useVertical:!0}:(s===o.WritingMode.vertical?a.y<n.y:a.x>n.x)?{needsFlipping:!0}:null}function cu(s,a,n,l,b,O,R,j,ue,Te,Ye,qe,tt,Dt){var Rt,Wt=a/24,kt=s.lineOffsetX*Wt,zt=s.lineOffsetY*Wt;if(s.numGlyphs>1){var nr=s.glyphStartIndex+s.numGlyphs,Jt=s.lineStartIndex,Cr=s.lineStartIndex+s.lineLength,pr=Oo(Wt,j,kt,zt,n,Ye,qe,s,ue,O,tt);if(!pr)return{notEnoughRoom:!0};var _r=Ln(pr.first.point,R).point,wr=Ln(pr.last.point,R).point;if(l&&!n){var Hr=Ml(s.writingMode,_r,wr,Dt);if(Hr)return Hr}Rt=[pr.first];for(var Yr=s.glyphStartIndex+1;Yr<nr-1;Yr++)Rt.push(Cs(Wt*j.getoffsetX(Yr),kt,zt,n,Ye,qe,s.segment,Jt,Cr,ue,O,tt));Rt.push(pr.last)}else{if(l&&!n){var un=Ln(qe,b).point,_n=s.lineStartIndex+s.segment+1,ia=new o.Point(ue.getx(_n),ue.gety(_n)),pa=Ln(ia,b),ya=pa.signedDistanceFromCamera>0?pa.point:fa(qe,ia,un,1,b),Pa=Ml(s.writingMode,un,ya,Dt);if(Pa)return Pa}var Pn=Cs(Wt*j.getoffsetX(s.glyphStartIndex),kt,zt,n,Ye,qe,s.segment,s.lineStartIndex,s.lineStartIndex+s.lineLength,ue,O,tt);if(!Pn)return{notEnoughRoom:!0};Rt=[Pn]}for(var ga=0,aa=Rt;ga<aa.length;ga+=1){var zn=aa[ga];o.addDynamicAttributes(Te,zn.point,zn.angle)}return{}}function fa(s,a,n,l,b){var O=Ln(s.add(s.sub(a)._unit()),b).point,R=n.sub(O);return n.add(R._mult(l/R.mag()))}function Cs(s,a,n,l,b,O,R,j,ue,Te,Ye,qe){var tt=l?s-a:s+a,Dt=tt>0?1:-1,Rt=0;l&&(Dt*=-1,Rt=Math.PI),Dt<0&&(Rt+=Math.PI);for(var Wt=Dt>0?j+R:j+R+1,kt=b,zt=b,nr=0,Jt=0,Cr=Math.abs(tt),pr=[];nr+Jt<=Cr;){if((Wt+=Dt)<j||Wt>=ue)return null;if(zt=kt,pr.push(kt),(kt=qe[Wt])===void 0){var _r=new o.Point(Te.getx(Wt),Te.gety(Wt)),wr=Ln(_r,Ye);if(wr.signedDistanceFromCamera>0)kt=qe[Wt]=wr.point;else{var Hr=Wt-Dt;kt=fa(nr===0?O:new o.Point(Te.getx(Hr),Te.gety(Hr)),_r,zt,Cr-nr+1,Ye)}}nr+=Jt,Jt=zt.dist(kt)}var Yr=(Cr-nr)/Jt,un=kt.sub(zt),_n=un.mult(Yr)._add(zt);_n._add(un._unit()._perp()._mult(n*Dt));var ia=Rt+Math.atan2(kt.y-zt.y,kt.x-zt.x);return pr.push(_n),{point:_n,angle:ia,path:pr}}va.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},va.prototype.insert=function(s,a,n,l,b){this._forEachCell(a,n,l,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(a),this.bboxes.push(n),this.bboxes.push(l),this.bboxes.push(b)},va.prototype.insertCircle=function(s,a,n,l){this._forEachCell(a-l,n-l,a+l,n+l,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(a),this.circles.push(n),this.circles.push(l)},va.prototype._insertBoxCell=function(s,a,n,l,b,O){this.boxCells[b].push(O)},va.prototype._insertCircleCell=function(s,a,n,l,b,O){this.circleCells[b].push(O)},va.prototype._query=function(s,a,n,l,b,O){if(n<0||s>this.width||l<0||a>this.height)return!b&&[];var R=[];if(s<=0&&a<=0&&this.width<=n&&this.height<=l){if(b)return!0;for(var j=0;j<this.boxKeys.length;j++)R.push({key:this.boxKeys[j],x1:this.bboxes[4*j],y1:this.bboxes[4*j+1],x2:this.bboxes[4*j+2],y2:this.bboxes[4*j+3]});for(var ue=0;ue<this.circleKeys.length;ue++){var Te=this.circles[3*ue],Ye=this.circles[3*ue+1],qe=this.circles[3*ue+2];R.push({key:this.circleKeys[ue],x1:Te-qe,y1:Ye-qe,x2:Te+qe,y2:Ye+qe})}return O?R.filter(O):R}return this._forEachCell(s,a,n,l,this._queryCell,R,{hitTest:b,seenUids:{box:{},circle:{}}},O),b?R.length>0:R},va.prototype._queryCircle=function(s,a,n,l,b){var O=s-n,R=s+n,j=a-n,ue=a+n;if(R<0||O>this.width||ue<0||j>this.height)return!l&&[];var Te=[];return this._forEachCell(O,j,R,ue,this._queryCellCircle,Te,{hitTest:l,circle:{x:s,y:a,radius:n},seenUids:{box:{},circle:{}}},b),l?Te.length>0:Te},va.prototype.query=function(s,a,n,l,b){return this._query(s,a,n,l,!1,b)},va.prototype.hitTest=function(s,a,n,l,b){return this._query(s,a,n,l,!0,b)},va.prototype.hitTestCircle=function(s,a,n,l){return this._queryCircle(s,a,n,!0,l)},va.prototype._queryCell=function(s,a,n,l,b,O,R,j){var ue=R.seenUids,Te=this.boxCells[b];if(Te!==null)for(var Ye=this.bboxes,qe=0,tt=Te;qe<tt.length;qe+=1){var Dt=tt[qe];if(!ue.box[Dt]){ue.box[Dt]=!0;var Rt=4*Dt;if(s<=Ye[Rt+2]&&a<=Ye[Rt+3]&&n>=Ye[Rt+0]&&l>=Ye[Rt+1]&&(!j||j(this.boxKeys[Dt]))){if(R.hitTest)return O.push(!0),!0;O.push({key:this.boxKeys[Dt],x1:Ye[Rt],y1:Ye[Rt+1],x2:Ye[Rt+2],y2:Ye[Rt+3]})}}}var Wt=this.circleCells[b];if(Wt!==null)for(var kt=this.circles,zt=0,nr=Wt;zt<nr.length;zt+=1){var Jt=nr[zt];if(!ue.circle[Jt]){ue.circle[Jt]=!0;var Cr=3*Jt;if(this._circleAndRectCollide(kt[Cr],kt[Cr+1],kt[Cr+2],s,a,n,l)&&(!j||j(this.circleKeys[Jt]))){if(R.hitTest)return O.push(!0),!0;var pr=kt[Cr],_r=kt[Cr+1],wr=kt[Cr+2];O.push({key:this.circleKeys[Jt],x1:pr-wr,y1:_r-wr,x2:pr+wr,y2:_r+wr})}}}},va.prototype._queryCellCircle=function(s,a,n,l,b,O,R,j){var ue=R.circle,Te=R.seenUids,Ye=this.boxCells[b];if(Ye!==null)for(var qe=this.bboxes,tt=0,Dt=Ye;tt<Dt.length;tt+=1){var Rt=Dt[tt];if(!Te.box[Rt]){Te.box[Rt]=!0;var Wt=4*Rt;if(this._circleAndRectCollide(ue.x,ue.y,ue.radius,qe[Wt+0],qe[Wt+1],qe[Wt+2],qe[Wt+3])&&(!j||j(this.boxKeys[Rt])))return O.push(!0),!0}}var kt=this.circleCells[b];if(kt!==null)for(var zt=this.circles,nr=0,Jt=kt;nr<Jt.length;nr+=1){var Cr=Jt[nr];if(!Te.circle[Cr]){Te.circle[Cr]=!0;var pr=3*Cr;if(this._circlesCollide(zt[pr],zt[pr+1],zt[pr+2],ue.x,ue.y,ue.radius)&&(!j||j(this.circleKeys[Cr])))return O.push(!0),!0}}},va.prototype._forEachCell=function(s,a,n,l,b,O,R,j){for(var ue=this._convertToXCellCoord(s),Te=this._convertToYCellCoord(a),Ye=this._convertToXCellCoord(n),qe=this._convertToYCellCoord(l),tt=ue;tt<=Ye;tt++)for(var Dt=Te;Dt<=qe;Dt++)if(b.call(this,s,a,n,l,this.xCellCount*Dt+tt,O,R,j))return},va.prototype._convertToXCellCoord=function(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))},va.prototype._convertToYCellCoord=function(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))},va.prototype._circlesCollide=function(s,a,n,l,b,O){var R=l-s,j=b-a,ue=n+O;return ue*ue>R*R+j*j},va.prototype._circleAndRectCollide=function(s,a,n,l,b,O,R){var j=(O-l)/2,ue=Math.abs(s-(l+j));if(ue>j+n)return!1;var Te=(R-b)/2,Ye=Math.abs(a-(b+Te));if(Ye>Te+n)return!1;if(ue<=j||Ye<=Te)return!0;var qe=ue-j,tt=Ye-Te;return qe*qe+tt*tt<=n*n};var oo=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Na(s,a){for(var n=0;n<s;n++){var l=a.length;a.resize(l+4),a.float32.set(oo,3*l)}}function Fu(s,a,n){var l=a[0],b=a[1];return s[0]=n[0]*l+n[4]*b+n[12],s[1]=n[1]*l+n[5]*b+n[13],s[3]=n[3]*l+n[7]*b+n[15],s}var Ai=function(a,n,l){n===void 0&&(n=new va(a.width+200,a.height+200,25)),l===void 0&&(l=new va(a.width+200,a.height+200,25)),this.transform=a,this.grid=n,this.ignoredGrid=l,this.pitchfactor=Math.cos(a._pitch)*a.cameraToCenterDistance,this.screenRightBoundary=a.width+100,this.screenBottomBoundary=a.height+100,this.gridRightBoundary=a.width+200,this.gridBottomBoundary=a.height+200};function li(s,a,n){return a*(o.EXTENT/(s.tileSize*Math.pow(2,n-s.tileID.overscaledZ)))}Ai.prototype.placeCollisionBox=function(s,a,n,l,b){var O=this.projectAndGetPerspectiveRatio(l,s.anchorPointX,s.anchorPointY),R=n*O.perspectiveRatio,j=s.x1*R+O.point.x,ue=s.y1*R+O.point.y,Te=s.x2*R+O.point.x,Ye=s.y2*R+O.point.y;return!this.isInsideGrid(j,ue,Te,Ye)||!a&&this.grid.hitTest(j,ue,Te,Ye,b)?{box:[],offscreen:!1}:{box:[j,ue,Te,Ye],offscreen:this.isOffscreen(j,ue,Te,Ye)}},Ai.prototype.placeCollisionCircles=function(s,a,n,l,b,O,R,j,ue,Te,Ye,qe,tt){var Dt=[],Rt=new o.Point(a.anchorX,a.anchorY),Wt=Ln(Rt,O),kt=Ei(this.transform.cameraToCenterDistance,Wt.signedDistanceFromCamera),zt=(Te?b/kt:b*kt)/o.ONE_EM,nr=Ln(Rt,R).point,Jt=Oo(zt,l,a.lineOffsetX*zt,a.lineOffsetY*zt,!1,nr,Rt,a,n,R,{}),Cr=!1,pr=!1,_r=!0;if(Jt){for(var wr=.5*qe*kt+tt,Hr=new o.Point(-100,-100),Yr=new o.Point(this.screenRightBoundary,this.screenBottomBoundary),un=new Ri,_n=Jt.first,ia=Jt.last,pa=[],ya=_n.path.length-1;ya>=1;ya--)pa.push(_n.path[ya]);for(var Pa=1;Pa<ia.path.length;Pa++)pa.push(ia.path[Pa]);var Pn=2.5*wr;if(j){var ga=pa.map(function(ss){return Ln(ss,j)});pa=ga.some(function(ss){return ss.signedDistanceFromCamera<=0})?[]:ga.map(function(ss){return ss.point})}var aa=[];if(pa.length>0){for(var zn=pa[0].clone(),Ca=pa[0].clone(),qn=1;qn<pa.length;qn++)zn.x=Math.min(zn.x,pa[qn].x),zn.y=Math.min(zn.y,pa[qn].y),Ca.x=Math.max(Ca.x,pa[qn].x),Ca.y=Math.max(Ca.y,pa[qn].y);aa=zn.x>=Hr.x&&Ca.x<=Yr.x&&zn.y>=Hr.y&&Ca.y<=Yr.y?[pa]:Ca.x<Hr.x||zn.x>Yr.x||Ca.y<Hr.y||zn.y>Yr.y?[]:o.clipLine([pa],Hr.x,Hr.y,Yr.x,Yr.y)}for(var wa=0,Ja=aa;wa<Ja.length;wa+=1){var co;un.reset(Ja[wa],.25*wr),co=un.length<=.5*wr?1:Math.ceil(un.paddedLength/Pn)+1;for(var $i=0;$i<co;$i++){var Vi=$i/Math.max(co-1,1),fi=un.lerp(Vi),Ji=fi.x+100,Lo=fi.y+100;Dt.push(Ji,Lo,wr,0);var Iu=Ji-wr,Us=Lo-wr,Bs=Ji+wr,Jo=Lo+wr;if(_r=_r&&this.isOffscreen(Iu,Us,Bs,Jo),pr=pr||this.isInsideGrid(Iu,Us,Bs,Jo),!s&&this.grid.hitTestCircle(Ji,Lo,wr,Ye)&&(Cr=!0,!ue))return{circles:[],offscreen:!1,collisionDetected:Cr}}}}return{circles:!ue&&Cr||!pr?[]:Dt,offscreen:_r,collisionDetected:Cr}},Ai.prototype.queryRenderedSymbols=function(s){if(s.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var a=[],n=1/0,l=1/0,b=-1/0,O=-1/0,R=0,j=s;R<j.length;R+=1){var ue=j[R],Te=new o.Point(ue.x+100,ue.y+100);n=Math.min(n,Te.x),l=Math.min(l,Te.y),b=Math.max(b,Te.x),O=Math.max(O,Te.y),a.push(Te)}for(var Ye={},qe={},tt=0,Dt=this.grid.query(n,l,b,O).concat(this.ignoredGrid.query(n,l,b,O));tt<Dt.length;tt+=1){var Rt=Dt[tt],Wt=Rt.key;if(Ye[Wt.bucketInstanceId]===void 0&&(Ye[Wt.bucketInstanceId]={}),!Ye[Wt.bucketInstanceId][Wt.featureIndex]){var kt=[new o.Point(Rt.x1,Rt.y1),new o.Point(Rt.x2,Rt.y1),new o.Point(Rt.x2,Rt.y2),new o.Point(Rt.x1,Rt.y2)];o.polygonIntersectsPolygon(a,kt)&&(Ye[Wt.bucketInstanceId][Wt.featureIndex]=!0,qe[Wt.bucketInstanceId]===void 0&&(qe[Wt.bucketInstanceId]=[]),qe[Wt.bucketInstanceId].push(Wt.featureIndex))}}return qe},Ai.prototype.insertCollisionBox=function(s,a,n,l,b){(a?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:l,collisionGroupID:b},s[0],s[1],s[2],s[3])},Ai.prototype.insertCollisionCircles=function(s,a,n,l,b){for(var O=a?this.ignoredGrid:this.grid,R={bucketInstanceId:n,featureIndex:l,collisionGroupID:b},j=0;j<s.length;j+=4)O.insertCircle(R,s[j],s[j+1],s[j+2])},Ai.prototype.projectAndGetPerspectiveRatio=function(s,a,n){var l=[a,n,0,1];return Fu(l,l,s),{point:new o.Point((l[0]/l[3]+1)/2*this.transform.width+100,(-l[1]/l[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/l[3]*.5}},Ai.prototype.isOffscreen=function(s,a,n,l){return n<100||s>=this.screenRightBoundary||l<100||a>this.screenBottomBoundary},Ai.prototype.isInsideGrid=function(s,a,n,l){return n>=0&&s<this.gridRightBoundary&&l>=0&&a<this.gridBottomBoundary},Ai.prototype.getViewportMatrix=function(){var s=o.identity([]);return o.translate(s,s,[-100,-100,0]),s};var xo=function(a,n,l,b){this.opacity=a?Math.max(0,Math.min(1,a.opacity+(a.placed?n:-n))):b&&l?1:0,this.placed=l};xo.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var ms=function(a,n,l,b,O){this.text=new xo(a?a.text:null,n,l,O),this.icon=new xo(a?a.icon:null,n,b,O)};ms.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var so=function(a,n,l){this.text=a,this.icon=n,this.skipFade=l},Uu=function(){this.invProjMatrix=o.create(),this.viewportMatrix=o.create(),this.circles=[]},Ys=function(a,n,l,b,O){this.bucketInstanceId=a,this.featureIndex=n,this.sourceLayerIndex=l,this.bucketIndex=b,this.tileID=O},Eo=function(a){this.crossSourceCollisions=a,this.maxGroupID=0,this.collisionGroups={}};function fu(s,a,n,l,b){var O=o.getAnchorAlignment(s),R=-(O.horizontalAlign-.5)*a,j=-(O.verticalAlign-.5)*n,ue=o.evaluateVariableOffset(s,l);return new o.Point(R+ue[0]*b,j+ue[1]*b)}function Ut(s,a,n,l,b,O){var R=s.x1,j=s.x2,ue=s.y1,Te=s.y2,Ye=s.anchorPointX,qe=s.anchorPointY,tt=new o.Point(a,n);return l&&tt._rotate(b?O:-O),{x1:R+tt.x,y1:ue+tt.y,x2:j+tt.x,y2:Te+tt.y,anchorPointX:Ye,anchorPointY:qe}}Eo.prototype.get=function(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){var a=++this.maxGroupID;this.collisionGroups[s]={ID:a,predicate:function(l){return l.collisionGroupID===a}}}return this.collisionGroups[s]};var Ie=function(a,n,l,b){this.transform=a.clone(),this.collisionIndex=new Ai(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=n,this.retainedQueryData={},this.collisionGroups=new Eo(l),this.collisionCircleArrays={},this.prevPlacement=b,b&&(b.prevPlacement=void 0),this.placedOrientations={}};function Mt(s,a,n,l,b){s.emplaceBack(a?1:0,n?1:0,l||0,b||0),s.emplaceBack(a?1:0,n?1:0,l||0,b||0),s.emplaceBack(a?1:0,n?1:0,l||0,b||0),s.emplaceBack(a?1:0,n?1:0,l||0,b||0)}Ie.prototype.getBucketParts=function(s,a,n,l){var b=n.getBucket(a),O=n.latestFeatureIndex;if(b&&O&&a.id===b.layerIds[0]){var R=n.collisionBoxArray,j=b.layers[0].layout,ue=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),Te=n.tileSize/o.EXTENT,Ye=this.transform.calculatePosMatrix(n.tileID.toUnwrapped()),qe=j.get("text-pitch-alignment")==="map",tt=j.get("text-rotation-alignment")==="map",Dt=li(n,1,this.transform.zoom),Rt=ii(Ye,qe,tt,this.transform,Dt),Wt=null;if(qe){var kt=Ia(Ye,qe,tt,this.transform,Dt);Wt=o.multiply([],this.transform.labelPlaneMatrix,kt)}this.retainedQueryData[b.bucketInstanceId]=new Ys(b.bucketInstanceId,O,b.sourceLayerIndex,b.index,n.tileID);var zt={bucket:b,layout:j,posMatrix:Ye,textLabelPlaneMatrix:Rt,labelToScreenMatrix:Wt,scale:ue,textPixelRatio:Te,holdingForFade:n.holdingForFade(),collisionBoxArray:R,partiallyEvaluatedTextSize:o.evaluateSizeForZoom(b.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(b.sourceID)};if(l)for(var nr=0,Jt=b.sortKeyRanges;nr<Jt.length;nr+=1){var Cr=Jt[nr];s.push({sortKey:Cr.sortKey,symbolInstanceStart:Cr.symbolInstanceStart,symbolInstanceEnd:Cr.symbolInstanceEnd,parameters:zt})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:b.symbolInstances.length,parameters:zt})}},Ie.prototype.attemptAnchorPlacement=function(s,a,n,l,b,O,R,j,ue,Te,Ye,qe,tt,Dt,Rt){var Wt,kt=[qe.textOffset0,qe.textOffset1],zt=fu(s,n,l,kt,b),nr=this.collisionIndex.placeCollisionBox(Ut(a,zt.x,zt.y,O,R,this.transform.angle),Ye,j,ue,Te.predicate);if(!Rt||this.collisionIndex.placeCollisionBox(Ut(Rt,zt.x,zt.y,O,R,this.transform.angle),Ye,j,ue,Te.predicate).box.length!==0)return nr.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[qe.crossTileID]&&this.prevPlacement.placements[qe.crossTileID]&&this.prevPlacement.placements[qe.crossTileID].text&&(Wt=this.prevPlacement.variableOffsets[qe.crossTileID].anchor),this.variableOffsets[qe.crossTileID]={textOffset:kt,width:n,height:l,anchor:s,textBoxScale:b,prevAnchor:Wt},this.markUsedJustification(tt,s,qe,Dt),tt.allowVerticalPlacement&&(this.markUsedOrientation(tt,Dt,qe),this.placedOrientations[qe.crossTileID]=Dt),{shift:zt,placedGlyphBoxes:nr}):void 0},Ie.prototype.placeLayerBucketPart=function(s,a,n){var l=this,b=s.parameters,O=b.bucket,R=b.layout,j=b.posMatrix,ue=b.textLabelPlaneMatrix,Te=b.labelToScreenMatrix,Ye=b.textPixelRatio,qe=b.holdingForFade,tt=b.collisionBoxArray,Dt=b.partiallyEvaluatedTextSize,Rt=b.collisionGroup,Wt=R.get("text-optional"),kt=R.get("icon-optional"),zt=R.get("text-allow-overlap"),nr=R.get("icon-allow-overlap"),Jt=R.get("text-rotation-alignment")==="map",Cr=R.get("text-pitch-alignment")==="map",pr=R.get("icon-text-fit")!=="none",_r=R.get("symbol-z-order")==="viewport-y",wr=zt&&(nr||!O.hasIconData()||kt),Hr=nr&&(zt||!O.hasTextData()||Wt);!O.collisionArrays&&tt&&O.deserializeCollisionBoxes(tt);var Yr=function(Pn,ga){if(!a[Pn.crossTileID])if(qe)l.placements[Pn.crossTileID]=new so(!1,!1,!1);else{var aa,zn=!1,Ca=!1,qn=!0,wa=null,Ja={box:null,offscreen:null},co={box:null,offscreen:null},$i=null,Vi=null,fi=0,Ji=0,Lo=0;ga.textFeatureIndex?fi=ga.textFeatureIndex:Pn.useRuntimeCollisionCircles&&(fi=Pn.featureIndex),ga.verticalTextFeatureIndex&&(Ji=ga.verticalTextFeatureIndex);var Iu=ga.textBox;if(Iu){var Us=function(to){var Vs=o.WritingMode.horizontal;if(O.allowVerticalPlacement&&!to&&l.prevPlacement){var ro=l.prevPlacement.placedOrientations[Pn.crossTileID];ro&&(l.placedOrientations[Pn.crossTileID]=ro,l.markUsedOrientation(O,Vs=ro,Pn))}return Vs},Bs=function(to,Vs){if(O.allowVerticalPlacement&&Pn.numVerticalGlyphVertices>0&&ga.verticalTextBox)for(var ro=0,$u=O.writingModes;ro<$u.length&&($u[ro]===o.WritingMode.vertical?(Ja=Vs(),co=Ja):Ja=to(),!(Ja&&Ja.box&&Ja.box.length));ro+=1);else Ja=to()};if(R.get("text-variable-anchor")){var Jo=R.get("text-variable-anchor");if(l.prevPlacement&&l.prevPlacement.variableOffsets[Pn.crossTileID]){var ss=l.prevPlacement.variableOffsets[Pn.crossTileID];Jo.indexOf(ss.anchor)>0&&(Jo=Jo.filter(function(xs){return xs!==ss.anchor})).unshift(ss.anchor)}var Al=function(to,Vs,ro){for(var $u=to.x2-to.x1,pl=to.y2-to.y1,ml=Pn.textBoxScale,Ac=pr&&!nr?Vs:null,Ju={box:[],offscreen:!1},Wl=zt?2*Jo.length:Jo.length,Uo=0;Uo<Wl;++Uo){var vo=l.attemptAnchorPlacement(Jo[Uo%Jo.length],to,$u,pl,ml,Jt,Cr,Ye,j,Rt,Uo>=Jo.length,Pn,O,ro,Ac);if(vo&&(Ju=vo.placedGlyphBoxes)&&Ju.box&&Ju.box.length){zn=!0,wa=vo.shift;break}}return Ju};Bs(function(){return Al(Iu,ga.iconBox,o.WritingMode.horizontal)},function(){var xs=ga.verticalTextBox;return O.allowVerticalPlacement&&!(Ja&&Ja.box&&Ja.box.length)&&Pn.numVerticalGlyphVertices>0&&xs?Al(xs,ga.verticalIconBox,o.WritingMode.vertical):{box:null,offscreen:null}}),Ja&&(zn=Ja.box,qn=Ja.offscreen);var Eu=Us(Ja&&Ja.box);if(!zn&&l.prevPlacement){var dl=l.prevPlacement.variableOffsets[Pn.crossTileID];dl&&(l.variableOffsets[Pn.crossTileID]=dl,l.markUsedJustification(O,dl.anchor,Pn,Eu))}}else{var Gl=function(to,Vs){var ro=l.collisionIndex.placeCollisionBox(to,zt,Ye,j,Rt.predicate);return ro&&ro.box&&ro.box.length&&(l.markUsedOrientation(O,Vs,Pn),l.placedOrientations[Pn.crossTileID]=Vs),ro};Bs(function(){return Gl(Iu,o.WritingMode.horizontal)},function(){var xs=ga.verticalTextBox;return O.allowVerticalPlacement&&Pn.numVerticalGlyphVertices>0&&xs?Gl(xs,o.WritingMode.vertical):{box:null,offscreen:null}}),Us(Ja&&Ja.box&&Ja.box.length)}}if(zn=(aa=Ja)&&aa.box&&aa.box.length>0,qn=aa&&aa.offscreen,Pn.useRuntimeCollisionCircles){var Du=O.text.placedSymbolArray.get(Pn.centerJustifiedTextSymbolIndex),Kc=o.evaluateSizeForFeature(O.textSizeData,Dt,Du),Ku=R.get("text-padding");$i=l.collisionIndex.placeCollisionCircles(zt,Du,O.lineVertexArray,O.glyphOffsetArray,Kc,j,ue,Te,n,Cr,Rt.predicate,Pn.collisionCircleDiameter,Ku),zn=zt||$i.circles.length>0&&!$i.collisionDetected,qn=qn&&$i.offscreen}if(ga.iconFeatureIndex&&(Lo=ga.iconFeatureIndex),ga.iconBox){var eo=function(to){var Vs=pr&&wa?Ut(to,wa.x,wa.y,Jt,Cr,l.transform.angle):to;return l.collisionIndex.placeCollisionBox(Vs,nr,Ye,j,Rt.predicate)};Ca=co&&co.box&&co.box.length&&ga.verticalIconBox?(Vi=eo(ga.verticalIconBox)).box.length>0:(Vi=eo(ga.iconBox)).box.length>0,qn=qn&&Vi.offscreen}var Rs=Wt||Pn.numHorizontalGlyphVertices===0&&Pn.numVerticalGlyphVertices===0,Hl=kt||Pn.numIconVertices===0;if(Rs||Hl?Hl?Rs||(Ca=Ca&&zn):zn=Ca&&zn:Ca=zn=Ca&&zn,zn&&aa&&aa.box&&l.collisionIndex.insertCollisionBox(aa.box,R.get("text-ignore-placement"),O.bucketInstanceId,co&&co.box&&Ji?Ji:fi,Rt.ID),Ca&&Vi&&l.collisionIndex.insertCollisionBox(Vi.box,R.get("icon-ignore-placement"),O.bucketInstanceId,Lo,Rt.ID),$i&&(zn&&l.collisionIndex.insertCollisionCircles($i.circles,R.get("text-ignore-placement"),O.bucketInstanceId,fi,Rt.ID),n)){var fc=O.bucketInstanceId,Xi=l.collisionCircleArrays[fc];Xi===void 0&&(Xi=l.collisionCircleArrays[fc]=new Uu);for(var jo=0;jo<$i.circles.length;jo+=4)Xi.circles.push($i.circles[jo+0]),Xi.circles.push($i.circles[jo+1]),Xi.circles.push($i.circles[jo+2]),Xi.circles.push($i.collisionDetected?1:0)}l.placements[Pn.crossTileID]=new so(zn||wr,Ca||Hr,qn||O.justReloaded),a[Pn.crossTileID]=!0}};if(_r)for(var un=O.getSortedSymbolIndexes(this.transform.angle),_n=un.length-1;_n>=0;--_n){var ia=un[_n];Yr(O.symbolInstances.get(ia),O.collisionArrays[ia])}else for(var pa=s.symbolInstanceStart;pa<s.symbolInstanceEnd;pa++)Yr(O.symbolInstances.get(pa),O.collisionArrays[pa]);if(n&&O.bucketInstanceId in this.collisionCircleArrays){var ya=this.collisionCircleArrays[O.bucketInstanceId];o.invert(ya.invProjMatrix,j),ya.viewportMatrix=this.collisionIndex.getViewportMatrix()}O.justReloaded=!1},Ie.prototype.markUsedJustification=function(s,a,n,l){var b;b=l===o.WritingMode.vertical?n.verticalPlacedTextSymbolIndex:{left:n.leftJustifiedTextSymbolIndex,center:n.centerJustifiedTextSymbolIndex,right:n.rightJustifiedTextSymbolIndex}[o.getAnchorJustification(a)];for(var O=0,R=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex,n.verticalPlacedTextSymbolIndex];O<R.length;O+=1){var j=R[O];j>=0&&(s.text.placedSymbolArray.get(j).crossTileID=b>=0&&j!==b?0:n.crossTileID)}},Ie.prototype.markUsedOrientation=function(s,a,n){for(var l=a===o.WritingMode.horizontal||a===o.WritingMode.horizontalOnly?a:0,b=a===o.WritingMode.vertical?a:0,O=0,R=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex];O<R.length;O+=1)s.text.placedSymbolArray.get(R[O]).placedOrientation=l;n.verticalPlacedTextSymbolIndex&&(s.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).placedOrientation=b)},Ie.prototype.commit=function(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;var a=this.prevPlacement,n=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;var l=a?a.symbolFadeChange(s):1,b=a?a.opacities:{},O=a?a.variableOffsets:{},R=a?a.placedOrientations:{};for(var j in this.placements){var ue=this.placements[j],Te=b[j];Te?(this.opacities[j]=new ms(Te,l,ue.text,ue.icon),n=n||ue.text!==Te.text.placed||ue.icon!==Te.icon.placed):(this.opacities[j]=new ms(null,l,ue.text,ue.icon,ue.skipFade),n=n||ue.text||ue.icon)}for(var Ye in b){var qe=b[Ye];if(!this.opacities[Ye]){var tt=new ms(qe,l,!1,!1);tt.isHidden()||(this.opacities[Ye]=tt,n=n||qe.text.placed||qe.icon.placed)}}for(var Dt in O)this.variableOffsets[Dt]||!this.opacities[Dt]||this.opacities[Dt].isHidden()||(this.variableOffsets[Dt]=O[Dt]);for(var Rt in R)this.placedOrientations[Rt]||!this.opacities[Rt]||this.opacities[Rt].isHidden()||(this.placedOrientations[Rt]=R[Rt]);n?this.lastPlacementChangeTime=s:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:s)},Ie.prototype.updateLayerOpacities=function(s,a){for(var n={},l=0,b=a;l<b.length;l+=1){var O=b[l],R=O.getBucket(s);R&&O.latestFeatureIndex&&s.id===R.layerIds[0]&&this.updateBucketOpacities(R,n,O.collisionBoxArray)}},Ie.prototype.updateBucketOpacities=function(s,a,n){var l=this;s.hasTextData()&&s.text.opacityVertexArray.clear(),s.hasIconData()&&s.icon.opacityVertexArray.clear(),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();var b=s.layers[0].layout,O=new ms(null,0,!1,!1,!0),R=b.get("text-allow-overlap"),j=b.get("icon-allow-overlap"),ue=b.get("text-variable-anchor"),Te=b.get("text-rotation-alignment")==="map",Ye=b.get("text-pitch-alignment")==="map",qe=b.get("icon-text-fit")!=="none",tt=new ms(null,0,R&&(j||!s.hasIconData()||b.get("icon-optional")),j&&(R||!s.hasTextData()||b.get("text-optional")),!0);!s.collisionArrays&&n&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(n);for(var Dt=function(nr,Jt,Cr){for(var pr=0;pr<Jt/4;pr++)nr.opacityVertexArray.emplaceBack(Cr)},Rt=function(nr){var Jt=s.symbolInstances.get(nr),Cr=Jt.numHorizontalGlyphVertices,pr=Jt.numVerticalGlyphVertices,_r=Jt.crossTileID,wr=l.opacities[_r];a[_r]?wr=O:wr||(l.opacities[_r]=wr=tt),a[_r]=!0;var Hr=Jt.numIconVertices>0,Yr=l.placedOrientations[Jt.crossTileID],un=Yr===o.WritingMode.vertical,_n=Yr===o.WritingMode.horizontal||Yr===o.WritingMode.horizontalOnly;if(Cr>0||pr>0){var ia=To(wr.text);Dt(s.text,Cr,un?tl:ia),Dt(s.text,pr,_n?tl:ia);var pa=wr.text.isHidden();[Jt.rightJustifiedTextSymbolIndex,Jt.centerJustifiedTextSymbolIndex,Jt.leftJustifiedTextSymbolIndex].forEach(function(Ja){Ja>=0&&(s.text.placedSymbolArray.get(Ja).hidden=pa||un?1:0)}),Jt.verticalPlacedTextSymbolIndex>=0&&(s.text.placedSymbolArray.get(Jt.verticalPlacedTextSymbolIndex).hidden=pa||_n?1:0);var ya=l.variableOffsets[Jt.crossTileID];ya&&l.markUsedJustification(s,ya.anchor,Jt,Yr);var Pa=l.placedOrientations[Jt.crossTileID];Pa&&(l.markUsedJustification(s,"left",Jt,Pa),l.markUsedOrientation(s,Pa,Jt))}if(Hr){var Pn=To(wr.icon),ga=!(qe&&Jt.verticalPlacedIconSymbolIndex&&un);Jt.placedIconSymbolIndex>=0&&(Dt(s.icon,Jt.numIconVertices,ga?Pn:tl),s.icon.placedSymbolArray.get(Jt.placedIconSymbolIndex).hidden=wr.icon.isHidden()),Jt.verticalPlacedIconSymbolIndex>=0&&(Dt(s.icon,Jt.numVerticalIconVertices,ga?tl:Pn),s.icon.placedSymbolArray.get(Jt.verticalPlacedIconSymbolIndex).hidden=wr.icon.isHidden())}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){var aa=s.collisionArrays[nr];if(aa){var zn=new o.Point(0,0);if(aa.textBox||aa.verticalTextBox){var Ca=!0;if(ue){var qn=l.variableOffsets[_r];qn?(zn=fu(qn.anchor,qn.width,qn.height,qn.textOffset,qn.textBoxScale),Te&&zn._rotate(Ye?l.transform.angle:-l.transform.angle)):Ca=!1}aa.textBox&&Mt(s.textCollisionBox.collisionVertexArray,wr.text.placed,!Ca||un,zn.x,zn.y),aa.verticalTextBox&&Mt(s.textCollisionBox.collisionVertexArray,wr.text.placed,!Ca||_n,zn.x,zn.y)}var wa=Boolean(!_n&&aa.verticalIconBox);aa.iconBox&&Mt(s.iconCollisionBox.collisionVertexArray,wr.icon.placed,wa,qe?zn.x:0,qe?zn.y:0),aa.verticalIconBox&&Mt(s.iconCollisionBox.collisionVertexArray,wr.icon.placed,!wa,qe?zn.x:0,qe?zn.y:0)}}},Wt=0;Wt<s.symbolInstances.length;Wt++)Rt(Wt);if(s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.bucketInstanceId in this.collisionCircleArrays){var kt=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=kt.invProjMatrix,s.placementViewportMatrix=kt.viewportMatrix,s.collisionCircleArray=kt.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}},Ie.prototype.symbolFadeChange=function(s){return this.fadeDuration===0?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Ie.prototype.zoomAdjustment=function(s){return Math.max(0,(this.transform.zoom-s)/1.5)},Ie.prototype.hasTransitions=function(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration},Ie.prototype.stillRecent=function(s,a){var n=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*n>s},Ie.prototype.setStale=function(){this.stale=!0};var cr=Math.pow(2,25),en=Math.pow(2,24),bn=Math.pow(2,17),jn=Math.pow(2,16),Fi=Math.pow(2,9),qi=Math.pow(2,8),Mo=Math.pow(2,1);function To(s){if(s.opacity===0&&!s.placed)return 0;if(s.opacity===1&&s.placed)return 4294967295;var a=s.placed?1:0,n=Math.floor(127*s.opacity);return n*cr+a*en+n*bn+a*jn+n*Fi+a*qi+n*Mo+a}var tl=0,ql=function(a){this._sortAcrossTiles=a.layout.get("symbol-z-order")!=="viewport-y"&&a.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};ql.prototype.continuePlacement=function(s,a,n,l,b){for(var O=this._bucketParts;this._currentTileIndex<s.length;)if(a.getBucketParts(O,l,s[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,O.sort(function(R,j){return R.sortKey-j.sortKey}));this._currentPartIndex<O.length;)if(a.placeLayerBucketPart(O[this._currentPartIndex],this._seenCrossTileIDs,n),this._currentPartIndex++,b())return!0;return!1};var Ks=function(a,n,l,b,O,R,j){this.placement=new Ie(a,O,R,j),this._currentPlacementIndex=n.length-1,this._forceFullPlacement=l,this._showCollisionBoxes=b,this._done=!1};Ks.prototype.isDone=function(){return this._done},Ks.prototype.continuePlacement=function(s,a,n){for(var l=this,b=o.browser.now(),O=function(){var Te=o.browser.now()-b;return!l._forceFullPlacement&&Te>2};this._currentPlacementIndex>=0;){var R=a[s[this._currentPlacementIndex]],j=this.placement.collisionIndex.transform.zoom;if(R.type==="symbol"&&(!R.minzoom||R.minzoom<=j)&&(!R.maxzoom||R.maxzoom>j)){if(this._inProgressLayer||(this._inProgressLayer=new ql(R)),this._inProgressLayer.continuePlacement(n[R.source],this.placement,this._showCollisionBoxes,R,O))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Ks.prototype.commit=function(s){return this.placement.commit(s),this.placement};var jc=512/o.EXTENT/2,vs=function(a,n,l){this.tileID=a,this.indexedSymbolInstances={},this.bucketInstanceId=l;for(var b=0;b<n.length;b++){var O=n.get(b),R=O.key;this.indexedSymbolInstances[R]||(this.indexedSymbolInstances[R]=[]),this.indexedSymbolInstances[R].push({crossTileID:O.crossTileID,coord:this.getScaledCoordinates(O,a)})}};vs.prototype.getScaledCoordinates=function(s,a){var n=jc/Math.pow(2,a.canonical.z-this.tileID.canonical.z);return{x:Math.floor((a.canonical.x*o.EXTENT+s.anchorX)*n),y:Math.floor((a.canonical.y*o.EXTENT+s.anchorY)*n)}},vs.prototype.findMatches=function(s,a,n){for(var l=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z),b=0;b<s.length;b++){var O=s.get(b);if(!O.crossTileID){var R=this.indexedSymbolInstances[O.key];if(R)for(var j=this.getScaledCoordinates(O,a),ue=0,Te=R;ue<Te.length;ue+=1){var Ye=Te[ue];if(Math.abs(Ye.coord.x-j.x)<=l&&Math.abs(Ye.coord.y-j.y)<=l&&!n[Ye.crossTileID]){n[Ye.crossTileID]=!0,O.crossTileID=Ye.crossTileID;break}}}}};var Bu=function(){this.maxCrossTileID=0};Bu.prototype.generate=function(){return++this.maxCrossTileID};var ws=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};ws.prototype.handleWrapJump=function(s){var a=Math.round((s-this.lng)/360);if(a!==0)for(var n in this.indexes){var l=this.indexes[n],b={};for(var O in l){var R=l[O];R.tileID=R.tileID.unwrapTo(R.tileID.wrap+a),b[R.tileID.key]=R}this.indexes[n]=b}this.lng=s},ws.prototype.addBucket=function(s,a,n){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(var l=0;l<a.symbolInstances.length;l++)a.symbolInstances.get(l).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]={});var b=this.usedCrossTileIDs[s.overscaledZ];for(var O in this.indexes){var R=this.indexes[O];if(Number(O)>s.overscaledZ)for(var j in R){var ue=R[j];ue.tileID.isChildOf(s)&&ue.findMatches(a.symbolInstances,s,b)}else{var Te=R[s.scaledTo(Number(O)).key];Te&&Te.findMatches(a.symbolInstances,s,b)}}for(var Ye=0;Ye<a.symbolInstances.length;Ye++){var qe=a.symbolInstances.get(Ye);qe.crossTileID||(qe.crossTileID=n.generate(),b[qe.crossTileID]=!0)}return this.indexes[s.overscaledZ]===void 0&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new vs(s,a.symbolInstances,a.bucketInstanceId),!0},ws.prototype.removeBucketCrossTileIDs=function(s,a){for(var n in a.indexedSymbolInstances)for(var l=0,b=a.indexedSymbolInstances[n];l<b.length;l+=1)delete this.usedCrossTileIDs[s][b[l].crossTileID]},ws.prototype.removeStaleBuckets=function(s){var a=!1;for(var n in this.indexes){var l=this.indexes[n];for(var b in l)s[l[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,l[b]),delete l[b],a=!0)}return a};var _o=function(){this.layerIndexes={},this.crossTileIDs=new Bu,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};_o.prototype.addLayer=function(s,a,n){var l=this.layerIndexes[s.id];l===void 0&&(l=this.layerIndexes[s.id]=new ws);var b=!1,O={};l.handleWrapJump(n);for(var R=0,j=a;R<j.length;R+=1){var ue=j[R],Te=ue.getBucket(s);Te&&s.id===Te.layerIds[0]&&(Te.bucketInstanceId||(Te.bucketInstanceId=++this.maxBucketInstanceId),l.addBucket(ue.tileID,Te,this.crossTileIDs)&&(b=!0),O[Te.bucketInstanceId]=!0)}return l.removeStaleBuckets(O)&&(b=!0),b},_o.prototype.pruneUnusedLayers=function(s){var a={};for(var n in s.forEach(function(l){a[l]=!0}),this.layerIndexes)a[n]||delete this.layerIndexes[n]};var Po=function(a,n){return o.emitValidationErrors(a,n&&n.filter(function(l){return l.identifier!=="source.canvas"}))},$s=o.pick(gn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),bl=o.pick(gn,["setCenter","setZoom","setBearing","setPitch"]),Su=function(){var s={},a=o.styleSpec.$version;for(var n in o.styleSpec.$root){var l,b=o.styleSpec.$root[n];b.required&&((l=n==="version"?a:b.type==="array"?[]:{})!=null&&(s[n]=l))}return s}(),ka=function(s){function a(n,l){var b=this;l===void 0&&(l={}),s.call(this),this.map=n,this.dispatcher=new ut(Xr(),this),this.imageManager=new je,this.imageManager.setEventedParent(this),this.glyphManager=new Ne(n._requestManager,l.localIdeographFontFamily),this.lineAtlas=new Le(256,512),this.crossTileSymbolIndex=new _o,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.getReferrer());var O=this;this._rtlTextPluginCallback=a.registerForPluginStateChange(function(R){O.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:R.pluginStatus,pluginURL:R.pluginURL},function(j,ue){if(o.triggerPluginCompletionEvent(j),ue&&ue.every(function(Ye){return Ye}))for(var Te in O.sourceCaches)O.sourceCaches[Te].reload()})}),this.on("data",function(R){if(R.dataType==="source"&&R.sourceDataType==="metadata"){var j=b.sourceCaches[R.sourceId];if(j){var ue=j.getSource();if(ue&&ue.vectorLayerIds)for(var Te in b._layers){var Ye=b._layers[Te];Ye.source===ue.id&&b._validateLayer(Ye)}}}})}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.loadURL=function(n,l){var b=this;l===void 0&&(l={}),this.fire(new o.Event("dataloading",{dataType:"style"}));var O=typeof l.validate=="boolean"?l.validate:!o.isMapboxURL(n);n=this.map._requestManager.normalizeStyleURL(n,l.accessToken);var R=this.map._requestManager.transformRequest(n,o.ResourceType.Style);this._request=o.getJSON(R,function(j,ue){b._request=null,j?b.fire(new o.ErrorEvent(j)):ue&&b._load(ue,O)})},a.prototype.loadJSON=function(n,l){var b=this;l===void 0&&(l={}),this.fire(new o.Event("dataloading",{dataType:"style"})),this._request=o.browser.frame(function(){b._request=null,b._load(n,l.validate!==!1)})},a.prototype.loadEmpty=function(){this.fire(new o.Event("dataloading",{dataType:"style"})),this._load(Su,!1)},a.prototype._load=function(n,l){if(!l||!Po(this,o.validateStyle(n))){for(var b in this._loaded=!0,this.stylesheet=n,n.sources)this.addSource(b,n.sources[b],{validate:!1});n.sprite?this._loadSprite(n.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(n.glyphs);var O=Kn(this.stylesheet.layers);this._order=O.map(function(Te){return Te.id}),this._layers={},this._serializedLayers={};for(var R=0,j=O;R<j.length;R+=1){var ue=j[R];(ue=o.createStyleLayer(ue)).setEventedParent(this,{layer:{id:ue.id}}),this._layers[ue.id]=ue,this._serializedLayers[ue.id]=ue.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new st(this.stylesheet.light),this.fire(new o.Event("data",{dataType:"style"})),this.fire(new o.Event("style.load"))}},a.prototype._loadSprite=function(n){var l=this;this._spriteRequest=function(b,O,R){var j,ue,Te,Ye=o.browser.devicePixelRatio>1?"@2x":"",qe=o.getJSON(O.transformRequest(O.normalizeSpriteURL(b,Ye,".json"),o.ResourceType.SpriteJSON),function(Rt,Wt){qe=null,Te||(Te=Rt,j=Wt,Dt())}),tt=o.getImage(O.transformRequest(O.normalizeSpriteURL(b,Ye,".png"),o.ResourceType.SpriteImage),function(Rt,Wt){tt=null,Te||(Te=Rt,ue=Wt,Dt())});function Dt(){if(Te)R(Te);else if(j&&ue){var Rt=o.browser.getImageData(ue),Wt={};for(var kt in j){var zt=j[kt],nr=zt.width,Jt=zt.height,Cr=zt.x,pr=zt.y,_r=zt.sdf,wr=zt.pixelRatio,Hr=zt.stretchX,Yr=zt.stretchY,un=zt.content,_n=new o.RGBAImage({width:nr,height:Jt});o.RGBAImage.copy(Rt,_n,{x:Cr,y:pr},{x:0,y:0},{width:nr,height:Jt}),Wt[kt]={data:_n,pixelRatio:wr,sdf:_r,stretchX:Hr,stretchY:Yr,content:un}}R(null,Wt)}}return{cancel:function(){qe&&(qe.cancel(),qe=null),tt&&(tt.cancel(),tt=null)}}}(n,this.map._requestManager,function(b,O){if(l._spriteRequest=null,b)l.fire(new o.ErrorEvent(b));else if(O)for(var R in O)l.imageManager.addImage(R,O[R]);l.imageManager.setLoaded(!0),l._availableImages=l.imageManager.listImages(),l.dispatcher.broadcast("setImages",l._availableImages),l.fire(new o.Event("data",{dataType:"style"}))})},a.prototype._validateLayer=function(n){var l=this.sourceCaches[n.source];if(l){var b=n.sourceLayer;if(b){var O=l.getSource();(O.type==="geojson"||O.vectorLayerIds&&O.vectorLayerIds.indexOf(b)===-1)&&this.fire(new o.ErrorEvent(new Error('Source layer "'+b+'" does not exist on source "'+O.id+'" as specified by style layer "'+n.id+'"')))}}},a.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var n in this.sourceCaches)if(!this.sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()},a.prototype._serializeLayers=function(n){for(var l=[],b=0,O=n;b<O.length;b+=1){var R=this._layers[O[b]];R.type!=="custom"&&l.push(R.serialize())}return l},a.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var n in this.sourceCaches)if(this.sourceCaches[n].hasTransition())return!0;for(var l in this._layers)if(this._layers[l].hasTransition())return!0;return!1},a.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},a.prototype.update=function(n){if(this._loaded){var l=this._changed;if(this._changed){var b=Object.keys(this._updatedLayers),O=Object.keys(this._removedLayers);for(var R in(b.length||O.length)&&this._updateWorkerLayers(b,O),this._updatedSources){var j=this._updatedSources[R];j==="reload"?this._reloadSource(R):j==="clear"&&this._clearSource(R)}for(var ue in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[ue].updateTransitions(n);this.light.updateTransitions(n),this._resetUpdates()}for(var Te in this.sourceCaches)this.sourceCaches[Te].used=!1;for(var Ye=0,qe=this._order;Ye<qe.length;Ye+=1){var tt=this._layers[qe[Ye]];tt.recalculate(n,this._availableImages),!tt.isHidden(n.zoom)&&tt.source&&(this.sourceCaches[tt.source].used=!0)}this.light.recalculate(n),this.z=n.zoom,l&&this.fire(new o.Event("data",{dataType:"style"}))}},a.prototype._updateTilesForChangedImages=function(){var n=Object.keys(this._changedImages);if(n.length){for(var l in this.sourceCaches)this.sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}},a.prototype._updateWorkerLayers=function(n,l){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(n),removedIds:l})},a.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},a.prototype.setState=function(n){var l=this;if(this._checkLoaded(),Po(this,o.validateStyle(n)))return!1;(n=o.clone$1(n)).layers=Kn(n.layers);var b=function(R,j){if(!R)return[{command:gn.setStyle,args:[j]}];var ue=[];try{if(!o.deepEqual(R.version,j.version))return[{command:gn.setStyle,args:[j]}];o.deepEqual(R.center,j.center)||ue.push({command:gn.setCenter,args:[j.center]}),o.deepEqual(R.zoom,j.zoom)||ue.push({command:gn.setZoom,args:[j.zoom]}),o.deepEqual(R.bearing,j.bearing)||ue.push({command:gn.setBearing,args:[j.bearing]}),o.deepEqual(R.pitch,j.pitch)||ue.push({command:gn.setPitch,args:[j.pitch]}),o.deepEqual(R.sprite,j.sprite)||ue.push({command:gn.setSprite,args:[j.sprite]}),o.deepEqual(R.glyphs,j.glyphs)||ue.push({command:gn.setGlyphs,args:[j.glyphs]}),o.deepEqual(R.transition,j.transition)||ue.push({command:gn.setTransition,args:[j.transition]}),o.deepEqual(R.light,j.light)||ue.push({command:gn.setLight,args:[j.light]});var Te={},Ye=[];!function(tt,Dt,Rt,Wt){var kt;for(kt in Dt=Dt||{},tt=tt||{})tt.hasOwnProperty(kt)&&(Dt.hasOwnProperty(kt)||kn(kt,Rt,Wt));for(kt in Dt)Dt.hasOwnProperty(kt)&&(tt.hasOwnProperty(kt)?o.deepEqual(tt[kt],Dt[kt])||(tt[kt].type==="geojson"&&Dt[kt].type==="geojson"&&Za(tt,Dt,kt)?Rt.push({command:gn.setGeoJSONSourceData,args:[kt,Dt[kt].data]}):An(kt,Dt,Rt,Wt)):ur(kt,Dt,Rt))}(R.sources,j.sources,Ye,Te);var qe=[];R.layers&&R.layers.forEach(function(tt){Te[tt.source]?ue.push({command:gn.removeLayer,args:[tt.id]}):qe.push(tt)}),ue=ue.concat(Ye),function(tt,Dt,Rt){Dt=Dt||[];var Wt,kt,zt,nr,Jt,Cr,pr,_r=(tt=tt||[]).map(ca),wr=Dt.map(ca),Hr=tt.reduce(bo,{}),Yr=Dt.reduce(bo,{}),un=_r.slice(),_n=Object.create(null);for(Wt=0,kt=0;Wt<_r.length;Wt++)Yr.hasOwnProperty(zt=_r[Wt])?kt++:(Rt.push({command:gn.removeLayer,args:[zt]}),un.splice(un.indexOf(zt,kt),1));for(Wt=0,kt=0;Wt<wr.length;Wt++)un[un.length-1-Wt]!==(zt=wr[wr.length-1-Wt])&&(Hr.hasOwnProperty(zt)?(Rt.push({command:gn.removeLayer,args:[zt]}),un.splice(un.lastIndexOf(zt,un.length-kt),1)):kt++,Rt.push({command:gn.addLayer,args:[Yr[zt],Cr=un[un.length-Wt]]}),un.splice(un.length-Wt,0,zt),_n[zt]=!0);for(Wt=0;Wt<wr.length;Wt++)if(nr=Hr[zt=wr[Wt]],Jt=Yr[zt],!_n[zt]&&!o.deepEqual(nr,Jt))if(o.deepEqual(nr.source,Jt.source)&&o.deepEqual(nr["source-layer"],Jt["source-layer"])&&o.deepEqual(nr.type,Jt.type)){for(pr in ea(nr.layout,Jt.layout,Rt,zt,null,gn.setLayoutProperty),ea(nr.paint,Jt.paint,Rt,zt,null,gn.setPaintProperty),o.deepEqual(nr.filter,Jt.filter)||Rt.push({command:gn.setFilter,args:[zt,Jt.filter]}),o.deepEqual(nr.minzoom,Jt.minzoom)&&o.deepEqual(nr.maxzoom,Jt.maxzoom)||Rt.push({command:gn.setLayerZoomRange,args:[zt,Jt.minzoom,Jt.maxzoom]}),nr)nr.hasOwnProperty(pr)&&pr!=="layout"&&pr!=="paint"&&pr!=="filter"&&pr!=="metadata"&&pr!=="minzoom"&&pr!=="maxzoom"&&(pr.indexOf("paint.")===0?ea(nr[pr],Jt[pr],Rt,zt,pr.slice(6),gn.setPaintProperty):o.deepEqual(nr[pr],Jt[pr])||Rt.push({command:gn.setLayerProperty,args:[zt,pr,Jt[pr]]}));for(pr in Jt)Jt.hasOwnProperty(pr)&&!nr.hasOwnProperty(pr)&&pr!=="layout"&&pr!=="paint"&&pr!=="filter"&&pr!=="metadata"&&pr!=="minzoom"&&pr!=="maxzoom"&&(pr.indexOf("paint.")===0?ea(nr[pr],Jt[pr],Rt,zt,pr.slice(6),gn.setPaintProperty):o.deepEqual(nr[pr],Jt[pr])||Rt.push({command:gn.setLayerProperty,args:[zt,pr,Jt[pr]]}))}else Rt.push({command:gn.removeLayer,args:[zt]}),Cr=un[un.lastIndexOf(zt)+1],Rt.push({command:gn.addLayer,args:[Jt,Cr]})}(qe,j.layers,ue)}catch(tt){console.warn("Unable to compute style diff:",tt),ue=[{command:gn.setStyle,args:[j]}]}return ue}(this.serialize(),n).filter(function(R){return!(R.command in bl)});if(b.length===0)return!1;var O=b.filter(function(R){return!(R.command in $s)});if(O.length>0)throw new Error("Unimplemented: "+O.map(function(R){return R.command}).join(", ")+".");return b.forEach(function(R){R.command!=="setTransition"&&l[R.command].apply(l,R.args)}),this.stylesheet=n,!0},a.prototype.addImage=function(n,l){if(this.getImage(n))return this.fire(new o.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(n,l),this._afterImageUpdated(n)},a.prototype.updateImage=function(n,l){this.imageManager.updateImage(n,l)},a.prototype.getImage=function(n){return this.imageManager.getImage(n)},a.prototype.removeImage=function(n){if(!this.getImage(n))return this.fire(new o.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(n),this._afterImageUpdated(n)},a.prototype._afterImageUpdated=function(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))},a.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},a.prototype.addSource=function(n,l,b){var O=this;if(b===void 0&&(b={}),this._checkLoaded(),this.sourceCaches[n]!==void 0)throw new Error("There is already a source with this ID");if(!l.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(l).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(o.validateStyle.source,"sources."+n,l,null,b))){this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);var R=this.sourceCaches[n]=new Qt(n,l,this.dispatcher);R.style=this,R.setEventedParent(this,function(){return{isSourceLoaded:O.loaded(),source:R.serialize(),sourceId:n}}),R.onAdd(this.map),this._changed=!0}},a.prototype.removeSource=function(n){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error("There is no source with this ID");for(var l in this._layers)if(this._layers[l].source===n)return this.fire(new o.ErrorEvent(new Error('Source "'+n+'" cannot be removed while layer "'+l+'" is using it.')));var b=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],b.fire(new o.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),b.setEventedParent(null),b.clearTiles(),b.onRemove&&b.onRemove(this.map),this._changed=!0},a.prototype.setGeoJSONSourceData=function(n,l){this._checkLoaded(),this.sourceCaches[n].getSource().setData(l),this._changed=!0},a.prototype.getSource=function(n){return this.sourceCaches[n]&&this.sourceCaches[n].getSource()},a.prototype.addLayer=function(n,l,b){b===void 0&&(b={}),this._checkLoaded();var O=n.id;if(this.getLayer(O))this.fire(new o.ErrorEvent(new Error('Layer with id "'+O+'" already exists on this map')));else{var R;if(n.type==="custom"){if(Po(this,o.validateCustomStyleLayer(n)))return;R=o.createStyleLayer(n)}else{if(typeof n.source=="object"&&(this.addSource(O,n.source),n=o.clone$1(n),n=o.extend(n,{source:O})),this._validate(o.validateStyle.layer,"layers."+O,n,{arrayIndex:-1},b))return;R=o.createStyleLayer(n),this._validateLayer(R),R.setEventedParent(this,{layer:{id:O}}),this._serializedLayers[R.id]=R.serialize()}var j=l?this._order.indexOf(l):this._order.length;if(l&&j===-1)this.fire(new o.ErrorEvent(new Error('Layer with id "'+l+'" does not exist on this map.')));else{if(this._order.splice(j,0,O),this._layerOrderChanged=!0,this._layers[O]=R,this._removedLayers[O]&&R.source&&R.type!=="custom"){var ue=this._removedLayers[O];delete this._removedLayers[O],ue.type!==R.type?this._updatedSources[R.source]="clear":(this._updatedSources[R.source]="reload",this.sourceCaches[R.source].pause())}this._updateLayer(R),R.onAdd&&R.onAdd(this.map)}}},a.prototype.moveLayer=function(n,l){if(this._checkLoaded(),this._changed=!0,this._layers[n]){if(n!==l){var b=this._order.indexOf(n);this._order.splice(b,1);var O=l?this._order.indexOf(l):this._order.length;l&&O===-1?this.fire(new o.ErrorEvent(new Error('Layer with id "'+l+'" does not exist on this map.'))):(this._order.splice(O,0,n),this._layerOrderChanged=!0)}}else this.fire(new o.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be moved.")))},a.prototype.removeLayer=function(n){this._checkLoaded();var l=this._layers[n];if(l){l.setEventedParent(null);var b=this._order.indexOf(n);this._order.splice(b,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=l,delete this._layers[n],delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],l.onRemove&&l.onRemove(this.map)}else this.fire(new o.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be removed.")))},a.prototype.getLayer=function(n){return this._layers[n]},a.prototype.hasLayer=function(n){return n in this._layers},a.prototype.setLayerZoomRange=function(n,l,b){this._checkLoaded();var O=this.getLayer(n);O?O.minzoom===l&&O.maxzoom===b||(l!=null&&(O.minzoom=l),b!=null&&(O.maxzoom=b),this._updateLayer(O)):this.fire(new o.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot have zoom extent.")))},a.prototype.setFilter=function(n,l,b){b===void 0&&(b={}),this._checkLoaded();var O=this.getLayer(n);if(O){if(!o.deepEqual(O.filter,l))return l==null?(O.filter=void 0,void this._updateLayer(O)):void(this._validate(o.validateStyle.filter,"layers."+O.id+".filter",l,null,b)||(O.filter=o.clone$1(l),this._updateLayer(O)))}else this.fire(new o.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be filtered.")))},a.prototype.getFilter=function(n){return o.clone$1(this.getLayer(n).filter)},a.prototype.setLayoutProperty=function(n,l,b,O){O===void 0&&(O={}),this._checkLoaded();var R=this.getLayer(n);R?o.deepEqual(R.getLayoutProperty(l),b)||(R.setLayoutProperty(l,b,O),this._updateLayer(R)):this.fire(new o.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be styled.")))},a.prototype.getLayoutProperty=function(n,l){var b=this.getLayer(n);if(b)return b.getLayoutProperty(l);this.fire(new o.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style.")))},a.prototype.setPaintProperty=function(n,l,b,O){O===void 0&&(O={}),this._checkLoaded();var R=this.getLayer(n);R?o.deepEqual(R.getPaintProperty(l),b)||(R.setPaintProperty(l,b,O)&&this._updateLayer(R),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new o.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be styled.")))},a.prototype.getPaintProperty=function(n,l){return this.getLayer(n).getPaintProperty(l)},a.prototype.setFeatureState=function(n,l){this._checkLoaded();var b=n.source,O=n.sourceLayer,R=this.sourceCaches[b];if(R!==void 0){var j=R.getSource().type;j==="geojson"&&O?this.fire(new o.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):j!=="vector"||O?(n.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),R.setFeatureState(O,n.id,l)):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error("The source '"+b+"' does not exist in the map's style.")))},a.prototype.removeFeatureState=function(n,l){this._checkLoaded();var b=n.source,O=this.sourceCaches[b];if(O!==void 0){var R=O.getSource().type,j=R==="vector"?n.sourceLayer:void 0;R!=="vector"||j?l&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new o.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):O.removeFeatureState(j,n.id,l):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error("The source '"+b+"' does not exist in the map's style.")))},a.prototype.getFeatureState=function(n){this._checkLoaded();var l=n.source,b=n.sourceLayer,O=this.sourceCaches[l];if(O!==void 0){if(O.getSource().type!=="vector"||b)return n.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),O.getFeatureState(b,n.id);this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error("The source '"+l+"' does not exist in the map's style.")))},a.prototype.getTransition=function(){return o.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},a.prototype.serialize=function(){return o.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:o.mapObject(this.sourceCaches,function(n){return n.serialize()}),layers:this._serializeLayers(this._order)},function(n){return n!==void 0})},a.prototype._updateLayer=function(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.sourceCaches[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()),this._changed=!0},a.prototype._flattenAndSortRenderedFeatures=function(n){for(var l=this,b=function(Yr){return l._layers[Yr].type==="fill-extrusion"},O={},R=[],j=this._order.length-1;j>=0;j--){var ue=this._order[j];if(b(ue)){O[ue]=j;for(var Te=0,Ye=n;Te<Ye.length;Te+=1){var qe=Ye[Te][ue];if(qe)for(var tt=0,Dt=qe;tt<Dt.length;tt+=1)R.push(Dt[tt])}}}R.sort(function(Hr,Yr){return Yr.intersectionZ-Hr.intersectionZ});for(var Rt=[],Wt=this._order.length-1;Wt>=0;Wt--){var kt=this._order[Wt];if(b(kt))for(var zt=R.length-1;zt>=0;zt--){var nr=R[zt].feature;if(O[nr.layer.id]<Wt)break;Rt.push(nr),R.pop()}else for(var Jt=0,Cr=n;Jt<Cr.length;Jt+=1){var pr=Cr[Jt][kt];if(pr)for(var _r=0,wr=pr;_r<wr.length;_r+=1)Rt.push(wr[_r].feature)}}return Rt},a.prototype.queryRenderedFeatures=function(n,l,b){l&&l.filter&&this._validate(o.validateStyle.filter,"queryRenderedFeatures.filter",l.filter,null,l);var O={};if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new o.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var R=0,j=l.layers;R<j.length;R+=1){var ue=j[R],Te=this._layers[ue];if(!Te)return this.fire(new o.ErrorEvent(new Error("The layer '"+ue+"' does not exist in the map's style and cannot be queried for features."))),[];O[Te.source]=!0}}var Ye=[];for(var qe in l.availableImages=this._availableImages,this.sourceCaches)l.layers&&!O[qe]||Ye.push(At(this.sourceCaches[qe],this._layers,this._serializedLayers,n,l,b));return this.placement&&Ye.push(function(tt,Dt,Rt,Wt,kt,zt,nr){for(var Jt={},Cr=zt.queryRenderedSymbols(Wt),pr=[],_r=0,wr=Object.keys(Cr).map(Number);_r<wr.length;_r+=1)pr.push(nr[wr[_r]]);pr.sort(be);for(var Hr=function(){var ya=un[Yr],Pa=ya.featureIndex.lookupSymbolFeatures(Cr[ya.bucketInstanceId],Dt,ya.bucketIndex,ya.sourceLayerIndex,kt.filter,kt.layers,kt.availableImages,tt);for(var Pn in Pa){var ga=Jt[Pn]=Jt[Pn]||[],aa=Pa[Pn];aa.sort(function(qn,wa){var Ja=ya.featureSortOrder;if(Ja){var co=Ja.indexOf(qn.featureIndex);return Ja.indexOf(wa.featureIndex)-co}return wa.featureIndex-qn.featureIndex});for(var zn=0,Ca=aa;zn<Ca.length;zn+=1)ga.push(Ca[zn])}},Yr=0,un=pr;Yr<un.length;Yr+=1)Hr();var _n=function(ya){Jt[ya].forEach(function(Pa){var Pn=Pa.feature,ga=Rt[tt[ya].source].getFeatureState(Pn.layer["source-layer"],Pn.id);Pn.source=Pn.layer.source,Pn.layer["source-layer"]&&(Pn.sourceLayer=Pn.layer["source-layer"]),Pn.state=ga})};for(var ia in Jt)_n(ia);return Jt}(this._layers,this._serializedLayers,this.sourceCaches,n,l,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Ye)},a.prototype.querySourceFeatures=function(n,l){l&&l.filter&&this._validate(o.validateStyle.filter,"querySourceFeatures.filter",l.filter,null,l);var b=this.sourceCaches[n];return b?function(O,R){for(var j=O.getRenderableIds().map(function(Dt){return O.getTileByID(Dt)}),ue=[],Te={},Ye=0;Ye<j.length;Ye++){var qe=j[Ye],tt=qe.tileID.canonical.key;Te[tt]||(Te[tt]=!0,qe.querySourceFeatures(ue,R))}return ue}(b,l):[]},a.prototype.addSourceType=function(n,l,b){return a.getSourceType(n)?b(new Error('A source type called "'+n+'" already exists.')):(a.setSourceType(n,l),l.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:l.workerSourceURL},b):b(null,null))},a.prototype.getLight=function(){return this.light.getLight()},a.prototype.setLight=function(n,l){l===void 0&&(l={}),this._checkLoaded();var b=this.light.getLight(),O=!1;for(var R in n)if(!o.deepEqual(n[R],b[R])){O=!0;break}if(O){var j={now:o.browser.now(),transition:o.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,l),this.light.updateTransitions(j)}},a.prototype._validate=function(n,l,b,O,R){return R===void 0&&(R={}),(!R||R.validate!==!1)&&Po(this,n.call(o.validateStyle,o.extend({key:l,style:this.serialize(),value:b,styleSpec:o.styleSpec},O)))},a.prototype._remove=function(){for(var n in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[n].setEventedParent(null);for(var l in this.sourceCaches)this.sourceCaches[l].clearTiles(),this.sourceCaches[l].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},a.prototype._clearSource=function(n){this.sourceCaches[n].clearTiles()},a.prototype._reloadSource=function(n){this.sourceCaches[n].resume(),this.sourceCaches[n].reload()},a.prototype._updateSources=function(n){for(var l in this.sourceCaches)this.sourceCaches[l].update(n)},a.prototype._generateCollisionBoxes=function(){for(var n in this.sourceCaches)this._reloadSource(n)},a.prototype._updatePlacement=function(n,l,b,O,R){R===void 0&&(R=!1);for(var j=!1,ue=!1,Te={},Ye=0,qe=this._order;Ye<qe.length;Ye+=1){var tt=this._layers[qe[Ye]];if(tt.type==="symbol"){if(!Te[tt.source]){var Dt=this.sourceCaches[tt.source];Te[tt.source]=Dt.getRenderableIds(!0).map(function(nr){return Dt.getTileByID(nr)}).sort(function(nr,Jt){return Jt.tileID.overscaledZ-nr.tileID.overscaledZ||(nr.tileID.isLessThan(Jt.tileID)?-1:1)})}var Rt=this.crossTileSymbolIndex.addLayer(tt,Te[tt.source],n.center.lng);j=j||Rt}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((R=R||this._layerOrderChanged||b===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.browser.now(),n.zoom))&&(this.pauseablePlacement=new Ks(n,this._order,R,l,b,O,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Te),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.browser.now()),ue=!0),j&&this.pauseablePlacement.placement.setStale()),ue||j)for(var Wt=0,kt=this._order;Wt<kt.length;Wt+=1){var zt=this._layers[kt[Wt]];zt.type==="symbol"&&this.placement.updateLayerOpacities(zt,Te[zt.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.browser.now())},a.prototype._releaseSymbolFadeTiles=function(){for(var n in this.sourceCaches)this.sourceCaches[n].releaseSymbolFadeTiles()},a.prototype.getImages=function(n,l,b){this.imageManager.getImages(l.icons,b),this._updateTilesForChangedImages();var O=this.sourceCaches[l.source];O&&O.setDependencies(l.tileID.key,l.type,l.icons)},a.prototype.getGlyphs=function(n,l,b){this.glyphManager.getGlyphs(l.stacks,b)},a.prototype.getResource=function(n,l,b){return o.makeRequest(l,b)},a}(o.Evented);ka.getSourceType=function(s){return rt[s]},ka.setSourceType=function(s,a){rt[s]=a},ka.registerForPluginStateChange=o.registerForPluginStateChange;var hu=o.createLayout([{name:"a_pos",type:"Int16",components:2}]),ec=Ui(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),Js=Ui(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),ns=Ui(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),wt=Ui(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),er=Ui("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ar=Ui(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Bn=Ui(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Qa=Ui("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Ii=Ui("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Ki=Ui("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),ja=Ui(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),pi=Ui(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Zo=Ui(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Ci=Ui(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),Xo=Ui(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Au=Ui(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),du=Ui(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Ds=Ui(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),xl=Ui(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Qs=Ui(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),rl=Ui(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),qs=Ui(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),Vu=Ui(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),tc=Ui(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),vc=Ui(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),gc=Ui(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Ui(s,a){var n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=a.match(/attribute ([\w]+) ([\w]+)/g),b=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),O=a.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),R=O?O.concat(b):b,j={};return{fragmentSource:s=s.replace(n,function(ue,Te,Ye,qe,tt){return j[tt]=!0,Te==="define"?`
#ifndef HAS_UNIFORM_u_`+tt+`
varying `+Ye+" "+qe+" "+tt+`;
#else
uniform `+Ye+" "+qe+" u_"+tt+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+tt+`
    `+Ye+" "+qe+" "+tt+" = u_"+tt+`;
#endif
`}),vertexSource:a=a.replace(n,function(ue,Te,Ye,qe,tt){var Dt=qe==="float"?"vec2":"vec4",Rt=tt.match(/color/)?"color":Dt;return j[tt]?Te==="define"?`
#ifndef HAS_UNIFORM_u_`+tt+`
uniform lowp float u_`+tt+`_t;
attribute `+Ye+" "+Dt+" a_"+tt+`;
varying `+Ye+" "+qe+" "+tt+`;
#else
uniform `+Ye+" "+qe+" u_"+tt+`;
#endif
`:Rt==="vec4"?`
#ifndef HAS_UNIFORM_u_`+tt+`
    `+tt+" = a_"+tt+`;
#else
    `+Ye+" "+qe+" "+tt+" = u_"+tt+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+tt+`
    `+tt+" = unpack_mix_"+Rt+"(a_"+tt+", u_"+tt+`_t);
#else
    `+Ye+" "+qe+" "+tt+" = u_"+tt+`;
#endif
`:Te==="define"?`
#ifndef HAS_UNIFORM_u_`+tt+`
uniform lowp float u_`+tt+`_t;
attribute `+Ye+" "+Dt+" a_"+tt+`;
#else
uniform `+Ye+" "+qe+" u_"+tt+`;
#endif
`:Rt==="vec4"?`
#ifndef HAS_UNIFORM_u_`+tt+`
    `+Ye+" "+qe+" "+tt+" = a_"+tt+`;
#else
    `+Ye+" "+qe+" "+tt+" = u_"+tt+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+tt+`
    `+Ye+" "+qe+" "+tt+" = unpack_mix_"+Rt+"(a_"+tt+", u_"+tt+`_t);
#else
    `+Ye+" "+qe+" "+tt+" = u_"+tt+`;
#endif
`}),staticAttributes:l,staticUniforms:R}}var zc=Object.freeze({__proto__:null,prelude:ec,background:Js,backgroundPattern:ns,circle:wt,clippingMask:er,heatmap:Ar,heatmapTexture:Bn,collisionBox:Qa,collisionCircle:Ii,debug:Ki,fill:ja,fillOutline:pi,fillOutlinePattern:Zo,fillPattern:Ci,fillExtrusion:Xo,fillExtrusionPattern:Au,hillshadePrepare:du,hillshade:Ds,line:xl,lineGradient:Qs,linePattern:rl,lineSDF:qs,raster:Vu,symbolIcon:tc,symbolSDF:vc,symbolTextAndIcon:gc}),yc=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function nf(s){for(var a=[],n=0;n<s.length;n++)if(s[n]!==null){var l=s[n].split(" ");a.push(l.pop())}return a}yc.prototype.bind=function(s,a,n,l,b,O,R,j){this.context=s;for(var ue=this.boundPaintVertexBuffers.length!==l.length,Te=0;!ue&&Te<l.length;Te++)this.boundPaintVertexBuffers[Te]!==l[Te]&&(ue=!0);s.extVertexArrayObject&&this.vao&&this.boundProgram===a&&this.boundLayoutVertexBuffer===n&&!ue&&this.boundIndexBuffer===b&&this.boundVertexOffset===O&&this.boundDynamicVertexBuffer===R&&this.boundDynamicVertexBuffer2===j?(s.bindVertexArrayOES.set(this.vao),R&&R.bind(),b&&b.dynamicDraw&&b.bind(),j&&j.bind()):this.freshBind(a,n,l,b,O,R,j)},yc.prototype.freshBind=function(s,a,n,l,b,O,R){var j,ue=s.numAttributes,Te=this.context,Ye=Te.gl;if(Te.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Te.extVertexArrayObject.createVertexArrayOES(),Te.bindVertexArrayOES.set(this.vao),j=0,this.boundProgram=s,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=l,this.boundVertexOffset=b,this.boundDynamicVertexBuffer=O,this.boundDynamicVertexBuffer2=R;else{j=Te.currentNumAttributes||0;for(var qe=ue;qe<j;qe++)Ye.disableVertexAttribArray(qe)}a.enableAttributes(Ye,s);for(var tt=0,Dt=n;tt<Dt.length;tt+=1)Dt[tt].enableAttributes(Ye,s);O&&O.enableAttributes(Ye,s),R&&R.enableAttributes(Ye,s),a.bind(),a.setVertexAttribPointers(Ye,s,b);for(var Rt=0,Wt=n;Rt<Wt.length;Rt+=1){var kt=Wt[Rt];kt.bind(),kt.setVertexAttribPointers(Ye,s,b)}O&&(O.bind(),O.setVertexAttribPointers(Ye,s,b)),l&&l.bind(),R&&(R.bind(),R.setVertexAttribPointers(Ye,s,b)),Te.currentNumAttributes=ue},yc.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var af=function(a,n,l,b,O,R){var j=a.gl;this.program=j.createProgram();for(var ue=nf(l.staticAttributes),Te=b?b.getBinderAttributes():[],Ye=ue.concat(Te),qe=l.staticUniforms?nf(l.staticUniforms):[],tt=b?b.getBinderUniforms():[],Dt=[],Rt=0,Wt=qe.concat(tt);Rt<Wt.length;Rt+=1){var kt=Wt[Rt];Dt.indexOf(kt)<0&&Dt.push(kt)}var zt=b?b.defines():[];R&&zt.push("#define OVERDRAW_INSPECTOR;");var nr=zt.concat(ec.fragmentSource,l.fragmentSource).join(`
`),Jt=zt.concat(ec.vertexSource,l.vertexSource).join(`
`),Cr=j.createShader(j.FRAGMENT_SHADER);if(j.isContextLost())this.failedToCreate=!0;else{j.shaderSource(Cr,nr),j.compileShader(Cr),j.attachShader(this.program,Cr);var pr=j.createShader(j.VERTEX_SHADER);if(j.isContextLost())this.failedToCreate=!0;else{j.shaderSource(pr,Jt),j.compileShader(pr),j.attachShader(this.program,pr),this.attributes={};var _r={};this.numAttributes=Ye.length;for(var wr=0;wr<this.numAttributes;wr++)Ye[wr]&&(j.bindAttribLocation(this.program,wr,Ye[wr]),this.attributes[Ye[wr]]=wr);j.linkProgram(this.program),j.deleteShader(pr),j.deleteShader(Cr);for(var Hr=0;Hr<Dt.length;Hr++){var Yr=Dt[Hr];if(Yr&&!_r[Yr]){var un=j.getUniformLocation(this.program,Yr);un&&(_r[Yr]=un)}}this.fixedUniforms=O(a,_r),this.binderUniforms=b?b.getUniforms(a,_r):[]}}};function of(s,a,n){var l=1/li(n,1,a.transform.tileZoom),b=Math.pow(2,n.tileID.overscaledZ),O=n.tileSize*Math.pow(2,a.transform.tileZoom)/b,R=O*(n.tileID.canonical.x+n.tileID.wrap*b),j=O*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[l,s.fromScale,s.toScale],u_fade:s.t,u_pixel_coord_upper:[R>>16,j>>16],u_pixel_coord_lower:[65535&R,65535&j]}}af.prototype.draw=function(s,a,n,l,b,O,R,j,ue,Te,Ye,qe,tt,Dt,Rt,Wt){var kt,zt=s.gl;if(!this.failedToCreate){for(var nr in s.program.set(this.program),s.setDepthMode(n),s.setStencilMode(l),s.setColorMode(b),s.setCullFace(O),this.fixedUniforms)this.fixedUniforms[nr].set(R[nr]);Dt&&Dt.setUniforms(s,this.binderUniforms,qe,{zoom:tt});for(var Jt=(kt={},kt[zt.LINES]=2,kt[zt.TRIANGLES]=3,kt[zt.LINE_STRIP]=1,kt)[a],Cr=0,pr=Ye.get();Cr<pr.length;Cr+=1){var _r=pr[Cr],wr=_r.vaos||(_r.vaos={});(wr[j]||(wr[j]=new yc)).bind(s,this,ue,Dt?Dt.getPaintVertexBuffers():[],Te,_r.vertexOffset,Rt,Wt),zt.drawElements(a,_r.primitiveLength*Jt,zt.UNSIGNED_SHORT,_r.primitiveOffset*Jt*2)}}};var Ti=function(a,n,l,b){var O=n.style.light,R=O.properties.get("position"),j=[R.x,R.y,R.z],ue=o.create$1();O.properties.get("anchor")==="viewport"&&o.fromRotation(ue,-n.transform.angle),o.transformMat3(j,j,ue);var Te=O.properties.get("color");return{u_matrix:a,u_lightpos:j,u_lightintensity:O.properties.get("intensity"),u_lightcolor:[Te.r,Te.g,Te.b],u_vertical_gradient:+l,u_opacity:b}},Cu=function(a,n,l,b,O,R,j){return o.extend(Ti(a,n,l,b),of(R,n,j),{u_height_factor:-Math.pow(2,O.overscaledZ)/j.tileSize/8})},pu=function(a){return{u_matrix:a}},eu=function(a,n,l,b){return o.extend(pu(a),of(l,n,b))},Fc=function(a,n){return{u_matrix:a,u_world:n}},rc=function(a,n,l,b,O){return o.extend(eu(a,n,l,b),{u_world:O})},mu=function(a,n,l,b){var O,R,j=a.transform;if(b.paint.get("circle-pitch-alignment")==="map"){var ue=li(l,1,j.zoom);O=!0,R=[ue,ue]}else O=!1,R=j.pixelsToGLUnits;return{u_camera_to_center_distance:j.cameraToCenterDistance,u_scale_with_map:+(b.paint.get("circle-pitch-scale")==="map"),u_matrix:a.translatePosMatrix(n.posMatrix,l,b.paint.get("circle-translate"),b.paint.get("circle-translate-anchor")),u_pitch_with_map:+O,u_device_pixel_ratio:o.browser.devicePixelRatio,u_extrude_scale:R}},Uc=function(a,n,l){var b=li(l,1,n.zoom),O=Math.pow(2,n.zoom-l.tileID.overscaledZ),R=l.tileID.overscaleFactor();return{u_matrix:a,u_camera_to_center_distance:n.cameraToCenterDistance,u_pixels_to_tile_units:b,u_extrude_scale:[n.pixelsToGLUnits[0]/(b*O),n.pixelsToGLUnits[1]/(b*O)],u_overscale_factor:R}},nl=function(a,n,l){return{u_matrix:a,u_inv_matrix:n,u_camera_to_center_distance:l.cameraToCenterDistance,u_viewport_size:[l.width,l.height]}},tu=function(a,n,l){return l===void 0&&(l=1),{u_matrix:a,u_color:n,u_overlay:0,u_overlay_scale:l}},nc=function(a){return{u_matrix:a}},bc=function(a,n,l,b){return{u_matrix:a,u_extrude_scale:li(n,1,l),u_intensity:b}},mi=function(a,n,l){var b=a.transform;return{u_matrix:Bc(a,n,l),u_ratio:1/li(n,1,b.zoom),u_device_pixel_ratio:o.browser.devicePixelRatio,u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]]}},xc=function(a,n,l,b){return o.extend(mi(a,n,l),{u_image:0,u_image_height:b})},Rf=function(a,n,l,b){var O=a.transform,R=If(n,O);return{u_matrix:Bc(a,n,l),u_texsize:n.imageAtlasTexture.size,u_ratio:1/li(n,1,O.zoom),u_device_pixel_ratio:o.browser.devicePixelRatio,u_image:0,u_scale:[R,b.fromScale,b.toScale],u_fade:b.t,u_units_to_pixels:[1/O.pixelsToGLUnits[0],1/O.pixelsToGLUnits[1]]}},Ec=function(a,n,l,b,O){var R=a.lineAtlas,j=If(n,a.transform),ue=l.layout.get("line-cap")==="round",Te=R.getDash(b.from,ue),Ye=R.getDash(b.to,ue),qe=Te.width*O.fromScale,tt=Ye.width*O.toScale;return o.extend(mi(a,n,l),{u_patternscale_a:[j/qe,-Te.height/2],u_patternscale_b:[j/tt,-Ye.height/2],u_sdfgamma:R.width/(256*Math.min(qe,tt)*o.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:Te.y,u_tex_y_b:Ye.y,u_mix:O.t})};function If(s,a){return 1/li(s,1,a.tileZoom)}function Bc(s,a,n){return s.translatePosMatrix(a.tileID.posMatrix,a,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}var Pl=function(a,n,l,b,O){return{u_matrix:a,u_tl_parent:n,u_scale_parent:l,u_buffer_scale:1,u_fade_t:b.mix,u_opacity:b.opacity*O.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:O.paint.get("raster-brightness-min"),u_brightness_high:O.paint.get("raster-brightness-max"),u_saturation_factor:(j=O.paint.get("raster-saturation"),j>0?1-1/(1.001-j):-j),u_contrast_factor:(R=O.paint.get("raster-contrast"),R>0?1/(1-R):1+R),u_spin_weights:al(O.paint.get("raster-hue-rotate"))};var R,j};function al(s){s*=Math.PI/180;var a=Math.sin(s),n=Math.cos(s);return[(2*n+1)/3,(-Math.sqrt(3)*a-n+1)/3,(Math.sqrt(3)*a-n+1)/3]}var Os,ac=function(a,n,l,b,O,R,j,ue,Te,Ye){var qe=O.transform;return{u_is_size_zoom_constant:+(a==="constant"||a==="source"),u_is_size_feature_constant:+(a==="constant"||a==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:qe.cameraToCenterDistance,u_pitch:qe.pitch/360*2*Math.PI,u_rotate_symbol:+l,u_aspect_ratio:qe.width/qe.height,u_fade_change:O.options.fadeDuration?O.symbolFadeChange:1,u_matrix:R,u_label_plane_matrix:j,u_coord_matrix:ue,u_is_text:+Te,u_pitch_with_map:+b,u_texsize:Ye,u_texture:0}},No=function(a,n,l,b,O,R,j,ue,Te,Ye,qe){var tt=O.transform;return o.extend(ac(a,n,l,b,O,R,j,ue,Te,Ye),{u_gamma_scale:b?Math.cos(tt._pitch)*tt.cameraToCenterDistance:1,u_device_pixel_ratio:o.browser.devicePixelRatio,u_is_halo:+qe})},Ll=function(a,n,l,b,O,R,j,ue,Te,Ye){return o.extend(No(a,n,l,b,O,R,j,ue,!0,Te,!0),{u_texsize_icon:Ye,u_texture_icon:1})},El=function(a,n,l){return{u_matrix:a,u_opacity:n,u_color:l}},Vc=function(a,n,l,b,O,R){return o.extend(function(j,ue,Te,Ye){var qe=Te.imageManager.getPattern(j.from.toString()),tt=Te.imageManager.getPattern(j.to.toString()),Dt=Te.imageManager.getPixelSize(),Rt=Dt.width,Wt=Dt.height,kt=Math.pow(2,Ye.tileID.overscaledZ),zt=Ye.tileSize*Math.pow(2,Te.transform.tileZoom)/kt,nr=zt*(Ye.tileID.canonical.x+Ye.tileID.wrap*kt),Jt=zt*Ye.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:qe.tl,u_pattern_br_a:qe.br,u_pattern_tl_b:tt.tl,u_pattern_br_b:tt.br,u_texsize:[Rt,Wt],u_mix:ue.t,u_pattern_size_a:qe.displaySize,u_pattern_size_b:tt.displaySize,u_scale_a:ue.fromScale,u_scale_b:ue.toScale,u_tile_units_to_pixels:1/li(Ye,1,Te.transform.tileZoom),u_pixel_coord_upper:[nr>>16,Jt>>16],u_pixel_coord_lower:[65535&nr,65535&Jt]}}(b,R,l,O),{u_matrix:a,u_opacity:n})},Rl={fillExtrusion:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_lightpos:new o.Uniform3f(a,n.u_lightpos),u_lightintensity:new o.Uniform1f(a,n.u_lightintensity),u_lightcolor:new o.Uniform3f(a,n.u_lightcolor),u_vertical_gradient:new o.Uniform1f(a,n.u_vertical_gradient),u_opacity:new o.Uniform1f(a,n.u_opacity)}},fillExtrusionPattern:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_lightpos:new o.Uniform3f(a,n.u_lightpos),u_lightintensity:new o.Uniform1f(a,n.u_lightintensity),u_lightcolor:new o.Uniform3f(a,n.u_lightcolor),u_vertical_gradient:new o.Uniform1f(a,n.u_vertical_gradient),u_height_factor:new o.Uniform1f(a,n.u_height_factor),u_image:new o.Uniform1i(a,n.u_image),u_texsize:new o.Uniform2f(a,n.u_texsize),u_pixel_coord_upper:new o.Uniform2f(a,n.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(a,n.u_pixel_coord_lower),u_scale:new o.Uniform3f(a,n.u_scale),u_fade:new o.Uniform1f(a,n.u_fade),u_opacity:new o.Uniform1f(a,n.u_opacity)}},fill:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix)}},fillPattern:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_image:new o.Uniform1i(a,n.u_image),u_texsize:new o.Uniform2f(a,n.u_texsize),u_pixel_coord_upper:new o.Uniform2f(a,n.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(a,n.u_pixel_coord_lower),u_scale:new o.Uniform3f(a,n.u_scale),u_fade:new o.Uniform1f(a,n.u_fade)}},fillOutline:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_world:new o.Uniform2f(a,n.u_world)}},fillOutlinePattern:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_world:new o.Uniform2f(a,n.u_world),u_image:new o.Uniform1i(a,n.u_image),u_texsize:new o.Uniform2f(a,n.u_texsize),u_pixel_coord_upper:new o.Uniform2f(a,n.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(a,n.u_pixel_coord_lower),u_scale:new o.Uniform3f(a,n.u_scale),u_fade:new o.Uniform1f(a,n.u_fade)}},circle:function(a,n){return{u_camera_to_center_distance:new o.Uniform1f(a,n.u_camera_to_center_distance),u_scale_with_map:new o.Uniform1i(a,n.u_scale_with_map),u_pitch_with_map:new o.Uniform1i(a,n.u_pitch_with_map),u_extrude_scale:new o.Uniform2f(a,n.u_extrude_scale),u_device_pixel_ratio:new o.Uniform1f(a,n.u_device_pixel_ratio),u_matrix:new o.UniformMatrix4f(a,n.u_matrix)}},collisionBox:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_camera_to_center_distance:new o.Uniform1f(a,n.u_camera_to_center_distance),u_pixels_to_tile_units:new o.Uniform1f(a,n.u_pixels_to_tile_units),u_extrude_scale:new o.Uniform2f(a,n.u_extrude_scale),u_overscale_factor:new o.Uniform1f(a,n.u_overscale_factor)}},collisionCircle:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_inv_matrix:new o.UniformMatrix4f(a,n.u_inv_matrix),u_camera_to_center_distance:new o.Uniform1f(a,n.u_camera_to_center_distance),u_viewport_size:new o.Uniform2f(a,n.u_viewport_size)}},debug:function(a,n){return{u_color:new o.UniformColor(a,n.u_color),u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_overlay:new o.Uniform1i(a,n.u_overlay),u_overlay_scale:new o.Uniform1f(a,n.u_overlay_scale)}},clippingMask:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix)}},heatmap:function(a,n){return{u_extrude_scale:new o.Uniform1f(a,n.u_extrude_scale),u_intensity:new o.Uniform1f(a,n.u_intensity),u_matrix:new o.UniformMatrix4f(a,n.u_matrix)}},heatmapTexture:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_world:new o.Uniform2f(a,n.u_world),u_image:new o.Uniform1i(a,n.u_image),u_color_ramp:new o.Uniform1i(a,n.u_color_ramp),u_opacity:new o.Uniform1f(a,n.u_opacity)}},hillshade:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_image:new o.Uniform1i(a,n.u_image),u_latrange:new o.Uniform2f(a,n.u_latrange),u_light:new o.Uniform2f(a,n.u_light),u_shadow:new o.UniformColor(a,n.u_shadow),u_highlight:new o.UniformColor(a,n.u_highlight),u_accent:new o.UniformColor(a,n.u_accent)}},hillshadePrepare:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_image:new o.Uniform1i(a,n.u_image),u_dimension:new o.Uniform2f(a,n.u_dimension),u_zoom:new o.Uniform1f(a,n.u_zoom),u_unpack:new o.Uniform4f(a,n.u_unpack)}},line:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_ratio:new o.Uniform1f(a,n.u_ratio),u_device_pixel_ratio:new o.Uniform1f(a,n.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(a,n.u_units_to_pixels)}},lineGradient:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_ratio:new o.Uniform1f(a,n.u_ratio),u_device_pixel_ratio:new o.Uniform1f(a,n.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(a,n.u_units_to_pixels),u_image:new o.Uniform1i(a,n.u_image),u_image_height:new o.Uniform1f(a,n.u_image_height)}},linePattern:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_texsize:new o.Uniform2f(a,n.u_texsize),u_ratio:new o.Uniform1f(a,n.u_ratio),u_device_pixel_ratio:new o.Uniform1f(a,n.u_device_pixel_ratio),u_image:new o.Uniform1i(a,n.u_image),u_units_to_pixels:new o.Uniform2f(a,n.u_units_to_pixels),u_scale:new o.Uniform3f(a,n.u_scale),u_fade:new o.Uniform1f(a,n.u_fade)}},lineSDF:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_ratio:new o.Uniform1f(a,n.u_ratio),u_device_pixel_ratio:new o.Uniform1f(a,n.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(a,n.u_units_to_pixels),u_patternscale_a:new o.Uniform2f(a,n.u_patternscale_a),u_patternscale_b:new o.Uniform2f(a,n.u_patternscale_b),u_sdfgamma:new o.Uniform1f(a,n.u_sdfgamma),u_image:new o.Uniform1i(a,n.u_image),u_tex_y_a:new o.Uniform1f(a,n.u_tex_y_a),u_tex_y_b:new o.Uniform1f(a,n.u_tex_y_b),u_mix:new o.Uniform1f(a,n.u_mix)}},raster:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_tl_parent:new o.Uniform2f(a,n.u_tl_parent),u_scale_parent:new o.Uniform1f(a,n.u_scale_parent),u_buffer_scale:new o.Uniform1f(a,n.u_buffer_scale),u_fade_t:new o.Uniform1f(a,n.u_fade_t),u_opacity:new o.Uniform1f(a,n.u_opacity),u_image0:new o.Uniform1i(a,n.u_image0),u_image1:new o.Uniform1i(a,n.u_image1),u_brightness_low:new o.Uniform1f(a,n.u_brightness_low),u_brightness_high:new o.Uniform1f(a,n.u_brightness_high),u_saturation_factor:new o.Uniform1f(a,n.u_saturation_factor),u_contrast_factor:new o.Uniform1f(a,n.u_contrast_factor),u_spin_weights:new o.Uniform3f(a,n.u_spin_weights)}},symbolIcon:function(a,n){return{u_is_size_zoom_constant:new o.Uniform1i(a,n.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(a,n.u_is_size_feature_constant),u_size_t:new o.Uniform1f(a,n.u_size_t),u_size:new o.Uniform1f(a,n.u_size),u_camera_to_center_distance:new o.Uniform1f(a,n.u_camera_to_center_distance),u_pitch:new o.Uniform1f(a,n.u_pitch),u_rotate_symbol:new o.Uniform1i(a,n.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(a,n.u_aspect_ratio),u_fade_change:new o.Uniform1f(a,n.u_fade_change),u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(a,n.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(a,n.u_coord_matrix),u_is_text:new o.Uniform1i(a,n.u_is_text),u_pitch_with_map:new o.Uniform1i(a,n.u_pitch_with_map),u_texsize:new o.Uniform2f(a,n.u_texsize),u_texture:new o.Uniform1i(a,n.u_texture)}},symbolSDF:function(a,n){return{u_is_size_zoom_constant:new o.Uniform1i(a,n.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(a,n.u_is_size_feature_constant),u_size_t:new o.Uniform1f(a,n.u_size_t),u_size:new o.Uniform1f(a,n.u_size),u_camera_to_center_distance:new o.Uniform1f(a,n.u_camera_to_center_distance),u_pitch:new o.Uniform1f(a,n.u_pitch),u_rotate_symbol:new o.Uniform1i(a,n.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(a,n.u_aspect_ratio),u_fade_change:new o.Uniform1f(a,n.u_fade_change),u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(a,n.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(a,n.u_coord_matrix),u_is_text:new o.Uniform1i(a,n.u_is_text),u_pitch_with_map:new o.Uniform1i(a,n.u_pitch_with_map),u_texsize:new o.Uniform2f(a,n.u_texsize),u_texture:new o.Uniform1i(a,n.u_texture),u_gamma_scale:new o.Uniform1f(a,n.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(a,n.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(a,n.u_is_halo)}},symbolTextAndIcon:function(a,n){return{u_is_size_zoom_constant:new o.Uniform1i(a,n.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(a,n.u_is_size_feature_constant),u_size_t:new o.Uniform1f(a,n.u_size_t),u_size:new o.Uniform1f(a,n.u_size),u_camera_to_center_distance:new o.Uniform1f(a,n.u_camera_to_center_distance),u_pitch:new o.Uniform1f(a,n.u_pitch),u_rotate_symbol:new o.Uniform1i(a,n.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(a,n.u_aspect_ratio),u_fade_change:new o.Uniform1f(a,n.u_fade_change),u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(a,n.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(a,n.u_coord_matrix),u_is_text:new o.Uniform1i(a,n.u_is_text),u_pitch_with_map:new o.Uniform1i(a,n.u_pitch_with_map),u_texsize:new o.Uniform2f(a,n.u_texsize),u_texsize_icon:new o.Uniform2f(a,n.u_texsize_icon),u_texture:new o.Uniform1i(a,n.u_texture),u_texture_icon:new o.Uniform1i(a,n.u_texture_icon),u_gamma_scale:new o.Uniform1f(a,n.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(a,n.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(a,n.u_is_halo)}},background:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_opacity:new o.Uniform1f(a,n.u_opacity),u_color:new o.UniformColor(a,n.u_color)}},backgroundPattern:function(a,n){return{u_matrix:new o.UniformMatrix4f(a,n.u_matrix),u_opacity:new o.Uniform1f(a,n.u_opacity),u_image:new o.Uniform1i(a,n.u_image),u_pattern_tl_a:new o.Uniform2f(a,n.u_pattern_tl_a),u_pattern_br_a:new o.Uniform2f(a,n.u_pattern_br_a),u_pattern_tl_b:new o.Uniform2f(a,n.u_pattern_tl_b),u_pattern_br_b:new o.Uniform2f(a,n.u_pattern_br_b),u_texsize:new o.Uniform2f(a,n.u_texsize),u_mix:new o.Uniform1f(a,n.u_mix),u_pattern_size_a:new o.Uniform2f(a,n.u_pattern_size_a),u_pattern_size_b:new o.Uniform2f(a,n.u_pattern_size_b),u_scale_a:new o.Uniform1f(a,n.u_scale_a),u_scale_b:new o.Uniform1f(a,n.u_scale_b),u_pixel_coord_upper:new o.Uniform2f(a,n.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(a,n.u_pixel_coord_lower),u_tile_units_to_pixels:new o.Uniform1f(a,n.u_tile_units_to_pixels)}}};function ru(s,a,n,l,b,O,R){for(var j=s.context,ue=j.gl,Te=s.useProgram("collisionBox"),Ye=[],qe=0,tt=0,Dt=0;Dt<l.length;Dt++){var Rt=l[Dt],Wt=a.getTile(Rt),kt=Wt.getBucket(n);if(kt){var zt=Rt.posMatrix;b[0]===0&&b[1]===0||(zt=s.translatePosMatrix(Rt.posMatrix,Wt,b,O));var nr=R?kt.textCollisionBox:kt.iconCollisionBox,Jt=kt.collisionCircleArray;if(Jt.length>0){var Cr=o.create(),pr=zt;o.mul(Cr,kt.placementInvProjMatrix,s.transform.glCoordMatrix),o.mul(Cr,Cr,kt.placementViewportMatrix),Ye.push({circleArray:Jt,circleOffset:tt,transform:pr,invTransform:Cr}),tt=qe+=Jt.length/4}nr&&Te.draw(j,ue.LINES,me.disabled,at.disabled,s.colorModeForRenderPass(),He.disabled,Uc(zt,s.transform,Wt),n.id,nr.layoutVertexBuffer,nr.indexBuffer,nr.segments,null,s.transform.zoom,null,null,nr.collisionVertexBuffer)}}if(R&&Ye.length){var _r=s.useProgram("collisionCircle"),wr=new o.StructArrayLayout2f1f2i16;wr.resize(4*qe),wr._trim();for(var Hr=0,Yr=0,un=Ye;Yr<un.length;Yr+=1)for(var _n=un[Yr],ia=0;ia<_n.circleArray.length/4;ia++){var pa=4*ia,ya=_n.circleArray[pa+0],Pa=_n.circleArray[pa+1],Pn=_n.circleArray[pa+2],ga=_n.circleArray[pa+3];wr.emplace(Hr++,ya,Pa,Pn,ga,0),wr.emplace(Hr++,ya,Pa,Pn,ga,1),wr.emplace(Hr++,ya,Pa,Pn,ga,2),wr.emplace(Hr++,ya,Pa,Pn,ga,3)}(!Os||Os.length<2*qe)&&(Os=function(co){var $i=2*co,Vi=new o.StructArrayLayout3ui6;Vi.resize($i),Vi._trim();for(var fi=0;fi<$i;fi++){var Ji=6*fi;Vi.uint16[Ji+0]=4*fi+0,Vi.uint16[Ji+1]=4*fi+1,Vi.uint16[Ji+2]=4*fi+2,Vi.uint16[Ji+3]=4*fi+2,Vi.uint16[Ji+4]=4*fi+3,Vi.uint16[Ji+5]=4*fi+0}return Vi}(qe));for(var aa=j.createIndexBuffer(Os,!0),zn=j.createVertexBuffer(wr,o.collisionCircleLayout.members,!0),Ca=0,qn=Ye;Ca<qn.length;Ca+=1){var wa=qn[Ca],Ja=nl(wa.transform,wa.invTransform,s.transform);_r.draw(j,ue.TRIANGLES,me.disabled,at.disabled,s.colorModeForRenderPass(),He.disabled,Ja,n.id,zn,aa,o.SegmentVector.simpleSegment(0,2*wa.circleOffset,wa.circleArray.length,wa.circleArray.length/2),null,s.transform.zoom,null,null,null)}zn.destroy(),aa.destroy()}}var Gc=o.identity(new Float32Array(16));function bf(s,a,n,l,b,O){var R=o.getAnchorAlignment(s),j=-(R.horizontalAlign-.5)*a,ue=-(R.verticalAlign-.5)*n,Te=o.evaluateVariableOffset(s,l);return new o.Point((j/b+Te[0])*O,(ue/b+Te[1])*O)}function xf(s,a,n,l,b,O,R,j,ue,Te,Ye){var qe=s.text.placedSymbolArray,tt=s.text.dynamicLayoutVertexArray,Dt=s.icon.dynamicLayoutVertexArray,Rt={};tt.clear();for(var Wt=0;Wt<qe.length;Wt++){var kt=qe.get(Wt),zt=kt.hidden||!kt.crossTileID||s.allowVerticalPlacement&&!kt.placedOrientation?null:l[kt.crossTileID];if(zt){var nr=new o.Point(kt.anchorX,kt.anchorY),Jt=Ln(nr,n?j:R),Cr=Ei(O.cameraToCenterDistance,Jt.signedDistanceFromCamera),pr=b.evaluateSizeForFeature(s.textSizeData,Te,kt)*Cr/o.ONE_EM;n&&(pr*=s.tilePixelRatio/ue);for(var _r=bf(zt.anchor,zt.width,zt.height,zt.textOffset,zt.textBoxScale,pr),wr=n?Ln(nr.add(_r),R).point:Jt.point.add(a?_r.rotate(-O.angle):_r),Hr=s.allowVerticalPlacement&&kt.placedOrientation===o.WritingMode.vertical?Math.PI/2:0,Yr=0;Yr<kt.numGlyphs;Yr++)o.addDynamicAttributes(tt,wr,Hr);Ye&&kt.associatedIconIndex>=0&&(Rt[kt.associatedIconIndex]={shiftedAnchor:wr,angle:Hr})}else Na(kt.numGlyphs,tt)}if(Ye){Dt.clear();for(var un=s.icon.placedSymbolArray,_n=0;_n<un.length;_n++){var ia=un.get(_n);if(ia.hidden)Na(ia.numGlyphs,Dt);else{var pa=Rt[_n];if(pa)for(var ya=0;ya<ia.numGlyphs;ya++)o.addDynamicAttributes(Dt,pa.shiftedAnchor,pa.angle);else Na(ia.numGlyphs,Dt)}}s.icon.dynamicLayoutVertexBuffer.updateData(Dt)}s.text.dynamicLayoutVertexBuffer.updateData(tt)}function Il(s,a,n){return n.iconsInText&&a?"symbolTextAndIcon":s?"symbolSDF":"symbolIcon"}function ic(s,a,n,l,b,O,R,j,ue,Te,Ye,qe){for(var tt=s.context,Dt=tt.gl,Rt=s.transform,Wt=j==="map",kt=ue==="map",zt=Wt&&n.layout.get("symbol-placement")!=="point",nr=Wt&&!kt&&!zt,Jt=n.layout.get("symbol-sort-key").constantOr(1)!==void 0,Cr=s.depthModeForSublayer(0,me.ReadOnly),pr=n.layout.get("text-variable-anchor"),_r=[],wr=0,Hr=l;wr<Hr.length;wr+=1){var Yr=Hr[wr],un=a.getTile(Yr),_n=un.getBucket(n);if(_n){var ia=b?_n.text:_n.icon;if(ia&&ia.segments.get().length){var pa=ia.programConfigurations.get(n.id),ya=b||_n.sdfIcons,Pa=b?_n.textSizeData:_n.iconSizeData,Pn=kt||Rt.pitch!==0,ga=s.useProgram(Il(ya,b,_n),pa),aa=o.evaluateSizeForZoom(Pa,Rt.zoom),zn=void 0,Ca=[0,0],qn=void 0,wa=void 0,Ja=null,co=void 0;if(b)qn=un.glyphAtlasTexture,wa=Dt.LINEAR,zn=un.glyphAtlasTexture.size,_n.iconsInText&&(Ca=un.imageAtlasTexture.size,Ja=un.imageAtlasTexture,co=Pn||s.options.rotating||s.options.zooming||Pa.kind==="composite"||Pa.kind==="camera"?Dt.LINEAR:Dt.NEAREST);else{var $i=n.layout.get("icon-size").constantOr(0)!==1||_n.iconsNeedLinear;qn=un.imageAtlasTexture,wa=ya||s.options.rotating||s.options.zooming||$i||Pn?Dt.LINEAR:Dt.NEAREST,zn=un.imageAtlasTexture.size}var Vi=li(un,1,s.transform.zoom),fi=ii(Yr.posMatrix,kt,Wt,s.transform,Vi),Ji=Ia(Yr.posMatrix,kt,Wt,s.transform,Vi),Lo=pr&&_n.hasTextData(),Iu=n.layout.get("icon-text-fit")!=="none"&&Lo&&_n.hasIconData();zt&&qa(_n,Yr.posMatrix,s,b,fi,Ji,kt,Te);var Us=s.translatePosMatrix(Yr.posMatrix,un,O,R),Bs=zt||b&&pr||Iu?Gc:fi,Jo=s.translatePosMatrix(Ji,un,O,R,!0),ss=ya&&n.paint.get(b?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Al={program:ga,buffers:ia,uniformValues:ya?_n.iconsInText?Ll(Pa.kind,aa,nr,kt,s,Us,Bs,Jo,zn,Ca):No(Pa.kind,aa,nr,kt,s,Us,Bs,Jo,b,zn,!0):ac(Pa.kind,aa,nr,kt,s,Us,Bs,Jo,b,zn),atlasTexture:qn,atlasTextureIcon:Ja,atlasInterpolation:wa,atlasInterpolationIcon:co,isSDF:ya,hasHalo:ss};if(Jt)for(var Eu=0,dl=ia.segments.get();Eu<dl.length;Eu+=1){var Gl=dl[Eu];_r.push({segments:new o.SegmentVector([Gl]),sortKey:Gl.sortKey,state:Al})}else _r.push({segments:ia.segments,sortKey:0,state:Al})}}}Jt&&_r.sort(function(Hl,fc){return Hl.sortKey-fc.sortKey});for(var Du=0,Kc=_r;Du<Kc.length;Du+=1){var Ku=Kc[Du],eo=Ku.state;if(tt.activeTexture.set(Dt.TEXTURE0),eo.atlasTexture.bind(eo.atlasInterpolation,Dt.CLAMP_TO_EDGE),eo.atlasTextureIcon&&(tt.activeTexture.set(Dt.TEXTURE1),eo.atlasTextureIcon&&eo.atlasTextureIcon.bind(eo.atlasInterpolationIcon,Dt.CLAMP_TO_EDGE)),eo.isSDF){var Rs=eo.uniformValues;eo.hasHalo&&(Rs.u_is_halo=1,Zi(eo.buffers,Ku.segments,n,s,eo.program,Cr,Ye,qe,Rs)),Rs.u_is_halo=0}Zi(eo.buffers,Ku.segments,n,s,eo.program,Cr,Ye,qe,eo.uniformValues)}}function Zi(s,a,n,l,b,O,R,j,ue){var Te=l.context;b.draw(Te,Te.gl.TRIANGLES,O,R,j,He.disabled,ue,n.id,s.layoutVertexBuffer,s.indexBuffer,a,n.paint,l.transform.zoom,s.programConfigurations.get(n.id),s.dynamicLayoutVertexBuffer,s.opacityVertexBuffer)}function Dl(s,a,n,l,b,O,R){var j,ue,Te,Ye,qe,tt=s.context.gl,Dt=n.paint.get("fill-pattern"),Rt=Dt&&Dt.constantOr(1),Wt=n.getCrossfadeParameters();R?(ue=Rt&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",j=tt.LINES):(ue=Rt?"fillPattern":"fill",j=tt.TRIANGLES);for(var kt=0,zt=l;kt<zt.length;kt+=1){var nr=zt[kt],Jt=a.getTile(nr);if(!Rt||Jt.patternsLoaded()){var Cr=Jt.getBucket(n);if(Cr){var pr=Cr.programConfigurations.get(n.id),_r=s.useProgram(ue,pr);Rt&&(s.context.activeTexture.set(tt.TEXTURE0),Jt.imageAtlasTexture.bind(tt.LINEAR,tt.CLAMP_TO_EDGE),pr.updatePaintBuffers(Wt));var wr=Dt.constantOr(null);if(wr&&Jt.imageAtlas){var Hr=Jt.imageAtlas,Yr=Hr.patternPositions[wr.to.toString()],un=Hr.patternPositions[wr.from.toString()];Yr&&un&&pr.setConstantPatternPositions(Yr,un)}var _n=s.translatePosMatrix(nr.posMatrix,Jt,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(R){Ye=Cr.indexBuffer2,qe=Cr.segments2;var ia=[tt.drawingBufferWidth,tt.drawingBufferHeight];Te=ue==="fillOutlinePattern"&&Rt?rc(_n,s,Wt,Jt,ia):Fc(_n,ia)}else Ye=Cr.indexBuffer,qe=Cr.segments,Te=Rt?eu(_n,s,Wt,Jt):pu(_n);_r.draw(s.context,j,b,s.stencilModeForClipping(nr),O,He.disabled,Te,n.id,Cr.layoutVertexBuffer,Ye,qe,n.paint,s.transform.zoom,pr)}}}}function Gu(s,a,n,l,b,O,R){for(var j=s.context,ue=j.gl,Te=n.paint.get("fill-extrusion-pattern"),Ye=Te.constantOr(1),qe=n.getCrossfadeParameters(),tt=n.paint.get("fill-extrusion-opacity"),Dt=0,Rt=l;Dt<Rt.length;Dt+=1){var Wt=Rt[Dt],kt=a.getTile(Wt),zt=kt.getBucket(n);if(zt){var nr=zt.programConfigurations.get(n.id),Jt=s.useProgram(Ye?"fillExtrusionPattern":"fillExtrusion",nr);Ye&&(s.context.activeTexture.set(ue.TEXTURE0),kt.imageAtlasTexture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE),nr.updatePaintBuffers(qe));var Cr=Te.constantOr(null);if(Cr&&kt.imageAtlas){var pr=kt.imageAtlas,_r=pr.patternPositions[Cr.to.toString()],wr=pr.patternPositions[Cr.from.toString()];_r&&wr&&nr.setConstantPatternPositions(_r,wr)}var Hr=s.translatePosMatrix(Wt.posMatrix,kt,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),Yr=n.paint.get("fill-extrusion-vertical-gradient"),un=Ye?Cu(Hr,s,Yr,tt,Wt,qe,kt):Ti(Hr,s,Yr,tt);Jt.draw(j,j.gl.TRIANGLES,b,O,R,He.backCCW,un,n.id,zt.layoutVertexBuffer,zt.indexBuffer,zt.segments,n.paint,s.transform.zoom,nr)}}}function Ef(s,a,n,l,b,O){var R=s.context,j=R.gl,ue=a.fbo;if(ue){var Te=s.useProgram("hillshade");R.activeTexture.set(j.TEXTURE0),j.bindTexture(j.TEXTURE_2D,ue.colorAttachment.get());var Ye=function(qe,tt,Dt){var Rt=Dt.paint.get("hillshade-shadow-color"),Wt=Dt.paint.get("hillshade-highlight-color"),kt=Dt.paint.get("hillshade-accent-color"),zt=Dt.paint.get("hillshade-illumination-direction")*(Math.PI/180);Dt.paint.get("hillshade-illumination-anchor")==="viewport"&&(zt-=qe.transform.angle);var nr,Jt,Cr,pr=!qe.options.moving;return{u_matrix:qe.transform.calculatePosMatrix(tt.tileID.toUnwrapped(),pr),u_image:0,u_latrange:(nr=tt.tileID,Jt=Math.pow(2,nr.canonical.z),Cr=nr.canonical.y,[new o.MercatorCoordinate(0,Cr/Jt).toLngLat().lat,new o.MercatorCoordinate(0,(Cr+1)/Jt).toLngLat().lat]),u_light:[Dt.paint.get("hillshade-exaggeration"),zt],u_shadow:Rt,u_highlight:Wt,u_accent:kt}}(s,a,n);Te.draw(R,j.TRIANGLES,l,b,O,He.disabled,Ye,n.id,s.rasterBoundsBuffer,s.quadTriangleIndexBuffer,s.rasterBoundsSegments)}}function Nl(s,a,n,l,b,O){var R=s.context,j=R.gl,ue=a.dem;if(ue&&ue.data){var Te=ue.dim,Ye=ue.stride,qe=ue.getPixels();if(R.activeTexture.set(j.TEXTURE1),R.pixelStoreUnpackPremultiplyAlpha.set(!1),a.demTexture=a.demTexture||s.getTileTexture(Ye),a.demTexture){var tt=a.demTexture;tt.update(qe,{premultiply:!1}),tt.bind(j.NEAREST,j.CLAMP_TO_EDGE)}else a.demTexture=new o.Texture(R,qe,j.RGBA,{premultiply:!1}),a.demTexture.bind(j.NEAREST,j.CLAMP_TO_EDGE);R.activeTexture.set(j.TEXTURE0);var Dt=a.fbo;if(!Dt){var Rt=new o.Texture(R,{width:Te,height:Te,data:null},j.RGBA);Rt.bind(j.LINEAR,j.CLAMP_TO_EDGE),(Dt=a.fbo=R.createFramebuffer(Te,Te,!0)).colorAttachment.set(Rt.texture)}R.bindFramebuffer.set(Dt.framebuffer),R.viewport.set([0,0,Te,Te]),s.useProgram("hillshadePrepare").draw(R,j.TRIANGLES,l,b,O,He.disabled,function(Wt,kt){var zt=kt.stride,nr=o.create();return o.ortho(nr,0,o.EXTENT,-o.EXTENT,0,0,1),o.translate(nr,nr,[0,-o.EXTENT,0]),{u_matrix:nr,u_image:1,u_dimension:[zt,zt],u_zoom:Wt.overscaledZ,u_unpack:kt.getUnpackVector()}}(a.tileID,ue),n.id,s.rasterBoundsBuffer,s.quadTriangleIndexBuffer,s.rasterBoundsSegments),a.needsHillshadePrepare=!1}}function oc(s,a,n,l,b){var O=l.paint.get("raster-fade-duration");if(O>0){var R=o.browser.now(),j=(R-s.timeAdded)/O,ue=a?(R-a.timeAdded)/O:-1,Te=n.getSource(),Ye=b.coveringZoomLevel({tileSize:Te.tileSize,roundZoom:Te.roundZoom}),qe=!a||Math.abs(a.tileID.overscaledZ-Ye)>Math.abs(s.tileID.overscaledZ-Ye),tt=qe&&s.refreshedUponExpiration?1:o.clamp(qe?j:1-ue,0,1);return s.refreshedUponExpiration&&j>=1&&(s.refreshedUponExpiration=!1),a?{opacity:1,mix:1-tt}:{opacity:tt,mix:0}}return{opacity:1,mix:0}}var Wf=new o.Color(1,0,0,1),Df=new o.Color(0,1,0,1),Tc=new o.Color(0,0,1,1),kl=new o.Color(1,0,1,1),_c=new o.Color(0,1,1,1);function wu(s,a,n,l){il(s,0,a+n/2,s.transform.width,n,l)}function Ns(s,a,n,l){il(s,a-n/2,0,n,s.transform.height,l)}function il(s,a,n,l,b,O){var R=s.context,j=R.gl;j.enable(j.SCISSOR_TEST),j.scissor(a*o.browser.devicePixelRatio,n*o.browser.devicePixelRatio,l*o.browser.devicePixelRatio,b*o.browser.devicePixelRatio),R.clear({color:O}),j.disable(j.SCISSOR_TEST)}function Tl(s,a,n){var l=s.context,b=l.gl,O=n.posMatrix,R=s.useProgram("debug"),j=me.disabled,ue=at.disabled,Te=s.colorModeForRenderPass();l.activeTexture.set(b.TEXTURE0),s.emptyTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),R.draw(l,b.LINE_STRIP,j,ue,Te,He.disabled,tu(O,o.Color.red),"$debug",s.debugBuffer,s.tileBorderIndexBuffer,s.debugSegments);var Ye=a.getTileByID(n.key).latestRawTileData,qe=Math.floor((Ye&&Ye.byteLength||0)/1024),tt=a.getTile(n).tileSize,Dt=512/Math.min(tt,512)*(n.overscaledZ/s.transform.zoom)*.5,Rt=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(Rt+=" => "+n.overscaledZ),function(Wt,kt){Wt.initDebugOverlayCanvas();var zt=Wt.debugOverlayCanvas,nr=Wt.context.gl,Jt=Wt.debugOverlayCanvas.getContext("2d");Jt.clearRect(0,0,zt.width,zt.height),Jt.shadowColor="white",Jt.shadowBlur=2,Jt.lineWidth=1.5,Jt.strokeStyle="white",Jt.textBaseline="top",Jt.font="bold 36px Open Sans, sans-serif",Jt.fillText(kt,5,5),Jt.strokeText(kt,5,5),Wt.debugOverlayTexture.update(zt),Wt.debugOverlayTexture.bind(nr.LINEAR,nr.CLAMP_TO_EDGE)}(s,Rt+" "+qe+"kb"),R.draw(l,b.TRIANGLES,j,ue,bt.alphaBlended,He.disabled,tu(O,o.Color.transparent,Dt),"$debug",s.debugBuffer,s.quadTriangleIndexBuffer,s.debugSegments)}var sc={symbol:function(a,n,l,b,O){if(a.renderPass==="translucent"){var R=at.disabled,j=a.colorModeForRenderPass();l.layout.get("text-variable-anchor")&&function(ue,Te,Ye,qe,tt,Dt,Rt){for(var Wt=Te.transform,kt=tt==="map",zt=Dt==="map",nr=0,Jt=ue;nr<Jt.length;nr+=1){var Cr=Jt[nr],pr=qe.getTile(Cr),_r=pr.getBucket(Ye);if(_r&&_r.text&&_r.text.segments.get().length){var wr=o.evaluateSizeForZoom(_r.textSizeData,Wt.zoom),Hr=li(pr,1,Te.transform.zoom),Yr=ii(Cr.posMatrix,zt,kt,Te.transform,Hr),un=Ye.layout.get("icon-text-fit")!=="none"&&_r.hasIconData();if(wr){var _n=Math.pow(2,Wt.zoom-pr.tileID.overscaledZ);xf(_r,kt,zt,Rt,o.symbolSize,Wt,Yr,Cr.posMatrix,_n,wr,un)}}}}(b,a,l,n,l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),O),l.paint.get("icon-opacity").constantOr(1)!==0&&ic(a,n,l,b,!1,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),l.layout.get("icon-rotation-alignment"),l.layout.get("icon-pitch-alignment"),l.layout.get("icon-keep-upright"),R,j),l.paint.get("text-opacity").constantOr(1)!==0&&ic(a,n,l,b,!0,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),l.layout.get("text-keep-upright"),R,j),n.map.showCollisionBoxes&&(ru(a,n,l,b,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),!0),ru(a,n,l,b,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),!1))}},circle:function(a,n,l,b){if(a.renderPass==="translucent"){var O=l.paint.get("circle-opacity"),R=l.paint.get("circle-stroke-width"),j=l.paint.get("circle-stroke-opacity"),ue=l.layout.get("circle-sort-key").constantOr(1)!==void 0;if(O.constantOr(1)!==0||R.constantOr(1)!==0&&j.constantOr(1)!==0){for(var Te=a.context,Ye=Te.gl,qe=a.depthModeForSublayer(0,me.ReadOnly),tt=at.disabled,Dt=a.colorModeForRenderPass(),Rt=[],Wt=0;Wt<b.length;Wt++){var kt=b[Wt],zt=n.getTile(kt),nr=zt.getBucket(l);if(nr){var Jt=nr.programConfigurations.get(l.id),Cr={programConfiguration:Jt,program:a.useProgram("circle",Jt),layoutVertexBuffer:nr.layoutVertexBuffer,indexBuffer:nr.indexBuffer,uniformValues:mu(a,kt,zt,l)};if(ue)for(var pr=0,_r=nr.segments.get();pr<_r.length;pr+=1){var wr=_r[pr];Rt.push({segments:new o.SegmentVector([wr]),sortKey:wr.sortKey,state:Cr})}else Rt.push({segments:nr.segments,sortKey:0,state:Cr})}}ue&&Rt.sort(function(ia,pa){return ia.sortKey-pa.sortKey});for(var Hr=0,Yr=Rt;Hr<Yr.length;Hr+=1){var un=Yr[Hr],_n=un.state;_n.program.draw(Te,Ye.TRIANGLES,qe,tt,Dt,He.disabled,_n.uniformValues,l.id,_n.layoutVertexBuffer,_n.indexBuffer,un.segments,l.paint,a.transform.zoom,_n.programConfiguration)}}}},heatmap:function(a,n,l,b){if(l.paint.get("heatmap-opacity")!==0)if(a.renderPass==="offscreen"){var O=a.context,R=O.gl,j=at.disabled,ue=new bt([R.ONE,R.ONE],o.Color.transparent,[!0,!0,!0,!0]);!function(Rt,Wt,kt){var zt=Rt.gl;Rt.activeTexture.set(zt.TEXTURE1),Rt.viewport.set([0,0,Wt.width/4,Wt.height/4]);var nr=kt.heatmapFbo;if(nr)zt.bindTexture(zt.TEXTURE_2D,nr.colorAttachment.get()),Rt.bindFramebuffer.set(nr.framebuffer);else{var Jt=zt.createTexture();zt.bindTexture(zt.TEXTURE_2D,Jt),zt.texParameteri(zt.TEXTURE_2D,zt.TEXTURE_WRAP_S,zt.CLAMP_TO_EDGE),zt.texParameteri(zt.TEXTURE_2D,zt.TEXTURE_WRAP_T,zt.CLAMP_TO_EDGE),zt.texParameteri(zt.TEXTURE_2D,zt.TEXTURE_MIN_FILTER,zt.LINEAR),zt.texParameteri(zt.TEXTURE_2D,zt.TEXTURE_MAG_FILTER,zt.LINEAR),nr=kt.heatmapFbo=Rt.createFramebuffer(Wt.width/4,Wt.height/4,!1),function(Cr,pr,_r,wr){var Hr=Cr.gl;Hr.texImage2D(Hr.TEXTURE_2D,0,Hr.RGBA,pr.width/4,pr.height/4,0,Hr.RGBA,Cr.extRenderToTextureHalfFloat?Cr.extTextureHalfFloat.HALF_FLOAT_OES:Hr.UNSIGNED_BYTE,null),wr.colorAttachment.set(_r)}(Rt,Wt,Jt,nr)}}(O,a,l),O.clear({color:o.Color.transparent});for(var Te=0;Te<b.length;Te++){var Ye=b[Te];if(!n.hasRenderableParent(Ye)){var qe=n.getTile(Ye),tt=qe.getBucket(l);if(tt){var Dt=tt.programConfigurations.get(l.id);a.useProgram("heatmap",Dt).draw(O,R.TRIANGLES,me.disabled,j,ue,He.disabled,bc(Ye.posMatrix,qe,a.transform.zoom,l.paint.get("heatmap-intensity")),l.id,tt.layoutVertexBuffer,tt.indexBuffer,tt.segments,l.paint,a.transform.zoom,Dt)}}}O.viewport.set([0,0,a.width,a.height])}else a.renderPass==="translucent"&&(a.context.setColorMode(a.colorModeForRenderPass()),function(Rt,Wt){var kt=Rt.context,zt=kt.gl,nr=Wt.heatmapFbo;if(nr){kt.activeTexture.set(zt.TEXTURE0),zt.bindTexture(zt.TEXTURE_2D,nr.colorAttachment.get()),kt.activeTexture.set(zt.TEXTURE1);var Jt=Wt.colorRampTexture;Jt||(Jt=Wt.colorRampTexture=new o.Texture(kt,Wt.colorRamp,zt.RGBA)),Jt.bind(zt.LINEAR,zt.CLAMP_TO_EDGE),Rt.useProgram("heatmapTexture").draw(kt,zt.TRIANGLES,me.disabled,at.disabled,Rt.colorModeForRenderPass(),He.disabled,function(Cr,pr,_r,wr){var Hr=o.create();o.ortho(Hr,0,Cr.width,Cr.height,0,0,1);var Yr=Cr.context.gl;return{u_matrix:Hr,u_world:[Yr.drawingBufferWidth,Yr.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:pr.paint.get("heatmap-opacity")}}(Rt,Wt),Wt.id,Rt.viewportBuffer,Rt.quadTriangleIndexBuffer,Rt.viewportSegments,Wt.paint,Rt.transform.zoom)}}(a,l))},line:function(a,n,l,b){if(a.renderPass==="translucent"){var O=l.paint.get("line-opacity"),R=l.paint.get("line-width");if(O.constantOr(1)!==0&&R.constantOr(1)!==0)for(var j=a.depthModeForSublayer(0,me.ReadOnly),ue=a.colorModeForRenderPass(),Te=l.paint.get("line-dasharray"),Ye=l.paint.get("line-pattern"),qe=Ye.constantOr(1),tt=l.paint.get("line-gradient"),Dt=l.getCrossfadeParameters(),Rt=qe?"linePattern":Te?"lineSDF":tt?"lineGradient":"line",Wt=a.context,kt=Wt.gl,zt=!0,nr=0,Jt=b;nr<Jt.length;nr+=1){var Cr=Jt[nr],pr=n.getTile(Cr);if(!qe||pr.patternsLoaded()){var _r=pr.getBucket(l);if(_r){var wr=_r.programConfigurations.get(l.id),Hr=a.context.program.get(),Yr=a.useProgram(Rt,wr),un=zt||Yr.program!==Hr,_n=Ye.constantOr(null);if(_n&&pr.imageAtlas){var ia=pr.imageAtlas,pa=ia.patternPositions[_n.to.toString()],ya=ia.patternPositions[_n.from.toString()];pa&&ya&&wr.setConstantPatternPositions(pa,ya)}var Pa=qe?Rf(a,pr,l,Dt):Te?Ec(a,pr,l,Te,Dt):tt?xc(a,pr,l,_r.lineClipsArray.length):mi(a,pr,l);if(qe)Wt.activeTexture.set(kt.TEXTURE0),pr.imageAtlasTexture.bind(kt.LINEAR,kt.CLAMP_TO_EDGE),wr.updatePaintBuffers(Dt);else if(Te&&(un||a.lineAtlas.dirty))Wt.activeTexture.set(kt.TEXTURE0),a.lineAtlas.bind(Wt);else if(tt){var Pn=_r.gradients[l.id],ga=Pn.texture;if(l.gradientVersion!==Pn.version){var aa=256;if(l.stepInterpolant){var zn=n.getSource().maxzoom,Ca=Cr.canonical.z===zn?Math.ceil(1<<a.transform.maxZoom-Cr.canonical.z):1;aa=o.clamp(o.nextPowerOfTwo(_r.maxLineLength/o.EXTENT*1024*Ca),256,Wt.maxTextureSize)}Pn.gradient=o.renderColorRamp({expression:l.gradientExpression(),evaluationKey:"lineProgress",resolution:aa,image:Pn.gradient||void 0,clips:_r.lineClipsArray}),Pn.texture?Pn.texture.update(Pn.gradient):Pn.texture=new o.Texture(Wt,Pn.gradient,kt.RGBA),Pn.version=l.gradientVersion,ga=Pn.texture}Wt.activeTexture.set(kt.TEXTURE0),ga.bind(l.stepInterpolant?kt.NEAREST:kt.LINEAR,kt.CLAMP_TO_EDGE)}Yr.draw(Wt,kt.TRIANGLES,j,a.stencilModeForClipping(Cr),ue,He.disabled,Pa,l.id,_r.layoutVertexBuffer,_r.indexBuffer,_r.segments,l.paint,a.transform.zoom,wr,_r.layoutVertexBuffer2),zt=!1}}}}},fill:function(a,n,l,b){var O=l.paint.get("fill-color"),R=l.paint.get("fill-opacity");if(R.constantOr(1)!==0){var j=a.colorModeForRenderPass(),ue=l.paint.get("fill-pattern"),Te=a.opaquePassEnabledForLayer()&&!ue.constantOr(1)&&O.constantOr(o.Color.transparent).a===1&&R.constantOr(0)===1?"opaque":"translucent";if(a.renderPass===Te){var Ye=a.depthModeForSublayer(1,a.renderPass==="opaque"?me.ReadWrite:me.ReadOnly);Dl(a,n,l,b,Ye,j,!1)}if(a.renderPass==="translucent"&&l.paint.get("fill-antialias")){var qe=a.depthModeForSublayer(l.getPaintProperty("fill-outline-color")?2:0,me.ReadOnly);Dl(a,n,l,b,qe,j,!0)}}},"fill-extrusion":function(a,n,l,b){var O=l.paint.get("fill-extrusion-opacity");if(O!==0&&a.renderPass==="translucent"){var R=new me(a.context.gl.LEQUAL,me.ReadWrite,a.depthRangeFor3D);if(O!==1||l.paint.get("fill-extrusion-pattern").constantOr(1))Gu(a,n,l,b,R,at.disabled,bt.disabled),Gu(a,n,l,b,R,a.stencilModeFor3D(),a.colorModeForRenderPass());else{var j=a.colorModeForRenderPass();Gu(a,n,l,b,R,at.disabled,j)}}},hillshade:function(a,n,l,b){if(a.renderPass==="offscreen"||a.renderPass==="translucent"){for(var O=a.context,R=a.depthModeForSublayer(0,me.ReadOnly),j=a.colorModeForRenderPass(),ue=a.renderPass==="translucent"?a.stencilConfigForOverlap(b):[{},b],Te=ue[0],Ye=0,qe=ue[1];Ye<qe.length;Ye+=1){var tt=qe[Ye],Dt=n.getTile(tt);Dt.needsHillshadePrepare&&a.renderPass==="offscreen"?Nl(a,Dt,l,R,at.disabled,j):a.renderPass==="translucent"&&Ef(a,Dt,l,R,Te[tt.overscaledZ],j)}O.viewport.set([0,0,a.width,a.height])}},raster:function(a,n,l,b){if(a.renderPass==="translucent"&&l.paint.get("raster-opacity")!==0&&b.length)for(var O=a.context,R=O.gl,j=n.getSource(),ue=a.useProgram("raster"),Te=a.colorModeForRenderPass(),Ye=j instanceof Ee?[{},b]:a.stencilConfigForOverlap(b),qe=Ye[0],tt=Ye[1],Dt=tt[tt.length-1].overscaledZ,Rt=!a.options.moving,Wt=0,kt=tt;Wt<kt.length;Wt+=1){var zt=kt[Wt],nr=a.depthModeForSublayer(zt.overscaledZ-Dt,l.paint.get("raster-opacity")===1?me.ReadWrite:me.ReadOnly,R.LESS),Jt=n.getTile(zt),Cr=a.transform.calculatePosMatrix(zt.toUnwrapped(),Rt);Jt.registerFadeDuration(l.paint.get("raster-fade-duration"));var pr=n.findLoadedParent(zt,0),_r=oc(Jt,pr,n,l,a.transform),wr=void 0,Hr=void 0,Yr=l.paint.get("raster-resampling")==="nearest"?R.NEAREST:R.LINEAR;O.activeTexture.set(R.TEXTURE0),Jt.texture.bind(Yr,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST),O.activeTexture.set(R.TEXTURE1),pr?(pr.texture.bind(Yr,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST),wr=Math.pow(2,pr.tileID.overscaledZ-Jt.tileID.overscaledZ),Hr=[Jt.tileID.canonical.x*wr%1,Jt.tileID.canonical.y*wr%1]):Jt.texture.bind(Yr,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST);var un=Pl(Cr,Hr||[0,0],wr||1,_r,l);j instanceof Ee?ue.draw(O,R.TRIANGLES,nr,at.disabled,Te,He.disabled,un,l.id,j.boundsBuffer,a.quadTriangleIndexBuffer,j.boundsSegments):ue.draw(O,R.TRIANGLES,nr,qe[zt.overscaledZ],Te,He.disabled,un,l.id,a.rasterBoundsBuffer,a.quadTriangleIndexBuffer,a.rasterBoundsSegments)}},background:function(a,n,l){var b=l.paint.get("background-color"),O=l.paint.get("background-opacity");if(O!==0){var R=a.context,j=R.gl,ue=a.transform,Te=ue.tileSize,Ye=l.paint.get("background-pattern");if(!a.isPatternMissing(Ye)){var qe=!Ye&&b.a===1&&O===1&&a.opaquePassEnabledForLayer()?"opaque":"translucent";if(a.renderPass===qe){var tt=at.disabled,Dt=a.depthModeForSublayer(0,qe==="opaque"?me.ReadWrite:me.ReadOnly),Rt=a.colorModeForRenderPass(),Wt=a.useProgram(Ye?"backgroundPattern":"background"),kt=ue.coveringTiles({tileSize:Te});Ye&&(R.activeTexture.set(j.TEXTURE0),a.imageManager.bind(a.context));for(var zt=l.getCrossfadeParameters(),nr=0,Jt=kt;nr<Jt.length;nr+=1){var Cr=Jt[nr],pr=a.transform.calculatePosMatrix(Cr.toUnwrapped()),_r=Ye?Vc(pr,O,a,Ye,{tileID:Cr,tileSize:Te},zt):El(pr,O,b);Wt.draw(R,j.TRIANGLES,Dt,tt,Rt,He.disabled,_r,l.id,a.tileExtentBuffer,a.quadTriangleIndexBuffer,a.tileExtentSegments)}}}}},debug:function(a,n,l){for(var b=0;b<l.length;b++)Tl(a,n,l[b])},custom:function(a,n,l){var b=a.context,O=l.implementation;if(a.renderPass==="offscreen"){var R=O.prerender;R&&(a.setCustomLayerDefaults(),b.setColorMode(a.colorModeForRenderPass()),R.call(O,b.gl,a.transform.customLayerMatrix()),b.setDirty(),a.setBaseState())}else if(a.renderPass==="translucent"){a.setCustomLayerDefaults(),b.setColorMode(a.colorModeForRenderPass()),b.setStencilMode(at.disabled);var j=O.renderingMode==="3d"?new me(a.context.gl.LEQUAL,me.ReadWrite,a.depthRangeFor3D):a.depthModeForSublayer(0,me.ReadOnly);b.setDepthMode(j),O.render(b.gl,a.transform.customLayerMatrix()),b.setDirty(),a.setBaseState(),b.bindFramebuffer.set(null)}}},Bi=function(a,n){this.context=new ht(a),this.transform=n,this._tileTextures={},this.setup(),this.numSublayers=Qt.maxUnderzooming+Qt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new _o,this.gpuTimers={}};Bi.prototype.resize=function(s,a){if(this.width=s*o.browser.devicePixelRatio,this.height=a*o.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var n=0,l=this.style._order;n<l.length;n+=1)this.style._layers[l[n]].resize()},Bi.prototype.setup=function(){var s=this.context,a=new o.StructArrayLayout2i4;a.emplaceBack(0,0),a.emplaceBack(o.EXTENT,0),a.emplaceBack(0,o.EXTENT),a.emplaceBack(o.EXTENT,o.EXTENT),this.tileExtentBuffer=s.createVertexBuffer(a,hu.members),this.tileExtentSegments=o.SegmentVector.simpleSegment(0,0,4,2);var n=new o.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(o.EXTENT,0),n.emplaceBack(0,o.EXTENT),n.emplaceBack(o.EXTENT,o.EXTENT),this.debugBuffer=s.createVertexBuffer(n,hu.members),this.debugSegments=o.SegmentVector.simpleSegment(0,0,4,5);var l=new o.StructArrayLayout4i8;l.emplaceBack(0,0,0,0),l.emplaceBack(o.EXTENT,0,o.EXTENT,0),l.emplaceBack(0,o.EXTENT,0,o.EXTENT),l.emplaceBack(o.EXTENT,o.EXTENT,o.EXTENT,o.EXTENT),this.rasterBoundsBuffer=s.createVertexBuffer(l,Ce.members),this.rasterBoundsSegments=o.SegmentVector.simpleSegment(0,0,4,2);var b=new o.StructArrayLayout2i4;b.emplaceBack(0,0),b.emplaceBack(1,0),b.emplaceBack(0,1),b.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(b,hu.members),this.viewportSegments=o.SegmentVector.simpleSegment(0,0,4,2);var O=new o.StructArrayLayout1ui2;O.emplaceBack(0),O.emplaceBack(1),O.emplaceBack(3),O.emplaceBack(2),O.emplaceBack(0),this.tileBorderIndexBuffer=s.createIndexBuffer(O);var R=new o.StructArrayLayout3ui6;R.emplaceBack(0,1,2),R.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(R),this.emptyTexture=new o.Texture(s,{width:1,height:1,data:new Uint8Array([0,0,0,0])},s.gl.RGBA);var j=this.context.gl;this.stencilClearMode=new at({func:j.ALWAYS,mask:0},0,255,j.ZERO,j.ZERO,j.ZERO)},Bi.prototype.clearStencil=function(){var s=this.context,a=s.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var n=o.create();o.ortho(n,0,this.width,this.height,0,0,1),o.scale(n,n,[a.drawingBufferWidth,a.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(s,a.TRIANGLES,me.disabled,this.stencilClearMode,bt.disabled,He.disabled,nc(n),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Bi.prototype._renderTileClippingMasks=function(s,a){if(this.currentStencilSource!==s.source&&s.isTileClipped()&&a&&a.length){this.currentStencilSource=s.source;var n=this.context,l=n.gl;this.nextStencilID+a.length>256&&this.clearStencil(),n.setColorMode(bt.disabled),n.setDepthMode(me.disabled);var b=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var O=0,R=a;O<R.length;O+=1){var j=R[O],ue=this._tileClippingMaskIDs[j.key]=this.nextStencilID++;b.draw(n,l.TRIANGLES,me.disabled,new at({func:l.ALWAYS,mask:0},ue,255,l.KEEP,l.KEEP,l.REPLACE),bt.disabled,He.disabled,nc(j.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Bi.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var s=this.nextStencilID++,a=this.context.gl;return new at({func:a.NOTEQUAL,mask:255},s,255,a.KEEP,a.KEEP,a.REPLACE)},Bi.prototype.stencilModeForClipping=function(s){var a=this.context.gl;return new at({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,a.KEEP,a.KEEP,a.REPLACE)},Bi.prototype.stencilConfigForOverlap=function(s){var a,n=this.context.gl,l=s.sort(function(ue,Te){return Te.overscaledZ-ue.overscaledZ}),b=l[l.length-1].overscaledZ,O=l[0].overscaledZ-b+1;if(O>1){this.currentStencilSource=void 0,this.nextStencilID+O>256&&this.clearStencil();for(var R={},j=0;j<O;j++)R[j+b]=new at({func:n.GEQUAL,mask:255},j+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=O,[R,l]}return[(a={},a[b]=at.disabled,a),l]},Bi.prototype.colorModeForRenderPass=function(){var s=this.context.gl;return this._showOverdrawInspector?new bt([s.CONSTANT_COLOR,s.ONE],new o.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?bt.unblended:bt.alphaBlended},Bi.prototype.depthModeForSublayer=function(s,a,n){if(!this.opaquePassEnabledForLayer())return me.disabled;var l=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new me(n||this.context.gl.LEQUAL,a,[l,l])},Bi.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Bi.prototype.render=function(s,a){var n=this;this.style=s,this.options=a,this.lineAtlas=s.lineAtlas,this.imageManager=s.imageManager,this.glyphManager=s.glyphManager,this.symbolFadeChange=s.placement.symbolFadeChange(o.browser.now()),this.imageManager.beginFrame();var l=this.style._order,b=this.style.sourceCaches;for(var O in b){var R=b[O];R.used&&R.prepare(this.context)}var j,ue,Te={},Ye={},qe={};for(var tt in b){var Dt=b[tt];Te[tt]=Dt.getVisibleCoordinates(),Ye[tt]=Te[tt].slice().reverse(),qe[tt]=Dt.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Rt=0;Rt<l.length;Rt++)if(this.style._layers[l[Rt]].is3D()){this.opaquePassCutoff=Rt;break}this.renderPass="offscreen";for(var Wt=0,kt=l;Wt<kt.length;Wt+=1){var zt=this.style._layers[kt[Wt]];if(zt.hasOffscreenPass()&&!zt.isHidden(this.transform.zoom)){var nr=Ye[zt.source];(zt.type==="custom"||nr.length)&&this.renderLayer(this,b[zt.source],zt,nr)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?o.Color.black:o.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(s._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=l.length-1;this.currentLayer>=0;this.currentLayer--){var Jt=this.style._layers[l[this.currentLayer]],Cr=b[Jt.source],pr=Te[Jt.source];this._renderTileClippingMasks(Jt,pr),this.renderLayer(this,Cr,Jt,pr)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<l.length;this.currentLayer++){var _r=this.style._layers[l[this.currentLayer]],wr=b[_r.source],Hr=(_r.type==="symbol"?qe:Ye)[_r.source];this._renderTileClippingMasks(_r,Te[_r.source]),this.renderLayer(this,wr,_r,Hr)}this.options.showTileBoundaries&&(o.values(this.style._layers).forEach(function(Yr){Yr.source&&!Yr.isHidden(n.transform.zoom)&&(Yr.source!==(ue&&ue.id)&&(ue=n.style.sourceCaches[Yr.source]),(!j||j.getSource().maxzoom<ue.getSource().maxzoom)&&(j=ue))}),j&&sc.debug(this,j,j.getVisibleCoordinates())),this.options.showPadding&&function(Yr){var un=Yr.transform.padding;wu(Yr,Yr.transform.height-(un.top||0),3,Wf),wu(Yr,un.bottom||0,3,Df),Ns(Yr,un.left||0,3,Tc),Ns(Yr,Yr.transform.width-(un.right||0),3,kl);var _n=Yr.transform.centerPoint;!function(ia,pa,ya,Pa){il(ia,pa-1,ya-10,2,20,Pa),il(ia,pa-10,ya-1,20,2,Pa)}(Yr,_n.x,Yr.transform.height-_n.y,_c)}(this),this.context.setDefault()},Bi.prototype.renderLayer=function(s,a,n,l){n.isHidden(this.transform.zoom)||(n.type==="background"||n.type==="custom"||l.length)&&(this.id=n.id,this.gpuTimingStart(n),sc[n.type](s,a,n,l,this.style.placement.variableOffsets),this.gpuTimingEnd())},Bi.prototype.gpuTimingStart=function(s){if(this.options.gpuTiming){var a=this.context.extTimerQuery,n=this.gpuTimers[s.id];n||(n=this.gpuTimers[s.id]={calls:0,cpuTime:0,query:a.createQueryEXT()}),n.calls++,a.beginQueryEXT(a.TIME_ELAPSED_EXT,n.query)}},Bi.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var s=this.context.extTimerQuery;s.endQueryEXT(s.TIME_ELAPSED_EXT)}},Bi.prototype.collectGpuTimers=function(){var s=this.gpuTimers;return this.gpuTimers={},s},Bi.prototype.queryGpuTimers=function(s){var a={};for(var n in s){var l=s[n],b=this.context.extTimerQuery,O=b.getQueryObjectEXT(l.query,b.QUERY_RESULT_EXT)/1e6;b.deleteQueryEXT(l.query),a[n]=O}return a},Bi.prototype.translatePosMatrix=function(s,a,n,l,b){if(!n[0]&&!n[1])return s;var O=b?l==="map"?this.transform.angle:0:l==="viewport"?-this.transform.angle:0;if(O){var R=Math.sin(O),j=Math.cos(O);n=[n[0]*j-n[1]*R,n[0]*R+n[1]*j]}var ue=[b?n[0]:li(a,n[0],this.transform.zoom),b?n[1]:li(a,n[1],this.transform.zoom),0],Te=new Float32Array(16);return o.translate(Te,s,ue),Te},Bi.prototype.saveTileTexture=function(s){var a=this._tileTextures[s.size[0]];a?a.push(s):this._tileTextures[s.size[0]]=[s]},Bi.prototype.getTileTexture=function(s){var a=this._tileTextures[s];return a&&a.length>0?a.pop():null},Bi.prototype.isPatternMissing=function(s){if(!s)return!1;if(!s.from||!s.to)return!0;var a=this.imageManager.getPattern(s.from.toString()),n=this.imageManager.getPattern(s.to.toString());return!a||!n},Bi.prototype.useProgram=function(s,a){this.cache=this.cache||{};var n=""+s+(a?a.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[n]||(this.cache[n]=new af(this.context,s,zc[s],a,Rl[s],this._showOverdrawInspector)),this.cache[n]},Bi.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Bi.prototype.setBaseState=function(){var s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)},Bi.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=o.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Bi.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var vu=function(a,n){this.points=a,this.planes=n};vu.fromInvProjectionMatrix=function(s,a,n){var l=Math.pow(2,n),b=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(R){return o.transformMat4([],R,s)}).map(function(R){return o.scale$1([],R,1/R[3]/a*l)}),O=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(R){var j=o.sub([],b[R[0]],b[R[1]]),ue=o.sub([],b[R[2]],b[R[1]]),Te=o.normalize([],o.cross([],j,ue)),Ye=-o.dot(Te,b[R[1]]);return Te.concat(Ye)});return new vu(b,O)};var ol=function(a,n){this.min=a,this.max=n,this.center=o.scale$2([],o.add([],this.min,this.max),.5)};ol.prototype.quadrant=function(s){for(var a=[s%2==0,s<2],n=o.clone$2(this.min),l=o.clone$2(this.max),b=0;b<a.length;b++)n[b]=a[b]?this.min[b]:this.center[b],l[b]=a[b]?this.center[b]:this.max[b];return l[2]=this.max[2],new ol(n,l)},ol.prototype.distanceX=function(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]},ol.prototype.distanceY=function(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]},ol.prototype.intersects=function(s){for(var a=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],n=!0,l=0;l<s.planes.length;l++){for(var b=s.planes[l],O=0,R=0;R<a.length;R++)O+=o.dot$1(b,a[R])>=0;if(O===0)return 0;O!==a.length&&(n=!1)}if(n)return 2;for(var j=0;j<3;j++){for(var ue=Number.MAX_VALUE,Te=-Number.MAX_VALUE,Ye=0;Ye<s.points.length;Ye++){var qe=s.points[Ye][j]-this.min[j];ue=Math.min(ue,qe),Te=Math.max(Te,qe)}if(Te<0||ue>this.max[j]-this.min[j])return 0}return 1};var Yo=function(a,n,l,b){if(a===void 0&&(a=0),n===void 0&&(n=0),l===void 0&&(l=0),b===void 0&&(b=0),isNaN(a)||a<0||isNaN(n)||n<0||isNaN(l)||l<0||isNaN(b)||b<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=a,this.bottom=n,this.left=l,this.right=b};Yo.prototype.interpolate=function(s,a,n){return a.top!=null&&s.top!=null&&(this.top=o.number(s.top,a.top,n)),a.bottom!=null&&s.bottom!=null&&(this.bottom=o.number(s.bottom,a.bottom,n)),a.left!=null&&s.left!=null&&(this.left=o.number(s.left,a.left,n)),a.right!=null&&s.right!=null&&(this.right=o.number(s.right,a.right,n)),this},Yo.prototype.getCenter=function(s,a){var n=o.clamp((this.left+s-this.right)/2,0,s),l=o.clamp((this.top+a-this.bottom)/2,0,a);return new o.Point(n,l)},Yo.prototype.equals=function(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right},Yo.prototype.clone=function(){return new Yo(this.top,this.bottom,this.left,this.right)},Yo.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var ei=function(a,n,l,b,O){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=O===void 0||O,this._minZoom=a||0,this._maxZoom=n||22,this._minPitch=l==null?0:l,this._maxPitch=b==null?60:b,this.setMaxBounds(),this.width=0,this.height=0,this._center=new o.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Yo,this._posMatrixCache={},this._alignedPosMatrixCache={}},$a={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};ei.prototype.clone=function(){var s=new ei(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return s.tileSize=this.tileSize,s.latRange=this.latRange,s.width=this.width,s.height=this.height,s._center=this._center,s.zoom=this.zoom,s.angle=this.angle,s._fov=this._fov,s._pitch=this._pitch,s._unmodified=this._unmodified,s._edgeInsets=this._edgeInsets.clone(),s._calcMatrices(),s},$a.minZoom.get=function(){return this._minZoom},$a.minZoom.set=function(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))},$a.maxZoom.get=function(){return this._maxZoom},$a.maxZoom.set=function(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))},$a.minPitch.get=function(){return this._minPitch},$a.minPitch.set=function(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))},$a.maxPitch.get=function(){return this._maxPitch},$a.maxPitch.set=function(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))},$a.renderWorldCopies.get=function(){return this._renderWorldCopies},$a.renderWorldCopies.set=function(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s},$a.worldSize.get=function(){return this.tileSize*this.scale},$a.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},$a.size.get=function(){return new o.Point(this.width,this.height)},$a.bearing.get=function(){return-this.angle/Math.PI*180},$a.bearing.set=function(s){var a=-o.wrap(s,-180,180)*Math.PI/180;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=o.create$2(),o.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},$a.pitch.get=function(){return this._pitch/Math.PI*180},$a.pitch.set=function(s){var a=o.clamp(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())},$a.fov.get=function(){return this._fov/Math.PI*180},$a.fov.set=function(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=s/180*Math.PI,this._calcMatrices())},$a.zoom.get=function(){return this._zoom},$a.zoom.set=function(s){var a=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this.scale=this.zoomScale(a),this.tileZoom=Math.floor(a),this.zoomFraction=a-this.tileZoom,this._constrain(),this._calcMatrices())},$a.center.get=function(){return this._center},$a.center.set=function(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._constrain(),this._calcMatrices())},$a.padding.get=function(){return this._edgeInsets.toJSON()},$a.padding.set=function(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())},$a.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},ei.prototype.isPaddingEqual=function(s){return this._edgeInsets.equals(s)},ei.prototype.interpolatePadding=function(s,a,n){this._unmodified=!1,this._edgeInsets.interpolate(s,a,n),this._constrain(),this._calcMatrices()},ei.prototype.coveringZoomLevel=function(s){var a=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,a)},ei.prototype.getVisibleUnwrappedCoordinates=function(s){var a=[new o.UnwrappedTileID(0,s)];if(this._renderWorldCopies)for(var n=this.pointCoordinate(new o.Point(0,0)),l=this.pointCoordinate(new o.Point(this.width,0)),b=this.pointCoordinate(new o.Point(this.width,this.height)),O=this.pointCoordinate(new o.Point(0,this.height)),R=Math.floor(Math.min(n.x,l.x,b.x,O.x)),j=Math.floor(Math.max(n.x,l.x,b.x,O.x)),ue=R-1;ue<=j+1;ue++)ue!==0&&a.push(new o.UnwrappedTileID(ue,s));return a},ei.prototype.coveringTiles=function(s){var a=this.coveringZoomLevel(s),n=a;if(s.minzoom!==void 0&&a<s.minzoom)return[];s.maxzoom!==void 0&&a>s.maxzoom&&(a=s.maxzoom);var l=o.MercatorCoordinate.fromLngLat(this.center),b=Math.pow(2,a),O=[b*l.x,b*l.y,0],R=vu.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,a),j=s.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(j=a);var ue=function(un){return{aabb:new ol([un*b,0,0],[(un+1)*b,b,0]),zoom:0,x:0,y:0,wrap:un,fullyVisible:!1}},Te=[],Ye=[],qe=a,tt=s.reparseOverscaled?n:a;if(this._renderWorldCopies)for(var Dt=1;Dt<=3;Dt++)Te.push(ue(-Dt)),Te.push(ue(Dt));for(Te.push(ue(0));Te.length>0;){var Rt=Te.pop(),Wt=Rt.x,kt=Rt.y,zt=Rt.fullyVisible;if(!zt){var nr=Rt.aabb.intersects(R);if(nr===0)continue;zt=nr===2}var Jt=Rt.aabb.distanceX(O),Cr=Rt.aabb.distanceY(O),pr=Math.max(Math.abs(Jt),Math.abs(Cr));if(Rt.zoom===qe||pr>3+(1<<qe-Rt.zoom)-2&&Rt.zoom>=j)Ye.push({tileID:new o.OverscaledTileID(Rt.zoom===qe?tt:Rt.zoom,Rt.wrap,Rt.zoom,Wt,kt),distanceSq:o.sqrLen([O[0]-.5-Wt,O[1]-.5-kt])});else for(var _r=0;_r<4;_r++){var wr=(Wt<<1)+_r%2,Hr=(kt<<1)+(_r>>1);Te.push({aabb:Rt.aabb.quadrant(_r),zoom:Rt.zoom+1,x:wr,y:Hr,wrap:Rt.wrap,fullyVisible:zt})}}return Ye.sort(function(Yr,un){return Yr.distanceSq-un.distanceSq}).map(function(Yr){return Yr.tileID})},ei.prototype.resize=function(s,a){this.width=s,this.height=a,this.pixelsToGLUnits=[2/s,-2/a],this._constrain(),this._calcMatrices()},$a.unmodified.get=function(){return this._unmodified},ei.prototype.zoomScale=function(s){return Math.pow(2,s)},ei.prototype.scaleZoom=function(s){return Math.log(s)/Math.LN2},ei.prototype.project=function(s){var a=o.clamp(s.lat,-this.maxValidLatitude,this.maxValidLatitude);return new o.Point(o.mercatorXfromLng(s.lng)*this.worldSize,o.mercatorYfromLat(a)*this.worldSize)},ei.prototype.unproject=function(s){return new o.MercatorCoordinate(s.x/this.worldSize,s.y/this.worldSize).toLngLat()},$a.point.get=function(){return this.project(this.center)},ei.prototype.setLocationAtPoint=function(s,a){var n=this.pointCoordinate(a),l=this.pointCoordinate(this.centerPoint),b=this.locationCoordinate(s),O=new o.MercatorCoordinate(b.x-(n.x-l.x),b.y-(n.y-l.y));this.center=this.coordinateLocation(O),this._renderWorldCopies&&(this.center=this.center.wrap())},ei.prototype.locationPoint=function(s){return this.coordinatePoint(this.locationCoordinate(s))},ei.prototype.pointLocation=function(s){return this.coordinateLocation(this.pointCoordinate(s))},ei.prototype.locationCoordinate=function(s){return o.MercatorCoordinate.fromLngLat(s)},ei.prototype.coordinateLocation=function(s){return s.toLngLat()},ei.prototype.pointCoordinate=function(s){var a=[s.x,s.y,0,1],n=[s.x,s.y,1,1];o.transformMat4(a,a,this.pixelMatrixInverse),o.transformMat4(n,n,this.pixelMatrixInverse);var l=a[3],b=n[3],O=a[1]/l,R=n[1]/b,j=a[2]/l,ue=n[2]/b,Te=j===ue?0:(0-j)/(ue-j);return new o.MercatorCoordinate(o.number(a[0]/l,n[0]/b,Te)/this.worldSize,o.number(O,R,Te)/this.worldSize)},ei.prototype.coordinatePoint=function(s){var a=[s.x*this.worldSize,s.y*this.worldSize,0,1];return o.transformMat4(a,a,this.pixelMatrix),new o.Point(a[0]/a[3],a[1]/a[3])},ei.prototype.getBounds=function(){return new o.LngLatBounds().extend(this.pointLocation(new o.Point(0,0))).extend(this.pointLocation(new o.Point(this.width,0))).extend(this.pointLocation(new o.Point(this.width,this.height))).extend(this.pointLocation(new o.Point(0,this.height)))},ei.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new o.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},ei.prototype.setMaxBounds=function(s){s?(this.lngRange=[s.getWest(),s.getEast()],this.latRange=[s.getSouth(),s.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},ei.prototype.calculatePosMatrix=function(s,a){a===void 0&&(a=!1);var n=s.key,l=a?this._alignedPosMatrixCache:this._posMatrixCache;if(l[n])return l[n];var b=s.canonical,O=this.worldSize/this.zoomScale(b.z),R=b.x+Math.pow(2,b.z)*s.wrap,j=o.identity(new Float64Array(16));return o.translate(j,j,[R*O,b.y*O,0]),o.scale(j,j,[O/o.EXTENT,O/o.EXTENT,1]),o.multiply(j,a?this.alignedProjMatrix:this.projMatrix,j),l[n]=new Float32Array(j),l[n]},ei.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},ei.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var s,a,n,l,b=-90,O=90,R=-180,j=180,ue=this.size,Te=this._unmodified;if(this.latRange){var Ye=this.latRange;b=o.mercatorYfromLat(Ye[1])*this.worldSize,s=(O=o.mercatorYfromLat(Ye[0])*this.worldSize)-b<ue.y?ue.y/(O-b):0}if(this.lngRange){var qe=this.lngRange;R=o.mercatorXfromLng(qe[0])*this.worldSize,a=(j=o.mercatorXfromLng(qe[1])*this.worldSize)-R<ue.x?ue.x/(j-R):0}var tt=this.point,Dt=Math.max(a||0,s||0);if(Dt)return this.center=this.unproject(new o.Point(a?(j+R)/2:tt.x,s?(O+b)/2:tt.y)),this.zoom+=this.scaleZoom(Dt),this._unmodified=Te,void(this._constraining=!1);if(this.latRange){var Rt=tt.y,Wt=ue.y/2;Rt-Wt<b&&(l=b+Wt),Rt+Wt>O&&(l=O-Wt)}if(this.lngRange){var kt=tt.x,zt=ue.x/2;kt-zt<R&&(n=R+zt),kt+zt>j&&(n=j-zt)}n===void 0&&l===void 0||(this.center=this.unproject(new o.Point(n!==void 0?n:tt.x,l!==void 0?l:tt.y))),this._unmodified=Te,this._constraining=!1}},ei.prototype._calcMatrices=function(){if(this.height){var s=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var a=Math.PI/2+this._pitch,n=this._fov*(.5+s.y/this.height),l=Math.sin(n)*this.cameraToCenterDistance/Math.sin(o.clamp(Math.PI-a-n,.01,Math.PI-.01)),b=this.point,O=b.x,R=b.y,j=1.01*(Math.cos(Math.PI/2-this._pitch)*l+this.cameraToCenterDistance),ue=this.height/50,Te=new Float64Array(16);o.perspective(Te,this._fov,this.width/this.height,ue,j),Te[8]=2*-s.x/this.width,Te[9]=2*s.y/this.height,o.scale(Te,Te,[1,-1,1]),o.translate(Te,Te,[0,0,-this.cameraToCenterDistance]),o.rotateX(Te,Te,this._pitch),o.rotateZ(Te,Te,this.angle),o.translate(Te,Te,[-O,-R,0]),this.mercatorMatrix=o.scale([],Te,[this.worldSize,this.worldSize,this.worldSize]),o.scale(Te,Te,[1,1,o.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=Te,this.invProjMatrix=o.invert([],this.projMatrix);var Ye=this.width%2/2,qe=this.height%2/2,tt=Math.cos(this.angle),Dt=Math.sin(this.angle),Rt=O-Math.round(O)+tt*Ye+Dt*qe,Wt=R-Math.round(R)+tt*qe+Dt*Ye,kt=new Float64Array(Te);if(o.translate(kt,kt,[Rt>.5?Rt-1:Rt,Wt>.5?Wt-1:Wt,0]),this.alignedProjMatrix=kt,Te=o.create(),o.scale(Te,Te,[this.width/2,-this.height/2,1]),o.translate(Te,Te,[1,-1,0]),this.labelPlaneMatrix=Te,Te=o.create(),o.scale(Te,Te,[1,-1,1]),o.translate(Te,Te,[-1,-1,0]),o.scale(Te,Te,[2/this.width,2/this.height,1]),this.glCoordMatrix=Te,this.pixelMatrix=o.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(Te=o.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=Te,this._posMatrixCache={},this._alignedPosMatrixCache={}}},ei.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var s=this.pointCoordinate(new o.Point(0,0)),a=[s.x*this.worldSize,s.y*this.worldSize,0,1];return o.transformMat4(a,a,this.pixelMatrix)[3]/this.cameraToCenterDistance},ei.prototype.getCameraPoint=function(){var s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.Point(0,s))},ei.prototype.getCameraQueryGeometry=function(s){var a=this.getCameraPoint();if(s.length===1)return[s[0],a];for(var n=a.x,l=a.y,b=a.x,O=a.y,R=0,j=s;R<j.length;R+=1){var ue=j[R];n=Math.min(n,ue.x),l=Math.min(l,ue.y),b=Math.max(b,ue.x),O=Math.max(O,ue.y)}return[new o.Point(n,l),new o.Point(b,l),new o.Point(b,O),new o.Point(n,O),new o.Point(n,l)]},Object.defineProperties(ei.prototype,$a);var Hu=function(a){var n,l,b,O;this._hashName=a&&encodeURIComponent(a),o.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(n=this._updateHashUnthrottled.bind(this),l=!1,b=null,O=function(){b=null,l&&(n(),b=setTimeout(O,300),l=!1)},function(){return l=!0,b||O(),b})};Hu.prototype.addTo=function(s){return this._map=s,o.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Hu.prototype.remove=function(){return o.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Hu.prototype.getHashString=function(s){var a=this._map.getCenter(),n=Math.round(100*this._map.getZoom())/100,l=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,l),O=Math.round(a.lng*b)/b,R=Math.round(a.lat*b)/b,j=this._map.getBearing(),ue=this._map.getPitch(),Te="";if(Te+=s?"/"+O+"/"+R+"/"+n:n+"/"+R+"/"+O,(j||ue)&&(Te+="/"+Math.round(10*j)/10),ue&&(Te+="/"+Math.round(ue)),this._hashName){var Ye=this._hashName,qe=!1,tt=o.window.location.hash.slice(1).split("&").map(function(Dt){var Rt=Dt.split("=")[0];return Rt===Ye?(qe=!0,Rt+"="+Te):Dt}).filter(function(Dt){return Dt});return qe||tt.push(Ye+"="+Te),"#"+tt.join("&")}return"#"+Te},Hu.prototype._getCurrentHash=function(){var s,a=this,n=o.window.location.hash.replace("#","");return this._hashName?(n.split("&").map(function(l){return l.split("=")}).forEach(function(l){l[0]===a._hashName&&(s=l)}),(s&&s[1]||"").split("/")):n.split("/")},Hu.prototype._onHashChange=function(){var s=this._getCurrentHash();if(s.length>=3&&!s.some(function(n){return isNaN(n)})){var a=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(s[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:a,pitch:+(s[4]||0)}),!0}return!1},Hu.prototype._updateHashUnthrottled=function(){var s=this.getHashString();try{o.window.history.replaceState(o.window.history.state,"",s)}catch(a){}};var ti={linearity:.3,easing:o.bezier(0,0,.3,1)},Xa=o.extend({deceleration:2500,maxSpeed:1400},ti),Tf=o.extend({deceleration:20,maxSpeed:1400},ti),_f=o.extend({deceleration:1e3,maxSpeed:360},ti),Ko=o.extend({deceleration:1e3,maxSpeed:90},ti),Wu=function(a){this._map=a,this.clear()};function gs(s,a){(!s.duration||s.duration<a.duration)&&(s.duration=a.duration,s.easing=a.easing)}function ks(s,a,n){var l=n.maxSpeed,b=n.linearity,O=n.deceleration,R=o.clamp(s*b/(a/1e3),-l,l),j=Math.abs(R)/(O*b);return{easing:n.easing,duration:1e3*j,amount:R*(j/2)}}Wu.prototype.clear=function(){this._inertiaBuffer=[]},Wu.prototype.record=function(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.browser.now(),settings:s})},Wu.prototype._drainInertiaBuffer=function(){for(var s=this._inertiaBuffer,a=o.browser.now();s.length>0&&a-s[0].time>160;)s.shift()},Wu.prototype._onMoveEnd=function(s){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var a={zoom:0,bearing:0,pitch:0,pan:new o.Point(0,0),pinchAround:void 0,around:void 0},n=0,l=this._inertiaBuffer;n<l.length;n+=1){var b=l[n].settings;a.zoom+=b.zoomDelta||0,a.bearing+=b.bearingDelta||0,a.pitch+=b.pitchDelta||0,b.panDelta&&a.pan._add(b.panDelta),b.around&&(a.around=b.around),b.pinchAround&&(a.pinchAround=b.pinchAround)}var O=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,R={};if(a.pan.mag()){var j=ks(a.pan.mag(),O,o.extend({},Xa,s||{}));R.offset=a.pan.mult(j.amount/a.pan.mag()),R.center=this._map.transform.center,gs(R,j)}if(a.zoom){var ue=ks(a.zoom,O,Tf);R.zoom=this._map.transform.zoom+ue.amount,gs(R,ue)}if(a.bearing){var Te=ks(a.bearing,O,_f);R.bearing=this._map.transform.bearing+o.clamp(Te.amount,-179,179),gs(R,Te)}if(a.pitch){var Ye=ks(a.pitch,O,Ko);R.pitch=this._map.transform.pitch+Ye.amount,gs(R,Ye)}if(R.zoom||R.bearing){var qe=a.pinchAround===void 0?a.around:a.pinchAround;R.around=qe?this._map.unproject(qe):this._map.getCenter()}return this.clear(),o.extend(R,{noMoveStart:!0})}};var ys=function(s){function a(l,b,O,R){R===void 0&&(R={});var j=D.mousePos(b.getCanvasContainer(),O),ue=b.unproject(j);s.call(this,l,o.extend({point:j,lngLat:ue,originalEvent:O},R)),this._defaultPrevented=!1,this.target=b}s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a;var n={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,n),a}(o.Event),$o=function(s){function a(l,b,O){var R=l==="touchend"?O.changedTouches:O.touches,j=D.touchPos(b.getCanvasContainer(),R),ue=j.map(function(qe){return b.unproject(qe)}),Te=j.reduce(function(qe,tt,Dt,Rt){return qe.add(tt.div(Rt.length))},new o.Point(0,0)),Ye=b.unproject(Te);s.call(this,l,{points:j,point:Te,lngLats:ue,lngLat:Ye,originalEvent:O}),this._defaultPrevented=!1}s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a;var n={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,n),a}(o.Event),Zu=function(s){function a(l,b,O){s.call(this,l,{originalEvent:O}),this._defaultPrevented=!1}s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a;var n={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,n),a}(o.Event),xn=function(a,n){this._map=a,this._clickTolerance=n.clickTolerance};xn.prototype.reset=function(){delete this._mousedownPos},xn.prototype.wheel=function(s){return this._firePreventable(new Zu(s.type,this._map,s))},xn.prototype.mousedown=function(s,a){return this._mousedownPos=a,this._firePreventable(new ys(s.type,this._map,s))},xn.prototype.mouseup=function(s){this._map.fire(new ys(s.type,this._map,s))},xn.prototype.click=function(s,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new ys(s.type,this._map,s))},xn.prototype.dblclick=function(s){return this._firePreventable(new ys(s.type,this._map,s))},xn.prototype.mouseover=function(s){this._map.fire(new ys(s.type,this._map,s))},xn.prototype.mouseout=function(s){this._map.fire(new ys(s.type,this._map,s))},xn.prototype.touchstart=function(s){return this._firePreventable(new $o(s.type,this._map,s))},xn.prototype.touchmove=function(s){this._map.fire(new $o(s.type,this._map,s))},xn.prototype.touchend=function(s){this._map.fire(new $o(s.type,this._map,s))},xn.prototype.touchcancel=function(s){this._map.fire(new $o(s.type,this._map,s))},xn.prototype._firePreventable=function(s){if(this._map.fire(s),s.defaultPrevented)return{}},xn.prototype.isEnabled=function(){return!0},xn.prototype.isActive=function(){return!1},xn.prototype.enable=function(){},xn.prototype.disable=function(){};var bs=function(a){this._map=a};bs.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},bs.prototype.mousemove=function(s){this._map.fire(new ys(s.type,this._map,s))},bs.prototype.mousedown=function(){this._delayContextMenu=!0},bs.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ys("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},bs.prototype.contextmenu=function(s){this._delayContextMenu?this._contextMenuEvent=s:this._map.fire(new ys(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()},bs.prototype.isEnabled=function(){return!0},bs.prototype.isActive=function(){return!1},bs.prototype.enable=function(){},bs.prototype.disable=function(){};var nu=function(a,n){this._map=a,this._el=a.getCanvasContainer(),this._container=a.getContainer(),this._clickTolerance=n.clickTolerance||1};function Sc(s,a){for(var n={},l=0;l<s.length;l++)n[s[l].identifier]=a[l];return n}nu.prototype.isEnabled=function(){return!!this._enabled},nu.prototype.isActive=function(){return!!this._active},nu.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},nu.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},nu.prototype.mousedown=function(s,a){this.isEnabled()&&s.shiftKey&&s.button===0&&(D.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)},nu.prototype.mousemoveWindow=function(s,a){if(this._active){var n=a;if(!(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance)){var l=this._startPos;this._lastPos=n,this._box||(this._box=D.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",s));var b=Math.min(l.x,n.x),O=Math.max(l.x,n.x),R=Math.min(l.y,n.y),j=Math.max(l.y,n.y);D.setTransform(this._box,"translate("+b+"px,"+R+"px)"),this._box.style.width=O-b+"px",this._box.style.height=j-R+"px"}}},nu.prototype.mouseupWindow=function(s,a){var n=this;if(this._active&&s.button===0){var l=this._startPos,b=a;if(this.reset(),D.suppressClick(),l.x!==b.x||l.y!==b.y)return this._map.fire(new o.Event("boxzoomend",{originalEvent:s})),{cameraAnimation:function(R){return R.fitScreenCoordinates(l,b,n._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",s)}},nu.prototype.keydown=function(s){this._active&&s.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",s))},nu.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(D.remove(this._box),this._box=null),D.enableDrag(),delete this._startPos,delete this._lastPos},nu.prototype._fireEvent=function(s,a){return this._map.fire(new o.Event(s,{originalEvent:a}))};var Ou=function(a){this.reset(),this.numTouches=a.numTouches};Ou.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Ou.prototype.touchstart=function(s,a,n){(this.centroid||n.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=s.timeStamp),n.length===this.numTouches&&(this.centroid=function(l){for(var b=new o.Point(0,0),O=0,R=l;O<R.length;O+=1)b._add(R[O]);return b.div(l.length)}(a),this.touches=Sc(n,a)))},Ou.prototype.touchmove=function(s,a,n){if(!this.aborted&&this.centroid){var l=Sc(n,a);for(var b in this.touches){var O=l[b];(!O||O.dist(this.touches[b])>30)&&(this.aborted=!0)}}},Ou.prototype.touchend=function(s,a,n){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),n.length===0){var l=!this.aborted&&this.centroid;if(this.reset(),l)return l}};var Mu=function(a){this.singleTap=new Ou(a),this.numTaps=a.numTaps,this.reset()};Mu.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},Mu.prototype.touchstart=function(s,a,n){this.singleTap.touchstart(s,a,n)},Mu.prototype.touchmove=function(s,a,n){this.singleTap.touchmove(s,a,n)},Mu.prototype.touchend=function(s,a,n){var l=this.singleTap.touchend(s,a,n);if(l){var b=s.timeStamp-this.lastTime<500,O=!this.lastTap||this.lastTap.dist(l)<30;if(b&&O||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=l,this.count===this.numTaps)return this.reset(),l}};var gu=function(){this._zoomIn=new Mu({numTouches:1,numTaps:2}),this._zoomOut=new Mu({numTouches:2,numTaps:1}),this.reset()};gu.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},gu.prototype.touchstart=function(s,a,n){this._zoomIn.touchstart(s,a,n),this._zoomOut.touchstart(s,a,n)},gu.prototype.touchmove=function(s,a,n){this._zoomIn.touchmove(s,a,n),this._zoomOut.touchmove(s,a,n)},gu.prototype.touchend=function(s,a,n){var l=this,b=this._zoomIn.touchend(s,a,n),O=this._zoomOut.touchend(s,a,n);return b?(this._active=!0,s.preventDefault(),setTimeout(function(){return l.reset()},0),{cameraAnimation:function(j){return j.easeTo({duration:300,zoom:j.getZoom()+1,around:j.unproject(b)},{originalEvent:s})}}):O?(this._active=!0,s.preventDefault(),setTimeout(function(){return l.reset()},0),{cameraAnimation:function(j){return j.easeTo({duration:300,zoom:j.getZoom()-1,around:j.unproject(O)},{originalEvent:s})}}):void 0},gu.prototype.touchcancel=function(){this.reset()},gu.prototype.enable=function(){this._enabled=!0},gu.prototype.disable=function(){this._enabled=!1,this.reset()},gu.prototype.isEnabled=function(){return this._enabled},gu.prototype.isActive=function(){return this._active};var Zr={0:1,2:2},vi=function(a){this.reset(),this._clickTolerance=a.clickTolerance||1};vi.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},vi.prototype._correctButton=function(s,a){return!1},vi.prototype._move=function(s,a){return{}},vi.prototype.mousedown=function(s,a){if(!this._lastPoint){var n=D.mouseButton(s);this._correctButton(s,n)&&(this._lastPoint=a,this._eventButton=n)}},vi.prototype.mousemoveWindow=function(s,a){var n=this._lastPoint;if(n){if(s.preventDefault(),function(l,b){var O=Zr[b];return l.buttons===void 0||(l.buttons&O)!==O}(s,this._eventButton))this.reset();else if(this._moved||!(a.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=a,this._move(n,a)}},vi.prototype.mouseupWindow=function(s){this._lastPoint&&D.mouseButton(s)===this._eventButton&&(this._moved&&D.suppressClick(),this.reset())},vi.prototype.enable=function(){this._enabled=!0},vi.prototype.disable=function(){this._enabled=!1,this.reset()},vi.prototype.isEnabled=function(){return this._enabled},vi.prototype.isActive=function(){return this._active};var Hc=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.mousedown=function(n,l){s.prototype.mousedown.call(this,n,l),this._lastPoint&&(this._active=!0)},a.prototype._correctButton=function(n,l){return l===0&&!n.ctrlKey},a.prototype._move=function(n,l){return{around:l,panDelta:l.sub(n)}},a}(vi),Wc=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype._correctButton=function(n,l){return l===0&&n.ctrlKey||l===2},a.prototype._move=function(n,l){var b=.8*(l.x-n.x);if(b)return this._active=!0,{bearingDelta:b}},a.prototype.contextmenu=function(n){n.preventDefault()},a}(vi),sl=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype._correctButton=function(n,l){return l===0&&n.ctrlKey||l===2},a.prototype._move=function(n,l){var b=-.5*(l.y-n.y);if(b)return this._active=!0,{pitchDelta:b}},a.prototype.contextmenu=function(n){n.preventDefault()},a}(vi),Pu=function(a){this._minTouches=1,this._clickTolerance=a.clickTolerance||1,this.reset()};Pu.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new o.Point(0,0)},Pu.prototype.touchstart=function(s,a,n){return this._calculateTransform(s,a,n)},Pu.prototype.touchmove=function(s,a,n){if(this._active&&!(n.length<this._minTouches))return s.preventDefault(),this._calculateTransform(s,a,n)},Pu.prototype.touchend=function(s,a,n){this._calculateTransform(s,a,n),this._active&&n.length<this._minTouches&&this.reset()},Pu.prototype.touchcancel=function(){this.reset()},Pu.prototype._calculateTransform=function(s,a,n){n.length>0&&(this._active=!0);var l=Sc(n,a),b=new o.Point(0,0),O=new o.Point(0,0),R=0;for(var j in l){var ue=l[j],Te=this._touches[j];Te&&(b._add(ue),O._add(ue.sub(Te)),R++,l[j]=ue)}if(this._touches=l,!(R<this._minTouches)&&O.mag()){var Ye=O.div(R);if(this._sum._add(Ye),!(this._sum.mag()<this._clickTolerance))return{around:b.div(R),panDelta:Ye}}},Pu.prototype.enable=function(){this._enabled=!0},Pu.prototype.disable=function(){this._enabled=!1,this.reset()},Pu.prototype.isEnabled=function(){return this._enabled},Pu.prototype.isActive=function(){return this._active};var Ms=function(){this.reset()};function as(s,a,n){for(var l=0;l<s.length;l++)if(s[l].identifier===n)return a[l]}function wi(s,a){return Math.log(s/a)/Math.LN2}Ms.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Ms.prototype._start=function(s){},Ms.prototype._move=function(s,a,n){return{}},Ms.prototype.touchstart=function(s,a,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([a[0],a[1]]))},Ms.prototype.touchmove=function(s,a,n){if(this._firstTwoTouches){s.preventDefault();var l=this._firstTwoTouches,b=l[1],O=as(n,a,l[0]),R=as(n,a,b);if(O&&R){var j=this._aroundCenter?null:O.add(R).div(2);return this._move([O,R],j,s)}}},Ms.prototype.touchend=function(s,a,n){if(this._firstTwoTouches){var l=this._firstTwoTouches,b=l[1],O=as(n,a,l[0]),R=as(n,a,b);O&&R||(this._active&&D.suppressClick(),this.reset())}},Ms.prototype.touchcancel=function(){this.reset()},Ms.prototype.enable=function(s){this._enabled=!0,this._aroundCenter=!!s&&s.around==="center"},Ms.prototype.disable=function(){this._enabled=!1,this.reset()},Ms.prototype.isEnabled=function(){return this._enabled},Ms.prototype.isActive=function(){return this._active};var js=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.reset=function(){s.prototype.reset.call(this),delete this._distance,delete this._startDistance},a.prototype._start=function(n){this._startDistance=this._distance=n[0].dist(n[1])},a.prototype._move=function(n,l){var b=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(wi(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:wi(this._distance,b),pinchAround:l}},a}(Ms);function sf(s,a){return 180*s.angleWith(a)/Math.PI}var ul=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.reset=function(){s.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},a.prototype._start=function(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])},a.prototype._move=function(n,l){var b=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:sf(this._vector,b),pinchAround:l}},a.prototype._isBelowThreshold=function(n){this._minDiameter=Math.min(this._minDiameter,n.mag());var l=25/(Math.PI*this._minDiameter)*360,b=sf(n,this._startVector);return Math.abs(b)<l},a}(Ms);function jl(s){return Math.abs(s.y)>Math.abs(s.x)}var uf=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.reset=function(){s.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},a.prototype._start=function(n){this._lastPoints=n,jl(n[0].sub(n[1]))&&(this._valid=!1)},a.prototype._move=function(n,l,b){var O=n[0].sub(this._lastPoints[0]),R=n[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(O,R,b.timeStamp),this._valid)return this._lastPoints=n,this._active=!0,{pitchDelta:(O.y+R.y)/2*-.5}},a.prototype.gestureBeginsVertically=function(n,l,b){if(this._valid!==void 0)return this._valid;var O=n.mag()>=2,R=l.mag()>=2;if(O||R){if(!O||!R)return this._firstMove===void 0&&(this._firstMove=b),b-this._firstMove<100&&void 0;var j=n.y>0==l.y>0;return jl(n)&&jl(l)&&j}},a}(Ms),uc={panStep:100,bearingStep:15,pitchStep:10},uo=function(){var a=uc;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep};function ci(s){return s*(2-s)}uo.prototype.reset=function(){this._active=!1},uo.prototype.keydown=function(s){var a=this;if(!(s.altKey||s.ctrlKey||s.metaKey)){var n=0,l=0,b=0,O=0,R=0;switch(s.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:s.shiftKey?l=-1:(s.preventDefault(),O=-1);break;case 39:s.shiftKey?l=1:(s.preventDefault(),O=1);break;case 38:s.shiftKey?b=1:(s.preventDefault(),R=-1);break;case 40:s.shiftKey?b=-1:(s.preventDefault(),R=1);break;default:return}return{cameraAnimation:function(ue){var Te=ue.getZoom();ue.easeTo({duration:300,easeId:"keyboardHandler",easing:ci,zoom:n?Math.round(Te)+n*(s.shiftKey?2:1):Te,bearing:ue.getBearing()+l*a._bearingStep,pitch:ue.getPitch()+b*a._pitchStep,offset:[-O*a._panStep,-R*a._panStep],center:ue.getCenter()},{originalEvent:s})}}}},uo.prototype.enable=function(){this._enabled=!0},uo.prototype.disable=function(){this._enabled=!1,this.reset()},uo.prototype.isEnabled=function(){return this._enabled},uo.prototype.isActive=function(){return this._active};var mo=function(a,n){this._map=a,this._el=a.getCanvasContainer(),this._handler=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,o.bindAll(["_onTimeout"],this)};mo.prototype.setZoomRate=function(s){this._defaultZoomRate=s},mo.prototype.setWheelZoomRate=function(s){this._wheelZoomRate=s},mo.prototype.isEnabled=function(){return!!this._enabled},mo.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},mo.prototype.isZooming=function(){return!!this._zooming},mo.prototype.enable=function(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=s&&s.around==="center")},mo.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},mo.prototype.wheel=function(s){if(this.isEnabled()){var a=s.deltaMode===o.window.WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY,n=o.browser.now(),l=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,a!==0&&a%4.000244140625==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":l>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(l*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),s.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=s,this._delta-=a,this._active||this._start(s)),s.preventDefault()}},mo.prototype._onTimeout=function(s){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(s)},mo.prototype._start=function(s){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var a=D.mousePos(this._el,s);this._around=o.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(a)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},mo.prototype.renderFrame=function(){var s=this;if(this._frameId&&(this._frameId=null,this.isActive())){var a=this._map.transform;if(this._delta!==0){var n=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,l=2/(1+Math.exp(-Math.abs(this._delta*n)));this._delta<0&&l!==0&&(l=1/l);var b=typeof this._targetZoom=="number"?a.zoomScale(this._targetZoom):a.scale;this._targetZoom=Math.min(a.maxZoom,Math.max(a.minZoom,a.scaleZoom(b*l))),this._type==="wheel"&&(this._startZoom=a.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var O,R=typeof this._targetZoom=="number"?this._targetZoom:a.zoom,j=this._startZoom,ue=this._easing,Te=!1;if(this._type==="wheel"&&j&&ue){var Ye=Math.min((o.browser.now()-this._lastWheelEventTime)/200,1),qe=ue(Ye);O=o.number(j,R,qe),Ye<1?this._frameId||(this._frameId=!0):Te=!0}else O=R,Te=!0;return this._active=!0,Te&&(this._active=!1,this._finishTimeout=setTimeout(function(){s._zooming=!1,s._handler._triggerRenderFrame(),delete s._targetZoom,delete s._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Te,zoomDelta:O-a.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},mo.prototype._smoothOutEasing=function(s){var a=o.ease;if(this._prevEase){var n=this._prevEase,l=(o.browser.now()-n.start)/n.duration,b=n.easing(l+.01)-n.easing(l),O=.27/Math.sqrt(b*b+1e-4)*.01,R=Math.sqrt(.0729-O*O);a=o.bezier(O,R,.25,1)}return this._prevEase={start:o.browser.now(),duration:s,easing:a},a},mo.prototype.reset=function(){this._active=!1};var ll=function(a,n){this._clickZoom=a,this._tapZoom=n};ll.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},ll.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},ll.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},ll.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var gi=function(){this.reset()};gi.prototype.reset=function(){this._active=!1},gi.prototype.dblclick=function(s,a){return s.preventDefault(),{cameraAnimation:function(l){l.easeTo({duration:300,zoom:l.getZoom()+(s.shiftKey?-1:1),around:l.unproject(a)},{originalEvent:s})}}},gi.prototype.enable=function(){this._enabled=!0},gi.prototype.disable=function(){this._enabled=!1,this.reset()},gi.prototype.isEnabled=function(){return this._enabled},gi.prototype.isActive=function(){return this._active};var Ps=function(){this._tap=new Mu({numTouches:1,numTaps:1}),this.reset()};Ps.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Ps.prototype.touchstart=function(s,a,n){this._swipePoint||(this._tapTime&&s.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?n.length>0&&(this._swipePoint=a[0],this._swipeTouch=n[0].identifier):this._tap.touchstart(s,a,n))},Ps.prototype.touchmove=function(s,a,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;var l=a[0],b=l.y-this._swipePoint.y;return this._swipePoint=l,s.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(s,a,n)},Ps.prototype.touchend=function(s,a,n){this._tapTime?this._swipePoint&&n.length===0&&this.reset():this._tap.touchend(s,a,n)&&(this._tapTime=s.timeStamp)},Ps.prototype.touchcancel=function(){this.reset()},Ps.prototype.enable=function(){this._enabled=!0},Ps.prototype.disable=function(){this._enabled=!1,this.reset()},Ps.prototype.isEnabled=function(){return this._enabled},Ps.prototype.isActive=function(){return this._active};var cl=function(a,n,l){this._el=a,this._mousePan=n,this._touchPan=l};cl.prototype.enable=function(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},cl.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},cl.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},cl.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var au=function(a,n,l){this._pitchWithRotate=a.pitchWithRotate,this._mouseRotate=n,this._mousePitch=l};au.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},au.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},au.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},au.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var ko=function(a,n,l,b){this._el=a,this._touchZoom=n,this._touchRotate=l,this._tapDragZoom=b,this._rotationDisabled=!1,this._enabled=!0};ko.prototype.enable=function(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},ko.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},ko.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},ko.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},ko.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},ko.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var _l=function(a){return a.zoom||a.drag||a.pitch||a.rotate},Qn=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a}(o.Event);function ua(s){return s.panDelta&&s.panDelta.mag()||s.zoomDelta||s.bearingDelta||s.pitchDelta}var lo=function(a,n){this._map=a,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Wu(a),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(n),o.bindAll(["handleEvent","handleWindowEvent"],this);var l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[o.window.document,"mousemove",{capture:!0}],[o.window.document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[o.window,"blur",void 0]];for(var b=0,O=this._listeners;b<O.length;b+=1){var R=O[b],j=R[0];D.addEventListener(j,R[1],j===o.window.document?this.handleWindowEvent:this.handleEvent,R[2])}};lo.prototype.destroy=function(){for(var s=0,a=this._listeners;s<a.length;s+=1){var n=a[s],l=n[0];D.removeEventListener(l,n[1],l===o.window.document?this.handleWindowEvent:this.handleEvent,n[2])}},lo.prototype._addDefaultHandlers=function(s){var a=this._map,n=a.getCanvasContainer();this._add("mapEvent",new xn(a,s));var l=a.boxZoom=new nu(a,s);this._add("boxZoom",l);var b=new gu,O=new gi;a.doubleClickZoom=new ll(O,b),this._add("tapZoom",b),this._add("clickZoom",O);var R=new Ps;this._add("tapDragZoom",R);var j=a.touchPitch=new uf;this._add("touchPitch",j);var ue=new Wc(s),Te=new sl(s);a.dragRotate=new au(s,ue,Te),this._add("mouseRotate",ue,["mousePitch"]),this._add("mousePitch",Te,["mouseRotate"]);var Ye=new Hc(s),qe=new Pu(s);a.dragPan=new cl(n,Ye,qe),this._add("mousePan",Ye),this._add("touchPan",qe,["touchZoom","touchRotate"]);var tt=new ul,Dt=new js;a.touchZoomRotate=new ko(n,Dt,tt,R),this._add("touchRotate",tt,["touchPan","touchZoom"]),this._add("touchZoom",Dt,["touchPan","touchRotate"]);var Rt=a.scrollZoom=new mo(a,this);this._add("scrollZoom",Rt,["mousePan"]);var Wt=a.keyboard=new uo;this._add("keyboard",Wt),this._add("blockableMapEvent",new bs(a));for(var kt=0,zt=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];kt<zt.length;kt+=1){var nr=zt[kt];s.interactive&&s[nr]&&a[nr].enable(s[nr])}},lo.prototype._add=function(s,a,n){this._handlers.push({handlerName:s,handler:a,allowed:n}),this._handlersById[s]=a},lo.prototype.stop=function(s){if(!this._updatingCamera){for(var a=0,n=this._handlers;a<n.length;a+=1)n[a].handler.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[]}},lo.prototype.isActive=function(){for(var s=0,a=this._handlers;s<a.length;s+=1)if(a[s].handler.isActive())return!0;return!1},lo.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},lo.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},lo.prototype.isMoving=function(){return Boolean(_l(this._eventsInProgress))||this.isZooming()},lo.prototype._blockedByActive=function(s,a,n){for(var l in s)if(l!==n&&(!a||a.indexOf(l)<0))return!0;return!1},lo.prototype.handleWindowEvent=function(s){this.handleEvent(s,s.type+"Window")},lo.prototype._getMapTouches=function(s){for(var a=[],n=0,l=s;n<l.length;n+=1){var b=l[n];this._el.contains(b.target)&&a.push(b)}return a},lo.prototype.handleEvent=function(s,a){if(s.type!=="blur"){this._updatingCamera=!0;for(var n=s.type==="renderFrame"?void 0:s,l={needsRenderFrame:!1},b={},O={},R=s.touches?this._getMapTouches(s.touches):void 0,j=R?D.touchPos(this._el,R):D.mousePos(this._el,s),ue=0,Te=this._handlers;ue<Te.length;ue+=1){var Ye=Te[ue],qe=Ye.handlerName,tt=Ye.handler,Dt=Ye.allowed;if(tt.isEnabled()){var Rt=void 0;this._blockedByActive(O,Dt,qe)?tt.reset():tt[a||s.type]&&(Rt=tt[a||s.type](s,j,R),this.mergeHandlerResult(l,b,Rt,qe,n),Rt&&Rt.needsRenderFrame&&this._triggerRenderFrame()),(Rt||tt.isActive())&&(O[qe]=tt)}}var Wt={};for(var kt in this._previousActiveHandlers)O[kt]||(Wt[kt]=n);this._previousActiveHandlers=O,(Object.keys(Wt).length||ua(l))&&(this._changes.push([l,b,Wt]),this._triggerRenderFrame()),(Object.keys(O).length||ua(l))&&this._map._stop(!0),this._updatingCamera=!1;var zt=l.cameraAnimation;zt&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],zt(this._map))}else this.stop(!0)},lo.prototype.mergeHandlerResult=function(s,a,n,l,b){if(n){o.extend(s,n);var O={handlerName:l,originalEvent:n.originalEvent||b};n.zoomDelta!==void 0&&(a.zoom=O),n.panDelta!==void 0&&(a.drag=O),n.pitchDelta!==void 0&&(a.pitch=O),n.bearingDelta!==void 0&&(a.rotate=O)}},lo.prototype._applyChanges=function(){for(var s={},a={},n={},l=0,b=this._changes;l<b.length;l+=1){var O=b[l],R=O[0],j=O[1],ue=O[2];R.panDelta&&(s.panDelta=(s.panDelta||new o.Point(0,0))._add(R.panDelta)),R.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+R.zoomDelta),R.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+R.bearingDelta),R.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+R.pitchDelta),R.around!==void 0&&(s.around=R.around),R.pinchAround!==void 0&&(s.pinchAround=R.pinchAround),R.noInertia&&(s.noInertia=R.noInertia),o.extend(a,j),o.extend(n,ue)}this._updateMapTransform(s,a,n),this._changes=[]},lo.prototype._updateMapTransform=function(s,a,n){var l=this._map,b=l.transform;if(!ua(s))return this._fireEvents(a,n,!0);var O=s.panDelta,R=s.zoomDelta,j=s.bearingDelta,ue=s.pitchDelta,Te=s.around,Ye=s.pinchAround;Ye!==void 0&&(Te=Ye),l._stop(!0),Te=Te||l.transform.centerPoint;var qe=b.pointLocation(O?Te.sub(O):Te);j&&(b.bearing+=j),ue&&(b.pitch+=ue),R&&(b.zoom+=R),b.setLocationAtPoint(qe,Te),this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(a,n,!0)},lo.prototype._fireEvents=function(s,a,n){var l=this,b=_l(this._eventsInProgress),O=_l(s),R={};for(var j in s)this._eventsInProgress[j]||(R[j+"start"]=s[j].originalEvent),this._eventsInProgress[j]=s[j];for(var ue in!b&&O&&this._fireEvent("movestart",O.originalEvent),R)this._fireEvent(ue,R[ue]);for(var Te in O&&this._fireEvent("move",O.originalEvent),s)this._fireEvent(Te,s[Te].originalEvent);var Ye,qe={};for(var tt in this._eventsInProgress){var Dt=this._eventsInProgress[tt],Rt=Dt.handlerName,Wt=Dt.originalEvent;this._handlersById[Rt].isActive()||(delete this._eventsInProgress[tt],qe[tt+"end"]=Ye=a[Rt]||Wt)}for(var kt in qe)this._fireEvent(kt,qe[kt]);var zt=_l(this._eventsInProgress);if(n&&(b||O)&&!zt){this._updatingCamera=!0;var nr=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Jt=function(pr){return pr!==0&&-l._bearingSnap<pr&&pr<l._bearingSnap};nr?(Jt(nr.bearing||this._map.getBearing())&&(nr.bearing=0),this._map.easeTo(nr,{originalEvent:Ye})):(this._map.fire(new o.Event("moveend",{originalEvent:Ye})),Jt(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},lo.prototype._fireEvent=function(s,a){this._map.fire(new o.Event(s,a?{originalEvent:a}:{}))},lo.prototype._requestFrame=function(){var s=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(a){delete s._frameId,s.handleEvent(new Qn("renderFrame",{timeStamp:a})),s._applyChanges()})},lo.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var zl=function(s){function a(n,l){s.call(this),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=l.bearingSnap,o.bindAll(["_renderFrameCallback"],this)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getCenter=function(){return new o.LngLat(this.transform.center.lng,this.transform.center.lat)},a.prototype.setCenter=function(n,l){return this.jumpTo({center:n},l)},a.prototype.panBy=function(n,l,b){return n=o.Point.convert(n).mult(-1),this.panTo(this.transform.center,o.extend({offset:n},l),b)},a.prototype.panTo=function(n,l,b){return this.easeTo(o.extend({center:n},l),b)},a.prototype.getZoom=function(){return this.transform.zoom},a.prototype.setZoom=function(n,l){return this.jumpTo({zoom:n},l),this},a.prototype.zoomTo=function(n,l,b){return this.easeTo(o.extend({zoom:n},l),b)},a.prototype.zoomIn=function(n,l){return this.zoomTo(this.getZoom()+1,n,l),this},a.prototype.zoomOut=function(n,l){return this.zoomTo(this.getZoom()-1,n,l),this},a.prototype.getBearing=function(){return this.transform.bearing},a.prototype.setBearing=function(n,l){return this.jumpTo({bearing:n},l),this},a.prototype.getPadding=function(){return this.transform.padding},a.prototype.setPadding=function(n,l){return this.jumpTo({padding:n},l),this},a.prototype.rotateTo=function(n,l,b){return this.easeTo(o.extend({bearing:n},l),b)},a.prototype.resetNorth=function(n,l){return this.rotateTo(0,o.extend({duration:1e3},n),l),this},a.prototype.resetNorthPitch=function(n,l){return this.easeTo(o.extend({bearing:0,pitch:0,duration:1e3},n),l),this},a.prototype.snapToNorth=function(n,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,l):this},a.prototype.getPitch=function(){return this.transform.pitch},a.prototype.setPitch=function(n,l){return this.jumpTo({pitch:n},l),this},a.prototype.cameraForBounds=function(n,l){return n=o.LngLatBounds.convert(n),this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),0,l)},a.prototype._cameraForBoxAndBearing=function(n,l,b,O){var R={top:0,bottom:0,right:0,left:0};if(typeof(O=o.extend({padding:R,offset:[0,0],maxZoom:this.transform.maxZoom},O)).padding=="number"){var j=O.padding;O.padding={top:j,bottom:j,right:j,left:j}}O.padding=o.extend(R,O.padding);var ue=this.transform,Te=ue.padding,Ye=ue.project(o.LngLat.convert(n)),qe=ue.project(o.LngLat.convert(l)),tt=Ye.rotate(-b*Math.PI/180),Dt=qe.rotate(-b*Math.PI/180),Rt=new o.Point(Math.max(tt.x,Dt.x),Math.max(tt.y,Dt.y)),Wt=new o.Point(Math.min(tt.x,Dt.x),Math.min(tt.y,Dt.y)),kt=Rt.sub(Wt),zt=(ue.width-(Te.left+Te.right+O.padding.left+O.padding.right))/kt.x,nr=(ue.height-(Te.top+Te.bottom+O.padding.top+O.padding.bottom))/kt.y;if(!(nr<0||zt<0)){var Jt=Math.min(ue.scaleZoom(ue.scale*Math.min(zt,nr)),O.maxZoom),Cr=o.Point.convert(O.offset),pr=new o.Point(Cr.x+(O.padding.left-O.padding.right)/2,Cr.y+(O.padding.top-O.padding.bottom)/2).mult(ue.scale/ue.zoomScale(Jt));return{center:ue.unproject(Ye.add(qe).div(2).sub(pr)),zoom:Jt,bearing:b}}o.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},a.prototype.fitBounds=function(n,l,b){return this._fitInternal(this.cameraForBounds(n,l),l,b)},a.prototype.fitScreenCoordinates=function(n,l,b,O,R){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(o.Point.convert(n)),this.transform.pointLocation(o.Point.convert(l)),b,O),O,R)},a.prototype._fitInternal=function(n,l,b){return n?(delete(l=o.extend(n,l)).padding,l.linear?this.easeTo(l,b):this.flyTo(l,b)):this},a.prototype.jumpTo=function(n,l){this.stop();var b=this.transform,O=!1,R=!1,j=!1;return"zoom"in n&&b.zoom!==+n.zoom&&(O=!0,b.zoom=+n.zoom),n.center!==void 0&&(b.center=o.LngLat.convert(n.center)),"bearing"in n&&b.bearing!==+n.bearing&&(R=!0,b.bearing=+n.bearing),"pitch"in n&&b.pitch!==+n.pitch&&(j=!0,b.pitch=+n.pitch),n.padding==null||b.isPaddingEqual(n.padding)||(b.padding=n.padding),this.fire(new o.Event("movestart",l)).fire(new o.Event("move",l)),O&&this.fire(new o.Event("zoomstart",l)).fire(new o.Event("zoom",l)).fire(new o.Event("zoomend",l)),R&&this.fire(new o.Event("rotatestart",l)).fire(new o.Event("rotate",l)).fire(new o.Event("rotateend",l)),j&&this.fire(new o.Event("pitchstart",l)).fire(new o.Event("pitch",l)).fire(new o.Event("pitchend",l)),this.fire(new o.Event("moveend",l))},a.prototype.easeTo=function(n,l){var b=this;this._stop(!1,n.easeId),((n=o.extend({offset:[0,0],duration:500,easing:o.ease},n)).animate===!1||!n.essential&&o.browser.prefersReducedMotion)&&(n.duration=0);var O=this.transform,R=this.getZoom(),j=this.getBearing(),ue=this.getPitch(),Te=this.getPadding(),Ye="zoom"in n?+n.zoom:R,qe="bearing"in n?this._normalizeBearing(n.bearing,j):j,tt="pitch"in n?+n.pitch:ue,Dt="padding"in n?n.padding:O.padding,Rt=o.Point.convert(n.offset),Wt=O.centerPoint.add(Rt),kt=O.pointLocation(Wt),zt=o.LngLat.convert(n.center||kt);this._normalizeCenter(zt);var nr,Jt,Cr=O.project(kt),pr=O.project(zt).sub(Cr),_r=O.zoomScale(Ye-R);n.around&&(nr=o.LngLat.convert(n.around),Jt=O.locationPoint(nr));var wr={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Ye!==R,this._rotating=this._rotating||j!==qe,this._pitching=this._pitching||tt!==ue,this._padding=!O.isPaddingEqual(Dt),this._easeId=n.easeId,this._prepareEase(l,n.noMoveStart,wr),this._ease(function(Hr){if(b._zooming&&(O.zoom=o.number(R,Ye,Hr)),b._rotating&&(O.bearing=o.number(j,qe,Hr)),b._pitching&&(O.pitch=o.number(ue,tt,Hr)),b._padding&&(O.interpolatePadding(Te,Dt,Hr),Wt=O.centerPoint.add(Rt)),nr)O.setLocationAtPoint(nr,Jt);else{var Yr=O.zoomScale(O.zoom-R),un=Ye>R?Math.min(2,_r):Math.max(.5,_r),_n=Math.pow(un,1-Hr),ia=O.unproject(Cr.add(pr.mult(Hr*_n)).mult(Yr));O.setLocationAtPoint(O.renderWorldCopies?ia.wrap():ia,Wt)}b._fireMoveEvents(l)},function(Hr){b._afterEase(l,Hr)},n),this},a.prototype._prepareEase=function(n,l,b){b===void 0&&(b={}),this._moving=!0,l||b.moving||this.fire(new o.Event("movestart",n)),this._zooming&&!b.zooming&&this.fire(new o.Event("zoomstart",n)),this._rotating&&!b.rotating&&this.fire(new o.Event("rotatestart",n)),this._pitching&&!b.pitching&&this.fire(new o.Event("pitchstart",n))},a.prototype._fireMoveEvents=function(n){this.fire(new o.Event("move",n)),this._zooming&&this.fire(new o.Event("zoom",n)),this._rotating&&this.fire(new o.Event("rotate",n)),this._pitching&&this.fire(new o.Event("pitch",n))},a.prototype._afterEase=function(n,l){if(!this._easeId||!l||this._easeId!==l){delete this._easeId;var b=this._zooming,O=this._rotating,R=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,b&&this.fire(new o.Event("zoomend",n)),O&&this.fire(new o.Event("rotateend",n)),R&&this.fire(new o.Event("pitchend",n)),this.fire(new o.Event("moveend",n))}},a.prototype.flyTo=function(n,l){var b=this;if(!n.essential&&o.browser.prefersReducedMotion){var O=o.pick(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(O,l)}this.stop(),n=o.extend({offset:[0,0],speed:1.2,curve:1.42,easing:o.ease},n);var R=this.transform,j=this.getZoom(),ue=this.getBearing(),Te=this.getPitch(),Ye=this.getPadding(),qe="zoom"in n?o.clamp(+n.zoom,R.minZoom,R.maxZoom):j,tt="bearing"in n?this._normalizeBearing(n.bearing,ue):ue,Dt="pitch"in n?+n.pitch:Te,Rt="padding"in n?n.padding:R.padding,Wt=R.zoomScale(qe-j),kt=o.Point.convert(n.offset),zt=R.centerPoint.add(kt),nr=R.pointLocation(zt),Jt=o.LngLat.convert(n.center||nr);this._normalizeCenter(Jt);var Cr=R.project(nr),pr=R.project(Jt).sub(Cr),_r=n.curve,wr=Math.max(R.width,R.height),Hr=wr/Wt,Yr=pr.mag();if("minZoom"in n){var un=o.clamp(Math.min(n.minZoom,j,qe),R.minZoom,R.maxZoom),_n=wr/R.zoomScale(un-j);_r=Math.sqrt(_n/Yr*2)}var ia=_r*_r;function pa(qn){var wa=(Hr*Hr-wr*wr+(qn?-1:1)*ia*ia*Yr*Yr)/(2*(qn?Hr:wr)*ia*Yr);return Math.log(Math.sqrt(wa*wa+1)-wa)}function ya(qn){return(Math.exp(qn)-Math.exp(-qn))/2}function Pa(qn){return(Math.exp(qn)+Math.exp(-qn))/2}var Pn=pa(0),ga=function(wa){return Pa(Pn)/Pa(Pn+_r*wa)},aa=function(wa){return wr*((Pa(Pn)*(ya(Ja=Pn+_r*wa)/Pa(Ja))-ya(Pn))/ia)/Yr;var Ja},zn=(pa(1)-Pn)/_r;if(Math.abs(Yr)<1e-6||!isFinite(zn)){if(Math.abs(wr-Hr)<1e-6)return this.easeTo(n,l);var Ca=Hr<wr?-1:1;zn=Math.abs(Math.log(Hr/wr))/_r,aa=function(){return 0},ga=function(wa){return Math.exp(Ca*_r*wa)}}return n.duration="duration"in n?+n.duration:1e3*zn/("screenSpeed"in n?+n.screenSpeed/_r:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=ue!==tt,this._pitching=Dt!==Te,this._padding=!R.isPaddingEqual(Rt),this._prepareEase(l,!1),this._ease(function(qn){var wa=qn*zn,Ja=1/ga(wa);R.zoom=qn===1?qe:j+R.scaleZoom(Ja),b._rotating&&(R.bearing=o.number(ue,tt,qn)),b._pitching&&(R.pitch=o.number(Te,Dt,qn)),b._padding&&(R.interpolatePadding(Ye,Rt,qn),zt=R.centerPoint.add(kt));var co=qn===1?Jt:R.unproject(Cr.add(pr.mult(aa(wa))).mult(Ja));R.setLocationAtPoint(R.renderWorldCopies?co.wrap():co,zt),b._fireMoveEvents(l)},function(){return b._afterEase(l)},n),this},a.prototype.isEasing=function(){return!!this._easeFrameId},a.prototype.stop=function(){return this._stop()},a.prototype._stop=function(n,l){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var b=this._onEaseEnd;delete this._onEaseEnd,b.call(this,l)}if(!n){var O=this.handlers;O&&O.stop(!1)}return this},a.prototype._ease=function(n,l,b){b.animate===!1||b.duration===0?(n(1),l()):(this._easeStart=o.browser.now(),this._easeOptions=b,this._onEaseFrame=n,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},a.prototype._renderFrameCallback=function(){var n=Math.min((o.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},a.prototype._normalizeBearing=function(n,l){n=o.wrap(n,-180,180);var b=Math.abs(n-l);return Math.abs(n-360-l)<b&&(n-=360),Math.abs(n+360-l)<b&&(n+=360),n},a.prototype._normalizeCenter=function(n){var l=this.transform;if(l.renderWorldCopies&&!l.lngRange){var b=n.lng-l.center.lng;n.lng+=b>180?-360:b<-180?360:0}},a}(o.Evented),zs=function(a){a===void 0&&(a={}),this.options=a,o.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};zs.prototype.getDefaultPosition=function(){return"bottom-right"},zs.prototype.onAdd=function(s){var a=this.options&&this.options.compact;return this._map=s,this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=D.create("div","mapboxgl-ctrl-attrib-inner",this._container),a&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),a===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},zs.prototype.onRemove=function(){D.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},zs.prototype._updateEditLink=function(){var s=this._editLink;s||(s=this._editLink=this._container.querySelector(".mapbox-improve-map"));var a=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.config.ACCESS_TOKEN}];if(s){var n=a.reduce(function(l,b,O){return b.value&&(l+=b.key+"="+b.value+(O<a.length-1?"&":"")),l},"?");s.href=o.config.FEEDBACK_URL+"/"+n+(this._map._hash?this._map._hash.getHashString(!0):""),s.rel="noopener nofollow"}},zs.prototype._updateData=function(s){!s||s.sourceDataType!=="metadata"&&s.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},zs.prototype._updateAttributions=function(){if(this._map.style){var s=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=s.concat(this.options.customAttribution.map(function(j){return typeof j!="string"?"":j})):typeof this.options.customAttribution=="string"&&s.push(this.options.customAttribution)),this._map.style.stylesheet){var a=this._map.style.stylesheet;this.styleOwner=a.owner,this.styleId=a.id}var n=this._map.style.sourceCaches;for(var l in n){var b=n[l];if(b.used){var O=b.getSource();O.attribution&&s.indexOf(O.attribution)<0&&s.push(O.attribution)}}s.sort(function(j,ue){return j.length-ue.length});var R=(s=s.filter(function(j,ue){for(var Te=ue+1;Te<s.length;Te++)if(s[Te].indexOf(j)>=0)return!1;return!0})).join(" | ");R!==this._attribHTML&&(this._attribHTML=R,s.length?(this._innerContainer.innerHTML=R,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},zs.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var Di=function(){o.bindAll(["_updateLogo"],this),o.bindAll(["_updateCompact"],this)};Di.prototype.onAdd=function(s){this._map=s,this._container=D.create("div","mapboxgl-ctrl");var a=D.create("a","mapboxgl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://www.mapbox.com/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Di.prototype.onRemove=function(){D.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Di.prototype.getDefaultPosition=function(){return"bottom-left"},Di.prototype._updateLogo=function(s){s&&s.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},Di.prototype._logoRequired=function(){if(this._map.style){var s=this._map.style.sourceCaches;for(var a in s)if(s[a].getSource().mapbox_logo)return!0;return!1}},Di.prototype._updateCompact=function(){var s=this._container.children;if(s.length){var a=s[0];this._map.getCanvasContainer().offsetWidth<250?a.classList.add("mapboxgl-compact"):a.classList.remove("mapboxgl-compact")}};var is=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};is.prototype.add=function(s){var a=++this._id;return this._queue.push({callback:s,id:a,cancelled:!1}),a},is.prototype.remove=function(s){for(var a=this._currentlyRunning,n=0,l=a?this._queue.concat(a):this._queue;n<l.length;n+=1){var b=l[n];if(b.id===s)return void(b.cancelled=!0)}},is.prototype.run=function(s){s===void 0&&(s=0);var a=this._currentlyRunning=this._queue;this._queue=[];for(var n=0,l=a;n<l.length;n+=1){var b=l[n];if(!b.cancelled&&(b.callback(s),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},is.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Zc={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Fs=o.window.HTMLImageElement,_i=o.window.HTMLElement,Si=o.window.ImageBitmap,Xu={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},yu=function(s){function a(l){var b=this;if((l=o.extend({},Xu,l)).minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var O=new ei(l.minZoom,l.maxZoom,l.minPitch,l.maxPitch,l.renderWorldCopies);if(s.call(this,O,l),this._interactive=l.interactive,this._maxTileCacheSize=l.maxTileCacheSize,this._failIfMajorPerformanceCaveat=l.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=l.preserveDrawingBuffer,this._antialias=l.antialias,this._trackResize=l.trackResize,this._bearingSnap=l.bearingSnap,this._refreshExpiredTiles=l.refreshExpiredTiles,this._fadeDuration=l.fadeDuration,this._crossSourceCollisions=l.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=l.collectResourceTiming,this._renderTaskQueue=new is,this._controls=[],this._mapId=o.uniqueId(),this._locale=o.extend({},Zc,l.locale),this._requestManager=new o.RequestManager(l.transformRequest,l.accessToken),typeof l.container=="string"){if(this._container=o.window.document.getElementById(l.container),!this._container)throw new Error("Container '"+l.container+"' not found.")}else{if(!(l.container instanceof _i))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(l.maxBounds&&this.setMaxBounds(l.maxBounds),o.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return b._update(!1)}),this.on("moveend",function(){return b._update(!1)}),this.on("zoom",function(){return b._update(!0)}),o.window!==void 0&&(o.window.addEventListener("online",this._onWindowOnline,!1),o.window.addEventListener("resize",this._onWindowResize,!1),o.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new lo(this,l),this._hash=l.hash&&new Hu(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,o.extend({},l.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=l.localIdeographFontFamily,l.style&&this.setStyle(l.style,{localIdeographFontFamily:l.localIdeographFontFamily}),l.attributionControl&&this.addControl(new zs({customAttribution:l.customAttribution})),this.addControl(new Di,l.logoPosition),this.on("style.load",function(){b.transform.unmodified&&b.jumpTo(b.style.stylesheet)}),this.on("data",function(R){b._update(R.dataType==="style"),b.fire(new o.Event(R.dataType+"data",R))}),this.on("dataloading",function(R){b.fire(new o.Event(R.dataType+"dataloading",R))})}s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a;var n={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return a.prototype._getMapId=function(){return this._mapId},a.prototype.addControl=function(l,b){if(b===void 0&&l.getDefaultPosition&&(b=l.getDefaultPosition()),b===void 0&&(b="top-right"),!l||!l.onAdd)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var O=l.onAdd(this);this._controls.push(l);var R=this._controlPositions[b];return b.indexOf("bottom")!==-1?R.insertBefore(O,R.firstChild):R.appendChild(O),this},a.prototype.removeControl=function(l){if(!l||!l.onRemove)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var b=this._controls.indexOf(l);return b>-1&&this._controls.splice(b,1),l.onRemove(this),this},a.prototype.resize=function(l){var b=this._containerDimensions(),O=b[0],R=b[1];this._resizeCanvas(O,R),this.transform.resize(O,R),this.painter.resize(O,R);var j=!this._moving;return j&&(this.stop(),this.fire(new o.Event("movestart",l)).fire(new o.Event("move",l))),this.fire(new o.Event("resize",l)),j&&this.fire(new o.Event("moveend",l)),this},a.prototype.getBounds=function(){return this.transform.getBounds()},a.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},a.prototype.setMaxBounds=function(l){return this.transform.setMaxBounds(o.LngLatBounds.convert(l)),this._update()},a.prototype.setMinZoom=function(l){if((l=l==null?-2:l)>=-2&&l<=this.transform.maxZoom)return this.transform.minZoom=l,this._update(),this.getZoom()<l&&this.setZoom(l),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},a.prototype.getMinZoom=function(){return this.transform.minZoom},a.prototype.setMaxZoom=function(l){if((l=l==null?22:l)>=this.transform.minZoom)return this.transform.maxZoom=l,this._update(),this.getZoom()>l&&this.setZoom(l),this;throw new Error("maxZoom must be greater than the current minZoom")},a.prototype.getMaxZoom=function(){return this.transform.maxZoom},a.prototype.setMinPitch=function(l){if((l=l==null?0:l)<0)throw new Error("minPitch must be greater than or equal to 0");if(l>=0&&l<=this.transform.maxPitch)return this.transform.minPitch=l,this._update(),this.getPitch()<l&&this.setPitch(l),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},a.prototype.getMinPitch=function(){return this.transform.minPitch},a.prototype.setMaxPitch=function(l){if((l=l==null?60:l)>60)throw new Error("maxPitch must be less than or equal to 60");if(l>=this.transform.minPitch)return this.transform.maxPitch=l,this._update(),this.getPitch()>l&&this.setPitch(l),this;throw new Error("maxPitch must be greater than the current minPitch")},a.prototype.getMaxPitch=function(){return this.transform.maxPitch},a.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},a.prototype.setRenderWorldCopies=function(l){return this.transform.renderWorldCopies=l,this._update()},a.prototype.project=function(l){return this.transform.locationPoint(o.LngLat.convert(l))},a.prototype.unproject=function(l){return this.transform.pointLocation(o.Point.convert(l))},a.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},a.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},a.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},a.prototype._createDelegatedListener=function(l,b,O){var R,j=this;if(l==="mouseenter"||l==="mouseover"){var ue=!1;return{layer:b,listener:O,delegates:{mousemove:function(qe){var tt=j.getLayer(b)?j.queryRenderedFeatures(qe.point,{layers:[b]}):[];tt.length?ue||(ue=!0,O.call(j,new ys(l,j,qe.originalEvent,{features:tt}))):ue=!1},mouseout:function(){ue=!1}}}}if(l==="mouseleave"||l==="mouseout"){var Te=!1;return{layer:b,listener:O,delegates:{mousemove:function(qe){(j.getLayer(b)?j.queryRenderedFeatures(qe.point,{layers:[b]}):[]).length?Te=!0:Te&&(Te=!1,O.call(j,new ys(l,j,qe.originalEvent)))},mouseout:function(qe){Te&&(Te=!1,O.call(j,new ys(l,j,qe.originalEvent)))}}}}return{layer:b,listener:O,delegates:(R={},R[l]=function(Ye){var qe=j.getLayer(b)?j.queryRenderedFeatures(Ye.point,{layers:[b]}):[];qe.length&&(Ye.features=qe,O.call(j,Ye),delete Ye.features)},R)}},a.prototype.on=function(l,b,O){if(O===void 0)return s.prototype.on.call(this,l,b);var R=this._createDelegatedListener(l,b,O);for(var j in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[l]=this._delegatedListeners[l]||[],this._delegatedListeners[l].push(R),R.delegates)this.on(j,R.delegates[j]);return this},a.prototype.once=function(l,b,O){if(O===void 0)return s.prototype.once.call(this,l,b);var R=this._createDelegatedListener(l,b,O);for(var j in R.delegates)this.once(j,R.delegates[j]);return this},a.prototype.off=function(l,b,O){var R=this;return O===void 0?s.prototype.off.call(this,l,b):(this._delegatedListeners&&this._delegatedListeners[l]&&function(j){for(var ue=j[l],Te=0;Te<ue.length;Te++){var Ye=ue[Te];if(Ye.layer===b&&Ye.listener===O){for(var qe in Ye.delegates)R.off(qe,Ye.delegates[qe]);return ue.splice(Te,1),R}}}(this._delegatedListeners),this)},a.prototype.queryRenderedFeatures=function(l,b){if(!this.style)return[];var O;if(b!==void 0||l===void 0||l instanceof o.Point||Array.isArray(l)||(b=l,l=void 0),b=b||{},(l=l||[[0,0],[this.transform.width,this.transform.height]])instanceof o.Point||typeof l[0]=="number")O=[o.Point.convert(l)];else{var R=o.Point.convert(l[0]),j=o.Point.convert(l[1]);O=[R,new o.Point(j.x,R.y),j,new o.Point(R.x,j.y),R]}return this.style.queryRenderedFeatures(O,b,this.transform)},a.prototype.querySourceFeatures=function(l,b){return this.style.querySourceFeatures(l,b)},a.prototype.setStyle=function(l,b){return(b=o.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},b)).diff!==!1&&b.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&l?(this._diffStyle(l,b),this):(this._localIdeographFontFamily=b.localIdeographFontFamily,this._updateStyle(l,b))},a.prototype._getUIString=function(l){var b=this._locale[l];if(b==null)throw new Error("Missing UI string '"+l+"'");return b},a.prototype._updateStyle=function(l,b){return this.style&&(this.style.setEventedParent(null),this.style._remove()),l?(this.style=new ka(this,b||{}),this.style.setEventedParent(this,{style:this.style}),typeof l=="string"?this.style.loadURL(l):this.style.loadJSON(l),this):(delete this.style,this)},a.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new ka(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},a.prototype._diffStyle=function(l,b){var O=this;if(typeof l=="string"){var R=this._requestManager.normalizeStyleURL(l),j=this._requestManager.transformRequest(R,o.ResourceType.Style);o.getJSON(j,function(ue,Te){ue?O.fire(new o.ErrorEvent(ue)):Te&&O._updateDiff(Te,b)})}else typeof l=="object"&&this._updateDiff(l,b)},a.prototype._updateDiff=function(l,b){try{this.style.setState(l)&&this._update(!0)}catch(O){o.warnOnce("Unable to perform style diff: "+(O.message||O.error||O)+".  Rebuilding the style from scratch."),this._updateStyle(l,b)}},a.prototype.getStyle=function(){if(this.style)return this.style.serialize()},a.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():o.warnOnce("There is no style added to the map.")},a.prototype.addSource=function(l,b){return this._lazyInitEmptyStyle(),this.style.addSource(l,b),this._update(!0)},a.prototype.isSourceLoaded=function(l){var b=this.style&&this.style.sourceCaches[l];if(b!==void 0)return b.loaded();this.fire(new o.ErrorEvent(new Error("There is no source with ID '"+l+"'")))},a.prototype.areTilesLoaded=function(){var l=this.style&&this.style.sourceCaches;for(var b in l){var O=l[b]._tiles;for(var R in O){var j=O[R];if(j.state!=="loaded"&&j.state!=="errored")return!1}}return!0},a.prototype.addSourceType=function(l,b,O){return this._lazyInitEmptyStyle(),this.style.addSourceType(l,b,O)},a.prototype.removeSource=function(l){return this.style.removeSource(l),this._update(!0)},a.prototype.getSource=function(l){return this.style.getSource(l)},a.prototype.addImage=function(l,b,O){O===void 0&&(O={});var R=O.pixelRatio;R===void 0&&(R=1);var j=O.sdf;j===void 0&&(j=!1);var ue=O.stretchX,Te=O.stretchY,Ye=O.content;if(this._lazyInitEmptyStyle(),b instanceof Fs||Si&&b instanceof Si){var qe=o.browser.getImageData(b);this.style.addImage(l,{data:new o.RGBAImage({width:qe.width,height:qe.height},qe.data),pixelRatio:R,stretchX:ue,stretchY:Te,content:Ye,sdf:j,version:0})}else{if(b.width===void 0||b.height===void 0)return this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var tt=b;this.style.addImage(l,{data:new o.RGBAImage({width:b.width,height:b.height},new Uint8Array(b.data)),pixelRatio:R,stretchX:ue,stretchY:Te,content:Ye,sdf:j,version:0,userImage:tt}),tt.onAdd&&tt.onAdd(this,l)}},a.prototype.updateImage=function(l,b){var O=this.style.getImage(l);if(!O)return this.fire(new o.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var R=b instanceof Fs||Si&&b instanceof Si?o.browser.getImageData(b):b,j=R.width,ue=R.height,Te=R.data;return j===void 0||ue===void 0?this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):j!==O.data.width||ue!==O.data.height?this.fire(new o.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(O.data.replace(Te,!(b instanceof Fs||Si&&b instanceof Si)),void this.style.updateImage(l,O))},a.prototype.hasImage=function(l){return l?!!this.style.getImage(l):(this.fire(new o.ErrorEvent(new Error("Missing required image id"))),!1)},a.prototype.removeImage=function(l){this.style.removeImage(l)},a.prototype.loadImage=function(l,b){o.getImage(this._requestManager.transformRequest(l,o.ResourceType.Image),b)},a.prototype.listImages=function(){return this.style.listImages()},a.prototype.addLayer=function(l,b){return this._lazyInitEmptyStyle(),this.style.addLayer(l,b),this._update(!0)},a.prototype.moveLayer=function(l,b){return this.style.moveLayer(l,b),this._update(!0)},a.prototype.removeLayer=function(l){return this.style.removeLayer(l),this._update(!0)},a.prototype.getLayer=function(l){return this.style.getLayer(l)},a.prototype.setLayerZoomRange=function(l,b,O){return this.style.setLayerZoomRange(l,b,O),this._update(!0)},a.prototype.setFilter=function(l,b,O){return O===void 0&&(O={}),this.style.setFilter(l,b,O),this._update(!0)},a.prototype.getFilter=function(l){return this.style.getFilter(l)},a.prototype.setPaintProperty=function(l,b,O,R){return R===void 0&&(R={}),this.style.setPaintProperty(l,b,O,R),this._update(!0)},a.prototype.getPaintProperty=function(l,b){return this.style.getPaintProperty(l,b)},a.prototype.setLayoutProperty=function(l,b,O,R){return R===void 0&&(R={}),this.style.setLayoutProperty(l,b,O,R),this._update(!0)},a.prototype.getLayoutProperty=function(l,b){return this.style.getLayoutProperty(l,b)},a.prototype.setLight=function(l,b){return b===void 0&&(b={}),this._lazyInitEmptyStyle(),this.style.setLight(l,b),this._update(!0)},a.prototype.getLight=function(){return this.style.getLight()},a.prototype.setFeatureState=function(l,b){return this.style.setFeatureState(l,b),this._update()},a.prototype.removeFeatureState=function(l,b){return this.style.removeFeatureState(l,b),this._update()},a.prototype.getFeatureState=function(l){return this.style.getFeatureState(l)},a.prototype.getContainer=function(){return this._container},a.prototype.getCanvasContainer=function(){return this._canvasContainer},a.prototype.getCanvas=function(){return this._canvas},a.prototype._containerDimensions=function(){var l=0,b=0;return this._container&&(l=this._container.clientWidth||400,b=this._container.clientHeight||300),[l,b]},a.prototype._detectMissingCSS=function(){o.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},a.prototype._setupContainer=function(){var l=this._container;l.classList.add("mapboxgl-map"),(this._missingCSSCanary=D.create("div","mapboxgl-canary",l)).style.visibility="hidden",this._detectMissingCSS();var b=this._canvasContainer=D.create("div","mapboxgl-canvas-container",l);this._interactive&&b.classList.add("mapboxgl-interactive"),this._canvas=D.create("canvas","mapboxgl-canvas",b),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var O=this._containerDimensions();this._resizeCanvas(O[0],O[1]);var R=this._controlContainer=D.create("div","mapboxgl-control-container",l),j=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(ue){j[ue]=D.create("div","mapboxgl-ctrl-"+ue,R)})},a.prototype._resizeCanvas=function(l,b){var O=o.browser.devicePixelRatio||1;this._canvas.width=O*l,this._canvas.height=O*b,this._canvas.style.width=l+"px",this._canvas.style.height=b+"px"},a.prototype._setupPainter=function(){var l=o.extend({},Z.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),b=this._canvas.getContext("webgl",l)||this._canvas.getContext("experimental-webgl",l);b?(this.painter=new Bi(b,this.transform),o.webpSupported.testSupport(b)):this.fire(new o.ErrorEvent(new Error("Failed to initialize WebGL")))},a.prototype._contextLost=function(l){l.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.Event("webglcontextlost",{originalEvent:l}))},a.prototype._contextRestored=function(l){this._setupPainter(),this.resize(),this._update(),this.fire(new o.Event("webglcontextrestored",{originalEvent:l}))},a.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},a.prototype._update=function(l){return this.style?(this._styleDirty=this._styleDirty||l,this._sourcesDirty=!0,this.triggerRepaint(),this):this},a.prototype._requestRenderFrame=function(l){return this._update(),this._renderTaskQueue.add(l)},a.prototype._cancelRenderFrame=function(l){this._renderTaskQueue.remove(l)},a.prototype._render=function(l){var b,O=this,R=0,j=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(b=j.createQueryEXT(),j.beginQueryEXT(j.TIME_ELAPSED_EXT,b),R=o.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(l),!this._removed){var ue=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var Te=this.transform.zoom,Ye=o.browser.now();this.style.zoomHistory.update(Te,Ye);var qe=new o.EvaluationParameters(Te,{now:Ye,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),tt=qe.crossFadingFactor();tt===1&&tt===this._crossFadingFactor||(ue=!0,this._crossFadingFactor=tt),this.style.update(qe)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new o.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new o.Event("load"))),this.style&&(this.style.hasTransitions()||ue)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Dt=o.browser.now()-R;j.endQueryEXT(j.TIME_ELAPSED_EXT,b),setTimeout(function(){var kt=j.getQueryObjectEXT(b,j.QUERY_RESULT_EXT)/1e6;j.deleteQueryEXT(b),O.fire(new o.Event("gpu-timing-frame",{cpuTime:Dt,gpuTime:kt}))},50)}if(this.listens("gpu-timing-layer")){var Rt=this.painter.collectGpuTimers();setTimeout(function(){var kt=O.painter.queryGpuTimers(Rt);O.fire(new o.Event("gpu-timing-layer",{layerTimes:kt}))},50)}var Wt=this._sourcesDirty||this._styleDirty||this._placementDirty;return Wt||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.Event("idle")),!this._loaded||this._fullyLoaded||Wt||(this._fullyLoaded=!0),this}},a.prototype.remove=function(){this._hash&&this._hash.remove();for(var l=0,b=this._controls;l<b.length;l+=1)b[l].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),o.window!==void 0&&(o.window.removeEventListener("resize",this._onWindowResize,!1),o.window.removeEventListener("orientationchange",this._onWindowResize,!1),o.window.removeEventListener("online",this._onWindowOnline,!1));var O=this.painter.context.gl.getExtension("WEBGL_lose_context");O&&O.loseContext(),Fl(this._canvasContainer),Fl(this._controlContainer),Fl(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new o.Event("remove"))},a.prototype.triggerRepaint=function(){var l=this;this.style&&!this._frame&&(this._frame=o.browser.frame(function(b){l._frame=null,l._render(b)}))},a.prototype._onWindowOnline=function(){this._update()},a.prototype._onWindowResize=function(l){this._trackResize&&this.resize({originalEvent:l})._update()},n.showTileBoundaries.get=function(){return!!this._showTileBoundaries},n.showTileBoundaries.set=function(l){this._showTileBoundaries!==l&&(this._showTileBoundaries=l,this._update())},n.showPadding.get=function(){return!!this._showPadding},n.showPadding.set=function(l){this._showPadding!==l&&(this._showPadding=l,this._update())},n.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},n.showCollisionBoxes.set=function(l){this._showCollisionBoxes!==l&&(this._showCollisionBoxes=l,l?this.style._generateCollisionBoxes():this._update())},n.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},n.showOverdrawInspector.set=function(l){this._showOverdrawInspector!==l&&(this._showOverdrawInspector=l,this._update())},n.repaint.get=function(){return!!this._repaint},n.repaint.set=function(l){this._repaint!==l&&(this._repaint=l,this.triggerRepaint())},n.vertices.get=function(){return!!this._vertices},n.vertices.set=function(l){this._vertices=l,this._update()},a.prototype._setCacheLimits=function(l,b){o.setCacheLimits(l,b)},n.version.get=function(){return o.version},Object.defineProperties(a.prototype,n),a}(zl);function Fl(s){s.parentNode&&s.parentNode.removeChild(s)}var lc={showCompass:!0,showZoom:!0,visualizePitch:!1},Lu=function(a){var n=this;this.options=o.extend({},lc,a),this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(l){return l.preventDefault()}),this.options.showZoom&&(o.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(l){return n._map.zoomIn({},{originalEvent:l})}),D.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(l){return n._map.zoomOut({},{originalEvent:l})}),D.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(o.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(l){n.options.visualizePitch?n._map.resetNorthPitch({},{originalEvent:l}):n._map.resetNorth({},{originalEvent:l})}),this._compassIcon=D.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Lu.prototype._updateZoomButtons=function(){var s=this._map.getZoom();this._zoomInButton.disabled=s===this._map.getMaxZoom(),this._zoomOutButton.disabled=s===this._map.getMinZoom()},Lu.prototype._rotateCompassArrow=function(){var s=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=s},Lu.prototype.onAdd=function(s){return this._map=s,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new os(this._map,this._compass,this.options.visualizePitch)),this._container},Lu.prototype.onRemove=function(){D.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Lu.prototype._createButton=function(s,a){var n=D.create("button",s,this._container);return n.type="button",n.addEventListener("click",a),n},Lu.prototype._setButtonTitle=function(s,a){var n=this._map._getUIString("NavigationControl."+a);s.title=n,s.setAttribute("aria-label",n)};var os=function(a,n,l){l===void 0&&(l=!1),this._clickTolerance=10,this.element=n,this.mouseRotate=new Wc({clickTolerance:a.dragRotate._mouseRotate._clickTolerance}),this.map=a,l&&(this.mousePitch=new sl({clickTolerance:a.dragRotate._mousePitch._clickTolerance})),o.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),D.addEventListener(n,"mousedown",this.mousedown),D.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),D.addEventListener(n,"touchmove",this.touchmove),D.addEventListener(n,"touchend",this.touchend),D.addEventListener(n,"touchcancel",this.reset)};function Yu(s,a,n){if(s=new o.LngLat(s.lng,s.lat),a){var l=new o.LngLat(s.lng-360,s.lat),b=new o.LngLat(s.lng+360,s.lat),O=n.locationPoint(s).distSqr(a);n.locationPoint(l).distSqr(a)<O?s=l:n.locationPoint(b).distSqr(a)<O&&(s=b)}for(;Math.abs(s.lng-n.center.lng)>180;){var R=n.locationPoint(s);if(R.x>=0&&R.y>=0&&R.x<=n.width&&R.y<=n.height)break;s.lng>n.center.lng?s.lng-=360:s.lng+=360}return s}os.prototype.down=function(s,a){this.mouseRotate.mousedown(s,a),this.mousePitch&&this.mousePitch.mousedown(s,a),D.disableDrag()},os.prototype.move=function(s,a){var n=this.map,l=this.mouseRotate.mousemoveWindow(s,a);if(l&&l.bearingDelta&&n.setBearing(n.getBearing()+l.bearingDelta),this.mousePitch){var b=this.mousePitch.mousemoveWindow(s,a);b&&b.pitchDelta&&n.setPitch(n.getPitch()+b.pitchDelta)}},os.prototype.off=function(){var s=this.element;D.removeEventListener(s,"mousedown",this.mousedown),D.removeEventListener(s,"touchstart",this.touchstart,{passive:!1}),D.removeEventListener(s,"touchmove",this.touchmove),D.removeEventListener(s,"touchend",this.touchend),D.removeEventListener(s,"touchcancel",this.reset),this.offTemp()},os.prototype.offTemp=function(){D.enableDrag(),D.removeEventListener(o.window,"mousemove",this.mousemove),D.removeEventListener(o.window,"mouseup",this.mouseup)},os.prototype.mousedown=function(s){this.down(o.extend({},s,{ctrlKey:!0,preventDefault:function(){return s.preventDefault()}}),D.mousePos(this.element,s)),D.addEventListener(o.window,"mousemove",this.mousemove),D.addEventListener(o.window,"mouseup",this.mouseup)},os.prototype.mousemove=function(s){this.move(s,D.mousePos(this.element,s))},os.prototype.mouseup=function(s){this.mouseRotate.mouseupWindow(s),this.mousePitch&&this.mousePitch.mouseupWindow(s),this.offTemp()},os.prototype.touchstart=function(s){s.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=D.touchPos(this.element,s.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return s.preventDefault()}},this._startPos))},os.prototype.touchmove=function(s){s.targetTouches.length!==1?this.reset():(this._lastPos=D.touchPos(this.element,s.targetTouches)[0],this.move({preventDefault:function(){return s.preventDefault()}},this._lastPos))},os.prototype.touchend=function(s){s.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},os.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var bu={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Sf(s,a,n){var l=s.classList;for(var b in bu)l.remove("mapboxgl-"+n+"-anchor-"+b);l.add("mapboxgl-"+n+"-anchor-"+a)}var Ul,Xc=function(s){function a(n,l){var b=this;if(s.call(this),(n instanceof o.window.HTMLElement||l)&&(n=o.extend({element:n},l)),o.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,n&&n.element)this._element=n.element,this._offset=o.Point.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=D.create("div"),this._element.setAttribute("aria-label","Map marker");var O=D.createNS("http://www.w3.org/2000/svg","svg");O.setAttributeNS(null,"display","block"),O.setAttributeNS(null,"height","41px"),O.setAttributeNS(null,"width","27px"),O.setAttributeNS(null,"viewBox","0 0 27 41");var R=D.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"stroke","none"),R.setAttributeNS(null,"stroke-width","1"),R.setAttributeNS(null,"fill","none"),R.setAttributeNS(null,"fill-rule","evenodd");var j=D.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"fill-rule","nonzero");var ue=D.createNS("http://www.w3.org/2000/svg","g");ue.setAttributeNS(null,"transform","translate(3.0, 29.0)"),ue.setAttributeNS(null,"fill","#000000");for(var Te=0,Ye=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];Te<Ye.length;Te+=1){var qe=Ye[Te],tt=D.createNS("http://www.w3.org/2000/svg","ellipse");tt.setAttributeNS(null,"opacity","0.04"),tt.setAttributeNS(null,"cx","10.5"),tt.setAttributeNS(null,"cy","5.80029008"),tt.setAttributeNS(null,"rx",qe.rx),tt.setAttributeNS(null,"ry",qe.ry),ue.appendChild(tt)}var Dt=D.createNS("http://www.w3.org/2000/svg","g");Dt.setAttributeNS(null,"fill",this._color);var Rt=D.createNS("http://www.w3.org/2000/svg","path");Rt.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Dt.appendChild(Rt);var Wt=D.createNS("http://www.w3.org/2000/svg","g");Wt.setAttributeNS(null,"opacity","0.25"),Wt.setAttributeNS(null,"fill","#000000");var kt=D.createNS("http://www.w3.org/2000/svg","path");kt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Wt.appendChild(kt);var zt=D.createNS("http://www.w3.org/2000/svg","g");zt.setAttributeNS(null,"transform","translate(6.0, 7.0)"),zt.setAttributeNS(null,"fill","#FFFFFF");var nr=D.createNS("http://www.w3.org/2000/svg","g");nr.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Jt=D.createNS("http://www.w3.org/2000/svg","circle");Jt.setAttributeNS(null,"fill","#000000"),Jt.setAttributeNS(null,"opacity","0.25"),Jt.setAttributeNS(null,"cx","5.5"),Jt.setAttributeNS(null,"cy","5.5"),Jt.setAttributeNS(null,"r","5.4999962");var Cr=D.createNS("http://www.w3.org/2000/svg","circle");Cr.setAttributeNS(null,"fill","#FFFFFF"),Cr.setAttributeNS(null,"cx","5.5"),Cr.setAttributeNS(null,"cy","5.5"),Cr.setAttributeNS(null,"r","5.4999962"),nr.appendChild(Jt),nr.appendChild(Cr),j.appendChild(ue),j.appendChild(Dt),j.appendChild(Wt),j.appendChild(zt),j.appendChild(nr),O.appendChild(j),O.setAttributeNS(null,"height",41*this._scale+"px"),O.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(O),this._offset=o.Point.convert(n&&n.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(pr){pr.preventDefault()}),this._element.addEventListener("mousedown",function(pr){pr.preventDefault()}),this._element.addEventListener("focus",function(){var pr=b._map.getContainer();pr.scrollTop=0,pr.scrollLeft=0}),Sf(this._element,this._anchor,"marker"),this._popup=null}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.addTo=function(n){return this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},a.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),D.remove(this._element),this._popup&&this._popup.remove(),this},a.prototype.getLngLat=function(){return this._lngLat},a.prototype.setLngLat=function(n){return this._lngLat=o.LngLat.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},a.prototype.getElement=function(){return this._element},a.prototype.setPopup=function(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){var l=Math.sqrt(Math.pow(13.5,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[l,-1*(24.6+l)],"bottom-right":[-l,-1*(24.6+l)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=n,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},a.prototype._onKeyPress=function(n){var l=n.code,b=n.charCode||n.keyCode;l!=="Space"&&l!=="Enter"&&b!==32&&b!==13||this.togglePopup()},a.prototype._onMapClick=function(n){var l=n.originalEvent.target,b=this._element;this._popup&&(l===b||b.contains(l))&&this.togglePopup()},a.prototype.getPopup=function(){return this._popup},a.prototype.togglePopup=function(){var n=this._popup;return n?(n.isOpen()?n.remove():n.addTo(this._map),this):this},a.prototype._update=function(n){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Yu(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var l="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?l="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(l="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var b="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?b="rotateX(0deg)":this._pitchAlignment==="map"&&(b="rotateX("+this._map.getPitch()+"deg)"),n&&n.type!=="moveend"||(this._pos=this._pos.round()),D.setTransform(this._element,bu[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+b+" "+l)}},a.prototype.getOffset=function(){return this._offset},a.prototype.setOffset=function(n){return this._offset=o.Point.convert(n),this._update(),this},a.prototype._onMove=function(n){this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.Event("dragstart"))),this.fire(new o.Event("drag"))},a.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.Event("dragend")),this._state="inactive"},a.prototype._addDragHandler=function(n){this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},a.prototype.setDraggable=function(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},a.prototype.isDraggable=function(){return this._draggable},a.prototype.setRotation=function(n){return this._rotation=n||0,this._update(),this},a.prototype.getRotation=function(){return this._rotation},a.prototype.setRotationAlignment=function(n){return this._rotationAlignment=n||"auto",this._update(),this},a.prototype.getRotationAlignment=function(){return this._rotationAlignment},a.prototype.setPitchAlignment=function(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this},a.prototype.getPitchAlignment=function(){return this._pitchAlignment},a}(o.Evented),lf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},iu=0,Sl=!1,xu=function(s){function a(n){s.call(this),this.options=o.extend({},lf,n),o.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.onAdd=function(n){var l;return this._map=n,this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),l=this._setupUI,Ul!==void 0?l(Ul):o.window.navigator.permissions!==void 0?o.window.navigator.permissions.query({name:"geolocation"}).then(function(b){l(Ul=b.state!=="denied")}):l(Ul=!!o.window.navigator.geolocation),this._container},a.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(o.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),D.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,iu=0,Sl=!1},a.prototype._isOutOfMapMaxBounds=function(n){var l=this._map.getMaxBounds(),b=n.coords;return l&&(b.longitude<l.getWest()||b.longitude>l.getEast()||b.latitude<l.getSouth()||b.latitude>l.getNorth())},a.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},a.prototype._onSuccess=function(n){if(this._map){if(this._isOutOfMapMaxBounds(n))return this._setErrorState(),this.fire(new o.Event("outofmaxbounds",n)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=n,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(n),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(n),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("geolocate",n)),this._finish()}},a.prototype._updateCamera=function(n){var l=new o.LngLat(n.coords.longitude,n.coords.latitude),b=n.coords.accuracy,O=this._map.getBearing(),R=o.extend({bearing:O},this.options.fitBoundsOptions);this._map.fitBounds(l.toBounds(b),R,{geolocateSource:!0})},a.prototype._updateMarker=function(n){if(n){var l=new o.LngLat(n.coords.longitude,n.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=n.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},a.prototype._updateCircleRadius=function(){var n=this._map._container.clientHeight/2,l=this._map.unproject([0,n]),b=this._map.unproject([1,n]),O=l.distanceTo(b),R=Math.ceil(2*this._accuracy/O);this._circleElement.style.width=R+"px",this._circleElement.style.height=R+"px"},a.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},a.prototype._onError=function(n){if(this._map){if(this.options.trackUserLocation)if(n.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(n.code===3&&Sl)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("error",n)),this._finish()}},a.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},a.prototype._setupUI=function(n){var l=this;if(this._container.addEventListener("contextmenu",function(R){return R.preventDefault()}),this._geolocateButton=D.create("button","mapboxgl-ctrl-geolocate",this._container),D.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",n===!1){o.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var b=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=b,this._geolocateButton.setAttribute("aria-label",b)}else{var O=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=O,this._geolocateButton.setAttribute("aria-label",O)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=D.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Xc(this._dotElement),this._circleElement=D.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Xc({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(R){R.geolocateSource||l._watchState!=="ACTIVE_LOCK"||R.originalEvent&&R.originalEvent.type==="resize"||(l._watchState="BACKGROUND",l._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),l._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),l.fire(new o.Event("trackuserlocationend")))})},a.prototype.trigger=function(){if(!this._setup)return o.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":iu--,Sl=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var n;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++iu>1?(n={maximumAge:6e5,timeout:0},Sl=!0):(n=this.options.positionOptions,Sl=!1),this._geolocationWatchID=o.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,n)}}else o.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},a.prototype._clearWatch=function(){o.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},a}(o.Evented),cc={maxWidth:100,unit:"metric"},Ru=function(a){this.options=o.extend({},cc,a),o.bindAll(["_onMove","setUnit"],this)};function fl(s,a,n){var l=n&&n.maxWidth||100,b=s._container.clientHeight/2,O=s.unproject([0,b]),R=s.unproject([l,b]),j=O.distanceTo(R);if(n&&n.unit==="imperial"){var ue=3.2808*j;ue>5280?hl(a,l,ue/5280,s._getUIString("ScaleControl.Miles")):hl(a,l,ue,s._getUIString("ScaleControl.Feet"))}else n&&n.unit==="nautical"?hl(a,l,j/1852,s._getUIString("ScaleControl.NauticalMiles")):j>=1e3?hl(a,l,j/1e3,s._getUIString("ScaleControl.Kilometers")):hl(a,l,j,s._getUIString("ScaleControl.Meters"))}function hl(s,a,n,l){var b,O,R,j=(b=n,(O=Math.pow(10,(""+Math.floor(b)).length-1))*(R=(R=b/O)>=10?10:R>=5?5:R>=3?3:R>=2?2:R>=1?1:function(ue){var Te=Math.pow(10,Math.ceil(-Math.log(ue)/Math.LN10));return Math.round(ue*Te)/Te}(R)));s.style.width=a*(j/n)+"px",s.innerHTML=j+"&nbsp;"+l}Ru.prototype.getDefaultPosition=function(){return"bottom-left"},Ru.prototype._onMove=function(){fl(this._map,this._container,this.options)},Ru.prototype.onAdd=function(s){return this._map=s,this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",s.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Ru.prototype.onRemove=function(){D.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Ru.prototype.setUnit=function(s){this.options.unit=s,fl(this._map,this._container,this.options)};var Ls=function(a){this._fullscreen=!1,a&&a.container&&(a.container instanceof o.window.HTMLElement?this._container=a.container:o.warnOnce("Full screen control 'container' must be a DOM element.")),o.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in o.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in o.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in o.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in o.window.document&&(this._fullscreenchange="MSFullscreenChange")};Ls.prototype.onAdd=function(s){return this._map=s,this._container||(this._container=this._map.getContainer()),this._controlContainer=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Ls.prototype.onRemove=function(){D.remove(this._controlContainer),this._map=null,o.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Ls.prototype._checkFullscreenSupport=function(){return!!(o.window.document.fullscreenEnabled||o.window.document.mozFullScreenEnabled||o.window.document.msFullscreenEnabled||o.window.document.webkitFullscreenEnabled)},Ls.prototype._setupUI=function(){var s=this._fullscreenButton=D.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);D.create("span","mapboxgl-ctrl-icon",s).setAttribute("aria-hidden",!0),s.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),o.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Ls.prototype._updateTitle=function(){var s=this._getTitle();this._fullscreenButton.setAttribute("aria-label",s),this._fullscreenButton.title=s},Ls.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Ls.prototype._isFullscreen=function(){return this._fullscreen},Ls.prototype._changeIcon=function(){(o.window.document.fullscreenElement||o.window.document.mozFullScreenElement||o.window.document.webkitFullscreenElement||o.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Ls.prototype._onClickFullscreen=function(){this._isFullscreen()?o.window.document.exitFullscreen?o.window.document.exitFullscreen():o.window.document.mozCancelFullScreen?o.window.document.mozCancelFullScreen():o.window.document.msExitFullscreen?o.window.document.msExitFullscreen():o.window.document.webkitCancelFullScreen&&o.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Bl={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},Yc=function(s){function a(n){s.call(this),this.options=o.extend(Object.create(Bl),n),o.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.addTo=function(n){return this._map&&this.remove(),this._map=n,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new o.Event("open")),this},a.prototype.isOpen=function(){return!!this._map},a.prototype.remove=function(){return this._content&&D.remove(this._content),this._container&&(D.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new o.Event("close")),this},a.prototype.getLngLat=function(){return this._lngLat},a.prototype.setLngLat=function(n){return this._lngLat=o.LngLat.convert(n),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},a.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},a.prototype.getElement=function(){return this._container},a.prototype.setText=function(n){return this.setDOMContent(o.window.document.createTextNode(n))},a.prototype.setHTML=function(n){var l,b=o.window.document.createDocumentFragment(),O=o.window.document.createElement("body");for(O.innerHTML=n;l=O.firstChild;)b.appendChild(l);return this.setDOMContent(b)},a.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},a.prototype.setMaxWidth=function(n){return this.options.maxWidth=n,this._update(),this},a.prototype.setDOMContent=function(n){return this._createContent(),this._content.appendChild(n),this._update(),this},a.prototype.addClassName=function(n){this._container&&this._container.classList.add(n)},a.prototype.removeClassName=function(n){this._container&&this._container.classList.remove(n)},a.prototype.toggleClassName=function(n){if(this._container)return this._container.classList.toggle(n)},a.prototype._createContent=function(){this._content&&D.remove(this._content),this._content=D.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=D.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},a.prototype._onMouseUp=function(n){this._update(n.point)},a.prototype._onMouseMove=function(n){this._update(n.point)},a.prototype._onDrag=function(n){this._update(n.point)},a.prototype._update=function(n){var l=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=D.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=D.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(qe){return l._container.classList.add(qe)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Yu(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||n)){var b=this._pos=this._trackPointer&&n?n:this._map.project(this._lngLat),O=this.options.anchor,R=function qe(tt){if(tt){if(typeof tt=="number"){var Dt=Math.round(Math.sqrt(.5*Math.pow(tt,2)));return{center:new o.Point(0,0),top:new o.Point(0,tt),"top-left":new o.Point(Dt,Dt),"top-right":new o.Point(-Dt,Dt),bottom:new o.Point(0,-tt),"bottom-left":new o.Point(Dt,-Dt),"bottom-right":new o.Point(-Dt,-Dt),left:new o.Point(tt,0),right:new o.Point(-tt,0)}}if(tt instanceof o.Point||Array.isArray(tt)){var Rt=o.Point.convert(tt);return{center:Rt,top:Rt,"top-left":Rt,"top-right":Rt,bottom:Rt,"bottom-left":Rt,"bottom-right":Rt,left:Rt,right:Rt}}return{center:o.Point.convert(tt.center||[0,0]),top:o.Point.convert(tt.top||[0,0]),"top-left":o.Point.convert(tt["top-left"]||[0,0]),"top-right":o.Point.convert(tt["top-right"]||[0,0]),bottom:o.Point.convert(tt.bottom||[0,0]),"bottom-left":o.Point.convert(tt["bottom-left"]||[0,0]),"bottom-right":o.Point.convert(tt["bottom-right"]||[0,0]),left:o.Point.convert(tt.left||[0,0]),right:o.Point.convert(tt.right||[0,0])}}return qe(new o.Point(0,0))}(this.options.offset);if(!O){var j,ue=this._container.offsetWidth,Te=this._container.offsetHeight;j=b.y+R.bottom.y<Te?["top"]:b.y>this._map.transform.height-Te?["bottom"]:[],b.x<ue/2?j.push("left"):b.x>this._map.transform.width-ue/2&&j.push("right"),O=j.length===0?"bottom":j.join("-")}var Ye=b.add(R[O]).round();D.setTransform(this._container,bu[O]+" translate("+Ye.x+"px,"+Ye.y+"px)"),Sf(this._container,O,"popup")}},a.prototype._onClose=function(){this.remove()},a}(o.Evented),Vl={version:o.version,supported:Z,setRTLTextPlugin:o.setRTLTextPlugin,getRTLTextPluginStatus:o.getRTLTextPluginStatus,Map:yu,NavigationControl:Lu,GeolocateControl:xu,AttributionControl:zs,ScaleControl:Ru,FullscreenControl:Ls,Popup:Yc,Marker:Xc,Style:ka,LngLat:o.LngLat,LngLatBounds:o.LngLatBounds,Point:o.Point,MercatorCoordinate:o.MercatorCoordinate,Evented:o.Evented,config:o.config,prewarm:function(){Xr().acquire(or)},clearPrewarmedResources:function(){var a=Tn;a&&(a.isPreloaded()&&a.numActive()===1?(a.release(or),Tn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return o.config.ACCESS_TOKEN},set accessToken(s){o.config.ACCESS_TOKEN=s},get baseApiUrl(){return o.config.API_URL},set baseApiUrl(s){o.config.API_URL=s},get workerCount(){return Br.workerCount},set workerCount(s){Br.workerCount=s},get maxParallelImageRequests(){return o.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(s){o.config.MAX_PARALLEL_IMAGE_REQUESTS=s},clearStorage:function(a){o.clearTileCache(a)},workerUrl:""};return Vl}),X})},"4cb6":function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("xfSm");E.METADATA_KEY=T;var m=i("9Fde");E.Container=m.Container;var X=i("FV85");E.BindingScopeEnum=X.BindingScopeEnum,E.BindingTypeEnum=X.BindingTypeEnum,E.TargetTypeEnum=X.TargetTypeEnum;var z=i("dxzI");E.AsyncContainerModule=z.AsyncContainerModule,E.ContainerModule=z.ContainerModule;var o=i("cZ5Q");E.injectable=o.injectable;var Z=i("0gSV");E.tagged=Z.tagged;var D=i("ZzCi");E.named=D.named;var K=i("Yk9n");E.inject=K.inject,E.LazyServiceIdentifer=K.LazyServiceIdentifer;var re=i("jYx5");E.optional=re.optional;var de=i("n2J3");E.unmanaged=de.unmanaged;var Y=i("jIg/");E.multiInject=Y.multiInject;var Fe=i("oaX6");E.targetName=Fe.targetName;var Ze=i("Sk89");E.postConstruct=Ze.postConstruct;var ye=i("wnjb");E.MetadataReader=ye.MetadataReader;var we=i("d9O0");E.id=we.id;var pt=i("Ztfv");E.decorate=pt.decorate;var je=i("RR/i");E.traverseAncerstors=je.traverseAncerstors,E.taggedConstraint=je.taggedConstraint,E.namedConstraint=je.namedConstraint,E.typeConstraint=je.typeConstraint;var Tt=i("ujMp");E.getServiceIdentifierAsString=Tt.getServiceIdentifierAsString;var Xe=i("78VC");E.multiBindToService=Xe.multiBindToService},"4qC0":function(Re,E,i){var T=i("NykK"),m=i("Z0cm"),X=i("ExA7"),z="[object String]";function o(Z){return typeof Z=="string"||!m(Z)&&X(Z)&&T(Z)==z}Re.exports=o},"5Tg0":function(Re,E,i){(function(T){var m=i("Kz5y"),X=E&&!E.nodeType&&E,z=X&&typeof T=="object"&&T&&!T.nodeType&&T,o=z&&z.exports===X,Z=o?m.Buffer:void 0,D=Z?Z.allocUnsafe:void 0;function K(re,de){if(de)return re.slice();var Y=re.length,Fe=D?D(Y):new re.constructor(Y);return re.copy(Fe),Fe}T.exports=K}).call(this,i("YuTi")(Re))},"5gLl":function(Re,E,i){"use strict";i.d(E,"a",function(){return Y});var T=i("lSNA"),m=i.n(T),X=i("LvWW"),z=i.n(X),o=i("AKIq"),Z=i.n(o),D=i("cWyK"),K=i.n(D);function re(Fe,Ze){var ye=Object.keys(Fe);if(Object.getOwnPropertySymbols){var we=Object.getOwnPropertySymbols(Fe);Ze&&(we=we.filter(function(pt){return Object.getOwnPropertyDescriptor(Fe,pt).enumerable})),ye.push.apply(ye,we)}return ye}function de(Fe){for(var Ze=1;Ze<arguments.length;Ze++){var ye=arguments[Ze]!=null?arguments[Ze]:{};Ze%2?re(Object(ye),!0).forEach(function(we){m()(Fe,we,ye[we])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Fe,Object.getOwnPropertyDescriptors(ye)):re(Object(ye)).forEach(function(we){Object.defineProperty(Fe,we,Object.getOwnPropertyDescriptor(ye,we))})}return Fe}function Y(Fe,Ze){var ye=[],we={};if(Fe.features=Fe.features.filter(function(je){var Tt=je.geometry;return je!=null&&Tt&&Tt.type&&Tt.coordinates&&Tt.coordinates.length>0}),z()(Fe,!0),Fe.features.length===0)return{dataArray:[],featureKeys:we};var pt=0;return D.flattenEach(Fe,function(je,Tt){var Xe=Object(o.getCoords)(je),gt=Tt,Je=de(de({},je.properties),{},{coordinates:Xe,_id:gt});ye.push(Je)}),{dataArray:ye,featureKeys:we}}},"5ku3":function(Re,E,i){"use strict";(function(T){i.d(E,"a",function(){return z});var m=i("U8pU"),X=i("I0ug");function z(){var Z=(typeof T=="undefined"?"undefined":Object(m.a)(T))==="object"&&String(T)==="[object process]"&&!T.browser;return!Z||Object(X.a)()}function o(){return z()&&typeof document!="undefined"}}).call(this,i("Q2Ig"))},"5zYK":function(Re,E,i){"use strict";i.d(E,"a",function(){return re});var T=i("lSNA"),m=i.n(T),X=i("RIqP"),z=i.n(X),o=i("LvWW"),Z=i.n(o);function D(de,Y){var Fe=Object.keys(de);if(Object.getOwnPropertySymbols){var Ze=Object.getOwnPropertySymbols(de);Y&&(Ze=Ze.filter(function(ye){return Object.getOwnPropertyDescriptor(de,ye).enumerable})),Fe.push.apply(Fe,Ze)}return Fe}function K(de){for(var Y=1;Y<arguments.length;Y++){var Fe=arguments[Y]!=null?arguments[Y]:{};Y%2?D(Object(Fe),!0).forEach(function(Ze){m()(de,Ze,Fe[Ze])}):Object.getOwnPropertyDescriptors?Object.defineProperties(de,Object.getOwnPropertyDescriptors(Fe)):D(Object(Fe)).forEach(function(Ze){Object.defineProperty(de,Ze,Object.getOwnPropertyDescriptor(Fe,Ze))})}return de}function re(de,Y){var Fe=Y.x,Ze=Y.y,ye=Y.x1,we=Y.y1,pt=Y.coordinates,je=[];return de.forEach(function(Tt,Xe){var gt=[];if(Fe&&Ze&&(gt=[parseFloat(Tt[Fe]),parseFloat(Tt[Ze])]),Fe&&Ze&&ye&&we){var Je=[parseFloat(Tt[Fe]),parseFloat(Tt[Ze])],Et=[parseFloat(Tt[ye]),parseFloat(Tt[we])];gt=[Je,Et]}if(pt){var _t="Polygon";Array.isArray(pt[0])||(_t="Point"),Array.isArray(pt[0])&&!Array.isArray(pt[0][0])&&(_t="LineString");var Ne={type:_t,coordinates:z()(Tt[pt])};Z()(Ne,!0),gt=Ne.coordinates}var ke=K(K({},Tt),{},{_id:Xe,coordinates:gt});je.push(ke)}),{dataArray:je}}},"6AGu":function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("FV85"),m=i("LKzl"),X=function(){function z(o){this._binding=o}return z.prototype.inRequestScope=function(){return this._binding.scope=T.BindingScopeEnum.Request,new m.BindingWhenOnSyntax(this._binding)},z.prototype.inSingletonScope=function(){return this._binding.scope=T.BindingScopeEnum.Singleton,new m.BindingWhenOnSyntax(this._binding)},z.prototype.inTransientScope=function(){return this._binding.scope=T.BindingScopeEnum.Transient,new m.BindingWhenOnSyntax(this._binding)},z}();E.BindingInSyntax=X},"6D9b":function(Re,E,i){Re.exports={"ant-modal":"ant-modal","ant-image-preview":"ant-image-preview","zoom-enter":"zoom-enter","zoom-appear":"zoom-appear","ant-modal-mask":"ant-modal-mask","ant-image-preview-mask":"ant-image-preview-mask","ant-modal-mask-hidden":"ant-modal-mask-hidden","ant-image-preview-mask-hidden":"ant-image-preview-mask-hidden","ant-modal-wrap":"ant-modal-wrap","ant-image-preview-wrap":"ant-image-preview-wrap","ant-statistic":"ant-statistic","ant-statistic-title":"ant-statistic-title","ant-statistic-content":"ant-statistic-content","ant-statistic-content-value":"ant-statistic-content-value","ant-statistic-content-value-decimal":"ant-statistic-content-value-decimal","ant-statistic-content-prefix":"ant-statistic-content-prefix","ant-statistic-content-suffix":"ant-statistic-content-suffix","ant-statistic-rtl":"ant-statistic-rtl"}},"6NqC":function(Re,E){},"6acW":function(Re,E,i){var T=i("dt0z"),m=i("gQMU");function X(z){return m(T(z).toLowerCase())}Re.exports=X},"6nK8":function(Re,E,i){var T=i("dVn5"),m=i("fo6e"),X=i("dt0z"),z=i("9NmV");function o(Z,D,K){return Z=X(Z),D=K?void 0:D,D===void 0?m(Z)?z(Z):T(Z):Z.match(D)||[]}Re.exports=o},"711d":function(Re,E){function i(T){return function(m){return m==null?void 0:m[T]}}Re.exports=i},"78VC":function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.multiBindToService=function(T){return function(m){return function(){for(var X=[],z=0;z<arguments.length;z++)X[z]=arguments[z];return X.forEach(function(o){return T.bind(o).toService(m)})}}}},"7Ix3":function(Re,E){function i(T){var m=[];if(T!=null)for(var X in Object(T))m.push(X);return m}Re.exports=i},"7tbW":function(Re,E,i){var T=i("LGYb");function m(X){return X&&X.length?T(X):[]}Re.exports=m},"8/Fi":function(Re,E,i){"use strict";var T=i("J4zp"),m=i.n(T),X=i("9nhX"),z=i.n(X),o=["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"];function Z(ut){return o.indexOf(ut)}var D=2,K=4,re=64,de=128,Y=256,Fe=512,Ze=8192,ye=16384,we=32768,pt=32768*2,je=131072,Tt=262144,Xe=524288,gt=1048576,Je=2097152,Et=4194304,_t=8388608,Ne=16777216,ke=16777216*2;function Ue(ut,Vt){return ut=z()(Math.floor(ut),0,255),Vt=z()(Math.floor(Vt),0,255),256*ut+Vt}function st(ut){var Vt=ut.color,Zt=ut.radius,ir=ut.tileX,oe=ut.tileY,Q=ut.shape,H=ut.opacity,Ce=ut.stroke,Ee=ut.strokeWidth,Ae=ut.strokeOpacity,ge=[],rt=[],Yt=[],At=[Ue(Vt[0],Vt[1]),Ue(Vt[2],Vt[3])],be=[Ue(Ce[0],Ce[1]),Ue(Ce[2],Ce[3])];return[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(xe){var Ve=m()(xe,2),lt=Ve[0],Pe=Ve[1];ge.push([].concat(At,[(lt+1)*_t+(Pe+1)*Je+Z(Q)*je+Zt,(ir+512)*Xe+(oe+512)*re])),rt.push([].concat(be,[Ee,Ae])),Yt.push([H,0,0,0])}),{packedBuffer:ge,packedBuffer2:rt,packedBuffer3:Yt}}function Le(ut,Vt){if(ut===0&&!Vt)return 0;if(ut===1&&Vt)return 4294967295;var Zt=Vt?1:0,ir=Math.floor(ut*127);return ir*ke+Zt*Ne+ir*je+Zt*pt+ir*Fe+Zt*Y+ir*D+Zt}},"88Gu":function(Re,E){var i=800,T=16,m=Date.now;function X(z){var o=0,Z=0;return function(){var D=m(),K=T-(D-Z);if(Z=D,K>0){if(++o>=i)return arguments[0]}else o=0;return z.apply(void 0,arguments)}}Re.exports=X},"8ml+":function(Re,E,i){"use strict";var T=i("h1nZ");i.o(T,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return T.CityBuildingLayer}),i.o(T,"Control")&&i.d(E,"Control",function(){return T.Control}),i.o(T,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return T.HeatmapLayer}),i.o(T,"ImageLayer")&&i.d(E,"ImageLayer",function(){return T.ImageLayer}),i.o(T,"LineLayer")&&i.d(E,"LineLayer",function(){return T.LineLayer}),i.o(T,"Logo")&&i.d(E,"Logo",function(){return T.Logo}),i.o(T,"Marker")&&i.d(E,"Marker",function(){return T.Marker}),i.o(T,"PointLayer")&&i.d(E,"PointLayer",function(){return T.PointLayer}),i.o(T,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return T.PolygonLayer}),i.o(T,"Popup")&&i.d(E,"Popup",function(){return T.Popup}),i.o(T,"RasterLayer")&&i.d(E,"RasterLayer",function(){return T.RasterLayer}),i.o(T,"Scale")&&i.d(E,"Scale",function(){return T.Scale}),i.o(T,"Scene")&&i.d(E,"Scene",function(){return T.Scene}),i.o(T,"Zoom")&&i.d(E,"Zoom",function(){return T.Zoom});var m=i("kQ+U");i.d(E,"Scene",function(){return m.a});var X=i("sxDa");i.d(E,"CityBuildingLayer",function(){return X.a}),i.d(E,"HeatmapLayer",function(){return X.b}),i.d(E,"ImageLayer",function(){return X.c}),i.d(E,"LineLayer",function(){return X.d}),i.d(E,"PointLayer",function(){return X.e}),i.d(E,"PolygonLayer",function(){return X.f}),i.d(E,"RasterLayer",function(){return X.g});var z=i("k5/I");i.d(E,"Control",function(){return z.a}),i.d(E,"Logo",function(){return z.b}),i.d(E,"Marker",function(){return z.c}),i.d(E,"Popup",function(){return z.d}),i.d(E,"Scale",function(){return z.e}),i.d(E,"Zoom",function(){return z.f});var o=i("Hel2"),Z=i("RL2/")},"8uyu":function(Re,E){},"9Fde":function(Re,E,i){"use strict";var T=this&&this.__awaiter||function(pt,je,Tt,Xe){return new(Tt||(Tt=Promise))(function(gt,Je){function Et(ke){try{Ne(Xe.next(ke))}catch(Ue){Je(Ue)}}function _t(ke){try{Ne(Xe.throw(ke))}catch(Ue){Je(Ue)}}function Ne(ke){ke.done?gt(ke.value):new Tt(function(Ue){Ue(ke.value)}).then(Et,_t)}Ne((Xe=Xe.apply(pt,je||[])).next())})},m=this&&this.__generator||function(pt,je){var Tt={label:0,sent:function(){if(Je[0]&1)throw Je[1];return Je[1]},trys:[],ops:[]},Xe,gt,Je,Et;return Et={next:_t(0),throw:_t(1),return:_t(2)},typeof Symbol=="function"&&(Et[Symbol.iterator]=function(){return this}),Et;function _t(ke){return function(Ue){return Ne([ke,Ue])}}function Ne(ke){if(Xe)throw new TypeError("Generator is already executing.");for(;Tt;)try{if(Xe=1,gt&&(Je=gt[ke[0]&2?"return":ke[0]?"throw":"next"])&&!(Je=Je.call(gt,ke[1])).done)return Je;(gt=0,Je)&&(ke=[0,Je.value]);switch(ke[0]){case 0:case 1:Je=ke;break;case 4:return Tt.label++,{value:ke[1],done:!1};case 5:Tt.label++,gt=ke[1],ke=[0];continue;case 7:ke=Tt.ops.pop(),Tt.trys.pop();continue;default:if(!(Je=Tt.trys,Je=Je.length>0&&Je[Je.length-1])&&(ke[0]===6||ke[0]===2)){Tt=0;continue}if(ke[0]===3&&(!Je||ke[1]>Je[0]&&ke[1]<Je[3])){Tt.label=ke[1];break}if(ke[0]===6&&Tt.label<Je[1]){Tt.label=Je[1],Je=ke;break}if(Je&&Tt.label<Je[2]){Tt.label=Je[2],Tt.ops.push(ke);break}Je[2]&&Tt.ops.pop(),Tt.trys.pop();continue}ke=je.call(pt,Tt)}catch(Ue){ke=[6,Ue],gt=0}finally{Xe=Je=0}if(ke[0]&5)throw ke[1];return{value:ke[0]?ke[1]:void 0,done:!0}}};Object.defineProperty(E,"__esModule",{value:!0});var X=i("LgvC"),z=i("MON2"),o=i("FV85"),Z=i("xfSm"),D=i("wnjb"),K=i("h7MG"),re=i("aPG5"),de=i("gzZq"),Y=i("d9O0"),Fe=i("ujMp"),Ze=i("HpQ9"),ye=i("AwBQ"),we=function(){function pt(je){var Tt=je||{};if(typeof Tt!="object")throw new Error(""+z.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(Tt.defaultScope===void 0)Tt.defaultScope=o.BindingScopeEnum.Transient;else if(Tt.defaultScope!==o.BindingScopeEnum.Singleton&&Tt.defaultScope!==o.BindingScopeEnum.Transient&&Tt.defaultScope!==o.BindingScopeEnum.Request)throw new Error(""+z.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(Tt.autoBindInjectable===void 0)Tt.autoBindInjectable=!1;else if(typeof Tt.autoBindInjectable!="boolean")throw new Error(""+z.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(Tt.skipBaseClassChecks===void 0)Tt.skipBaseClassChecks=!1;else if(typeof Tt.skipBaseClassChecks!="boolean")throw new Error(""+z.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:Tt.autoBindInjectable,defaultScope:Tt.defaultScope,skipBaseClassChecks:Tt.skipBaseClassChecks},this.id=Y.id(),this._bindingDictionary=new ye.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new D.MetadataReader}return pt.merge=function(je,Tt){var Xe=new pt,gt=K.getBindingDictionary(Xe),Je=K.getBindingDictionary(je),Et=K.getBindingDictionary(Tt);function _t(Ne,ke){Ne.traverse(function(Ue,st){st.forEach(function(Le){ke.add(Le.serviceIdentifier,Le.clone())})})}return _t(Je,gt),_t(Et,gt),Xe},pt.prototype.load=function(){for(var je=[],Tt=0;Tt<arguments.length;Tt++)je[Tt]=arguments[Tt];for(var Xe=this._getContainerModuleHelpersFactory(),gt=0,Je=je;gt<Je.length;gt++){var Et=Je[gt],_t=Xe(Et.id);Et.registry(_t.bindFunction,_t.unbindFunction,_t.isboundFunction,_t.rebindFunction)}},pt.prototype.loadAsync=function(){for(var je=[],Tt=0;Tt<arguments.length;Tt++)je[Tt]=arguments[Tt];return T(this,void 0,void 0,function(){var Xe,gt,Je,Et,_t;return m(this,function(Ne){switch(Ne.label){case 0:Xe=this._getContainerModuleHelpersFactory(),gt=0,Je=je,Ne.label=1;case 1:return gt<Je.length?(Et=Je[gt],_t=Xe(Et.id),[4,Et.registry(_t.bindFunction,_t.unbindFunction,_t.isboundFunction,_t.rebindFunction)]):[3,4];case 2:Ne.sent(),Ne.label=3;case 3:return gt++,[3,1];case 4:return[2]}})})},pt.prototype.unload=function(){for(var je=this,Tt=[],Xe=0;Xe<arguments.length;Xe++)Tt[Xe]=arguments[Xe];var gt=function(Et){return function(_t){return _t.moduleId===Et}};Tt.forEach(function(Je){var Et=gt(Je.id);je._bindingDictionary.removeByCondition(Et)})},pt.prototype.bind=function(je){var Tt=this.options.defaultScope||o.BindingScopeEnum.Transient,Xe=new X.Binding(je,Tt);return this._bindingDictionary.add(je,Xe),new de.BindingToSyntax(Xe)},pt.prototype.rebind=function(je){return this.unbind(je),this.bind(je)},pt.prototype.unbind=function(je){try{this._bindingDictionary.remove(je)}catch(Tt){throw new Error(z.CANNOT_UNBIND+" "+Fe.getServiceIdentifierAsString(je))}},pt.prototype.unbindAll=function(){this._bindingDictionary=new ye.Lookup},pt.prototype.isBound=function(je){var Tt=this._bindingDictionary.hasKey(je);return!Tt&&this.parent&&(Tt=this.parent.isBound(je)),Tt},pt.prototype.isBoundNamed=function(je,Tt){return this.isBoundTagged(je,Z.NAMED_TAG,Tt)},pt.prototype.isBoundTagged=function(je,Tt,Xe){var gt=!1;if(this._bindingDictionary.hasKey(je)){var Je=this._bindingDictionary.get(je),Et=K.createMockRequest(this,je,Tt,Xe);gt=Je.some(function(_t){return _t.constraint(Et)})}return!gt&&this.parent&&(gt=this.parent.isBoundTagged(je,Tt,Xe)),gt},pt.prototype.snapshot=function(){this._snapshots.push(Ze.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},pt.prototype.restore=function(){var je=this._snapshots.pop();if(je===void 0)throw new Error(z.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=je.bindings,this._middleware=je.middleware},pt.prototype.createChild=function(je){var Tt=new pt(je||this.options);return Tt.parent=this,Tt},pt.prototype.applyMiddleware=function(){for(var je=[],Tt=0;Tt<arguments.length;Tt++)je[Tt]=arguments[Tt];var Xe=this._middleware?this._middleware:this._planAndResolve();this._middleware=je.reduce(function(gt,Je){return Je(gt)},Xe)},pt.prototype.applyCustomMetadataReader=function(je){this._metadataReader=je},pt.prototype.get=function(je){return this._get(!1,!1,o.TargetTypeEnum.Variable,je)},pt.prototype.getTagged=function(je,Tt,Xe){return this._get(!1,!1,o.TargetTypeEnum.Variable,je,Tt,Xe)},pt.prototype.getNamed=function(je,Tt){return this.getTagged(je,Z.NAMED_TAG,Tt)},pt.prototype.getAll=function(je){return this._get(!0,!0,o.TargetTypeEnum.Variable,je)},pt.prototype.getAllTagged=function(je,Tt,Xe){return this._get(!1,!0,o.TargetTypeEnum.Variable,je,Tt,Xe)},pt.prototype.getAllNamed=function(je,Tt){return this.getAllTagged(je,Z.NAMED_TAG,Tt)},pt.prototype.resolve=function(je){var Tt=this.createChild();return Tt.bind(je).toSelf(),Tt.get(je)},pt.prototype._getContainerModuleHelpersFactory=function(){var je=this,Tt=function(Ne,ke){Ne._binding.moduleId=ke},Xe=function(Ne){return function(ke){var Ue=je.bind.bind(je),st=Ue(ke);return Tt(st,Ne),st}},gt=function(Ne){return function(ke){var Ue=je.unbind.bind(je);Ue(ke)}},Je=function(Ne){return function(ke){var Ue=je.isBound.bind(je);return Ue(ke)}},Et=function(Ne){return function(ke){var Ue=je.rebind.bind(je),st=Ue(ke);return Tt(st,Ne),st}};return function(_t){return{bindFunction:Xe(_t),isboundFunction:Je(_t),rebindFunction:Et(_t),unbindFunction:gt(_t)}}},pt.prototype._get=function(je,Tt,Xe,gt,Je,Et){var _t=null,Ne={avoidConstraints:je,contextInterceptor:function(Ue){return Ue},isMultiInject:Tt,key:Je,serviceIdentifier:gt,targetType:Xe,value:Et};if(this._middleware){if(_t=this._middleware(Ne),_t==null)throw new Error(z.INVALID_MIDDLEWARE_RETURN)}else _t=this._planAndResolve()(Ne);return _t},pt.prototype._planAndResolve=function(){var je=this;return function(Tt){var Xe=K.plan(je._metadataReader,je,Tt.isMultiInject,Tt.targetType,Tt.serviceIdentifier,Tt.key,Tt.value,Tt.avoidConstraints);Xe=Tt.contextInterceptor(Xe);var gt=re.resolve(Xe);return gt}},pt}();E.Container=we},"9NmV":function(Re,E){var i="\\ud800-\\udfff",T="\\u0300-\\u036f",m="\\ufe20-\\ufe2f",X="\\u20d0-\\u20ff",z=T+m+X,o="\\u2700-\\u27bf",Z="a-z\\xdf-\\xf6\\xf8-\\xff",D="\\xac\\xb1\\xd7\\xf7",K="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",re="\\u2000-\\u206f",de=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Y="A-Z\\xc0-\\xd6\\xd8-\\xde",Fe="\\ufe0e\\ufe0f",Ze=D+K+re+de,ye="['\u2019]",we="["+Ze+"]",pt="["+z+"]",je="\\d+",Tt="["+o+"]",Xe="["+Z+"]",gt="[^"+i+Ze+je+o+Z+Y+"]",Je="\\ud83c[\\udffb-\\udfff]",Et="(?:"+pt+"|"+Je+")",_t="[^"+i+"]",Ne="(?:\\ud83c[\\udde6-\\uddff]){2}",ke="[\\ud800-\\udbff][\\udc00-\\udfff]",Ue="["+Y+"]",st="\\u200d",Le="(?:"+Xe+"|"+gt+")",ut="(?:"+Ue+"|"+gt+")",Vt="(?:"+ye+"(?:d|ll|m|re|s|t|ve))?",Zt="(?:"+ye+"(?:D|LL|M|RE|S|T|VE))?",ir=Et+"?",oe="["+Fe+"]?",Q="(?:"+st+"(?:"+[_t,Ne,ke].join("|")+")"+oe+ir+")*",H="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ce="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ee=oe+ir+Q,Ae="(?:"+[Tt,Ne,ke].join("|")+")"+Ee,ge=RegExp([Ue+"?"+Xe+"+"+Vt+"(?="+[we,Ue,"$"].join("|")+")",ut+"+"+Zt+"(?="+[we,Ue+Le,"$"].join("|")+")",Ue+"?"+Le+"+"+Vt,Ue+"+"+Zt,Ce,H,je,Ae].join("|"),"g");function rt(Yt){return Yt.match(ge)||[]}Re.exports=rt},"9lTW":function(Re,E,i){"use strict";(function(T){var m=i("MgzW");/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function X(Le,ut){if(Le===ut)return 0;for(var Vt=Le.length,Zt=ut.length,ir=0,oe=Math.min(Vt,Zt);ir<oe;++ir)if(Le[ir]!==ut[ir]){Vt=Le[ir],Zt=ut[ir];break}return Vt<Zt?-1:Zt<Vt?1:0}function z(Le){return T.Buffer&&typeof T.Buffer.isBuffer=="function"?T.Buffer.isBuffer(Le):!!(Le!=null&&Le._isBuffer)}var o=i("MCLT"),Z=Object.prototype.hasOwnProperty,D=Array.prototype.slice,K=function(){return function(){}.name==="foo"}();function re(Le){return Object.prototype.toString.call(Le)}function de(Le){return z(Le)||typeof T.ArrayBuffer!="function"?!1:typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(Le):Le?Le instanceof DataView?!0:!!(Le.buffer&&Le.buffer instanceof ArrayBuffer):!1}var Y=Re.exports=Tt,Fe=/\s*function\s+([^\(\s]*)\s*/;function Ze(Le){if(!o.isFunction(Le))return;if(K)return Le.name;var ut=Le.toString(),Vt=ut.match(Fe);return Vt&&Vt[1]}Y.AssertionError=function(ut){this.name="AssertionError",this.actual=ut.actual,this.expected=ut.expected,this.operator=ut.operator,ut.message?(this.message=ut.message,this.generatedMessage=!1):(this.message=pt(this),this.generatedMessage=!0);var Vt=ut.stackStartFunction||je;if(Error.captureStackTrace)Error.captureStackTrace(this,Vt);else{var Zt=new Error;if(Zt.stack){var ir=Zt.stack,oe=Ze(Vt),Q=ir.indexOf(`
`+oe);if(Q>=0){var H=ir.indexOf(`
`,Q+1);ir=ir.substring(H+1)}this.stack=ir}}},o.inherits(Y.AssertionError,Error);function ye(Le,ut){return typeof Le=="string"?Le.length<ut?Le:Le.slice(0,ut):Le}function we(Le){if(K||!o.isFunction(Le))return o.inspect(Le);var ut=Ze(Le),Vt=ut?": "+ut:"";return"[Function"+Vt+"]"}function pt(Le){return ye(we(Le.actual),128)+" "+Le.operator+" "+ye(we(Le.expected),128)}function je(Le,ut,Vt,Zt,ir){throw new Y.AssertionError({message:Vt,actual:Le,expected:ut,operator:Zt,stackStartFunction:ir})}Y.fail=je;function Tt(Le,ut){Le||je(Le,!0,ut,"==",Y.ok)}Y.ok=Tt,Y.equal=function(ut,Vt,Zt){ut!=Vt&&je(ut,Vt,Zt,"==",Y.equal)},Y.notEqual=function(ut,Vt,Zt){ut==Vt&&je(ut,Vt,Zt,"!=",Y.notEqual)},Y.deepEqual=function(ut,Vt,Zt){Xe(ut,Vt,!1)||je(ut,Vt,Zt,"deepEqual",Y.deepEqual)},Y.deepStrictEqual=function(ut,Vt,Zt){Xe(ut,Vt,!0)||je(ut,Vt,Zt,"deepStrictEqual",Y.deepStrictEqual)};function Xe(Le,ut,Vt,Zt){if(Le===ut)return!0;if(z(Le)&&z(ut))return X(Le,ut)===0;if(o.isDate(Le)&&o.isDate(ut))return Le.getTime()===ut.getTime();if(o.isRegExp(Le)&&o.isRegExp(ut))return Le.source===ut.source&&Le.global===ut.global&&Le.multiline===ut.multiline&&Le.lastIndex===ut.lastIndex&&Le.ignoreCase===ut.ignoreCase;if((Le===null||typeof Le!="object")&&(ut===null||typeof ut!="object"))return Vt?Le===ut:Le==ut;if(de(Le)&&de(ut)&&re(Le)===re(ut)&&!(Le instanceof Float32Array||Le instanceof Float64Array))return X(new Uint8Array(Le.buffer),new Uint8Array(ut.buffer))===0;if(z(Le)!==z(ut))return!1;Zt=Zt||{actual:[],expected:[]};var ir=Zt.actual.indexOf(Le);return ir!==-1&&ir===Zt.expected.indexOf(ut)?!0:(Zt.actual.push(Le),Zt.expected.push(ut),Je(Le,ut,Vt,Zt))}function gt(Le){return Object.prototype.toString.call(Le)=="[object Arguments]"}function Je(Le,ut,Vt,Zt){if(Le==null||ut===null||ut===void 0)return!1;if(o.isPrimitive(Le)||o.isPrimitive(ut))return Le===ut;if(Vt&&Object.getPrototypeOf(Le)!==Object.getPrototypeOf(ut))return!1;var ir=gt(Le),oe=gt(ut);if(ir&&!oe||!ir&&oe)return!1;if(ir)return Le=D.call(Le),ut=D.call(ut),Xe(Le,ut,Vt);var Q=st(Le),H=st(ut),Ce,Ee;if(Q.length!==H.length)return!1;for(Q.sort(),H.sort(),Ee=Q.length-1;Ee>=0;Ee--)if(Q[Ee]!==H[Ee])return!1;for(Ee=Q.length-1;Ee>=0;Ee--)if(Ce=Q[Ee],!Xe(Le[Ce],ut[Ce],Vt,Zt))return!1;return!0}Y.notDeepEqual=function(ut,Vt,Zt){Xe(ut,Vt,!1)&&je(ut,Vt,Zt,"notDeepEqual",Y.notDeepEqual)},Y.notDeepStrictEqual=Et;function Et(Le,ut,Vt){Xe(Le,ut,!0)&&je(Le,ut,Vt,"notDeepStrictEqual",Et)}Y.strictEqual=function(ut,Vt,Zt){ut!==Vt&&je(ut,Vt,Zt,"===",Y.strictEqual)},Y.notStrictEqual=function(ut,Vt,Zt){ut===Vt&&je(ut,Vt,Zt,"!==",Y.notStrictEqual)};function _t(Le,ut){if(!Le||!ut)return!1;if(Object.prototype.toString.call(ut)=="[object RegExp]")return ut.test(Le);try{if(Le instanceof ut)return!0}catch(Vt){}return Error.isPrototypeOf(ut)?!1:ut.call({},Le)===!0}function Ne(Le){var ut;try{Le()}catch(Vt){ut=Vt}return ut}function ke(Le,ut,Vt,Zt){var ir;if(typeof ut!="function")throw new TypeError('"block" argument must be a function');typeof Vt=="string"&&(Zt=Vt,Vt=null),ir=Ne(ut),Zt=(Vt&&Vt.name?" ("+Vt.name+").":".")+(Zt?" "+Zt:"."),Le&&!ir&&je(ir,Vt,"Missing expected exception"+Zt);var oe=typeof Zt=="string",Q=!Le&&o.isError(ir),H=!Le&&ir&&!Vt;if((Q&&oe&&_t(ir,Vt)||H)&&je(ir,Vt,"Got unwanted exception"+Zt),Le&&ir&&Vt&&!_t(ir,Vt)||!Le&&ir)throw ir}Y.throws=function(Le,ut,Vt){ke(!0,Le,ut,Vt)},Y.doesNotThrow=function(Le,ut,Vt){ke(!1,Le,ut,Vt)},Y.ifError=function(Le){if(Le)throw Le};function Ue(Le,ut){Le||je(Le,!0,ut,"==",Ue)}Y.strict=m(Ue,Y,{equal:Y.strictEqual,deepEqual:Y.deepStrictEqual,notEqual:Y.notStrictEqual,notDeepEqual:Y.notDeepStrictEqual}),Y.strict.strict=Y.strict;var st=Object.keys||function(Le){var ut=[];for(var Vt in Le)Z.call(Le,Vt)&&ut.push(Vt);return ut}}).call(this,i("yLpj"))},"9nhX":function(Re,E,i){var T=i("g4R6"),m=i("tLB3");function X(z,o,Z){return Z===void 0&&(Z=o,o=void 0),Z!==void 0&&(Z=m(Z),Z=Z===Z?Z:0),o!==void 0&&(o=m(o),o=o===o?o:0),T(m(z),o,Z)}Re.exports=X},AFH1:function(Re,E,i){"use strict";i.d(E,"a",function(){return T});var T;(function(m){m.TOPRIGHT="topright",m.TOPLEFT="topleft",m.BOTTOMRIGHT="bottomright",m.BOTTOMLEFT="bottomleft"})(T||(T={}))},AKIq:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("/rf6");function m(de){if(!de)throw new Error("coord is required");if(!Array.isArray(de)){if(de.type==="Feature"&&de.geometry!==null&&de.geometry.type==="Point")return de.geometry.coordinates;if(de.type==="Point")return de.coordinates}if(Array.isArray(de)&&de.length>=2&&!Array.isArray(de[0])&&!Array.isArray(de[1]))return de;throw new Error("coord must be GeoJSON Point or an Array of numbers")}E.getCoord=m;function X(de){if(Array.isArray(de))return de;if(de.type==="Feature"){if(de.geometry!==null)return de.geometry.coordinates}else if(de.coordinates)return de.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}E.getCoords=X;function z(de){if(de.length>1&&T.isNumber(de[0])&&T.isNumber(de[1]))return!0;if(Array.isArray(de[0])&&de[0].length)return z(de[0]);throw new Error("coordinates must only contain numbers")}E.containsNumber=z;function o(de,Y,Fe){if(!Y||!Fe)throw new Error("type and name required");if(!de||de.type!==Y)throw new Error("Invalid input to "+Fe+": must be a "+Y+", given "+de.type)}E.geojsonType=o;function Z(de,Y,Fe){if(!de)throw new Error("No feature passed");if(!Fe)throw new Error(".featureOf() requires a name");if(!de||de.type!=="Feature"||!de.geometry)throw new Error("Invalid input to "+Fe+", Feature with geometry required");if(!de.geometry||de.geometry.type!==Y)throw new Error("Invalid input to "+Fe+": must be a "+Y+", given "+de.geometry.type)}E.featureOf=Z;function D(de,Y,Fe){if(!de)throw new Error("No featureCollection passed");if(!Fe)throw new Error(".collectionOf() requires a name");if(!de||de.type!=="FeatureCollection")throw new Error("Invalid input to "+Fe+", FeatureCollection required");for(var Ze=0,ye=de.features;Ze<ye.length;Ze++){var we=ye[Ze];if(!we||we.type!=="Feature"||!we.geometry)throw new Error("Invalid input to "+Fe+", Feature with geometry required");if(!we.geometry||we.geometry.type!==Y)throw new Error("Invalid input to "+Fe+": must be a "+Y+", given "+we.geometry.type)}}E.collectionOf=D;function K(de){return de.type==="Feature"?de.geometry:de}E.getGeom=K;function re(de,Y){return de.type==="FeatureCollection"?"FeatureCollection":de.type==="GeometryCollection"?"GeometryCollection":de.type==="Feature"&&de.geometry!==null?de.geometry.type:de.type}E.getType=re},APxj:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("Ucsi");function m(X,z){z===void 0&&(z=!0);var o=T.makePropertyInjectDecorator(X,z),Z=T.makePropertyInjectNamedDecorator(X,z),D=T.makePropertyInjectTaggedDecorator(X,z),K=T.makePropertyMultiInjectDecorator(X,z);return{lazyInject:o,lazyInjectNamed:Z,lazyInjectTagged:D,lazyMultiInject:K}}E.default=m},AwBQ:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("MON2"),m=function(){function X(){this._map=new Map}return X.prototype.getMap=function(){return this._map},X.prototype.add=function(z,o){if(z==null)throw new Error(T.NULL_ARGUMENT);if(o==null)throw new Error(T.NULL_ARGUMENT);var Z=this._map.get(z);Z!==void 0?(Z.push(o),this._map.set(z,Z)):this._map.set(z,[o])},X.prototype.get=function(z){if(z==null)throw new Error(T.NULL_ARGUMENT);var o=this._map.get(z);if(o!==void 0)return o;throw new Error(T.KEY_NOT_FOUND)},X.prototype.remove=function(z){if(z==null)throw new Error(T.NULL_ARGUMENT);if(!this._map.delete(z))throw new Error(T.KEY_NOT_FOUND)},X.prototype.removeByCondition=function(z){var o=this;this._map.forEach(function(Z,D){var K=Z.filter(function(re){return!z(re)});K.length>0?o._map.set(D,K):o._map.delete(D)})},X.prototype.hasKey=function(z){if(z==null)throw new Error(T.NULL_ARGUMENT);return this._map.has(z)},X.prototype.clone=function(){var z=new X;return this._map.forEach(function(o,Z){o.forEach(function(D){return z.add(Z,D.clone())})}),z},X.prototype.traverse=function(z){this._map.forEach(function(o,Z){z(Z,o)})},X}();E.Lookup=m},"B6l+":function(Re,E,i){var T=i("Sq3C"),m=i("Z1HP"),X=i("Sxd8"),z=i("dt0z");function o(Z,D,K){Z=z(Z),D=X(D);var re=D?m(Z):0;return D&&re<D?Z+T(D-re,K):Z}Re.exports=o},BGjm:function(Re,E){Re.exports=i;function i(T,m){m||(m=document);var X=m.head||m.getElementsByTagName("head")[0];if(!X){X=m.createElement("head");var z=m.body||m.getElementsByTagName("body")[0];z?z.parentNode.insertBefore(X,z):m.documentElement.appendChild(X)}var o=m.createElement("style");return o.type="text/css",o.styleSheet?o.styleSheet.cssText=T:o.appendChild(m.createTextNode(T)),X.appendChild(o),o}},BMrR:function(Re,E,i){"use strict";var T=i("qrJ5");E.a=T.a},BkRI:function(Re,E,i){var T=i("OBhP"),m=1,X=4;function z(o){return T(o,m|X)}Re.exports=z},BpBL:function(Re,E,i){"use strict";i.d(E,"a",function(){return m});var T=i("Hel2");function m(z,o){var Z=o.extent,D=new Promise(function(re){X(z,function(de){re(de)})}),K={images:D,_id:1,dataArray:[{_id:0,coordinates:[[Z[0],Z[1]],[Z[2],Z[3]]]}]};return K}function X(z,o){var Z=z,D=[];if(typeof Z=="string")Object(T.o)({url:Z},function(de,Y){D.push(Y),o(D)});else{var K=Z.length,re=0;Z.forEach(function(de){Object(T.o)({url:de},function(Y,Fe){re++,D.push(Fe),re===K&&o(D)})})}return m}},CIdX:function(Re,E,i){Re.exports={waterWave:"antd-pro-pages-dashboard-monitor-components-charts-water-wave-index-waterWave",text:"antd-pro-pages-dashboard-monitor-components-charts-water-wave-index-text",waterWaveCanvasWrapper:"antd-pro-pages-dashboard-monitor-components-charts-water-wave-index-waterWaveCanvasWrapper"}},CZoQ:function(Re,E){function i(T,m,X){for(var z=X-1,o=T.length;++z<o;)if(T[z]===m)return z;return-1}Re.exports=i},"D+ow":function(Re,E){},D9lx:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("6AGu"),m=i("406g"),X=i("z4Hk"),z=function(){function o(Z){this._binding=Z,this._bindingWhenSyntax=new X.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new m.BindingOnSyntax(this._binding),this._bindingInSyntax=new T.BindingInSyntax(Z)}return o.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},o.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},o.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},o.prototype.when=function(Z){return this._bindingWhenSyntax.when(Z)},o.prototype.whenTargetNamed=function(Z){return this._bindingWhenSyntax.whenTargetNamed(Z)},o.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},o.prototype.whenTargetTagged=function(Z,D){return this._bindingWhenSyntax.whenTargetTagged(Z,D)},o.prototype.whenInjectedInto=function(Z){return this._bindingWhenSyntax.whenInjectedInto(Z)},o.prototype.whenParentNamed=function(Z){return this._bindingWhenSyntax.whenParentNamed(Z)},o.prototype.whenParentTagged=function(Z,D){return this._bindingWhenSyntax.whenParentTagged(Z,D)},o.prototype.whenAnyAncestorIs=function(Z){return this._bindingWhenSyntax.whenAnyAncestorIs(Z)},o.prototype.whenNoAncestorIs=function(Z){return this._bindingWhenSyntax.whenNoAncestorIs(Z)},o.prototype.whenAnyAncestorNamed=function(Z){return this._bindingWhenSyntax.whenAnyAncestorNamed(Z)},o.prototype.whenAnyAncestorTagged=function(Z,D){return this._bindingWhenSyntax.whenAnyAncestorTagged(Z,D)},o.prototype.whenNoAncestorNamed=function(Z){return this._bindingWhenSyntax.whenNoAncestorNamed(Z)},o.prototype.whenNoAncestorTagged=function(Z,D){return this._bindingWhenSyntax.whenNoAncestorTagged(Z,D)},o.prototype.whenAnyAncestorMatches=function(Z){return this._bindingWhenSyntax.whenAnyAncestorMatches(Z)},o.prototype.whenNoAncestorMatches=function(Z){return this._bindingWhenSyntax.whenNoAncestorMatches(Z)},o.prototype.onActivation=function(Z){return this._bindingOnSyntax.onActivation(Z)},o}();E.BindingInWhenOnSyntax=z},"Dw+G":function(Re,E,i){var T=i("juv8"),m=i("mTTR");function X(z,o){return z&&T(o,m(o),z)}Re.exports=X},DzJC:function(Re,E,i){var T=i("sEfC"),m=i("GoyQ"),X="Expected a function";function z(o,Z,D){var K=!0,re=!0;if(typeof o!="function")throw new TypeError(X);return m(D)&&(K="leading"in D?!!D.leading:K,re="trailing"in D?!!D.trailing:re),T(o,Z,{leading:K,maxWait:Z,trailing:re})}Re.exports=z},EA7m:function(Re,E,i){var T=i("zZ0H"),m=i("Ioao"),X=i("wclG");function z(o,Z){return X(m(o,Z,T),o+"")}Re.exports=z},EEGq:function(Re,E,i){var T=i("juv8"),m=i("oCl/");function X(z,o){return T(z,m(z),o)}Re.exports=X},EfZ0:function(Re,E,i){"use strict";i.d(E,"a",function(){return T});var T={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"}},Em2t:function(Re,E,i){var T=i("bahg"),m=i("quyA"),X=i("0JQy");function z(o){return m(o)?X(o):T(o)}Re.exports=z},FI6e:function(Re,E){},FV85:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T={Request:"Request",Singleton:"Singleton",Transient:"Transient"};E.BindingScopeEnum=T;var m={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};E.BindingTypeEnum=m;var X={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};E.TargetTypeEnum=X},FmoU:function(Re,E,i){"use strict";i.d(E,"a",function(){return gt}),i.d(E,"b",function(){return Ne});var T=function(Q,H,Ce){Q.prototype=H.prototype=Ce,Ce.constructor=Q};function m(Q,H){var Ce=Object.create(Q.prototype);for(var Ee in H)Ce[Ee]=H[Ee];return Ce}function X(){}var z=.7,o=1/z,Z="\\s*([+-]?\\d+)\\s*",D="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",K="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",re=/^#([0-9a-f]{3,8})$/,de=new RegExp("^rgb\\("+[Z,Z,Z]+"\\)$"),Y=new RegExp("^rgb\\("+[K,K,K]+"\\)$"),Fe=new RegExp("^rgba\\("+[Z,Z,Z,D]+"\\)$"),Ze=new RegExp("^rgba\\("+[K,K,K,D]+"\\)$"),ye=new RegExp("^hsl\\("+[D,K,K]+"\\)$"),we=new RegExp("^hsla\\("+[D,K,K,D]+"\\)$"),pt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};T(X,gt,{copy:function(H){return Object.assign(new this.constructor,this,H)},displayable:function(){return this.rgb().displayable()},hex:je,formatHex:je,formatHsl:Tt,formatRgb:Xe,toString:Xe});function je(){return this.rgb().formatHex()}function Tt(){return Vt(this).formatHsl()}function Xe(){return this.rgb().formatRgb()}function gt(Q){var H,Ce;return Q=(Q+"").trim().toLowerCase(),(H=re.exec(Q))?(Ce=H[1].length,H=parseInt(H[1],16),Ce===6?Je(H):Ce===3?new ke(H>>8&15|H>>4&240,H>>4&15|H&240,(H&15)<<4|H&15,1):Ce===8?Et(H>>24&255,H>>16&255,H>>8&255,(H&255)/255):Ce===4?Et(H>>12&15|H>>8&240,H>>8&15|H>>4&240,H>>4&15|H&240,((H&15)<<4|H&15)/255):null):(H=de.exec(Q))?new ke(H[1],H[2],H[3],1):(H=Y.exec(Q))?new ke(H[1]*255/100,H[2]*255/100,H[3]*255/100,1):(H=Fe.exec(Q))?Et(H[1],H[2],H[3],H[4]):(H=Ze.exec(Q))?Et(H[1]*255/100,H[2]*255/100,H[3]*255/100,H[4]):(H=ye.exec(Q))?ut(H[1],H[2]/100,H[3]/100,1):(H=we.exec(Q))?ut(H[1],H[2]/100,H[3]/100,H[4]):pt.hasOwnProperty(Q)?Je(pt[Q]):Q==="transparent"?new ke(NaN,NaN,NaN,0):null}function Je(Q){return new ke(Q>>16&255,Q>>8&255,Q&255,1)}function Et(Q,H,Ce,Ee){return Ee<=0&&(Q=H=Ce=NaN),new ke(Q,H,Ce,Ee)}function _t(Q){return Q instanceof X||(Q=gt(Q)),Q?(Q=Q.rgb(),new ke(Q.r,Q.g,Q.b,Q.opacity)):new ke}function Ne(Q,H,Ce,Ee){return arguments.length===1?_t(Q):new ke(Q,H,Ce,Ee==null?1:Ee)}function ke(Q,H,Ce,Ee){this.r=+Q,this.g=+H,this.b=+Ce,this.opacity=+Ee}T(ke,Ne,m(X,{brighter:function(H){return H=H==null?o:Math.pow(o,H),new ke(this.r*H,this.g*H,this.b*H,this.opacity)},darker:function(H){return H=H==null?z:Math.pow(z,H),new ke(this.r*H,this.g*H,this.b*H,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ue,formatHex:Ue,formatRgb:st,toString:st}));function Ue(){return"#"+Le(this.r)+Le(this.g)+Le(this.b)}function st(){var Q=this.opacity;return Q=isNaN(Q)?1:Math.max(0,Math.min(1,Q)),(Q===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(Q===1?")":", "+Q+")")}function Le(Q){return Q=Math.max(0,Math.min(255,Math.round(Q)||0)),(Q<16?"0":"")+Q.toString(16)}function ut(Q,H,Ce,Ee){return Ee<=0?Q=H=Ce=NaN:Ce<=0||Ce>=1?Q=H=NaN:H<=0&&(Q=NaN),new ir(Q,H,Ce,Ee)}function Vt(Q){if(Q instanceof ir)return new ir(Q.h,Q.s,Q.l,Q.opacity);if(Q instanceof X||(Q=gt(Q)),!Q)return new ir;if(Q instanceof ir)return Q;Q=Q.rgb();var H=Q.r/255,Ce=Q.g/255,Ee=Q.b/255,Ae=Math.min(H,Ce,Ee),ge=Math.max(H,Ce,Ee),rt=NaN,Yt=ge-Ae,At=(ge+Ae)/2;return Yt?(H===ge?rt=(Ce-Ee)/Yt+(Ce<Ee)*6:Ce===ge?rt=(Ee-H)/Yt+2:rt=(H-Ce)/Yt+4,Yt/=At<.5?ge+Ae:2-ge-Ae,rt*=60):Yt=At>0&&At<1?0:rt,new ir(rt,Yt,At,Q.opacity)}function Zt(Q,H,Ce,Ee){return arguments.length===1?Vt(Q):new ir(Q,H,Ce,Ee==null?1:Ee)}function ir(Q,H,Ce,Ee){this.h=+Q,this.s=+H,this.l=+Ce,this.opacity=+Ee}T(ir,Zt,m(X,{brighter:function(H){return H=H==null?o:Math.pow(o,H),new ir(this.h,this.s,this.l*H,this.opacity)},darker:function(H){return H=H==null?z:Math.pow(z,H),new ir(this.h,this.s,this.l*H,this.opacity)},rgb:function(){var H=this.h%360+(this.h<0)*360,Ce=isNaN(H)||isNaN(this.s)?0:this.s,Ee=this.l,Ae=Ee+(Ee<.5?Ee:1-Ee)*Ce,ge=2*Ee-Ae;return new ke(oe(H>=240?H-240:H+120,ge,Ae),oe(H,ge,Ae),oe(H<120?H+240:H-120,ge,Ae),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var H=this.opacity;return H=isNaN(H)?1:Math.max(0,Math.min(1,H)),(H===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(H===1?")":", "+H+")")}}));function oe(Q,H,Ce){return(Q<60?H+(Ce-H)*Q/60:Q<180?Ce:Q<240?H+(Ce-H)*(240-Q)/60:H)*255}},G6z8:function(Re,E,i){var T=i("fR/l"),m=i("oCl/"),X=i("mTTR");function z(o){return T(o,X,m)}Re.exports=z},GXnB:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("xfSm"),m=function(){function X(z,o){this.key=z,this.value=o}return X.prototype.toString=function(){return this.key===T.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},X}();E.Metadata=m},Gi0A:function(Re,E,i){var T=i("QqLw"),m=i("ExA7"),X="[object Map]";function z(o){return m(o)&&T(o)==X}Re.exports=z},"H+7v":function(Re,E,i){Re.exports={activeChart:"antd-pro-pages-dashboard-monitor-components-active-chart-index-activeChart",activeChartGrid:"antd-pro-pages-dashboard-monitor-components-active-chart-index-activeChartGrid",activeChartLegend:"antd-pro-pages-dashboard-monitor-components-active-chart-index-activeChartLegend",dashedLine:"antd-pro-pages-dashboard-monitor-components-active-chart-index-dashedLine",line:"antd-pro-pages-dashboard-monitor-components-active-chart-index-line"}},HTcj:function(Re,E,i){"use strict";var T=i("GNNt"),m=i("wEI+"),X=i("kZZr"),z=i.n(X),o=i("q1tI"),Z=i.n(o),D=i("TSYQ"),K=i.n(D),re=i("jYQm"),de=function(Fe){var Ze=Object(o.useContext)(re.a),ye=Fe.children,we=Fe.contentWidth,pt=Fe.className,je=Fe.style,Tt=Object(o.useContext)(m.b.ConfigContext),Xe=Tt.getPrefixCls,gt=Fe.prefixCls||Xe("pro"),Je=we||Ze.contentWidth,Et="".concat(gt,"-grid-content");return Z.a.createElement("div",{className:K()(Et,pt,{wide:Je==="Fixed"}),style:je},Z.a.createElement("div",{className:"".concat(gt,"-grid-content-children")},ye))};E.a=de},Hel2:function(Re,E,i){"use strict";i.d(E,"o",function(){return At}),i.d(E,"m",function(){return Pe}),i.d(E,"p",function(){return q}),i.d(E,"d",function(){return nt}),i.d(E,"q",function(){return $}),i.d(E,"r",function(){return ae}),i.d(E,"j",function(){return et}),i.d(E,"h",function(){return jt}),i.d(E,"b",function(){return sr}),i.d(E,"i",function(){return ft}),i.d(E,"s",function(){return Ct}),i.d(E,"k",function(){return vt}),i.d(E,"l",function(){return Oe}),i.d(E,"n",function(){return ct}),i.d(E,"f",function(){return Qe}),i.d(E,"e",function(){return Ft}),i.d(E,"g",function(){return vr}),i.d(E,"a",function(){return T}),i.d(E,"c",function(){return m});var T={};i.r(T),i.d(T,"getContainer",function(){return Z}),i.d(T,"trim",function(){return D}),i.d(T,"splitWords",function(){return K}),i.d(T,"create",function(){return de}),i.d(T,"remove",function(){return Y}),i.d(T,"addClass",function(){return Fe}),i.d(T,"removeClass",function(){return Ze}),i.d(T,"hasClass",function(){return ye}),i.d(T,"setClass",function(){return we}),i.d(T,"getClass",function(){return pt}),i.d(T,"empty",function(){return je}),i.d(T,"setTransform",function(){return Xe}),i.d(T,"triggerResize",function(){return gt}),i.d(T,"printCanvas",function(){return Je});var m={};i.r(m),i.d(m,"sum",function(){return Nn}),i.d(m,"max",function(){return Vr}),i.d(m,"min",function(){return lr}),i.d(m,"mean",function(){return vn}),i.d(m,"mode",function(){return na}),i.d(m,"statMap",function(){return ha}),i.d(m,"getColumn",function(){return Zn}),i.d(m,"getSatByColumn",function(){return Hn});function X(F){var W=131,le=137,me=0;F+="x";for(var at=Math.floor(9007199254740991/le),bt=0;bt<F.length;bt++)me>at&&(me=Math.floor(me/le)),me=me*W+F.charCodeAt(bt);return me}function z(F){F=F.toString();for(var W=5381,le=F.length;le;)W=W*33^F.charCodeAt(--le);return W>>>0}var o=window.document.documentElement.style;function Z(F){var W=F;return typeof F=="string"&&(W=document.getElementById(F)),W}function D(F){return F.trim?F.trim():F.replace(/^\s+|\s+$/g,"")}function K(F){return D(F).split(/\s+/)}function re(F){if(!o)return F[0];for(var W in F)if(F[W]&&F[W]in o)return F[W];return F[0]}function de(F,W,le){var me=document.createElement(F);return me.className=W||"",le&&le.appendChild(me),me}function Y(F){var W=F.parentNode;W&&W.removeChild(F)}function Fe(F,W){if(F.classList!==void 0)for(var le=K(W),me=0,at=le.length;me<at;me++)F.classList.add(le[me]);else if(!ye(F,W)){var bt=pt(F);we(F,(bt?bt+" ":"")+W)}}function Ze(F,W){F.classList!==void 0?F.classList.remove(W):we(F,D((" "+pt(F)+" ").replace(" "+W+" "," ")))}function ye(F,W){if(F.classList!==void 0)return F.classList.contains(W);var le=pt(F);return le.length>0&&new RegExp("(^|\\s)"+W+"(\\s|$)").test(le)}function we(F,W){F instanceof HTMLElement?F.className=W:F.className.baseVal=W}function pt(F){return F instanceof SVGElement&&(F=F.correspondingElement),F.className.baseVal===void 0?F.className:F.className.baseVal}function je(F){for(;F&&F.firstChild;)F.removeChild(F.firstChild)}var Tt=re(["transform","WebkitTransform"]);function Xe(F,W){F.style[Tt]=W}function gt(){if(typeof Event=="function")window.dispatchEvent(new Event("resize"));else{var F=window.document.createEvent("UIEvents");F.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(F)}}function Je(F){var W=["padding: "+(F.height/2-8)+"px "+F.width/2+"px;","line-height: "+F.height+"px;","background-image: url("+F.toDataURL()+");"];console.log(`%c
`,W.join(""))}var Et=i("lwsE"),_t=i.n(Et),Ne=i("W8MJ"),ke=i.n(Ne),Ue=i("7W2i"),st=i.n(Ue),Le=i("a1gu"),ut=i.n(Le),Vt=i("Nsbk"),Zt=i.n(Vt),ir=i("oShl"),oe=i.n(ir);function Q(F){var W=H();return function(){var me=Zt()(F),at;if(W){var bt=Zt()(this).constructor;at=Reflect.construct(me,arguments,bt)}else at=me.apply(this,arguments);return ut()(this,at)}}function H(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(F){return!1}}var Ce=function(F){st()(le,F);var W=Q(le);function le(me,at,bt){var He;return _t()(this,le),He=W.call(this,me),He.status=void 0,He.url=void 0,He.status=at,He.url=bt,He.name=He.constructor.name,He.message=me,He}return ke()(le,[{key:"toString",value:function(){return"".concat(this.name,": ").concat(this.message," (").concat(this.status,"): ").concat(this.url)}}]),le}(oe()(Error));function Ee(F){var W=new XMLHttpRequest;W.open("GET",F.url,!0);for(var le in F.headers)F.headers.hasOwnProperty(le)&&W.setRequestHeader(le,F.headers[le]);return W.withCredentials=F.credentials==="include",W}var Ae=function(W,le){var me=Ee(W);return me.setRequestHeader("Accept","application/json"),me.onerror=function(){le(new Error(me.statusText))},me.onload=function(){if(me.status>=200&&me.status<300&&me.response){var at;try{at=JSON.parse(me.response)}catch(bt){return le(bt)}le(null,at)}else me.status===401?le(new Ce("".concat(me.statusText),me.status,W.url)):le(new Ce(me.statusText,me.status,W.url))},me.send(),me},ge=function(W,le){var me=Ee(W);return me.responseType="arraybuffer",me.onerror=function(){le(new Error(me.statusText))},me.onload=function(){var at=me.response;if(at.byteLength===0&&me.status===200)return le(new Error("http status 200 returned without content."));me.status>=200&&me.status<300&&me.response?le(null,{data:at,cacheControl:me.getResponseHeader("Cache-Control"),expires:me.getResponseHeader("Expires")}):le(new Ce(me.statusText,me.status,W.url))},me.send(),me};function rt(F){var W=window.document.createElement("a");return W.href=F,W.protocol===window.document.location.protocol&&W.host===window.document.location.host}var Yt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",At=function(W,le){return ge(W,function(me,at){if(me)le(me);else if(at){var bt=new window.Image;bt.crossOrigin="anonymous";var He=window.URL||window.webkitURL;bt.onload=function(){le(null,bt),He.revokeObjectURL(bt.src)};var ht=new window.Blob([new Uint8Array(at.data)],{type:"image/png"});bt.src=at.data.byteLength?He.createObjectURL(ht):Yt}})},be=i("J4zp"),xe=i.n(be),Ve=i("/rf6"),lt=2*Math.PI*6378137/2;function Pe(F){var W=[Infinity,Infinity,-Infinity,-Infinity];return F.forEach(function(le){var me=le.coordinates;dt(W,me)}),W}function dt(F,W){return Array.isArray(W[0])?W.forEach(function(le){dt(F,le)}):(F[0]>W[0]&&(F[0]=W[0]),F[1]>W[1]&&(F[1]=W[1]),F[2]<W[0]&&(F[2]=W[0]),F[3]<W[1]&&(F[3]=W[1])),F}function w(F,W){return I(F,W)}function I(F,W){return Array.isArray(F[0])?F.map(function(le){return I(le,W)}):W(F)}function q(F){var W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,le=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{enable:!0,decimal:1};F=yt(F,W);var me=F[0],at=F[1],bt=me*lt/180,He=Math.log(Math.tan((90+at)*Math.PI/360))/(Math.PI/180);return He=He*lt/180,le.enable&&(bt=Number(bt.toFixed(le.decimal)),He=Number(He.toFixed(le.decimal))),F.length===3?[bt,He,F[2]]:[bt,He]}function ce(F){var W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,le=F[0],me=F[1],at=le/lt*180,bt=me/lt*180;return bt=180/Math.PI*(2*Math.atan(Math.exp(bt*Math.PI/180))-Math.PI/2),W!=null&&(at=Number(at.toFixed(W)),bt=Number(bt.toFixed(W))),F.length===3?[at,bt,F[2]]:[at,bt]}function Ge(F){if(F==null)throw new Error("lng is required");return(F>180||F<-180)&&(F=F%360,F>180&&(F=-360+F),F<-180&&(F=360+F),F===0&&(F=0)),F}function $e(F){if(F==null)throw new Error("lat is required");return(F>90||F<-90)&&(F=F%180,F>90&&(F=-180+F),F<-90&&(F=180+F),F===0&&(F=0)),F}function yt(F,W){if(W===!1)return F;var le=Ge(F[0]),me=$e(F[1]);return me>85&&(me=85),me<-85&&(me=-85),F.length===3?[le,me,F[2]]:[le,me]}function nt(F){var W=85.0511287798,le=Math.max(Math.min(W,F[1]),-W),me=256<<20,at=Math.PI/180,bt=F[0]*at,He=le*at;He=Math.log(Math.tan(Math.PI/4+He/2));var ht=.5/Math.PI,Qt=.5,qt=-.5/Math.PI;return at=.5,bt=me*(ht*bt+Qt),He=me*(qt*He+at),[Math.floor(bt),Math.floor(He)]}function Nt(F){var W=.5/Math.PI,le=.5,me=-.5/Math.PI,at=.5,bt=256<<20,He=xe()(F,2),ht=He[0],Qt=He[1];ht=(ht/bt-le)/W,Qt=(Qt/bt-at)/me,Qt=(Math.atan(Math.pow(Math.E,Qt))-Math.PI/4)*2,at=Math.PI/180;var qt=Qt/at,Nr=ht/at;return[Nr,qt]}function $(F,W,le){var me=Object(Ve.degreesToRadians)(W[1]-F[1]),at=Object(Ve.degreesToRadians)(W[0]-F[0]),bt=Object(Ve.degreesToRadians)(F[1]),He=Object(Ve.degreesToRadians)(W[1]),ht=Math.pow(Math.sin(me/2),2)+Math.pow(Math.sin(at/2),2)*Math.cos(bt)*Math.cos(He);return Object(Ve.radiansToLength)(2*Math.atan2(Math.sqrt(ht),Math.sqrt(1-ht)),le="meters")}function Ke(F){var W=Math.PI/180,le=85.0511287798,me=6378137,at=Math.max(Math.min(le,F[1]),-le),bt=Math.sin(at*W),He=me*F[0]*W,ht=me*Math.log((1+bt)/(1-bt))/2;return[He,ht]}function ae(F,W){var le=Math.abs(F[1][1]-F[0][1])*W,me=Math.abs(F[1][0]-F[0][0])*W;return[[F[0][0]-me,F[0][1]-le],[F[1][0]+me,F[1][1]+le]]}function et(F,W){return F[0][0]<=W[0][0]&&F[0][1]<=W[0][1]&&F[1][0]>=W[1][0]&&F[1][1]>=W[1][1]}function jt(F){return[[F[0],F[1]],[F[2],F[3]]]}var sr=function(){function F(){var W=arguments.length>0&&arguments[0]!==void 0?arguments[0]:50,le=arguments.length>1?arguments[1]:void 0;_t()(this,F),this.limit=void 0,this.cache=void 0,this.destroy=void 0,this.order=void 0,this.limit=W,this.destroy=le||this.defaultDestroy,this.order=[],this.clear()}return ke()(F,[{key:"clear",value:function(){var le=this;this.order.forEach(function(me){le.delete(me)}),this.cache={},this.order=[]}},{key:"get",value:function(le){var me=this.cache[le];return me&&(this.deleteOrder(le),this.appendOrder(le)),me}},{key:"set",value:function(le,me){this.cache[le]?(this.delete(le),this.cache[le]=me,this.appendOrder(le)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[le]=me,this.appendOrder(le))}},{key:"delete",value:function(le){var me=this.cache[le];me&&(this.deleteCache(le),this.deleteOrder(le),this.destroy(me,le))}},{key:"deleteCache",value:function(le){delete this.cache[le]}},{key:"deleteOrder",value:function(le){var me=this.order.findIndex(function(at){return at===le});me>=0&&this.order.splice(me,1)}},{key:"appendOrder",value:function(le){this.order.push(le)}},{key:"defaultDestroy",value:function(le,me){return null}}]),F}();function ft(F,W){F.forEach(function(le){if(!W[le])return;W[le]=W[le].bind(W)})}var mt=i("FmoU");function Ct(F){var W=mt.a(F),le=[0,0,0,0];return W!=null&&(le[0]=W.r/255,le[1]=W.g/255,le[2]=W.b/255,le[3]=W.opacity),le}function vt(F){var W=F&&F[0],le=F&&F[1],me=F&&F[2],at=W+le*256+me*65536-1;return at}function Oe(F){return[F+1&255,F+1>>8&255,F+1>>8>>8&255]}function ct(F){var W=document.createElement("canvas"),le=W.getContext("2d");W.width=256,W.height=1;for(var me=le.createLinearGradient(0,0,256,1),at=null,bt=F.positions[0],He=F.positions[F.positions.length-1],ht=0;ht<F.colors.length;++ht){var Qt=(F.positions[ht]-bt)/(He-bt);me.addColorStop(Qt,F.colors[ht])}return le.fillStyle=me,le.fillRect(0,0,256,1),at=new Uint8ClampedArray(le.getImageData(0,0,256,1).data),new ImageData(at,256,1)}var Qe;(function(F){F.CENTER="center",F.TOP="top",F["TOP-LEFT"]="top-left",F["TOP-RIGHT"]="top-right",F.BOTTOM="bottom",F["BOTTOM-LEFT"]="bottom-left",F.LEFT="left",F.RIGHT="right"})(Qe||(Qe={}));var Ft={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function vr(F,W,le){var me=F.classList;for(var at in Ft)Ft.hasOwnProperty(at)&&me.remove("l7-".concat(le,"-anchor-").concat(at));me.add("l7-".concat(le,"-anchor-").concat(W))}function Vr(F){if(F.length===0)throw new Error("max requires at least one data point");for(var W=F[0],le=1;le<F.length;le++)F[le]>W&&(W=F[le]);return W*1}function lr(F){if(F.length===0)throw new Error("min requires at least one data point");for(var W=F[0],le=1;le<F.length;le++)F[le]<W&&(W=F[le]);return W*1}function Nn(F){if(F.length===0)return 0;for(var W=F[0]*1,le=1;le<F.length;le++)W+=F[le]*1;return W}function vn(F){if(F.length===0)throw new Error("mean requires at least one data point");return Nn(F)/F.length}function na(F){if(F.length===0)throw new Error("mean requires at least one data point");if(F.length<3)return F[0];F.sort();for(var W=F[0],le=NaN,me=0,at=1,bt=1;bt<F.length+1;bt++)F[bt]!==W?(at>me&&(me=at,le=W),at=1,W=F[bt]):at++;return le*1}var ha={min:lr,max:Vr,mean:vn,sum:Nn,mode:na};function Zn(F,W){return F.map(function(le){return le[W]})}function Hn(F,W){return ha[F](W)}},HpQ9:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=function(){function m(){}return m.of=function(X,z){var o=new m;return o.bindings=X,o.middleware=z,o},m}();E.ContainerSnapshot=T},HthE:function(Re,E,i){"use strict";i.d(E,"a",function(){return T}),i.d(E,"b",function(){return m});var T;(function(X){X[X.LNGLAT=1]="LNGLAT",X[X.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",X[X.VECTOR_TILE=3]="VECTOR_TILE",X[X.IDENTITY=4]="IDENTITY",X[X.P20=5]="P20",X[X.P20_OFFSET=6]="P20_OFFSET",X[X.METER_OFFSET=7]="METER_OFFSET"})(T||(T={}));var m={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter"}},I0ug:function(Re,E,i){"use strict";(function(T){i.d(E,"a",function(){return X});var m=i("U8pU");function X(z){if(typeof window!="undefined"&&Object(m.a)(window.process)==="object"&&window.process.type==="renderer")return!0;if(typeof T!="undefined"&&Object(m.a)(T.versions)==="object"&&Boolean(T.versions.electron))return!0;var o=(typeof navigator=="undefined"?"undefined":Object(m.a)(navigator))==="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,Z=z||o;return!!(Z&&Z.indexOf("Electron")>=0)}}).call(this,i("Q2Ig"))},IOcx:function(Re,E,i){"use strict";i.d(E,"a",function(){return T}),i.d(E,"b",function(){return ut}),i.d(E,"c",function(){return Vt}),i.d(E,"d",function(){return Zt}),i.d(E,"e",function(){return ir});var T={};i.r(T),i.d(T,"create",function(){return X}),i.d(T,"clone",function(){return z}),i.d(T,"copy",function(){return o}),i.d(T,"identity",function(){return Z}),i.d(T,"fromValues",function(){return D}),i.d(T,"set",function(){return K}),i.d(T,"transpose",function(){return re}),i.d(T,"invert",function(){return de}),i.d(T,"adjoint",function(){return Y}),i.d(T,"determinant",function(){return Fe}),i.d(T,"multiply",function(){return Ze}),i.d(T,"rotate",function(){return ye}),i.d(T,"scale",function(){return we}),i.d(T,"fromRotation",function(){return pt}),i.d(T,"fromScaling",function(){return je}),i.d(T,"str",function(){return Tt}),i.d(T,"frob",function(){return Xe}),i.d(T,"LDU",function(){return gt}),i.d(T,"add",function(){return Je}),i.d(T,"subtract",function(){return Et}),i.d(T,"exactEquals",function(){return _t}),i.d(T,"equals",function(){return Ne}),i.d(T,"multiplyScalar",function(){return ke}),i.d(T,"multiplyScalarAndAdd",function(){return Ue}),i.d(T,"mul",function(){return st}),i.d(T,"sub",function(){return Le});var m=i("yU0y");function X(){var oe=new m.a(4);return m.a!=Float32Array&&(oe[1]=0,oe[2]=0),oe[0]=1,oe[3]=1,oe}function z(oe){var Q=new m.a(4);return Q[0]=oe[0],Q[1]=oe[1],Q[2]=oe[2],Q[3]=oe[3],Q}function o(oe,Q){return oe[0]=Q[0],oe[1]=Q[1],oe[2]=Q[2],oe[3]=Q[3],oe}function Z(oe){return oe[0]=1,oe[1]=0,oe[2]=0,oe[3]=1,oe}function D(oe,Q,H,Ce){var Ee=new m.a(4);return Ee[0]=oe,Ee[1]=Q,Ee[2]=H,Ee[3]=Ce,Ee}function K(oe,Q,H,Ce,Ee){return oe[0]=Q,oe[1]=H,oe[2]=Ce,oe[3]=Ee,oe}function re(oe,Q){if(oe===Q){var H=Q[1];oe[1]=Q[2],oe[2]=H}else oe[0]=Q[0],oe[1]=Q[2],oe[2]=Q[1],oe[3]=Q[3];return oe}function de(oe,Q){var H=Q[0],Ce=Q[1],Ee=Q[2],Ae=Q[3],ge=H*Ae-Ee*Ce;return ge?(ge=1/ge,oe[0]=Ae*ge,oe[1]=-Ce*ge,oe[2]=-Ee*ge,oe[3]=H*ge,oe):null}function Y(oe,Q){var H=Q[0];return oe[0]=Q[3],oe[1]=-Q[1],oe[2]=-Q[2],oe[3]=H,oe}function Fe(oe){return oe[0]*oe[3]-oe[2]*oe[1]}function Ze(oe,Q,H){var Ce=Q[0],Ee=Q[1],Ae=Q[2],ge=Q[3],rt=H[0],Yt=H[1],At=H[2],be=H[3];return oe[0]=Ce*rt+Ae*Yt,oe[1]=Ee*rt+ge*Yt,oe[2]=Ce*At+Ae*be,oe[3]=Ee*At+ge*be,oe}function ye(oe,Q,H){var Ce=Q[0],Ee=Q[1],Ae=Q[2],ge=Q[3],rt=Math.sin(H),Yt=Math.cos(H);return oe[0]=Ce*Yt+Ae*rt,oe[1]=Ee*Yt+ge*rt,oe[2]=Ce*-rt+Ae*Yt,oe[3]=Ee*-rt+ge*Yt,oe}function we(oe,Q,H){var Ce=Q[0],Ee=Q[1],Ae=Q[2],ge=Q[3],rt=H[0],Yt=H[1];return oe[0]=Ce*rt,oe[1]=Ee*rt,oe[2]=Ae*Yt,oe[3]=ge*Yt,oe}function pt(oe,Q){var H=Math.sin(Q),Ce=Math.cos(Q);return oe[0]=Ce,oe[1]=H,oe[2]=-H,oe[3]=Ce,oe}function je(oe,Q){return oe[0]=Q[0],oe[1]=0,oe[2]=0,oe[3]=Q[1],oe}function Tt(oe){return"mat2("+oe[0]+", "+oe[1]+", "+oe[2]+", "+oe[3]+")"}function Xe(oe){return Math.hypot(oe[0],oe[1],oe[2],oe[3])}function gt(oe,Q,H,Ce){return oe[2]=Ce[2]/Ce[0],H[0]=Ce[0],H[1]=Ce[1],H[3]=Ce[3]-oe[2]*H[1],[oe,Q,H]}function Je(oe,Q,H){return oe[0]=Q[0]+H[0],oe[1]=Q[1]+H[1],oe[2]=Q[2]+H[2],oe[3]=Q[3]+H[3],oe}function Et(oe,Q,H){return oe[0]=Q[0]-H[0],oe[1]=Q[1]-H[1],oe[2]=Q[2]-H[2],oe[3]=Q[3]-H[3],oe}function _t(oe,Q){return oe[0]===Q[0]&&oe[1]===Q[1]&&oe[2]===Q[2]&&oe[3]===Q[3]}function Ne(oe,Q){var H=oe[0],Ce=oe[1],Ee=oe[2],Ae=oe[3],ge=Q[0],rt=Q[1],Yt=Q[2],At=Q[3];return Math.abs(H-ge)<=m.b*Math.max(1,Math.abs(H),Math.abs(ge))&&Math.abs(Ce-rt)<=m.b*Math.max(1,Math.abs(Ce),Math.abs(rt))&&Math.abs(Ee-Yt)<=m.b*Math.max(1,Math.abs(Ee),Math.abs(Yt))&&Math.abs(Ae-At)<=m.b*Math.max(1,Math.abs(Ae),Math.abs(At))}function ke(oe,Q,H){return oe[0]=Q[0]*H,oe[1]=Q[1]*H,oe[2]=Q[2]*H,oe[3]=Q[3]*H,oe}function Ue(oe,Q,H,Ce){return oe[0]=Q[0]+H[0]*Ce,oe[1]=Q[1]+H[1]*Ce,oe[2]=Q[2]+H[2]*Ce,oe[3]=Q[3]+H[3]*Ce,oe}var st=Ze,Le=Et,ut=i("ZaHm"),Vt=i("ZxFD"),Zt=i("n+fv"),ir=i("bl9R")},ISu3:function(Re,E,i){"use strict";i.d(E,"a",function(){return X}),i.d(E,"c",function(){return z}),i.d(E,"b",function(){return o}),i.d(E,"d",function(){return Z});var T={},m={},X=function(K){return m[K]},z=function(K,re){m[K]=re},o=function(K){return T[K]},Z=function(K,re){T[K]=re}},Ioao:function(Re,E,i){var T=i("heNW"),m=Math.max;function X(z,o,Z){return o=m(o===void 0?z.length-1:o,0),function(){for(var D=arguments,K=-1,re=m(D.length-o,0),de=Array(re);++K<re;)de[K]=D[o+K];K=-1;for(var Y=Array(o+1);++K<o;)Y[K]=D[K];return Y[o]=Z(de),T(z,this,Y)}}Re.exports=X},J2iB:function(Re,E){function i(T){return T==null}Re.exports=i},J7lC:function(Re,E){},K9nA:function(Re,E,i){"use strict";(function(T,m){i.d(E,"b",function(){return Z}),i.d(E,"a",function(){return re});var X=i("U8pU"),z={self:typeof self!="undefined"&&self,window:typeof window!="undefined"&&window,global:typeof T!="undefined"&&T,document:typeof document!="undefined"&&document,process:(typeof m=="undefined"?"undefined":Object(X.a)(m))==="object"&&m},o=z.self||z.window||z.global,Z=z.window||z.self||z.global,D=z.global||z.self||z.window,K=z.document||{},re=z.process||{},de=console}).call(this,i("yLpj"),i("Q2Ig"))},KKCa:function(Re,E){typeof Object.create=="function"?Re.exports=function(T,m){T.super_=m,T.prototype=Object.create(m.prototype,{constructor:{value:T,enumerable:!1,writable:!0,configurable:!0}})}:Re.exports=function(T,m){T.super_=m;var X=function(){};X.prototype=m.prototype,T.prototype=new X,T.prototype.constructor=T}},KwMD:function(Re,E){function i(T,m,X,z){for(var o=T.length,Z=X+(z?1:-1);z?Z--:++Z<o;)if(m(T[Z],Z,T))return Z;return-1}Re.exports=i},KxBF:function(Re,E){function i(T,m,X){var z=-1,o=T.length;m<0&&(m=-m>o?0:o+m),X=X>o?o:X,X<0&&(X+=o),o=m>X?0:X-m>>>0,m>>>=0;for(var Z=Array(o);++z<o;)Z[z]=T[z+m];return Z}Re.exports=i},L56e:function(Re,E,i){"use strict";i.d(E,"a",function(){return T});var T=["mapload"]},LGYb:function(Re,E,i){var T=i("1hJj"),m=i("jbM+"),X=i("Xt/L"),z=i("xYSL"),o=i("dQpi"),Z=i("rEGp"),D=200;function K(re,de,Y){var Fe=-1,Ze=m,ye=re.length,we=!0,pt=[],je=pt;if(Y)we=!1,Ze=X;else if(ye>=D){var Tt=de?null:o(re);if(Tt)return Z(Tt);we=!1,Ze=z,je=new T}else je=de?[]:pt;e:for(;++Fe<ye;){var Xe=re[Fe],gt=de?de(Xe):Xe;if(Xe=Y||Xe!==0?Xe:0,we&&gt===gt){for(var Je=je.length;Je--;)if(je[Je]===gt)continue e;de&&je.push(gt),pt.push(Xe)}else Ze(je,gt,Y)||(je!==pt&&je.push(gt),pt.push(Xe))}return pt}Re.exports=K},LKzl:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("406g"),m=i("z4Hk"),X=function(){function z(o){this._binding=o,this._bindingWhenSyntax=new m.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new T.BindingOnSyntax(this._binding)}return z.prototype.when=function(o){return this._bindingWhenSyntax.when(o)},z.prototype.whenTargetNamed=function(o){return this._bindingWhenSyntax.whenTargetNamed(o)},z.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},z.prototype.whenTargetTagged=function(o,Z){return this._bindingWhenSyntax.whenTargetTagged(o,Z)},z.prototype.whenInjectedInto=function(o){return this._bindingWhenSyntax.whenInjectedInto(o)},z.prototype.whenParentNamed=function(o){return this._bindingWhenSyntax.whenParentNamed(o)},z.prototype.whenParentTagged=function(o,Z){return this._bindingWhenSyntax.whenParentTagged(o,Z)},z.prototype.whenAnyAncestorIs=function(o){return this._bindingWhenSyntax.whenAnyAncestorIs(o)},z.prototype.whenNoAncestorIs=function(o){return this._bindingWhenSyntax.whenNoAncestorIs(o)},z.prototype.whenAnyAncestorNamed=function(o){return this._bindingWhenSyntax.whenAnyAncestorNamed(o)},z.prototype.whenAnyAncestorTagged=function(o,Z){return this._bindingWhenSyntax.whenAnyAncestorTagged(o,Z)},z.prototype.whenNoAncestorNamed=function(o){return this._bindingWhenSyntax.whenNoAncestorNamed(o)},z.prototype.whenNoAncestorTagged=function(o,Z){return this._bindingWhenSyntax.whenNoAncestorTagged(o,Z)},z.prototype.whenAnyAncestorMatches=function(o){return this._bindingWhenSyntax.whenAnyAncestorMatches(o)},z.prototype.whenNoAncestorMatches=function(o){return this._bindingWhenSyntax.whenNoAncestorMatches(o)},z.prototype.onActivation=function(o){return this._bindingOnSyntax.onActivation(o)},z}();E.BindingWhenOnSyntax=X},LcsW:function(Re,E,i){var T=i("kekF"),m=T(Object.getPrototypeOf,Object);Re.exports=m},LgvC:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("FV85"),m=i("d9O0"),X=function(){function z(o,Z){this.id=m.id(),this.activated=!1,this.serviceIdentifier=o,this.scope=Z,this.type=T.BindingTypeEnum.Invalid,this.constraint=function(D){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return z.prototype.clone=function(){var o=new z(this.serviceIdentifier,this.scope);return o.activated=!1,o.implementationType=this.implementationType,o.dynamicValue=this.dynamicValue,o.scope=this.scope,o.type=this.type,o.factory=this.factory,o.provider=this.provider,o.constraint=this.constraint,o.onActivation=this.onActivation,o.cache=this.cache,o},z}();E.Binding=X},LsHQ:function(Re,E,i){var T=i("EA7m"),m=i("mv/X");function X(z){return T(function(o,Z){var D=-1,K=Z.length,re=K>1?Z[K-1]:void 0,de=K>2?Z[2]:void 0;for(re=z.length>3&&typeof re=="function"?(K--,re):void 0,de&&m(Z[0],Z[1],de)&&(re=K<3?void 0:re,K=1),o=Object(o);++D<K;){var Y=Z[D];Y&&z(o,Y,D,re)}return o})}Re.exports=X},LvWW:function(Re,E,i){var T=i("mhV4");Re.exports=m;function m(K,re){switch(K&&K.type||null){case"FeatureCollection":return K.features=K.features.map(X(m,re)),K;case"GeometryCollection":return K.geometries=K.geometries.map(X(m,re)),K;case"Feature":return K.geometry=m(K.geometry,re),K;case"Polygon":case"MultiPolygon":return z(K,re);default:return K}}function X(K,re){return function(de){return K(de,re)}}function z(K,re){return K.type==="Polygon"?K.coordinates=o(K.coordinates,re):K.type==="MultiPolygon"&&(K.coordinates=K.coordinates.map(X(o,re))),K}function o(K,re){re=!!re,K[0]=Z(K[0],re);for(var de=1;de<K.length;de++)K[de]=Z(K[de],!re);return K}function Z(K,re){return D(K)===re?K:K.reverse()}function D(K){return T.ring(K)>=0}},MCLT:function(Re,E,i){(function(T){var m=Object.getOwnPropertyDescriptors||function(ge){for(var rt=Object.keys(ge),Yt={},At=0;At<rt.length;At++)Yt[rt[At]]=Object.getOwnPropertyDescriptor(ge,rt[At]);return Yt},X=/%[sdj%]/g;E.format=function(Ae){if(!Je(Ae)){for(var ge=[],rt=0;rt<arguments.length;rt++)ge.push(Z(arguments[rt]));return ge.join(" ")}for(var rt=1,Yt=arguments,At=Yt.length,be=String(Ae).replace(X,function(Ve){if(Ve==="%%")return"%";if(rt>=At)return Ve;switch(Ve){case"%s":return String(Yt[rt++]);case"%d":return Number(Yt[rt++]);case"%j":try{return JSON.stringify(Yt[rt++])}catch(lt){return"[Circular]"}default:return Ve}}),xe=Yt[rt];rt<At;xe=Yt[++rt])Tt(xe)||!ke(xe)?be+=" "+xe:be+=" "+Z(xe);return be},E.deprecate=function(Ae,ge){if(typeof T!="undefined"&&T.noDeprecation===!0)return Ae;if(typeof T=="undefined")return function(){return E.deprecate(Ae,ge).apply(this,arguments)};var rt=!1;function Yt(){if(!rt){if(T.throwDeprecation)throw new Error(ge);T.traceDeprecation?console.trace(ge):console.error(ge),rt=!0}return Ae.apply(this,arguments)}return Yt};var z={},o;E.debuglog=function(Ae){if(_t(o)&&(o=Object({NODE_ENV:"production"}).NODE_DEBUG||""),Ae=Ae.toUpperCase(),!z[Ae])if(new RegExp("\\b"+Ae+"\\b","i").test(o)){var ge=T.pid;z[Ae]=function(){var rt=E.format.apply(E,arguments);console.error("%s %d: %s",Ae,ge,rt)}}else z[Ae]=function(){};return z[Ae]};function Z(Ae,ge){var rt={seen:[],stylize:K};return arguments.length>=3&&(rt.depth=arguments[2]),arguments.length>=4&&(rt.colors=arguments[3]),je(ge)?rt.showHidden=ge:ge&&E._extend(rt,ge),_t(rt.showHidden)&&(rt.showHidden=!1),_t(rt.depth)&&(rt.depth=2),_t(rt.colors)&&(rt.colors=!1),_t(rt.customInspect)&&(rt.customInspect=!0),rt.colors&&(rt.stylize=D),de(rt,Ae,rt.depth)}E.inspect=Z,Z.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},Z.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function D(Ae,ge){var rt=Z.styles[ge];return rt?"["+Z.colors[rt][0]+"m"+Ae+"["+Z.colors[rt][1]+"m":Ae}function K(Ae,ge){return Ae}function re(Ae){var ge={};return Ae.forEach(function(rt,Yt){ge[rt]=!0}),ge}function de(Ae,ge,rt){if(Ae.customInspect&&ge&&Le(ge.inspect)&&ge.inspect!==E.inspect&&!(ge.constructor&&ge.constructor.prototype===ge)){var Yt=ge.inspect(rt,Ae);return Je(Yt)||(Yt=de(Ae,Yt,rt)),Yt}var At=Y(Ae,ge);if(At)return At;var be=Object.keys(ge),xe=re(be);if(Ae.showHidden&&(be=Object.getOwnPropertyNames(ge)),st(ge)&&(be.indexOf("message")>=0||be.indexOf("description")>=0))return Fe(ge);if(be.length===0){if(Le(ge)){var Ve=ge.name?": "+ge.name:"";return Ae.stylize("[Function"+Ve+"]","special")}if(Ne(ge))return Ae.stylize(RegExp.prototype.toString.call(ge),"regexp");if(Ue(ge))return Ae.stylize(Date.prototype.toString.call(ge),"date");if(st(ge))return Fe(ge)}var lt="",Pe=!1,dt=["{","}"];if(pt(ge)&&(Pe=!0,dt=["[","]"]),Le(ge)){var w=ge.name?": "+ge.name:"";lt=" [Function"+w+"]"}if(Ne(ge)&&(lt=" "+RegExp.prototype.toString.call(ge)),Ue(ge)&&(lt=" "+Date.prototype.toUTCString.call(ge)),st(ge)&&(lt=" "+Fe(ge)),be.length===0&&(!Pe||ge.length==0))return dt[0]+lt+dt[1];if(rt<0)return Ne(ge)?Ae.stylize(RegExp.prototype.toString.call(ge),"regexp"):Ae.stylize("[Object]","special");Ae.seen.push(ge);var I;return Pe?I=Ze(Ae,ge,rt,xe,be):I=be.map(function(q){return ye(Ae,ge,rt,xe,q,Pe)}),Ae.seen.pop(),we(I,lt,dt)}function Y(Ae,ge){if(_t(ge))return Ae.stylize("undefined","undefined");if(Je(ge)){var rt="'"+JSON.stringify(ge).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return Ae.stylize(rt,"string")}if(gt(ge))return Ae.stylize(""+ge,"number");if(je(ge))return Ae.stylize(""+ge,"boolean");if(Tt(ge))return Ae.stylize("null","null")}function Fe(Ae){return"["+Error.prototype.toString.call(Ae)+"]"}function Ze(Ae,ge,rt,Yt,At){for(var be=[],xe=0,Ve=ge.length;xe<Ve;++xe)Q(ge,String(xe))?be.push(ye(Ae,ge,rt,Yt,String(xe),!0)):be.push("");return At.forEach(function(lt){lt.match(/^\d+$/)||be.push(ye(Ae,ge,rt,Yt,lt,!0))}),be}function ye(Ae,ge,rt,Yt,At,be){var xe,Ve,lt;if(lt=Object.getOwnPropertyDescriptor(ge,At)||{value:ge[At]},lt.get?lt.set?Ve=Ae.stylize("[Getter/Setter]","special"):Ve=Ae.stylize("[Getter]","special"):lt.set&&(Ve=Ae.stylize("[Setter]","special")),Q(Yt,At)||(xe="["+At+"]"),Ve||(Ae.seen.indexOf(lt.value)<0?(Tt(rt)?Ve=de(Ae,lt.value,null):Ve=de(Ae,lt.value,rt-1),Ve.indexOf(`
`)>-1&&(be?Ve=Ve.split(`
`).map(function(Pe){return"  "+Pe}).join(`
`).substr(2):Ve=`
`+Ve.split(`
`).map(function(Pe){return"   "+Pe}).join(`
`))):Ve=Ae.stylize("[Circular]","special")),_t(xe)){if(be&&At.match(/^\d+$/))return Ve;xe=JSON.stringify(""+At),xe.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(xe=xe.substr(1,xe.length-2),xe=Ae.stylize(xe,"name")):(xe=xe.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),xe=Ae.stylize(xe,"string"))}return xe+": "+Ve}function we(Ae,ge,rt){var Yt=0,At=Ae.reduce(function(be,xe){return Yt++,xe.indexOf(`
`)>=0&&Yt++,be+xe.replace(/\u001b\[\d\d?m/g,"").length+1},0);return At>60?rt[0]+(ge===""?"":ge+`
 `)+" "+Ae.join(`,
  `)+" "+rt[1]:rt[0]+ge+" "+Ae.join(", ")+" "+rt[1]}function pt(Ae){return Array.isArray(Ae)}E.isArray=pt;function je(Ae){return typeof Ae=="boolean"}E.isBoolean=je;function Tt(Ae){return Ae===null}E.isNull=Tt;function Xe(Ae){return Ae==null}E.isNullOrUndefined=Xe;function gt(Ae){return typeof Ae=="number"}E.isNumber=gt;function Je(Ae){return typeof Ae=="string"}E.isString=Je;function Et(Ae){return typeof Ae=="symbol"}E.isSymbol=Et;function _t(Ae){return Ae===void 0}E.isUndefined=_t;function Ne(Ae){return ke(Ae)&&Vt(Ae)==="[object RegExp]"}E.isRegExp=Ne;function ke(Ae){return typeof Ae=="object"&&Ae!==null}E.isObject=ke;function Ue(Ae){return ke(Ae)&&Vt(Ae)==="[object Date]"}E.isDate=Ue;function st(Ae){return ke(Ae)&&(Vt(Ae)==="[object Error]"||Ae instanceof Error)}E.isError=st;function Le(Ae){return typeof Ae=="function"}E.isFunction=Le;function ut(Ae){return Ae===null||typeof Ae=="boolean"||typeof Ae=="number"||typeof Ae=="string"||typeof Ae=="symbol"||typeof Ae=="undefined"}E.isPrimitive=ut,E.isBuffer=i("1gqn");function Vt(Ae){return Object.prototype.toString.call(Ae)}function Zt(Ae){return Ae<10?"0"+Ae.toString(10):Ae.toString(10)}var ir=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function oe(){var Ae=new Date,ge=[Zt(Ae.getHours()),Zt(Ae.getMinutes()),Zt(Ae.getSeconds())].join(":");return[Ae.getDate(),ir[Ae.getMonth()],ge].join(" ")}E.log=function(){console.log("%s - %s",oe(),E.format.apply(E,arguments))},E.inherits=i("KKCa"),E._extend=function(Ae,ge){if(!ge||!ke(ge))return Ae;for(var rt=Object.keys(ge),Yt=rt.length;Yt--;)Ae[rt[Yt]]=ge[rt[Yt]];return Ae};function Q(Ae,ge){return Object.prototype.hasOwnProperty.call(Ae,ge)}var H=typeof Symbol!="undefined"?Symbol("util.promisify.custom"):void 0;E.promisify=function(ge){if(typeof ge!="function")throw new TypeError('The "original" argument must be of type Function');if(H&&ge[H]){var rt=ge[H];if(typeof rt!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(rt,H,{value:rt,enumerable:!1,writable:!1,configurable:!0}),rt}function rt(){for(var Yt,At,be=new Promise(function(lt,Pe){Yt=lt,At=Pe}),xe=[],Ve=0;Ve<arguments.length;Ve++)xe.push(arguments[Ve]);xe.push(function(lt,Pe){lt?At(lt):Yt(Pe)});try{ge.apply(this,xe)}catch(lt){At(lt)}return be}return Object.setPrototypeOf(rt,Object.getPrototypeOf(ge)),H&&Object.defineProperty(rt,H,{value:rt,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(rt,m(ge))},E.promisify.custom=H;function Ce(Ae,ge){if(!Ae){var rt=new Error("Promise was rejected with a falsy value");rt.reason=Ae,Ae=rt}return ge(Ae)}function Ee(Ae){if(typeof Ae!="function")throw new TypeError('The "original" argument must be of type Function');function ge(){for(var rt=[],Yt=0;Yt<arguments.length;Yt++)rt.push(arguments[Yt]);var At=rt.pop();if(typeof At!="function")throw new TypeError("The last argument must be of type Function");var be=this,xe=function(){return At.apply(be,arguments)};Ae.apply(this,rt).then(function(Ve){T.nextTick(xe,null,Ve)},function(Ve){T.nextTick(Ce,Ve,xe)})}return Object.setPrototypeOf(ge,Object.getPrototypeOf(Ae)),Object.defineProperties(ge,m(Ae)),ge}E.callbackify=Ee}).call(this,i("Q2Ig"))},MON2:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",E.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",E.NULL_ARGUMENT="NULL argument",E.KEY_NOT_FOUND="Key Not Found",E.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",E.CANNOT_UNBIND="Could not unbind serviceIdentifier:",E.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",E.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",E.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:",E.UNDEFINED_INJECT_ANNOTATION=function(T){return"@inject called with undefined this could mean that the class "+T+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},E.CIRCULAR_DEPENDENCY="Circular dependency found:",E.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",E.INVALID_BINDING_TYPE="Invalid binding type:",E.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",E.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",E.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",E.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",E.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",E.ARGUMENTS_LENGTH_MISMATCH=function(){for(var T=[],m=0;m<arguments.length;m++)T[m]=arguments[m];return"The number of constructor arguments in the derived class "+(T[0]+" must be >= than the number of constructor arguments of its base class.")},E.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",E.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",E.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",E.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",E.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class",E.POST_CONSTRUCT_ERROR=function(){for(var T=[],m=0;m<arguments.length;m++)T[m]=arguments[m];return"@postConstruct error in class "+T[0]+": "+T[1]},E.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var T=[],m=0;m<arguments.length;m++)T[m]=arguments[m];return"It looks like there is a circular dependency "+("in one of the '"+T[0]+"' bindings. Please investigate bindings with")+("service identifier '"+T[1]+"'.")},E.STACK_OVERFLOW="Maximum call stack size exceeded"},MrPd:function(Re,E,i){var T=i("hypo"),m=i("ljhN"),X=Object.prototype,z=X.hasOwnProperty;function o(Z,D,K){var re=Z[D];(!(z.call(Z,D)&&m(re,K))||K===void 0&&!(D in Z))&&T(Z,D,K)}Re.exports=o},O0oS:function(Re,E,i){var T=i("Cwc5"),m=function(){try{var X=T(Object,"defineProperty");return X({},"",{}),X}catch(z){}}();Re.exports=m},O1je:function(Re,E){},OBhP:function(Re,E,i){var T=i("fmRc"),m=i("gFfm"),X=i("MrPd"),z=i("WwFo"),o=i("Dw+G"),Z=i("5Tg0"),D=i("Q1l4"),K=i("VOtZ"),re=i("EEGq"),de=i("qZTm"),Y=i("G6z8"),Fe=i("QqLw"),Ze=i("yHx3"),ye=i("wrZu"),we=i("+iFO"),pt=i("Z0cm"),je=i("DSRE"),Tt=i("zEVN"),Xe=i("GoyQ"),gt=i("1+5i"),Je=i("7GkX"),Et=i("mTTR"),_t=1,Ne=2,ke=4,Ue="[object Arguments]",st="[object Array]",Le="[object Boolean]",ut="[object Date]",Vt="[object Error]",Zt="[object Function]",ir="[object GeneratorFunction]",oe="[object Map]",Q="[object Number]",H="[object Object]",Ce="[object RegExp]",Ee="[object Set]",Ae="[object String]",ge="[object Symbol]",rt="[object WeakMap]",Yt="[object ArrayBuffer]",At="[object DataView]",be="[object Float32Array]",xe="[object Float64Array]",Ve="[object Int8Array]",lt="[object Int16Array]",Pe="[object Int32Array]",dt="[object Uint8Array]",w="[object Uint8ClampedArray]",I="[object Uint16Array]",q="[object Uint32Array]",ce={};ce[Ue]=ce[st]=ce[Yt]=ce[At]=ce[Le]=ce[ut]=ce[be]=ce[xe]=ce[Ve]=ce[lt]=ce[Pe]=ce[oe]=ce[Q]=ce[H]=ce[Ce]=ce[Ee]=ce[Ae]=ce[ge]=ce[dt]=ce[w]=ce[I]=ce[q]=!0,ce[Vt]=ce[Zt]=ce[rt]=!1;function Ge($e,yt,nt,Nt,$,Ke){var ae,et=yt&_t,jt=yt&Ne,sr=yt&ke;if(nt&&(ae=$?nt($e,Nt,$,Ke):nt($e)),ae!==void 0)return ae;if(!Xe($e))return $e;var ft=pt($e);if(ft){if(ae=Ze($e),!et)return D($e,ae)}else{var mt=Fe($e),Ct=mt==Zt||mt==ir;if(je($e))return Z($e,et);if(mt==H||mt==Ue||Ct&&!$){if(ae=jt||Ct?{}:we($e),!et)return jt?re($e,o(ae,$e)):K($e,z(ae,$e))}else{if(!ce[mt])return $?$e:{};ae=ye($e,mt,et)}}Ke||(Ke=new T);var vt=Ke.get($e);if(vt)return vt;Ke.set($e,ae),gt($e)?$e.forEach(function(Qe){ae.add(Ge(Qe,yt,nt,Qe,$e,Ke))}):Tt($e)&&$e.forEach(function(Qe,Ft){ae.set(Ft,Ge(Qe,yt,nt,Ft,$e,Ke))});var Oe=sr?jt?Y:de:jt?Et:Je,ct=ft?void 0:Oe($e);return m(ct||$e,function(Qe,Ft){ct&&(Ft=Qe,Qe=$e[Ft]),X(ae,Ft,Ge(Qe,yt,nt,Ft,$e,Ke))}),ae}Re.exports=Ge},PSsN:function(Re,E){},PUg6:function(Re,E,i){"use strict";i.d(E,"a",function(){return T});var T;(function(m){m.normal="normal",m.additive="additive",m.subtractive="subtractive",m.min="min",m.max="max"})(T||(T={}))},Q1l4:function(Re,E){function i(T,m){var X=-1,z=T.length;for(m||(m=Array(z));++X<z;)m[X]=T[X];return m}Re.exports=i},QGbF:function(Re,E){},"QQZ/":function(Re,E,i){var T=i("Sq3C"),m=i("Z1HP"),X=i("Sxd8"),z=i("dt0z");function o(Z,D,K){Z=z(Z),D=X(D);var re=D?m(Z):0;return D&&re<D?T(D-re,K)+Z:Z}Re.exports=o},QcOe:function(Re,E,i){var T=i("GoyQ"),m=i("6sVZ"),X=i("7Ix3"),z=Object.prototype,o=z.hasOwnProperty;function Z(D){if(!T(D))return X(D);var K=m(D),re=[];for(var de in D)de=="constructor"&&(K||!o.call(D,de))||re.push(de);return re}Re.exports=Z},QkVN:function(Re,E,i){var T=i("+Qka"),m=i("LsHQ"),X=m(function(z,o,Z){T(z,o,Z)});Re.exports=X},"R/W3":function(Re,E,i){var T=i("KwMD"),m=i("2ajD"),X=i("CZoQ");function z(o,Z,D){return Z===Z?X(o,Z,D):T(o,m,D)}Re.exports=z},"RL2/":function(Re,E,i){"use strict";var T="2.2.41"},RMtq:function(Re,E){},"RR/i":function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("xfSm"),m=i("GXnB"),X=function D(K,re){var de=K.parentRequest;return de!==null?re(de)?!0:D(de,re):!1};E.traverseAncerstors=X;var z=function(K){return function(re){var de=function(Fe){return Fe!==null&&Fe.target!==null&&Fe.target.matchesTag(K)(re)};return de.metaData=new m.Metadata(K,re),de}};E.taggedConstraint=z;var o=z(T.NAMED_TAG);E.namedConstraint=o;var Z=function(K){return function(re){var de=null;if(re!==null)if(de=re.bindings[0],typeof K=="string"){var Y=de.serviceIdentifier;return Y===K}else{var Fe=re.bindings[0].implementationType;return K===Fe}return!1}};E.typeConstraint=Z},Sk89:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("MON2"),m=i("xfSm"),X=i("GXnB");function z(){return function(o,Z,D){var K=new X.Metadata(m.POST_CONSTRUCT,Z);if(Reflect.hasOwnMetadata(m.POST_CONSTRUCT,o.constructor))throw new Error(T.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(m.POST_CONSTRUCT,K,o.constructor)}}E.postConstruct=z},Sq3C:function(Re,E,i){var T=i("sKgW"),m=i("zoYe"),X=i("wy8a"),z=i("quyA"),o=i("Z1HP"),Z=i("Em2t"),D=Math.ceil;function K(re,de){de=de===void 0?" ":m(de);var Y=de.length;if(Y<2)return Y?T(de,re):de;var Fe=T(de,D(re/o(de)));return z(de)?X(Z(Fe),0,re).join(""):Fe.slice(0,re)}Re.exports=K},Sxd8:function(Re,E,i){var T=i("ZCgT");function m(X){var z=T(X),o=z%1;return z===z?o?z-o:z:0}Re.exports=m},T1AV:function(Re,E,i){var T=i("t2Dn"),m=i("5Tg0"),X=i("yP5f"),z=i("Q1l4"),o=i("+iFO"),Z=i("03A+"),D=i("Z0cm"),K=i("3L66"),re=i("DSRE"),de=i("lSCD"),Y=i("GoyQ"),Fe=i("YO3V"),Ze=i("c6wG"),ye=i("itsj"),we=i("jeLo");function pt(je,Tt,Xe,gt,Je,Et,_t){var Ne=ye(je,Xe),ke=ye(Tt,Xe),Ue=_t.get(ke);if(Ue){T(je,Xe,Ue);return}var st=Et?Et(Ne,ke,Xe+"",je,Tt,_t):void 0,Le=st===void 0;if(Le){var ut=D(ke),Vt=!ut&&re(ke),Zt=!ut&&!Vt&&Ze(ke);st=ke,ut||Vt||Zt?D(Ne)?st=Ne:K(Ne)?st=z(Ne):Vt?(Le=!1,st=m(ke,!0)):Zt?(Le=!1,st=X(ke,!0)):st=[]:Fe(ke)||Z(ke)?(st=Ne,Z(Ne)?st=we(Ne):(!Y(Ne)||de(Ne))&&(st=o(ke))):Le=!1}Le&&(_t.set(ke,st),Je(st,ke,gt,Et,_t),_t.delete(ke)),T(je,Xe,st)}Re.exports=pt},TKrE:function(Re,E,i){var T=i("qRkn"),m=i("dt0z"),X=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,z="\\u0300-\\u036f",o="\\ufe20-\\ufe2f",Z="\\u20d0-\\u20ff",D=z+o+Z,K="["+D+"]",re=RegExp(K,"g");function de(Y){return Y=m(Y),Y&&Y.replace(X,T).replace(re,"")}Re.exports=de},"U+yc":function(Re,E){function i(T,m,X,z,o){var Z={};return Object.keys(z).forEach(function(D){Z[D]=z[D]}),Z.enumerable=!!Z.enumerable,Z.configurable=!!Z.configurable,("value"in Z||Z.initializer)&&(Z.writable=!0),Z=X.slice().reverse().reduce(function(D,K){return K(T,m,D)||D},Z),o&&Z.initializer!==void 0&&(Z.value=Z.initializer?Z.initializer.call(o):void 0,Z.initializer=void 0),Z.initializer===void 0&&(Object.defineProperty(T,m,Z),Z=null),Z}Re.exports=i},U1ZX:function(Re,E){},UB5X:function(Re,E,i){var T=i("NykK"),m=i("ExA7"),X="[object Number]";function z(o){return typeof o=="number"||m(o)&&T(o)==X}Re.exports=z},Ucsi:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=Symbol.for("INJECTION");function m(D,K,re,de){function Y(){return de&&!Reflect.hasMetadata(T,this,K)&&Reflect.defineMetadata(T,re(),this,K),Reflect.hasMetadata(T,this,K)?Reflect.getMetadata(T,this,K):re()}function Fe(Ze){Reflect.defineMetadata(T,Ze,this,K)}Object.defineProperty(D,K,{configurable:!0,enumerable:!0,get:Y,set:Fe})}function X(D,K){return function(re){return function(de,Y){var Fe=function(){return D.get(re)};m(de,Y,Fe,K)}}}E.makePropertyInjectDecorator=X;function z(D,K){return function(re,de){return function(Y,Fe){var Ze=function(){return D.getNamed(re,de)};m(Y,Fe,Ze,K)}}}E.makePropertyInjectNamedDecorator=z;function o(D,K){return function(re,de,Y){return function(Fe,Ze){var ye=function(){return D.getTagged(re,de,Y)};m(Fe,Ze,ye,K)}}}E.makePropertyInjectTaggedDecorator=o;function Z(D,K){return function(re){return function(de,Y){var Fe=function(){return D.getAll(re)};m(de,Y,Fe,K)}}}E.makePropertyMultiInjectDecorator=Z},V1cb:function(Re,E,i){"use strict";i.d(E,"a",function(){return T});var T;(function(m){m.Hover="hover",m.Click="click",m.Select="select",m.Active="active",m.Drag="drag"})(T||(T={}))},VIsB:function(Re,E,i){"use strict";i.d(E,"a",function(){return Z});var T=i("Hel2");function m(Fe,Ze){var ye;if(typeof Symbol=="undefined"||Fe[Symbol.iterator]==null){if(Array.isArray(Fe)||(ye=X(Fe))||Ze&&Fe&&typeof Fe.length=="number"){ye&&(Fe=ye);var we=0,pt=function(){};return{s:pt,n:function(){return we>=Fe.length?{done:!0}:{done:!1,value:Fe[we++]}},e:function(Je){throw Je},f:pt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var je=!0,Tt=!1,Xe;return{s:function(){ye=Fe[Symbol.iterator]()},n:function(){var Je=ye.next();return je=Je.done,Je},e:function(Je){Tt=!0,Xe=Je},f:function(){try{!je&&ye.return!=null&&ye.return()}finally{if(Tt)throw Xe}}}}function X(Fe,Ze){if(!Fe)return;if(typeof Fe=="string")return z(Fe,Ze);var ye=Object.prototype.toString.call(Fe).slice(8,-1);if(ye==="Object"&&Fe.constructor&&(ye=Fe.constructor.name),ye==="Map"||ye==="Set")return Array.from(Fe);if(ye==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ye))return z(Fe,Ze)}function z(Fe,Ze){(Ze==null||Ze>Fe.length)&&(Ze=Fe.length);for(var ye=0,we=new Array(Ze);ye<Ze;ye++)we[ye]=Fe[ye];return we}var o=6378e3;function Z(Fe,Ze){var ye=Fe.dataArray,we=Ze.size,pt=we===void 0?10:we,je=pt/(2*Math.PI*o)*(256<<20)/2,Tt=D(ye,pt),Xe=Tt.gridHash,gt=Tt.gridOffset,Je=Y(Xe,gt,Ze);return{yOffset:je,xOffset:je,radius:je,type:"grid",dataArray:Je}}function D(Fe,Ze){var ye=Infinity,we=-Infinity,pt,je=m(Fe),Tt;try{for(je.s();!(Tt=je.n()).done;){var Xe=Tt.value;pt=Xe.coordinates[1],Number.isFinite(pt)&&(ye=pt<ye?pt:ye,we=pt>we?pt:we)}}catch(Zt){je.e(Zt)}finally{je.f()}var gt=(ye+we)/2,Je=K(Ze,gt);if(Je.xOffset<=0||Je.yOffset<=0)return{gridHash:{},gridOffset:Je};var Et={},_t=m(Fe),Ne;try{for(_t.s();!(Ne=_t.n()).done;){var ke=Ne.value,Ue=ke.coordinates[1],st=ke.coordinates[0];if(Number.isFinite(Ue)&&Number.isFinite(st)){var Le=Math.floor((Ue+90)/Je.yOffset),ut=Math.floor((st+180)/Je.xOffset),Vt="".concat(Le,"-").concat(ut);Et[Vt]=Et[Vt]||{count:0,points:[]},Et[Vt].count+=1,Et[Vt].points.push(ke)}}}catch(Zt){_t.e(Zt)}finally{_t.f()}return{gridHash:Et,gridOffset:Je}}function K(Fe,Ze){var ye=re(Fe),we=de(Ze,Fe);return{yOffset:ye,xOffset:we}}function re(Fe){return Fe/o*(180/Math.PI)}function de(Fe,Ze){return Ze/o*(180/Math.PI)/Math.cos(Fe*Math.PI/180)}function Y(Fe,Ze,ye){return Object.keys(Fe).reduce(function(we,pt,je){var Tt=pt.split("-"),Xe=parseInt(Tt[0],10),gt=parseInt(Tt[1],10),Je={};if(ye.field&&ye.method){var Et=T.c.getColumn(Fe[pt].points,ye.field);Je[ye.method]=T.c.statMap[ye.method](Et)}return Object.assign(Je,{_id:je,coordinates:Object(T.d)([-180+Ze.xOffset*(gt+.5),-90+Ze.yOffset*(Xe+.5)]),rawData:Fe[pt].points,count:Fe[pt].count}),we.push(Je),we},[])}},VOtZ:function(Re,E,i){var T=i("juv8"),m=i("MvSz");function X(z,o){return T(z,m(z),o)}Re.exports=X},VmRL:function(Re,E,i){"use strict";Re.exports=T,Re.exports.default=T;function T(oe,Q,H){H=H||2;var Ce=Q&&Q.length,Ee=Ce?Q[0]*H:oe.length,Ae=m(oe,0,Ee,H,!0),ge=[];if(!Ae||Ae.next===Ae.prev)return ge;var rt,Yt,At,be,xe,Ve,lt;if(Ce&&(Ae=re(oe,Q,Ae,H)),oe.length>80*H){rt=At=oe[0],Yt=be=oe[1];for(var Pe=H;Pe<Ee;Pe+=H)xe=oe[Pe],Ve=oe[Pe+1],xe<rt&&(rt=xe),Ve<Yt&&(Yt=Ve),xe>At&&(At=xe),Ve>be&&(be=Ve);lt=Math.max(At-rt,be-Yt),lt=lt!==0?1/lt:0}return z(Ae,ge,H,rt,Yt,lt),ge}function m(oe,Q,H,Ce,Ee){var Ae,ge;if(Ee===ir(oe,Q,H,Ce)>0)for(Ae=Q;Ae<H;Ae+=Ce)ge=ut(Ae,oe[Ae],oe[Ae+1],ge);else for(Ae=H-Ce;Ae>=Q;Ae-=Ce)ge=ut(Ae,oe[Ae],oe[Ae+1],ge);return ge&&Je(ge,ge.next)&&(Vt(ge),ge=ge.next),ge}function X(oe,Q){if(!oe)return oe;Q||(Q=oe);var H=oe,Ce;do if(Ce=!1,!H.steiner&&(Je(H,H.next)||gt(H.prev,H,H.next)===0)){if(Vt(H),H=Q=H.prev,H===H.next)break;Ce=!0}else H=H.next;while(Ce||H!==Q);return Q}function z(oe,Q,H,Ce,Ee,Ae,ge){if(!oe)return;!ge&&Ae&&ye(oe,Ce,Ee,Ae);for(var rt=oe,Yt,At;oe.prev!==oe.next;){if(Yt=oe.prev,At=oe.next,Ae?Z(oe,Ce,Ee,Ae):o(oe)){Q.push(Yt.i/H),Q.push(oe.i/H),Q.push(At.i/H),Vt(oe),oe=At.next,rt=At.next;continue}if(oe=At,oe===rt){ge?ge===1?(oe=D(X(oe),Q,H),z(oe,Q,H,Ce,Ee,Ae,2)):ge===2&&K(oe,Q,H,Ce,Ee,Ae):z(X(oe),Q,H,Ce,Ee,Ae,1);break}}}function o(oe){var Q=oe.prev,H=oe,Ce=oe.next;if(gt(Q,H,Ce)>=0)return!1;for(var Ee=oe.next.next;Ee!==oe.prev;){if(Tt(Q.x,Q.y,H.x,H.y,Ce.x,Ce.y,Ee.x,Ee.y)&&gt(Ee.prev,Ee,Ee.next)>=0)return!1;Ee=Ee.next}return!0}function Z(oe,Q,H,Ce){var Ee=oe.prev,Ae=oe,ge=oe.next;if(gt(Ee,Ae,ge)>=0)return!1;for(var rt=Ee.x<Ae.x?Ee.x<ge.x?Ee.x:ge.x:Ae.x<ge.x?Ae.x:ge.x,Yt=Ee.y<Ae.y?Ee.y<ge.y?Ee.y:ge.y:Ae.y<ge.y?Ae.y:ge.y,At=Ee.x>Ae.x?Ee.x>ge.x?Ee.x:ge.x:Ae.x>ge.x?Ae.x:ge.x,be=Ee.y>Ae.y?Ee.y>ge.y?Ee.y:ge.y:Ae.y>ge.y?Ae.y:ge.y,xe=pt(rt,Yt,Q,H,Ce),Ve=pt(At,be,Q,H,Ce),lt=oe.prevZ,Pe=oe.nextZ;lt&&lt.z>=xe&&Pe&&Pe.z<=Ve;){if(lt!==oe.prev&&lt!==oe.next&&Tt(Ee.x,Ee.y,Ae.x,Ae.y,ge.x,ge.y,lt.x,lt.y)&&gt(lt.prev,lt,lt.next)>=0)return!1;if(lt=lt.prevZ,Pe!==oe.prev&&Pe!==oe.next&&Tt(Ee.x,Ee.y,Ae.x,Ae.y,ge.x,ge.y,Pe.x,Pe.y)&&gt(Pe.prev,Pe,Pe.next)>=0)return!1;Pe=Pe.nextZ}for(;lt&&lt.z>=xe;){if(lt!==oe.prev&&lt!==oe.next&&Tt(Ee.x,Ee.y,Ae.x,Ae.y,ge.x,ge.y,lt.x,lt.y)&&gt(lt.prev,lt,lt.next)>=0)return!1;lt=lt.prevZ}for(;Pe&&Pe.z<=Ve;){if(Pe!==oe.prev&&Pe!==oe.next&&Tt(Ee.x,Ee.y,Ae.x,Ae.y,ge.x,ge.y,Pe.x,Pe.y)&&gt(Pe.prev,Pe,Pe.next)>=0)return!1;Pe=Pe.nextZ}return!0}function D(oe,Q,H){var Ce=oe;do{var Ee=Ce.prev,Ae=Ce.next.next;!Je(Ee,Ae)&&Et(Ee,Ce,Ce.next,Ae)&&Ue(Ee,Ae)&&Ue(Ae,Ee)&&(Q.push(Ee.i/H),Q.push(Ce.i/H),Q.push(Ae.i/H),Vt(Ce),Vt(Ce.next),Ce=oe=Ae),Ce=Ce.next}while(Ce!==oe);return X(Ce)}function K(oe,Q,H,Ce,Ee,Ae){var ge=oe;do{for(var rt=ge.next.next;rt!==ge.prev;){if(ge.i!==rt.i&&Xe(ge,rt)){var Yt=Le(ge,rt);ge=X(ge,ge.next),Yt=X(Yt,Yt.next),z(ge,Q,H,Ce,Ee,Ae),z(Yt,Q,H,Ce,Ee,Ae);return}rt=rt.next}ge=ge.next}while(ge!==oe)}function re(oe,Q,H,Ce){var Ee=[],Ae,ge,rt,Yt,At;for(Ae=0,ge=Q.length;Ae<ge;Ae++)rt=Q[Ae]*Ce,Yt=Ae<ge-1?Q[Ae+1]*Ce:oe.length,At=m(oe,rt,Yt,Ce,!1),At===At.next&&(At.steiner=!0),Ee.push(je(At));for(Ee.sort(de),Ae=0;Ae<Ee.length;Ae++)Y(Ee[Ae],H),H=X(H,H.next);return H}function de(oe,Q){return oe.x-Q.x}function Y(oe,Q){if(Q=Fe(oe,Q),Q){var H=Le(Q,oe);X(Q,Q.next),X(H,H.next)}}function Fe(oe,Q){var H=Q,Ce=oe.x,Ee=oe.y,Ae=-Infinity,ge;do{if(Ee<=H.y&&Ee>=H.next.y&&H.next.y!==H.y){var rt=H.x+(Ee-H.y)*(H.next.x-H.x)/(H.next.y-H.y);if(rt<=Ce&&rt>Ae){if(Ae=rt,rt===Ce){if(Ee===H.y)return H;if(Ee===H.next.y)return H.next}ge=H.x<H.next.x?H:H.next}}H=H.next}while(H!==Q);if(!ge)return null;if(Ce===Ae)return ge;var Yt=ge,At=ge.x,be=ge.y,xe=Infinity,Ve;H=ge;do Ce>=H.x&&H.x>=At&&Ce!==H.x&&Tt(Ee<be?Ce:Ae,Ee,At,be,Ee<be?Ae:Ce,Ee,H.x,H.y)&&(Ve=Math.abs(Ee-H.y)/(Ce-H.x),Ue(H,oe)&&(Ve<xe||Ve===xe&&(H.x>ge.x||H.x===ge.x&&Ze(ge,H)))&&(ge=H,xe=Ve)),H=H.next;while(H!==Yt);return ge}function Ze(oe,Q){return gt(oe.prev,oe,Q.prev)<0&&gt(Q.next,oe,oe.next)<0}function ye(oe,Q,H,Ce){var Ee=oe;do Ee.z===null&&(Ee.z=pt(Ee.x,Ee.y,Q,H,Ce)),Ee.prevZ=Ee.prev,Ee.nextZ=Ee.next,Ee=Ee.next;while(Ee!==oe);Ee.prevZ.nextZ=null,Ee.prevZ=null,we(Ee)}function we(oe){var Q,H,Ce,Ee,Ae,ge,rt,Yt,At=1;do{for(H=oe,oe=null,Ae=null,ge=0;H;){for(ge++,Ce=H,rt=0,Q=0;Q<At&&!(rt++,Ce=Ce.nextZ,!Ce);Q++);for(Yt=At;rt>0||Yt>0&&Ce;)rt!==0&&(Yt===0||!Ce||H.z<=Ce.z)?(Ee=H,H=H.nextZ,rt--):(Ee=Ce,Ce=Ce.nextZ,Yt--),Ae?Ae.nextZ=Ee:oe=Ee,Ee.prevZ=Ae,Ae=Ee;H=Ce}Ae.nextZ=null,At*=2}while(ge>1);return oe}function pt(oe,Q,H,Ce,Ee){return oe=32767*(oe-H)*Ee,Q=32767*(Q-Ce)*Ee,oe=(oe|oe<<8)&16711935,oe=(oe|oe<<4)&252645135,oe=(oe|oe<<2)&858993459,oe=(oe|oe<<1)&1431655765,Q=(Q|Q<<8)&16711935,Q=(Q|Q<<4)&252645135,Q=(Q|Q<<2)&858993459,Q=(Q|Q<<1)&1431655765,oe|Q<<1}function je(oe){var Q=oe,H=oe;do(Q.x<H.x||Q.x===H.x&&Q.y<H.y)&&(H=Q),Q=Q.next;while(Q!==oe);return H}function Tt(oe,Q,H,Ce,Ee,Ae,ge,rt){return(Ee-ge)*(Q-rt)-(oe-ge)*(Ae-rt)>=0&&(oe-ge)*(Ce-rt)-(H-ge)*(Q-rt)>=0&&(H-ge)*(Ae-rt)-(Ee-ge)*(Ce-rt)>=0}function Xe(oe,Q){return oe.next.i!==Q.i&&oe.prev.i!==Q.i&&!ke(oe,Q)&&(Ue(oe,Q)&&Ue(Q,oe)&&st(oe,Q)&&(gt(oe.prev,oe,Q.prev)||gt(oe,Q.prev,Q))||Je(oe,Q)&&gt(oe.prev,oe,oe.next)>0&&gt(Q.prev,Q,Q.next)>0)}function gt(oe,Q,H){return(Q.y-oe.y)*(H.x-Q.x)-(Q.x-oe.x)*(H.y-Q.y)}function Je(oe,Q){return oe.x===Q.x&&oe.y===Q.y}function Et(oe,Q,H,Ce){var Ee=Ne(gt(oe,Q,H)),Ae=Ne(gt(oe,Q,Ce)),ge=Ne(gt(H,Ce,oe)),rt=Ne(gt(H,Ce,Q));return Ee!==Ae&&ge!==rt||(Ee===0&&_t(oe,H,Q)||(Ae===0&&_t(oe,Ce,Q)||ge===0&&_t(H,oe,Ce)))?!0:!!(rt===0&&_t(H,Q,Ce))}function _t(oe,Q,H){return Q.x<=Math.max(oe.x,H.x)&&Q.x>=Math.min(oe.x,H.x)&&Q.y<=Math.max(oe.y,H.y)&&Q.y>=Math.min(oe.y,H.y)}function Ne(oe){return oe>0?1:oe<0?-1:0}function ke(oe,Q){var H=oe;do{if(H.i!==oe.i&&H.next.i!==oe.i&&H.i!==Q.i&&H.next.i!==Q.i&&Et(H,H.next,oe,Q))return!0;H=H.next}while(H!==oe);return!1}function Ue(oe,Q){return gt(oe.prev,oe,oe.next)<0?gt(oe,Q,oe.next)>=0&&gt(oe,oe.prev,Q)>=0:gt(oe,Q,oe.prev)<0||gt(oe,oe.next,Q)<0}function st(oe,Q){var H=oe,Ce=!1,Ee=(oe.x+Q.x)/2,Ae=(oe.y+Q.y)/2;do H.y>Ae!==H.next.y>Ae&&H.next.y!==H.y&&Ee<(H.next.x-H.x)*(Ae-H.y)/(H.next.y-H.y)+H.x&&(Ce=!Ce),H=H.next;while(H!==oe);return Ce}function Le(oe,Q){var H=new Zt(oe.i,oe.x,oe.y),Ce=new Zt(Q.i,Q.x,Q.y),Ee=oe.next,Ae=Q.prev;return oe.next=Q,Q.prev=oe,H.next=Ee,Ee.prev=H,Ce.next=H,H.prev=Ce,Ae.next=Ce,Ce.prev=Ae,Ce}function ut(oe,Q,H,Ce){var Ee=new Zt(oe,Q,H);return Ce?(Ee.next=Ce.next,Ee.prev=Ce,Ce.next.prev=Ee,Ce.next=Ee):(Ee.prev=Ee,Ee.next=Ee),Ee}function Vt(oe){oe.next.prev=oe.prev,oe.prev.next=oe.next,oe.prevZ&&(oe.prevZ.nextZ=oe.nextZ),oe.nextZ&&(oe.nextZ.prevZ=oe.prevZ)}function Zt(oe,Q,H){this.i=oe,this.x=Q,this.y=H,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}T.deviation=function(oe,Q,H,Ce){var Ee=Q&&Q.length,Ae=Ee?Q[0]*H:oe.length,ge=Math.abs(ir(oe,0,Ae,H));if(Ee)for(var rt=0,Yt=Q.length;rt<Yt;rt++){var At=Q[rt]*H,be=rt<Yt-1?Q[rt+1]*H:oe.length;ge-=Math.abs(ir(oe,At,be,H))}var xe=0;for(rt=0;rt<Ce.length;rt+=3){var Ve=Ce[rt]*H,lt=Ce[rt+1]*H,Pe=Ce[rt+2]*H;xe+=Math.abs((oe[Ve]-oe[Pe])*(oe[lt+1]-oe[Ve+1])-(oe[Ve]-oe[lt])*(oe[Pe+1]-oe[Ve+1]))}return ge===0&&xe===0?0:Math.abs((xe-ge)/ge)};function ir(oe,Q,H,Ce){for(var Ee=0,Ae=Q,ge=H-Ce;Ae<H;Ae+=Ce)Ee+=(oe[ge]-oe[Ae])*(oe[Ae+1]+oe[ge+1]),ge=Ae;return Ee}T.flatten=function(oe){for(var Q=oe[0][0].length,H={vertices:[],holes:[],dimensions:Q},Ce=0,Ee=0;Ee<oe.length;Ee++){for(var Ae=0;Ae<oe[Ee].length;Ae++)for(var ge=0;ge<Q;ge++)H.vertices.push(oe[Ee][Ae][ge]);Ee>0&&(Ce+=oe[Ee-1].length,H.holes.push(Ce))}return H}},WFAs:function(Re,E){var i=Array.isArray;Re.exports=i},Wnft:function(Re,E,i){Re.exports={mapChart:"antd-pro-pages-dashboard-monitor-style-mapChart",pieCard:"antd-pro-pages-dashboard-monitor-style-pieCard"}},WwFo:function(Re,E,i){var T=i("juv8"),m=i("7GkX");function X(z,o){return z&&T(o,m(o),z)}Re.exports=X},XYm9:function(Re,E,i){var T=i("+K+b");function m(X,z){var o=z?T(X.buffer):X.buffer;return new X.constructor(o,X.byteOffset,X.byteLength)}Re.exports=m},"Xt/L":function(Re,E){function i(T,m,X){for(var z=-1,o=T==null?0:T.length;++z<o;)if(X(m,T[z]))return!0;return!1}Re.exports=i},Y8BV:function(Re,E,i){"use strict";i.d(E,"a",function(){return T});function T(m,X){var z=X.callback;return z&&(m.dataArray=m.dataArray.filter(z)),m}},YO3V:function(Re,E,i){var T=i("NykK"),m=i("LcsW"),X=i("ExA7"),z="[object Object]",o=Function.prototype,Z=Object.prototype,D=o.toString,K=Z.hasOwnProperty,re=D.call(Object);function de(Y){if(!X(Y)||T(Y)!=z)return!1;var Fe=m(Y);if(Fe===null)return!0;var Ze=K.call(Fe,"constructor")&&Fe.constructor;return typeof Ze=="function"&&Ze instanceof Ze&&D.call(Ze)==re}Re.exports=de},Yk9n:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("MON2"),m=i("xfSm"),X=i("GXnB"),z=i("Ztfv"),o=function(){function D(K){this._cb=K}return D.prototype.unwrap=function(){return this._cb()},D}();E.LazyServiceIdentifer=o;function Z(D){return function(K,re,de){if(D===void 0)throw new Error(T.UNDEFINED_INJECT_ANNOTATION(K.name));var Y=new X.Metadata(m.INJECT_TAG,D);typeof de=="number"?z.tagParameter(K,re,de,Y):z.tagProperty(K,re,Y)}}E.inject=Z},Z1HP:function(Re,E,i){var T=i("ycre"),m=i("quyA"),X=i("q4HE");function z(o){return m(o)?X(o):T(o)}Re.exports=z},ZCgT:function(Re,E,i){var T=i("tLB3"),m=1/0,X=17976931348623157e292;function z(o){if(!o)return o===0?o:0;if(o=T(o),o===m||o===-m){var Z=o<0?-1:1;return Z*X}return o===o?o:0}Re.exports=z},ZK94:function(Re,E){Re.exports.RADIUS=6378137,Re.exports.FLATTENING=1/298.257223563,Re.exports.POLAR_RADIUS=63567523142e-4},ZaHm:function(Re,E,i){"use strict";i.r(E),i.d(E,"create",function(){return m}),i.d(E,"clone",function(){return X}),i.d(E,"copy",function(){return z}),i.d(E,"fromValues",function(){return o}),i.d(E,"set",function(){return Z}),i.d(E,"identity",function(){return D}),i.d(E,"transpose",function(){return K}),i.d(E,"invert",function(){return re}),i.d(E,"adjoint",function(){return de}),i.d(E,"determinant",function(){return Y}),i.d(E,"multiply",function(){return Fe}),i.d(E,"translate",function(){return Ze}),i.d(E,"scale",function(){return ye}),i.d(E,"rotate",function(){return we}),i.d(E,"rotateX",function(){return pt}),i.d(E,"rotateY",function(){return je}),i.d(E,"rotateZ",function(){return Tt}),i.d(E,"fromTranslation",function(){return Xe}),i.d(E,"fromScaling",function(){return gt}),i.d(E,"fromRotation",function(){return Je}),i.d(E,"fromXRotation",function(){return Et}),i.d(E,"fromYRotation",function(){return _t}),i.d(E,"fromZRotation",function(){return Ne}),i.d(E,"fromRotationTranslation",function(){return ke}),i.d(E,"fromQuat2",function(){return Ue}),i.d(E,"getTranslation",function(){return st}),i.d(E,"getScaling",function(){return Le}),i.d(E,"getRotation",function(){return ut}),i.d(E,"fromRotationTranslationScale",function(){return Vt}),i.d(E,"fromRotationTranslationScaleOrigin",function(){return Zt}),i.d(E,"fromQuat",function(){return ir}),i.d(E,"frustum",function(){return oe}),i.d(E,"perspective",function(){return Q}),i.d(E,"perspectiveFromFieldOfView",function(){return H}),i.d(E,"ortho",function(){return Ce}),i.d(E,"lookAt",function(){return Ee}),i.d(E,"targetTo",function(){return Ae}),i.d(E,"str",function(){return ge}),i.d(E,"frob",function(){return rt}),i.d(E,"add",function(){return Yt}),i.d(E,"subtract",function(){return At}),i.d(E,"multiplyScalar",function(){return be}),i.d(E,"multiplyScalarAndAdd",function(){return xe}),i.d(E,"exactEquals",function(){return Ve}),i.d(E,"equals",function(){return lt}),i.d(E,"mul",function(){return Pe}),i.d(E,"sub",function(){return dt});var T=i("yU0y");function m(){var w=new T.a(16);return T.a!=Float32Array&&(w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=0,w[12]=0,w[13]=0,w[14]=0),w[0]=1,w[5]=1,w[10]=1,w[15]=1,w}function X(w){var I=new T.a(16);return I[0]=w[0],I[1]=w[1],I[2]=w[2],I[3]=w[3],I[4]=w[4],I[5]=w[5],I[6]=w[6],I[7]=w[7],I[8]=w[8],I[9]=w[9],I[10]=w[10],I[11]=w[11],I[12]=w[12],I[13]=w[13],I[14]=w[14],I[15]=w[15],I}function z(w,I){return w[0]=I[0],w[1]=I[1],w[2]=I[2],w[3]=I[3],w[4]=I[4],w[5]=I[5],w[6]=I[6],w[7]=I[7],w[8]=I[8],w[9]=I[9],w[10]=I[10],w[11]=I[11],w[12]=I[12],w[13]=I[13],w[14]=I[14],w[15]=I[15],w}function o(w,I,q,ce,Ge,$e,yt,nt,Nt,$,Ke,ae,et,jt,sr,ft){var mt=new T.a(16);return mt[0]=w,mt[1]=I,mt[2]=q,mt[3]=ce,mt[4]=Ge,mt[5]=$e,mt[6]=yt,mt[7]=nt,mt[8]=Nt,mt[9]=$,mt[10]=Ke,mt[11]=ae,mt[12]=et,mt[13]=jt,mt[14]=sr,mt[15]=ft,mt}function Z(w,I,q,ce,Ge,$e,yt,nt,Nt,$,Ke,ae,et,jt,sr,ft,mt){return w[0]=I,w[1]=q,w[2]=ce,w[3]=Ge,w[4]=$e,w[5]=yt,w[6]=nt,w[7]=Nt,w[8]=$,w[9]=Ke,w[10]=ae,w[11]=et,w[12]=jt,w[13]=sr,w[14]=ft,w[15]=mt,w}function D(w){return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function K(w,I){if(w===I){var q=I[1],ce=I[2],Ge=I[3],$e=I[6],yt=I[7],nt=I[11];w[1]=I[4],w[2]=I[8],w[3]=I[12],w[4]=q,w[6]=I[9],w[7]=I[13],w[8]=ce,w[9]=$e,w[11]=I[14],w[12]=Ge,w[13]=yt,w[14]=nt}else w[0]=I[0],w[1]=I[4],w[2]=I[8],w[3]=I[12],w[4]=I[1],w[5]=I[5],w[6]=I[9],w[7]=I[13],w[8]=I[2],w[9]=I[6],w[10]=I[10],w[11]=I[14],w[12]=I[3],w[13]=I[7],w[14]=I[11],w[15]=I[15];return w}function re(w,I){var q=I[0],ce=I[1],Ge=I[2],$e=I[3],yt=I[4],nt=I[5],Nt=I[6],$=I[7],Ke=I[8],ae=I[9],et=I[10],jt=I[11],sr=I[12],ft=I[13],mt=I[14],Ct=I[15],vt=q*nt-ce*yt,Oe=q*Nt-Ge*yt,ct=q*$-$e*yt,Qe=ce*Nt-Ge*nt,Ft=ce*$-$e*nt,vr=Ge*$-$e*Nt,Vr=Ke*ft-ae*sr,lr=Ke*mt-et*sr,Nn=Ke*Ct-jt*sr,vn=ae*mt-et*ft,na=ae*Ct-jt*ft,ha=et*Ct-jt*mt,Zn=vt*ha-Oe*na+ct*vn+Qe*Nn-Ft*lr+vr*Vr;return Zn?(Zn=1/Zn,w[0]=(nt*ha-Nt*na+$*vn)*Zn,w[1]=(Ge*na-ce*ha-$e*vn)*Zn,w[2]=(ft*vr-mt*Ft+Ct*Qe)*Zn,w[3]=(et*Ft-ae*vr-jt*Qe)*Zn,w[4]=(Nt*Nn-yt*ha-$*lr)*Zn,w[5]=(q*ha-Ge*Nn+$e*lr)*Zn,w[6]=(mt*ct-sr*vr-Ct*Oe)*Zn,w[7]=(Ke*vr-et*ct+jt*Oe)*Zn,w[8]=(yt*na-nt*Nn+$*Vr)*Zn,w[9]=(ce*Nn-q*na-$e*Vr)*Zn,w[10]=(sr*Ft-ft*ct+Ct*vt)*Zn,w[11]=(ae*ct-Ke*Ft-jt*vt)*Zn,w[12]=(nt*lr-yt*vn-Nt*Vr)*Zn,w[13]=(q*vn-ce*lr+Ge*Vr)*Zn,w[14]=(ft*Oe-sr*Qe-mt*vt)*Zn,w[15]=(Ke*Qe-ae*Oe+et*vt)*Zn,w):null}function de(w,I){var q=I[0],ce=I[1],Ge=I[2],$e=I[3],yt=I[4],nt=I[5],Nt=I[6],$=I[7],Ke=I[8],ae=I[9],et=I[10],jt=I[11],sr=I[12],ft=I[13],mt=I[14],Ct=I[15];return w[0]=nt*(et*Ct-jt*mt)-ae*(Nt*Ct-$*mt)+ft*(Nt*jt-$*et),w[1]=-(ce*(et*Ct-jt*mt)-ae*(Ge*Ct-$e*mt)+ft*(Ge*jt-$e*et)),w[2]=ce*(Nt*Ct-$*mt)-nt*(Ge*Ct-$e*mt)+ft*(Ge*$-$e*Nt),w[3]=-(ce*(Nt*jt-$*et)-nt*(Ge*jt-$e*et)+ae*(Ge*$-$e*Nt)),w[4]=-(yt*(et*Ct-jt*mt)-Ke*(Nt*Ct-$*mt)+sr*(Nt*jt-$*et)),w[5]=q*(et*Ct-jt*mt)-Ke*(Ge*Ct-$e*mt)+sr*(Ge*jt-$e*et),w[6]=-(q*(Nt*Ct-$*mt)-yt*(Ge*Ct-$e*mt)+sr*(Ge*$-$e*Nt)),w[7]=q*(Nt*jt-$*et)-yt*(Ge*jt-$e*et)+Ke*(Ge*$-$e*Nt),w[8]=yt*(ae*Ct-jt*ft)-Ke*(nt*Ct-$*ft)+sr*(nt*jt-$*ae),w[9]=-(q*(ae*Ct-jt*ft)-Ke*(ce*Ct-$e*ft)+sr*(ce*jt-$e*ae)),w[10]=q*(nt*Ct-$*ft)-yt*(ce*Ct-$e*ft)+sr*(ce*$-$e*nt),w[11]=-(q*(nt*jt-$*ae)-yt*(ce*jt-$e*ae)+Ke*(ce*$-$e*nt)),w[12]=-(yt*(ae*mt-et*ft)-Ke*(nt*mt-Nt*ft)+sr*(nt*et-Nt*ae)),w[13]=q*(ae*mt-et*ft)-Ke*(ce*mt-Ge*ft)+sr*(ce*et-Ge*ae),w[14]=-(q*(nt*mt-Nt*ft)-yt*(ce*mt-Ge*ft)+sr*(ce*Nt-Ge*nt)),w[15]=q*(nt*et-Nt*ae)-yt*(ce*et-Ge*ae)+Ke*(ce*Nt-Ge*nt),w}function Y(w){var I=w[0],q=w[1],ce=w[2],Ge=w[3],$e=w[4],yt=w[5],nt=w[6],Nt=w[7],$=w[8],Ke=w[9],ae=w[10],et=w[11],jt=w[12],sr=w[13],ft=w[14],mt=w[15],Ct=I*yt-q*$e,vt=I*nt-ce*$e,Oe=I*Nt-Ge*$e,ct=q*nt-ce*yt,Qe=q*Nt-Ge*yt,Ft=ce*Nt-Ge*nt,vr=$*sr-Ke*jt,Vr=$*ft-ae*jt,lr=$*mt-et*jt,Nn=Ke*ft-ae*sr,vn=Ke*mt-et*sr,na=ae*mt-et*ft;return Ct*na-vt*vn+Oe*Nn+ct*lr-Qe*Vr+Ft*vr}function Fe(w,I,q){var ce=I[0],Ge=I[1],$e=I[2],yt=I[3],nt=I[4],Nt=I[5],$=I[6],Ke=I[7],ae=I[8],et=I[9],jt=I[10],sr=I[11],ft=I[12],mt=I[13],Ct=I[14],vt=I[15],Oe=q[0],ct=q[1],Qe=q[2],Ft=q[3];return w[0]=Oe*ce+ct*nt+Qe*ae+Ft*ft,w[1]=Oe*Ge+ct*Nt+Qe*et+Ft*mt,w[2]=Oe*$e+ct*$+Qe*jt+Ft*Ct,w[3]=Oe*yt+ct*Ke+Qe*sr+Ft*vt,Oe=q[4],ct=q[5],Qe=q[6],Ft=q[7],w[4]=Oe*ce+ct*nt+Qe*ae+Ft*ft,w[5]=Oe*Ge+ct*Nt+Qe*et+Ft*mt,w[6]=Oe*$e+ct*$+Qe*jt+Ft*Ct,w[7]=Oe*yt+ct*Ke+Qe*sr+Ft*vt,Oe=q[8],ct=q[9],Qe=q[10],Ft=q[11],w[8]=Oe*ce+ct*nt+Qe*ae+Ft*ft,w[9]=Oe*Ge+ct*Nt+Qe*et+Ft*mt,w[10]=Oe*$e+ct*$+Qe*jt+Ft*Ct,w[11]=Oe*yt+ct*Ke+Qe*sr+Ft*vt,Oe=q[12],ct=q[13],Qe=q[14],Ft=q[15],w[12]=Oe*ce+ct*nt+Qe*ae+Ft*ft,w[13]=Oe*Ge+ct*Nt+Qe*et+Ft*mt,w[14]=Oe*$e+ct*$+Qe*jt+Ft*Ct,w[15]=Oe*yt+ct*Ke+Qe*sr+Ft*vt,w}function Ze(w,I,q){var ce=q[0],Ge=q[1],$e=q[2],yt,nt,Nt,$,Ke,ae,et,jt,sr,ft,mt,Ct;return I===w?(w[12]=I[0]*ce+I[4]*Ge+I[8]*$e+I[12],w[13]=I[1]*ce+I[5]*Ge+I[9]*$e+I[13],w[14]=I[2]*ce+I[6]*Ge+I[10]*$e+I[14],w[15]=I[3]*ce+I[7]*Ge+I[11]*$e+I[15]):(yt=I[0],nt=I[1],Nt=I[2],$=I[3],Ke=I[4],ae=I[5],et=I[6],jt=I[7],sr=I[8],ft=I[9],mt=I[10],Ct=I[11],w[0]=yt,w[1]=nt,w[2]=Nt,w[3]=$,w[4]=Ke,w[5]=ae,w[6]=et,w[7]=jt,w[8]=sr,w[9]=ft,w[10]=mt,w[11]=Ct,w[12]=yt*ce+Ke*Ge+sr*$e+I[12],w[13]=nt*ce+ae*Ge+ft*$e+I[13],w[14]=Nt*ce+et*Ge+mt*$e+I[14],w[15]=$*ce+jt*Ge+Ct*$e+I[15]),w}function ye(w,I,q){var ce=q[0],Ge=q[1],$e=q[2];return w[0]=I[0]*ce,w[1]=I[1]*ce,w[2]=I[2]*ce,w[3]=I[3]*ce,w[4]=I[4]*Ge,w[5]=I[5]*Ge,w[6]=I[6]*Ge,w[7]=I[7]*Ge,w[8]=I[8]*$e,w[9]=I[9]*$e,w[10]=I[10]*$e,w[11]=I[11]*$e,w[12]=I[12],w[13]=I[13],w[14]=I[14],w[15]=I[15],w}function we(w,I,q,ce){var Ge=ce[0],$e=ce[1],yt=ce[2],nt=Math.hypot(Ge,$e,yt),Nt,$,Ke,ae,et,jt,sr,ft,mt,Ct,vt,Oe,ct,Qe,Ft,vr,Vr,lr,Nn,vn,na,ha,Zn,Hn;return nt<T.b?null:(nt=1/nt,Ge*=nt,$e*=nt,yt*=nt,Nt=Math.sin(q),$=Math.cos(q),Ke=1-$,ae=I[0],et=I[1],jt=I[2],sr=I[3],ft=I[4],mt=I[5],Ct=I[6],vt=I[7],Oe=I[8],ct=I[9],Qe=I[10],Ft=I[11],vr=Ge*Ge*Ke+$,Vr=$e*Ge*Ke+yt*Nt,lr=yt*Ge*Ke-$e*Nt,Nn=Ge*$e*Ke-yt*Nt,vn=$e*$e*Ke+$,na=yt*$e*Ke+Ge*Nt,ha=Ge*yt*Ke+$e*Nt,Zn=$e*yt*Ke-Ge*Nt,Hn=yt*yt*Ke+$,w[0]=ae*vr+ft*Vr+Oe*lr,w[1]=et*vr+mt*Vr+ct*lr,w[2]=jt*vr+Ct*Vr+Qe*lr,w[3]=sr*vr+vt*Vr+Ft*lr,w[4]=ae*Nn+ft*vn+Oe*na,w[5]=et*Nn+mt*vn+ct*na,w[6]=jt*Nn+Ct*vn+Qe*na,w[7]=sr*Nn+vt*vn+Ft*na,w[8]=ae*ha+ft*Zn+Oe*Hn,w[9]=et*ha+mt*Zn+ct*Hn,w[10]=jt*ha+Ct*Zn+Qe*Hn,w[11]=sr*ha+vt*Zn+Ft*Hn,I!==w&&(w[12]=I[12],w[13]=I[13],w[14]=I[14],w[15]=I[15]),w)}function pt(w,I,q){var ce=Math.sin(q),Ge=Math.cos(q),$e=I[4],yt=I[5],nt=I[6],Nt=I[7],$=I[8],Ke=I[9],ae=I[10],et=I[11];return I!==w&&(w[0]=I[0],w[1]=I[1],w[2]=I[2],w[3]=I[3],w[12]=I[12],w[13]=I[13],w[14]=I[14],w[15]=I[15]),w[4]=$e*Ge+$*ce,w[5]=yt*Ge+Ke*ce,w[6]=nt*Ge+ae*ce,w[7]=Nt*Ge+et*ce,w[8]=$*Ge-$e*ce,w[9]=Ke*Ge-yt*ce,w[10]=ae*Ge-nt*ce,w[11]=et*Ge-Nt*ce,w}function je(w,I,q){var ce=Math.sin(q),Ge=Math.cos(q),$e=I[0],yt=I[1],nt=I[2],Nt=I[3],$=I[8],Ke=I[9],ae=I[10],et=I[11];return I!==w&&(w[4]=I[4],w[5]=I[5],w[6]=I[6],w[7]=I[7],w[12]=I[12],w[13]=I[13],w[14]=I[14],w[15]=I[15]),w[0]=$e*Ge-$*ce,w[1]=yt*Ge-Ke*ce,w[2]=nt*Ge-ae*ce,w[3]=Nt*Ge-et*ce,w[8]=$e*ce+$*Ge,w[9]=yt*ce+Ke*Ge,w[10]=nt*ce+ae*Ge,w[11]=Nt*ce+et*Ge,w}function Tt(w,I,q){var ce=Math.sin(q),Ge=Math.cos(q),$e=I[0],yt=I[1],nt=I[2],Nt=I[3],$=I[4],Ke=I[5],ae=I[6],et=I[7];return I!==w&&(w[8]=I[8],w[9]=I[9],w[10]=I[10],w[11]=I[11],w[12]=I[12],w[13]=I[13],w[14]=I[14],w[15]=I[15]),w[0]=$e*Ge+$*ce,w[1]=yt*Ge+Ke*ce,w[2]=nt*Ge+ae*ce,w[3]=Nt*Ge+et*ce,w[4]=$*Ge-$e*ce,w[5]=Ke*Ge-yt*ce,w[6]=ae*Ge-nt*ce,w[7]=et*Ge-Nt*ce,w}function Xe(w,I){return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=I[0],w[13]=I[1],w[14]=I[2],w[15]=1,w}function gt(w,I){return w[0]=I[0],w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=I[1],w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=I[2],w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function Je(w,I,q){var ce=q[0],Ge=q[1],$e=q[2],yt=Math.hypot(ce,Ge,$e),nt,Nt,$;return yt<T.b?null:(yt=1/yt,ce*=yt,Ge*=yt,$e*=yt,nt=Math.sin(I),Nt=Math.cos(I),$=1-Nt,w[0]=ce*ce*$+Nt,w[1]=Ge*ce*$+$e*nt,w[2]=$e*ce*$-Ge*nt,w[3]=0,w[4]=ce*Ge*$-$e*nt,w[5]=Ge*Ge*$+Nt,w[6]=$e*Ge*$+ce*nt,w[7]=0,w[8]=ce*$e*$+Ge*nt,w[9]=Ge*$e*$-ce*nt,w[10]=$e*$e*$+Nt,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w)}function Et(w,I){var q=Math.sin(I),ce=Math.cos(I);return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=ce,w[6]=q,w[7]=0,w[8]=0,w[9]=-q,w[10]=ce,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function _t(w,I){var q=Math.sin(I),ce=Math.cos(I);return w[0]=ce,w[1]=0,w[2]=-q,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=q,w[9]=0,w[10]=ce,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function Ne(w,I){var q=Math.sin(I),ce=Math.cos(I);return w[0]=ce,w[1]=q,w[2]=0,w[3]=0,w[4]=-q,w[5]=ce,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function ke(w,I,q){var ce=I[0],Ge=I[1],$e=I[2],yt=I[3],nt=ce+ce,Nt=Ge+Ge,$=$e+$e,Ke=ce*nt,ae=ce*Nt,et=ce*$,jt=Ge*Nt,sr=Ge*$,ft=$e*$,mt=yt*nt,Ct=yt*Nt,vt=yt*$;return w[0]=1-(jt+ft),w[1]=ae+vt,w[2]=et-Ct,w[3]=0,w[4]=ae-vt,w[5]=1-(Ke+ft),w[6]=sr+mt,w[7]=0,w[8]=et+Ct,w[9]=sr-mt,w[10]=1-(Ke+jt),w[11]=0,w[12]=q[0],w[13]=q[1],w[14]=q[2],w[15]=1,w}function Ue(w,I){var q=new T.a(3),ce=-I[0],Ge=-I[1],$e=-I[2],yt=I[3],nt=I[4],Nt=I[5],$=I[6],Ke=I[7],ae=ce*ce+Ge*Ge+$e*$e+yt*yt;return ae>0?(q[0]=(nt*yt+Ke*ce+Nt*$e-$*Ge)*2/ae,q[1]=(Nt*yt+Ke*Ge+$*ce-nt*$e)*2/ae,q[2]=($*yt+Ke*$e+nt*Ge-Nt*ce)*2/ae):(q[0]=(nt*yt+Ke*ce+Nt*$e-$*Ge)*2,q[1]=(Nt*yt+Ke*Ge+$*ce-nt*$e)*2,q[2]=($*yt+Ke*$e+nt*Ge-Nt*ce)*2),ke(w,I,q),w}function st(w,I){return w[0]=I[12],w[1]=I[13],w[2]=I[14],w}function Le(w,I){var q=I[0],ce=I[1],Ge=I[2],$e=I[4],yt=I[5],nt=I[6],Nt=I[8],$=I[9],Ke=I[10];return w[0]=Math.hypot(q,ce,Ge),w[1]=Math.hypot($e,yt,nt),w[2]=Math.hypot(Nt,$,Ke),w}function ut(w,I){var q=new T.a(3);Le(q,I);var ce=1/q[0],Ge=1/q[1],$e=1/q[2],yt=I[0]*ce,nt=I[1]*Ge,Nt=I[2]*$e,$=I[4]*ce,Ke=I[5]*Ge,ae=I[6]*$e,et=I[8]*ce,jt=I[9]*Ge,sr=I[10]*$e,ft=yt+Ke+sr,mt=0;return ft>0?(mt=Math.sqrt(ft+1)*2,w[3]=.25*mt,w[0]=(ae-jt)/mt,w[1]=(et-Nt)/mt,w[2]=(nt-$)/mt):yt>Ke&&yt>sr?(mt=Math.sqrt(1+yt-Ke-sr)*2,w[3]=(ae-jt)/mt,w[0]=.25*mt,w[1]=(nt+$)/mt,w[2]=(et+Nt)/mt):Ke>sr?(mt=Math.sqrt(1+Ke-yt-sr)*2,w[3]=(et-Nt)/mt,w[0]=(nt+$)/mt,w[1]=.25*mt,w[2]=(ae+jt)/mt):(mt=Math.sqrt(1+sr-yt-Ke)*2,w[3]=(nt-$)/mt,w[0]=(et+Nt)/mt,w[1]=(ae+jt)/mt,w[2]=.25*mt),w}function Vt(w,I,q,ce){var Ge=I[0],$e=I[1],yt=I[2],nt=I[3],Nt=Ge+Ge,$=$e+$e,Ke=yt+yt,ae=Ge*Nt,et=Ge*$,jt=Ge*Ke,sr=$e*$,ft=$e*Ke,mt=yt*Ke,Ct=nt*Nt,vt=nt*$,Oe=nt*Ke,ct=ce[0],Qe=ce[1],Ft=ce[2];return w[0]=(1-(sr+mt))*ct,w[1]=(et+Oe)*ct,w[2]=(jt-vt)*ct,w[3]=0,w[4]=(et-Oe)*Qe,w[5]=(1-(ae+mt))*Qe,w[6]=(ft+Ct)*Qe,w[7]=0,w[8]=(jt+vt)*Ft,w[9]=(ft-Ct)*Ft,w[10]=(1-(ae+sr))*Ft,w[11]=0,w[12]=q[0],w[13]=q[1],w[14]=q[2],w[15]=1,w}function Zt(w,I,q,ce,Ge){var $e=I[0],yt=I[1],nt=I[2],Nt=I[3],$=$e+$e,Ke=yt+yt,ae=nt+nt,et=$e*$,jt=$e*Ke,sr=$e*ae,ft=yt*Ke,mt=yt*ae,Ct=nt*ae,vt=Nt*$,Oe=Nt*Ke,ct=Nt*ae,Qe=ce[0],Ft=ce[1],vr=ce[2],Vr=Ge[0],lr=Ge[1],Nn=Ge[2],vn=(1-(ft+Ct))*Qe,na=(jt+ct)*Qe,ha=(sr-Oe)*Qe,Zn=(jt-ct)*Ft,Hn=(1-(et+Ct))*Ft,F=(mt+vt)*Ft,W=(sr+Oe)*vr,le=(mt-vt)*vr,me=(1-(et+ft))*vr;return w[0]=vn,w[1]=na,w[2]=ha,w[3]=0,w[4]=Zn,w[5]=Hn,w[6]=F,w[7]=0,w[8]=W,w[9]=le,w[10]=me,w[11]=0,w[12]=q[0]+Vr-(vn*Vr+Zn*lr+W*Nn),w[13]=q[1]+lr-(na*Vr+Hn*lr+le*Nn),w[14]=q[2]+Nn-(ha*Vr+F*lr+me*Nn),w[15]=1,w}function ir(w,I){var q=I[0],ce=I[1],Ge=I[2],$e=I[3],yt=q+q,nt=ce+ce,Nt=Ge+Ge,$=q*yt,Ke=ce*yt,ae=ce*nt,et=Ge*yt,jt=Ge*nt,sr=Ge*Nt,ft=$e*yt,mt=$e*nt,Ct=$e*Nt;return w[0]=1-ae-sr,w[1]=Ke+Ct,w[2]=et-mt,w[3]=0,w[4]=Ke-Ct,w[5]=1-$-sr,w[6]=jt+ft,w[7]=0,w[8]=et+mt,w[9]=jt-ft,w[10]=1-$-ae,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function oe(w,I,q,ce,Ge,$e,yt){var nt=1/(q-I),Nt=1/(Ge-ce),$=1/($e-yt);return w[0]=$e*2*nt,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=$e*2*Nt,w[6]=0,w[7]=0,w[8]=(q+I)*nt,w[9]=(Ge+ce)*Nt,w[10]=(yt+$e)*$,w[11]=-1,w[12]=0,w[13]=0,w[14]=yt*$e*2*$,w[15]=0,w}function Q(w,I,q,ce,Ge){var $e=1/Math.tan(I/2),yt;return w[0]=$e/q,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=$e,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=-1,w[12]=0,w[13]=0,w[15]=0,Ge!=null&&Ge!==Infinity?(yt=1/(ce-Ge),w[10]=(Ge+ce)*yt,w[14]=2*Ge*ce*yt):(w[10]=-1,w[14]=-2*ce),w}function H(w,I,q,ce){var Ge=Math.tan(I.upDegrees*Math.PI/180),$e=Math.tan(I.downDegrees*Math.PI/180),yt=Math.tan(I.leftDegrees*Math.PI/180),nt=Math.tan(I.rightDegrees*Math.PI/180),Nt=2/(yt+nt),$=2/(Ge+$e);return w[0]=Nt,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=$,w[6]=0,w[7]=0,w[8]=-((yt-nt)*Nt*.5),w[9]=(Ge-$e)*$*.5,w[10]=ce/(q-ce),w[11]=-1,w[12]=0,w[13]=0,w[14]=ce*q/(q-ce),w[15]=0,w}function Ce(w,I,q,ce,Ge,$e,yt){var nt=1/(I-q),Nt=1/(ce-Ge),$=1/($e-yt);return w[0]=-2*nt,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=-2*Nt,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=2*$,w[11]=0,w[12]=(I+q)*nt,w[13]=(Ge+ce)*Nt,w[14]=(yt+$e)*$,w[15]=1,w}function Ee(w,I,q,ce){var Ge,$e,yt,nt,Nt,$,Ke,ae,et,jt,sr=I[0],ft=I[1],mt=I[2],Ct=ce[0],vt=ce[1],Oe=ce[2],ct=q[0],Qe=q[1],Ft=q[2];return Math.abs(sr-ct)<T.b&&Math.abs(ft-Qe)<T.b&&Math.abs(mt-Ft)<T.b?D(w):(Ke=sr-ct,ae=ft-Qe,et=mt-Ft,jt=1/Math.hypot(Ke,ae,et),Ke*=jt,ae*=jt,et*=jt,Ge=vt*et-Oe*ae,$e=Oe*Ke-Ct*et,yt=Ct*ae-vt*Ke,jt=Math.hypot(Ge,$e,yt),jt?(jt=1/jt,Ge*=jt,$e*=jt,yt*=jt):(Ge=0,$e=0,yt=0),nt=ae*yt-et*$e,Nt=et*Ge-Ke*yt,$=Ke*$e-ae*Ge,jt=Math.hypot(nt,Nt,$),jt?(jt=1/jt,nt*=jt,Nt*=jt,$*=jt):(nt=0,Nt=0,$=0),w[0]=Ge,w[1]=nt,w[2]=Ke,w[3]=0,w[4]=$e,w[5]=Nt,w[6]=ae,w[7]=0,w[8]=yt,w[9]=$,w[10]=et,w[11]=0,w[12]=-(Ge*sr+$e*ft+yt*mt),w[13]=-(nt*sr+Nt*ft+$*mt),w[14]=-(Ke*sr+ae*ft+et*mt),w[15]=1,w)}function Ae(w,I,q,ce){var Ge=I[0],$e=I[1],yt=I[2],nt=ce[0],Nt=ce[1],$=ce[2],Ke=Ge-q[0],ae=$e-q[1],et=yt-q[2],jt=Ke*Ke+ae*ae+et*et;jt>0&&(jt=1/Math.sqrt(jt),Ke*=jt,ae*=jt,et*=jt);var sr=Nt*et-$*ae,ft=$*Ke-nt*et,mt=nt*ae-Nt*Ke;return jt=sr*sr+ft*ft+mt*mt,jt>0&&(jt=1/Math.sqrt(jt),sr*=jt,ft*=jt,mt*=jt),w[0]=sr,w[1]=ft,w[2]=mt,w[3]=0,w[4]=ae*mt-et*ft,w[5]=et*sr-Ke*mt,w[6]=Ke*ft-ae*sr,w[7]=0,w[8]=Ke,w[9]=ae,w[10]=et,w[11]=0,w[12]=Ge,w[13]=$e,w[14]=yt,w[15]=1,w}function ge(w){return"mat4("+w[0]+", "+w[1]+", "+w[2]+", "+w[3]+", "+w[4]+", "+w[5]+", "+w[6]+", "+w[7]+", "+w[8]+", "+w[9]+", "+w[10]+", "+w[11]+", "+w[12]+", "+w[13]+", "+w[14]+", "+w[15]+")"}function rt(w){return Math.hypot(w[0],w[1],w[2],w[3],w[4],w[5],w[6],w[7],w[8],w[9],w[10],w[11],w[12],w[13],w[14],w[15])}function Yt(w,I,q){return w[0]=I[0]+q[0],w[1]=I[1]+q[1],w[2]=I[2]+q[2],w[3]=I[3]+q[3],w[4]=I[4]+q[4],w[5]=I[5]+q[5],w[6]=I[6]+q[6],w[7]=I[7]+q[7],w[8]=I[8]+q[8],w[9]=I[9]+q[9],w[10]=I[10]+q[10],w[11]=I[11]+q[11],w[12]=I[12]+q[12],w[13]=I[13]+q[13],w[14]=I[14]+q[14],w[15]=I[15]+q[15],w}function At(w,I,q){return w[0]=I[0]-q[0],w[1]=I[1]-q[1],w[2]=I[2]-q[2],w[3]=I[3]-q[3],w[4]=I[4]-q[4],w[5]=I[5]-q[5],w[6]=I[6]-q[6],w[7]=I[7]-q[7],w[8]=I[8]-q[8],w[9]=I[9]-q[9],w[10]=I[10]-q[10],w[11]=I[11]-q[11],w[12]=I[12]-q[12],w[13]=I[13]-q[13],w[14]=I[14]-q[14],w[15]=I[15]-q[15],w}function be(w,I,q){return w[0]=I[0]*q,w[1]=I[1]*q,w[2]=I[2]*q,w[3]=I[3]*q,w[4]=I[4]*q,w[5]=I[5]*q,w[6]=I[6]*q,w[7]=I[7]*q,w[8]=I[8]*q,w[9]=I[9]*q,w[10]=I[10]*q,w[11]=I[11]*q,w[12]=I[12]*q,w[13]=I[13]*q,w[14]=I[14]*q,w[15]=I[15]*q,w}function xe(w,I,q,ce){return w[0]=I[0]+q[0]*ce,w[1]=I[1]+q[1]*ce,w[2]=I[2]+q[2]*ce,w[3]=I[3]+q[3]*ce,w[4]=I[4]+q[4]*ce,w[5]=I[5]+q[5]*ce,w[6]=I[6]+q[6]*ce,w[7]=I[7]+q[7]*ce,w[8]=I[8]+q[8]*ce,w[9]=I[9]+q[9]*ce,w[10]=I[10]+q[10]*ce,w[11]=I[11]+q[11]*ce,w[12]=I[12]+q[12]*ce,w[13]=I[13]+q[13]*ce,w[14]=I[14]+q[14]*ce,w[15]=I[15]+q[15]*ce,w}function Ve(w,I){return w[0]===I[0]&&w[1]===I[1]&&w[2]===I[2]&&w[3]===I[3]&&w[4]===I[4]&&w[5]===I[5]&&w[6]===I[6]&&w[7]===I[7]&&w[8]===I[8]&&w[9]===I[9]&&w[10]===I[10]&&w[11]===I[11]&&w[12]===I[12]&&w[13]===I[13]&&w[14]===I[14]&&w[15]===I[15]}function lt(w,I){var q=w[0],ce=w[1],Ge=w[2],$e=w[3],yt=w[4],nt=w[5],Nt=w[6],$=w[7],Ke=w[8],ae=w[9],et=w[10],jt=w[11],sr=w[12],ft=w[13],mt=w[14],Ct=w[15],vt=I[0],Oe=I[1],ct=I[2],Qe=I[3],Ft=I[4],vr=I[5],Vr=I[6],lr=I[7],Nn=I[8],vn=I[9],na=I[10],ha=I[11],Zn=I[12],Hn=I[13],F=I[14],W=I[15];return Math.abs(q-vt)<=T.b*Math.max(1,Math.abs(q),Math.abs(vt))&&Math.abs(ce-Oe)<=T.b*Math.max(1,Math.abs(ce),Math.abs(Oe))&&Math.abs(Ge-ct)<=T.b*Math.max(1,Math.abs(Ge),Math.abs(ct))&&Math.abs($e-Qe)<=T.b*Math.max(1,Math.abs($e),Math.abs(Qe))&&Math.abs(yt-Ft)<=T.b*Math.max(1,Math.abs(yt),Math.abs(Ft))&&Math.abs(nt-vr)<=T.b*Math.max(1,Math.abs(nt),Math.abs(vr))&&Math.abs(Nt-Vr)<=T.b*Math.max(1,Math.abs(Nt),Math.abs(Vr))&&Math.abs($-lr)<=T.b*Math.max(1,Math.abs($),Math.abs(lr))&&Math.abs(Ke-Nn)<=T.b*Math.max(1,Math.abs(Ke),Math.abs(Nn))&&Math.abs(ae-vn)<=T.b*Math.max(1,Math.abs(ae),Math.abs(vn))&&Math.abs(et-na)<=T.b*Math.max(1,Math.abs(et),Math.abs(na))&&Math.abs(jt-ha)<=T.b*Math.max(1,Math.abs(jt),Math.abs(ha))&&Math.abs(sr-Zn)<=T.b*Math.max(1,Math.abs(sr),Math.abs(Zn))&&Math.abs(ft-Hn)<=T.b*Math.max(1,Math.abs(ft),Math.abs(Hn))&&Math.abs(mt-F)<=T.b*Math.max(1,Math.abs(mt),Math.abs(F))&&Math.abs(Ct-W)<=T.b*Math.max(1,Math.abs(Ct),Math.abs(W))}var Pe=Fe,dt=At},Ztfv:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("MON2"),m=i("xfSm");function X(re,de,Y,Fe){var Ze=m.TAGGED;o(Ze,re,de,Fe,Y)}E.tagParameter=X;function z(re,de,Y){var Fe=m.TAGGED_PROP;o(Fe,re.constructor,de,Y)}E.tagProperty=z;function o(re,de,Y,Fe,Ze){var ye={},we=typeof Ze=="number",pt=Ze!==void 0&&we?Ze.toString():Y;if(we&&Y!==void 0)throw new Error(T.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(re,de)&&(ye=Reflect.getMetadata(re,de));var je=ye[pt];if(!Array.isArray(je))je=[];else for(var Tt=0,Xe=je;Tt<Xe.length;Tt++){var gt=Xe[Tt];if(gt.key===Fe.key)throw new Error(T.DUPLICATED_METADATA+" "+gt.key.toString())}je.push(Fe),ye[pt]=je,Reflect.defineMetadata(re,ye,de)}function Z(re,de){Reflect.decorate(re,de)}function D(re,de){return function(Y,Fe){de(Y,Fe,re)}}function K(re,de,Y){typeof Y=="number"?Z([D(Y,re)],de):typeof Y=="string"?Reflect.decorate([re],de,Y):Z([re],de)}E.decorate=K},ZxFD:function(Re,E,i){"use strict";i.r(E),i.d(E,"create",function(){return m}),i.d(E,"clone",function(){return X}),i.d(E,"fromValues",function(){return z}),i.d(E,"copy",function(){return o}),i.d(E,"set",function(){return Z}),i.d(E,"add",function(){return D}),i.d(E,"subtract",function(){return K}),i.d(E,"multiply",function(){return re}),i.d(E,"divide",function(){return de}),i.d(E,"ceil",function(){return Y}),i.d(E,"floor",function(){return Fe}),i.d(E,"min",function(){return Ze}),i.d(E,"max",function(){return ye}),i.d(E,"round",function(){return we}),i.d(E,"scale",function(){return pt}),i.d(E,"scaleAndAdd",function(){return je}),i.d(E,"distance",function(){return Tt}),i.d(E,"squaredDistance",function(){return Xe}),i.d(E,"length",function(){return gt}),i.d(E,"squaredLength",function(){return Je}),i.d(E,"negate",function(){return Et}),i.d(E,"inverse",function(){return _t}),i.d(E,"normalize",function(){return Ne}),i.d(E,"dot",function(){return ke}),i.d(E,"cross",function(){return Ue}),i.d(E,"lerp",function(){return st}),i.d(E,"random",function(){return Le}),i.d(E,"transformMat2",function(){return ut}),i.d(E,"transformMat2d",function(){return Vt}),i.d(E,"transformMat3",function(){return Zt}),i.d(E,"transformMat4",function(){return ir}),i.d(E,"rotate",function(){return oe}),i.d(E,"angle",function(){return Q}),i.d(E,"zero",function(){return H}),i.d(E,"str",function(){return Ce}),i.d(E,"exactEquals",function(){return Ee}),i.d(E,"equals",function(){return Ae}),i.d(E,"len",function(){return ge}),i.d(E,"sub",function(){return rt}),i.d(E,"mul",function(){return Yt}),i.d(E,"div",function(){return At}),i.d(E,"dist",function(){return be}),i.d(E,"sqrDist",function(){return xe}),i.d(E,"sqrLen",function(){return Ve}),i.d(E,"forEach",function(){return lt});var T=i("yU0y");function m(){var Pe=new T.a(2);return T.a!=Float32Array&&(Pe[0]=0,Pe[1]=0),Pe}function X(Pe){var dt=new T.a(2);return dt[0]=Pe[0],dt[1]=Pe[1],dt}function z(Pe,dt){var w=new T.a(2);return w[0]=Pe,w[1]=dt,w}function o(Pe,dt){return Pe[0]=dt[0],Pe[1]=dt[1],Pe}function Z(Pe,dt,w){return Pe[0]=dt,Pe[1]=w,Pe}function D(Pe,dt,w){return Pe[0]=dt[0]+w[0],Pe[1]=dt[1]+w[1],Pe}function K(Pe,dt,w){return Pe[0]=dt[0]-w[0],Pe[1]=dt[1]-w[1],Pe}function re(Pe,dt,w){return Pe[0]=dt[0]*w[0],Pe[1]=dt[1]*w[1],Pe}function de(Pe,dt,w){return Pe[0]=dt[0]/w[0],Pe[1]=dt[1]/w[1],Pe}function Y(Pe,dt){return Pe[0]=Math.ceil(dt[0]),Pe[1]=Math.ceil(dt[1]),Pe}function Fe(Pe,dt){return Pe[0]=Math.floor(dt[0]),Pe[1]=Math.floor(dt[1]),Pe}function Ze(Pe,dt,w){return Pe[0]=Math.min(dt[0],w[0]),Pe[1]=Math.min(dt[1],w[1]),Pe}function ye(Pe,dt,w){return Pe[0]=Math.max(dt[0],w[0]),Pe[1]=Math.max(dt[1],w[1]),Pe}function we(Pe,dt){return Pe[0]=Math.round(dt[0]),Pe[1]=Math.round(dt[1]),Pe}function pt(Pe,dt,w){return Pe[0]=dt[0]*w,Pe[1]=dt[1]*w,Pe}function je(Pe,dt,w,I){return Pe[0]=dt[0]+w[0]*I,Pe[1]=dt[1]+w[1]*I,Pe}function Tt(Pe,dt){var w=dt[0]-Pe[0],I=dt[1]-Pe[1];return Math.hypot(w,I)}function Xe(Pe,dt){var w=dt[0]-Pe[0],I=dt[1]-Pe[1];return w*w+I*I}function gt(Pe){var dt=Pe[0],w=Pe[1];return Math.hypot(dt,w)}function Je(Pe){var dt=Pe[0],w=Pe[1];return dt*dt+w*w}function Et(Pe,dt){return Pe[0]=-dt[0],Pe[1]=-dt[1],Pe}function _t(Pe,dt){return Pe[0]=1/dt[0],Pe[1]=1/dt[1],Pe}function Ne(Pe,dt){var w=dt[0],I=dt[1],q=w*w+I*I;return q>0&&(q=1/Math.sqrt(q)),Pe[0]=dt[0]*q,Pe[1]=dt[1]*q,Pe}function ke(Pe,dt){return Pe[0]*dt[0]+Pe[1]*dt[1]}function Ue(Pe,dt,w){var I=dt[0]*w[1]-dt[1]*w[0];return Pe[0]=Pe[1]=0,Pe[2]=I,Pe}function st(Pe,dt,w,I){var q=dt[0],ce=dt[1];return Pe[0]=q+I*(w[0]-q),Pe[1]=ce+I*(w[1]-ce),Pe}function Le(Pe,dt){dt=dt||1;var w=T.c()*2*Math.PI;return Pe[0]=Math.cos(w)*dt,Pe[1]=Math.sin(w)*dt,Pe}function ut(Pe,dt,w){var I=dt[0],q=dt[1];return Pe[0]=w[0]*I+w[2]*q,Pe[1]=w[1]*I+w[3]*q,Pe}function Vt(Pe,dt,w){var I=dt[0],q=dt[1];return Pe[0]=w[0]*I+w[2]*q+w[4],Pe[1]=w[1]*I+w[3]*q+w[5],Pe}function Zt(Pe,dt,w){var I=dt[0],q=dt[1];return Pe[0]=w[0]*I+w[3]*q+w[6],Pe[1]=w[1]*I+w[4]*q+w[7],Pe}function ir(Pe,dt,w){var I=dt[0],q=dt[1];return Pe[0]=w[0]*I+w[4]*q+w[12],Pe[1]=w[1]*I+w[5]*q+w[13],Pe}function oe(Pe,dt,w,I){var q=dt[0]-w[0],ce=dt[1]-w[1],Ge=Math.sin(I),$e=Math.cos(I);return Pe[0]=q*$e-ce*Ge+w[0],Pe[1]=q*Ge+ce*$e+w[1],Pe}function Q(Pe,dt){var w=Pe[0],I=Pe[1],q=dt[0],ce=dt[1],Ge=Math.sqrt(w*w+I*I)*Math.sqrt(q*q+ce*ce),$e=Ge&&(w*q+I*ce)/Ge;return Math.acos(Math.min(Math.max($e,-1),1))}function H(Pe){return Pe[0]=0,Pe[1]=0,Pe}function Ce(Pe){return"vec2("+Pe[0]+", "+Pe[1]+")"}function Ee(Pe,dt){return Pe[0]===dt[0]&&Pe[1]===dt[1]}function Ae(Pe,dt){var w=Pe[0],I=Pe[1],q=dt[0],ce=dt[1];return Math.abs(w-q)<=T.b*Math.max(1,Math.abs(w),Math.abs(q))&&Math.abs(I-ce)<=T.b*Math.max(1,Math.abs(I),Math.abs(ce))}var ge=gt,rt=K,Yt=re,At=de,be=Tt,xe=Xe,Ve=Je,lt=function(){var Pe=m();return function(dt,w,I,q,ce,Ge){var $e,yt;for(w||(w=2),I||(I=0),q?yt=Math.min(q*w+I,dt.length):yt=dt.length,$e=I;$e<yt;$e+=w)Pe[0]=dt[$e],Pe[1]=dt[$e+1],ce(Pe,Pe,Ge),dt[$e]=Pe[0],dt[$e+1]=Pe[1];return dt}}()},ZzCi:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("xfSm"),m=i("GXnB"),X=i("Ztfv");function z(o){return function(Z,D,K){var re=new m.Metadata(T.NAMED_TAG,o);typeof K=="number"?X.tagParameter(Z,D,K,re):X.tagProperty(Z,D,re)}}E.named=z},a5Wf:function(Re,E,i){"use strict";i.r(E);var T=i("IzEo"),m=i("bx4M"),X=i("14J3"),z=i("BMrR"),o=i("jCWc"),Z=i("kPKH"),D=i("1OyB"),K=i("vuIU"),re=i("Ji7U"),de=i("LK+K"),Y=i("aHsQ"),Fe=i("sGsY"),Ze=i("9kvl"),ye=i("q1tI"),we=i.n(ye),pt=i("HTcj"),je=i("ZhIB"),Tt=i.n(je),Xe=i("yP6+"),gt=i("wx14");function Je(v){var f=v.style;f.height="100%";var c=parseInt("".concat(getComputedStyle(v).height),10),p=parseInt("".concat(getComputedStyle(v).paddingTop),10)+parseInt("".concat(getComputedStyle(v).paddingBottom),10);return c-p}function Et(v){if(!v)return 0;var f=v,c=Je(f),p=f.parentNode;return p&&(c=Je(p)),c}function _t(){return function(v){var f=function(c){Object(re.a)(y,c);var p=Object(de.a)(y);function y(){var P;Object(D.a)(this,y);for(var N=arguments.length,ee=new Array(N),V=0;V<N;V++)ee[V]=arguments[V];return P=p.call.apply(p,[this].concat(ee)),P.state={computedHeight:0},P.root=null,P.handleRoot=function(J){P.root=J},P}return Object(K.a)(y,[{key:"componentDidMount",value:function(){var N=this.props.height;if(!N&&this.root){var ee=Et(this.root);this.setState({computedHeight:ee}),ee<1&&(ee=Et(this.root),this.setState({computedHeight:ee}))}}},{key:"render",value:function(){var N=this.props.height,ee=this.state.computedHeight,V=N||ee;return we.a.createElement("div",{ref:this.handleRoot},V>0&&we.a.createElement(v,Object(gt.a)({},this.props,{height:V})))}}]),y}(we.a.Component);return f}}var Ne=_t,ke=Xe.Guide.Arc,Ue=Xe.Guide.Html,st=Xe.Guide.Line,Le=function(f){switch(f){case"2":return"\u5DEE";case"4":return"\u4E2D";case"6":return"\u826F";case"8":return"\u4F18";default:return""}};Xe.Shape.registerShape&&Xe.Shape.registerShape("point","pointer",{drawShape:function(f,c){var p=f.points[0];p=this.parsePoint(p);var y=this.parsePoint({x:0,y:0});return c.addShape("line",{attrs:{x1:y.x,y1:y.y,x2:p.x,y2:p.y,stroke:f.color,lineWidth:2,lineCap:"round"}}),c.addShape("circle",{attrs:{x:y.x,y:y.y,r:6,stroke:f.color,lineWidth:3,fill:"#fff"}})}});var ut=function(f){var c=f.title,p=f.height,y=p===void 0?1:p,P=f.percent,N=f.forceFit,ee=N===void 0?!0:N,V=f.formatter,J=V===void 0?Le:V,he=f.color,We=he===void 0?"#2F9CFF":he,De=f.bgColor,It=De===void 0?"#F0F2F5":De,Kt={value:{type:"linear",min:0,max:10,tickCount:6,nice:!0}},Ht=[{value:P/10}],fr=function(){return`
  <div style="width: 300px;text-align: center;font-size: 12px!important;">
    <div style="font-size: 14px; color: rgba(0,0,0,0.43);margin: 0;">`.concat(c,`</div>
    <div style="font-size: 24px;color: rgba(0,0,0,0.85);margin: 0;">
      `).concat((Ht[0].value*10).toFixed(2),`%
    </div>
  </div>`)},Sr={fontSize:12,fill:"rgba(0, 0, 0, 0.65)",textAlign:"center"};return we.a.createElement(Xe.Chart,{height:y,data:Ht,scale:Kt,padding:[-16,0,16,0],forceFit:ee},we.a.createElement(Xe.Coord,{type:"polar",startAngle:-1.25*Math.PI,endAngle:.25*Math.PI,radius:.8}),we.a.createElement(Xe.Axis,{name:"1",line:void 0}),we.a.createElement(Xe.Axis,{line:void 0,tickLine:void 0,subTickLine:void 0,name:"value",zIndex:2,label:{offset:-12,formatter:J,textStyle:Sr}}),we.a.createElement(Xe.Guide,null,we.a.createElement(st,{start:[3,.905],end:[3,.85],lineStyle:{stroke:We,lineDash:void 0,lineWidth:2}}),we.a.createElement(st,{start:[5,.905],end:[5,.85],lineStyle:{stroke:We,lineDash:void 0,lineWidth:3}}),we.a.createElement(st,{start:[7,.905],end:[7,.85],lineStyle:{stroke:We,lineDash:void 0,lineWidth:3}}),we.a.createElement(ke,{start:[0,.965],end:[10,.965],style:{stroke:It,lineWidth:10}}),we.a.createElement(ke,{start:[0,.965],end:[Ht[0].value,.965],style:{stroke:We,lineWidth:10}}),we.a.createElement(Ue,{position:["50%","95%"],html:fr()})),we.a.createElement(Xe.Geom,{line:!1,type:"point",position:"value*1",shape:"pointer",color:We,active:!1}))},Vt=Ne()(ut),Zt=i("VTBJ"),ir=i("iz+Y"),oe=i.n(ir),Q=function(f){var c=f.height,p=c===void 0?1:c,y=f.data,P=y===void 0?[]:y,N=f.forceFit,ee=N===void 0?!0:N,V=f.color,J=V===void 0?"rgba(24, 144, 255, 0.2)":V,he=f.borderColor,We=he===void 0?"#1089ff":he,De=f.scale,It=De===void 0?{x:{},y:{}}:De,Kt=f.borderWidth,Ht=Kt===void 0?2:Kt,fr=f.line,Sr=f.xAxis,ln=f.yAxis,jr=f.animate,an=jr===void 0?!0:jr,pn=[36,5,30,5],Gn={x:Object(Zt.a)({type:"cat",range:[0,1]},It.x),y:Object(Zt.a)({min:0},It.y)},la=["x*y",function(Oi,Ga){return{name:Oi,value:Ga}}],ma=p+54;return we.a.createElement("div",{className:oe.a.miniChart,style:{height:p}},we.a.createElement("div",{className:oe.a.chartContent},p>0&&we.a.createElement(Xe.Chart,{animate:an,scale:Gn,height:ma,forceFit:ee,data:P,padding:pn},we.a.createElement(Xe.Axis,Object(gt.a)({key:"axis-x",name:"x",label:null,line:null,tickLine:null,grid:null},Sr)),we.a.createElement(Xe.Axis,Object(gt.a)({key:"axis-y",name:"y",label:null,line:null,tickLine:null,grid:null},ln)),we.a.createElement(Xe.Tooltip,{showTitle:!1,crosshairs:!1}),we.a.createElement(Xe.Geom,{type:"area",position:"x*y",color:J,tooltip:la,shape:"smooth",style:{fillOpacity:1}}),fr?we.a.createElement(Xe.Geom,{type:"line",position:"x*y",shape:"smooth",color:We,size:Ht,tooltip:!1}):we.a.createElement("span",{style:{display:"none"}}))))},H=Ne()(Q),Ce=i("/zsF"),Ee=i("PArb"),Ae=i("rePB"),ge=i("cQSq"),rt=i.n(ge),Yt=i("9/5/"),At=i.n(Yt),be=i("Jssm"),xe=i.n(be),Ve=i("TSYQ"),lt=i.n(Ve),Pe=i("d9mD"),dt=i.n(Pe),w=function(v){Object(re.a)(c,v);var f=Object(de.a)(c);function c(){var p;Object(D.a)(this,c);for(var y=arguments.length,P=new Array(y),N=0;N<y;N++)P[N]=arguments[N];return p=f.call.apply(f,[this].concat(P)),p.state={legendData:[],legendBlock:!1},p.chart=void 0,p.root=void 0,p.requestRef=0,p.resize=At()(function(){var ee=p.props.hasLegend,V=p.state.legendBlock;if(!ee||!p.root){window.removeEventListener("resize",p.resize);return}p.root&&p.root.parentNode&&p.root.parentNode.clientWidth<=380?V||p.setState({legendBlock:!0}):V&&p.setState({legendBlock:!1})},300),p.getG2Instance=function(ee){p.chart=ee,requestAnimationFrame(function(){p.getLegendData(),p.resize()})},p.getLegendData=function(){if(!p.chart)return;var ee=p.chart.getAllGeoms()[0];if(!ee)return;var V=ee.get("dataArray")||[],J=V.map(function(he){var We=he[0]._origin;return We.color=he[0].color,We.checked=!0,We});p.setState({legendData:J})},p.handleRoot=function(ee){p.root=ee},p.handleLegendClick=function(ee,V){var J=ee;J.checked=!J.checked;var he=p.state.legendData;he[V]=J;var We=he.filter(function(De){return De.checked}).map(function(De){return De.x});p.chart&&p.chart.filter("x",function(De){return We.indexOf("".concat(De))>-1}),p.setState({legendData:he})},p}return Object(K.a)(c,[{key:"componentDidMount",value:function(){var y=this;window.addEventListener("resize",function(){y.requestRef=requestAnimationFrame(function(){return y.resize()})},{passive:!0})}},{key:"componentDidUpdate",value:function(y){var P=this.props.data;P!==y.data&&this.getLegendData()}},{key:"componentWillUnmount",value:function(){this.requestRef&&window.cancelAnimationFrame(this.requestRef),window.removeEventListener("resize",this.resize),this.resize&&this.resize.cancel()}},{key:"render",value:function(){var y,P=this,N=this.props,ee=N.valueFormat,V=N.subTitle,J=N.total,he=N.hasLegend,We=he===void 0?!1:he,De=N.className,It=N.style,Kt=N.height,Ht=Kt===void 0?0:Kt,fr=N.forceFit,Sr=fr===void 0?!0:fr,ln=N.percent,jr=N.color,an=N.inner,pn=an===void 0?.75:an,Gn=N.animate,la=Gn===void 0?!0:Gn,ma=N.colors,Oi=N.lineWidth,Ga=Oi===void 0?1:Oi,Co=this.state,ho=Co.legendData,ju=Co.legendBlock,ls=lt()(dt.a.pie,De,(y={},Object(Ae.a)(y,dt.a.hasLegend,!!We),Object(Ae.a)(y,dt.a.legendBlock,ju),y)),Jl=this.props,Io=Jl.data,xi=Jl.selected,vf=xi===void 0?!0:xi,Qu=Jl.tooltip,Mf=Qu===void 0?!0:Qu,mc=Io||[],Cl=vf,Rc=Mf,Ic=ma;mc=mc||[],Cl=Cl||!0,Rc=Rc||!0;var Hi,wl={x:{type:"cat",range:[0,1]},y:{min:0}};(ln||ln===0)&&(Cl=!1,Rc=!1,Hi=function(Uf){return Uf==="\u5360\u6BD4"?jr||"rgba(24, 144, 255, 0.85)":"#F0F2F5"},mc=[{x:"\u5360\u6BD4",y:parseFloat("".concat(ln))},{x:"\u53CD\u6BD4",y:100-parseFloat("".concat(ln))}]);var Ho=["x*percent",function(Ol,Uf){return{name:Ol,value:"".concat((Uf*100).toFixed(2),"%")}}],Pf=[12,0,12,0],gf=new ge.DataView;return gf.source(mc).transform({type:"percent",field:"y",dimension:"x",as:"percent"}),we.a.createElement("div",{ref:this.handleRoot,className:ls,style:It},we.a.createElement(xe.a,{maxFontSize:25},we.a.createElement("div",{className:dt.a.chart},we.a.createElement(Xe.Chart,{scale:wl,height:Ht,forceFit:Sr,data:gf,padding:Pf,animate:la,onGetG2Instance:this.getG2Instance},!!Rc&&we.a.createElement(Xe.Tooltip,{showTitle:!1}),we.a.createElement(Xe.Coord,{type:"theta",innerRadius:pn}),we.a.createElement(Xe.Geom,{style:{lineWidth:Ga,stroke:"#fff"},tooltip:Rc?Ho:void 0,type:"intervalStack",position:"percent",color:["x",ln||ln===0?Hi:Ic],selected:Cl})),(V||J)&&we.a.createElement("div",{className:dt.a.total},V&&we.a.createElement("h4",{className:"pie-sub-title"},V),J&&we.a.createElement("div",{className:"pie-stat"},typeof J=="function"?J():J)))),We&&we.a.createElement("ul",{className:dt.a.legend},ho.map(function(Ol,Uf){return we.a.createElement("li",{key:Ol.x,onClick:function(){return P.handleLegendClick(Ol,Uf)}},we.a.createElement("span",{className:dt.a.dot,style:{backgroundColor:Ol.checked?Ol.color:"#aaa"}}),we.a.createElement("span",{className:dt.a.legendTitle},Ol.x),we.a.createElement(Ee.a,{type:"vertical"}),we.a.createElement("span",{className:dt.a.percent},"".concat((Number.isNaN(Ol.percent)?0:Ol.percent*100).toFixed(2),"%")),we.a.createElement("span",{className:dt.a.value},ee?ee(Ol.y):Ol.y))})))}}]),c}(ye.Component),I=Ne()(w),q=i("ODXe"),ce=i("1XEM"),Ge=i.n(ce),$e="https://gw.alipayobjects.com/zos/rmsportal/gWyeGLCdFFRavBGIDzWk.png",yt=function(v){Object(re.a)(c,v);var f=Object(de.a)(c);function c(){var p;Object(D.a)(this,c);for(var y=arguments.length,P=new Array(y),N=0;N<y;N++)P[N]=arguments[N];return p=f.call.apply(f,[this].concat(P)),p.state={dv:null,height:0,width:0},p.requestRef=0,p.isUnmount=!1,p.root=void 0,p.imageMask=void 0,p.resize=function(){p.requestRef=requestAnimationFrame(function(){p.renderChart(p.props)})},p.saveRootRef=function(ee){p.root=ee},p.initTagCloud=function(){function ee(V){return Object(Zt.a)(Object(Zt.a)({},V.style),{},{fillOpacity:V.opacity,fontSize:V.origin._origin.size,rotate:V.origin._origin.rotate,text:V.origin._origin.text,textAlign:"center",fontFamily:V.origin._origin.font,fill:V.color,textBaseline:"Alphabetic"})}Xe.Shape.registerShape("point","cloud",{drawShape:function(J,he){var We=ee(J);return he.addShape("text",{attrs:Object(Zt.a)(Object(Zt.a)({},We),{},{x:J.x,y:J.y})})}})},p.renderChart=At()(function(ee){var V=ee||p.props,J=V.data,he=V.height;if(J.length<1||!p.root)return;var We=he,De=p.root.offsetWidth,It=function(){var Ht=new rt.a.View().source(J),fr=Ht.range("value"),Sr=Object(q.a)(fr,2),ln=Sr[0],jr=Sr[1];if(Ht.transform({type:"tag-cloud",fields:["name","value"],imageMask:p.imageMask,font:"Verdana",size:[De,We],padding:0,timeInterval:5e3,rotate:function(){return 0},fontSize:function(pn){var Gn=Math.pow((pn.value-ln)/(jr-ln),2);return Gn*(17.5-5)+5}}),p.isUnmount)return;p.setState({dv:Ht,width:De,height:We})};p.imageMask?It():(p.imageMask=new Image,p.imageMask.crossOrigin="",p.imageMask.src=$e,p.imageMask.onload=It)},200),p}return Object(K.a)(c,[{key:"componentDidMount",value:function(){var y=this;requestAnimationFrame(function(){y.initTagCloud(),y.renderChart(y.props)}),window.addEventListener("resize",this.resize,{passive:!0})}},{key:"componentDidUpdate",value:function(y){var P=this.props.data;y&&JSON.stringify(y.data)!==JSON.stringify(P)&&this.renderChart(this.props)}},{key:"componentWillUnmount",value:function(){this.isUnmount=!0,window.cancelAnimationFrame(this.requestRef),window.removeEventListener("resize",this.resize)}},{key:"render",value:function(){var y=this.props,P=y.className,N=y.height,ee=this.state,V=ee.dv,J=ee.width,he=ee.height;return we.a.createElement("div",{className:lt()(Ge.a.tagCloud,P),style:{width:"100%",height:N},ref:this.saveRootRef},V&&we.a.createElement(Xe.Chart,{width:J,height:he,data:V,padding:0,scale:{x:{nice:!1},y:{nice:!1}}},we.a.createElement(Xe.Tooltip,{showTitle:!1}),we.a.createElement(Xe.Coord,{reflect:"y"}),we.a.createElement(Xe.Geom,{type:"point",position:"x*y",color:"text",shape:"cloud",tooltip:["text*value",function(De,It){return{name:De,value:It}}]})))}}]),c}(ye.Component),nt=Ne()(yt),Nt=i("CIdX"),$=i.n(Nt),Ke=function(v){Object(re.a)(c,v);var f=Object(de.a)(c);function c(){var p;Object(D.a)(this,c);for(var y=arguments.length,P=new Array(y),N=0;N<y;N++)P[N]=arguments[N];return p=f.call.apply(f,[this].concat(P)),p.state={radio:1},p.timer=0,p.root=null,p.node=null,p.resize=function(){if(p.root){var ee=p.props.height,V=ee===void 0?1:ee,J=p.root.parentNode,he=J.offsetWidth;p.setState({radio:he<V?he/V:1})}},p}return Object(K.a)(c,[{key:"componentDidMount",value:function(){var y=this;this.renderChart(),this.resize(),window.addEventListener("resize",function(){requestAnimationFrame(function(){return y.resize()})},{passive:!0})}},{key:"componentDidUpdate",value:function(y){var P=this.props.percent;y.percent!==P&&this.renderChart("update")}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.timer),this.node&&(this.node.innerHTML=""),window.removeEventListener("resize",this.resize)}},{key:"renderChart",value:function(y){var P=this.props,N=P.percent,ee=P.color,V=ee===void 0?"#1890FF":ee,J=N/100,he=this;if(cancelAnimationFrame(this.timer),!this.node||J!==0&&!J)return;var We=this.node,De=We.getContext("2d");if(!De)return;var It=We.width,Kt=We.height,Ht=It/2,fr=2,Sr=Ht-fr;De.beginPath(),De.lineWidth=fr*2;for(var ln=It-fr,jr=ln/8,an=.2,pn=an,Gn=fr,la=0,ma=0,Oi=.005,Ga=[],Co=Ht-fr,ho=-(Math.PI/2),ju=!0,ls=ho;ls<ho+2*Math.PI;ls+=1/(8*Math.PI))Ga.push([Ht+Co*Math.cos(ls),Ht+Co*Math.sin(ls)]);var Jl=Ga.shift();De.strokeStyle=V,De.moveTo(Jl[0],Jl[1]);function Io(){if(!De)return;De.beginPath(),De.save();for(var vf=[],Qu=Gn;Qu<=Gn+ln;Qu+=20/ln){var Mf=la+(Gn+Qu)/jr,mc=Math.sin(Mf)*pn,Cl=Qu,Rc=2*Sr*(1-ma)+(Ht-Sr)-jr*mc;De.lineTo(Cl,Rc),vf.push([Cl,Rc])}var Ic=vf.shift();De.lineTo(Gn+ln,Kt),De.lineTo(Gn,Kt),De.lineTo(Ic[0],Ic[1]);var Hi=De.createLinearGradient(0,0,0,Kt);Hi.addColorStop(0,"#ffffff"),Hi.addColorStop(1,V),De.fillStyle=Hi,De.fill(),De.restore()}function xi(){if(!De)return;if(De.clearRect(0,0,It,Kt),ju&&y!=="update")if(Ga.length){var vf=Ga.shift();De.lineTo(vf[0],vf[1]),De.stroke()}else ju=!1,De.lineTo(Jl[0],Jl[1]),De.stroke(),Ga=[],De.globalCompositeOperation="destination-over",De.beginPath(),De.lineWidth=fr,De.arc(Ht,Ht,Co,0,2*Math.PI,!0),De.beginPath(),De.save(),De.arc(Ht,Ht,Ht-3*fr,0,2*Math.PI,!0),De.restore(),De.clip(),De.fillStyle=V;else{if(J>=.85){if(pn>an/4){var Qu=an*.01;pn-=Qu}}else if(J<=.1){if(pn<an*1.5){var Mf=an*.01;pn+=Mf}}else{if(pn<=an){var mc=an*.01;pn+=mc}if(pn>=an){var Cl=an*.01;pn-=Cl}}J-ma>0&&(ma+=Oi),J-ma<0&&(ma-=Oi),la+=.07,Io()}he.timer=requestAnimationFrame(xi)}xi()}},{key:"render",value:function(){var y=this,P=this.state.radio,N=this.props,ee=N.percent,V=N.title,J=N.height,he=J===void 0?1:J;return we.a.createElement("div",{className:$.a.waterWave,ref:function(De){return y.root=De},style:{transform:"scale(".concat(P,")")}},we.a.createElement("div",{style:{width:he,height:he,overflow:"hidden"}},we.a.createElement("canvas",{className:$.a.waterWaveCanvasWrapper,ref:function(De){return y.node=De},width:he*2,height:he*2})),we.a.createElement("div",{className:$.a.text,style:{width:he}},V&&we.a.createElement("span",null,V),we.a.createElement("h4",null,ee,"%")))}}]),c}(ye.Component),ae=Ne()(Ke),et=i("o0o1"),jt=i.n(et),sr=i("HaE+"),ft=Object(ye.createContext)({});function mt(){return Object(ye.useContext)(ft)}var Ct=i("8ml+"),vt=i("lwsE"),Oe=i.n(vt),ct=i("W8MJ"),Qe=i.n(ct),Ft=i("7W2i"),vr=i.n(Ft),Vr=i("a1gu"),lr=i.n(Vr),Nn=i("Nsbk"),vn=i.n(Nn),na=i("lSNA"),ha=i.n(na),Zn=i("yG8O"),Hn=i.n(Zn),F=i("U+yc"),W=i.n(F),le=i("1ABj"),me=i("h1nZ"),at,bt,He,ht,Qt,qt;function Nr(v,f){var c=Object.keys(v);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(v);f&&(p=p.filter(function(y){return Object.getOwnPropertyDescriptor(v,y).enumerable})),c.push.apply(c,p)}return c}function qr(v){for(var f=1;f<arguments.length;f++){var c=arguments[f]!=null?arguments[f]:{};f%2?Nr(Object(c),!0).forEach(function(p){ha()(v,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(c)):Nr(Object(c)).forEach(function(p){Object.defineProperty(v,p,Object.getOwnPropertyDescriptor(c,p))})}return v}var or=(at=Object(me.lazyInject)(me.TYPES.ILogService),bt=Object(me.lazyInject)(me.TYPES.IGlobalConfigService),He=(qt=function(){function v(f){Oe()(this,v),Hn()(this,"logger",ht,this),Hn()(this,"configService",Qt,this),this.config=void 0,this.config=f}return Qe()(v,[{key:"setContainer",value:function(c,p){c.bind(me.TYPES.MapConfig).toConstantValue(qr(qr({},this.config),{},{id:p})),c.bind(me.TYPES.IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),v}(),qt),ht=W()(He.prototype,"logger",[at],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qt=W()(He.prototype,"configService",[bt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),He),Br=i("QILm"),Tn=i.n(Br),dr=i("yXPU"),Xr=i.n(dr),dn=i("hi0z"),Kn=i.n(dn),gn=i("Hel2"),ur=i("IOcx"),kn=i("4cb6"),An={dark:"amap://styles/2a09079c3daac9420ee53b67307a8006?isPublic=true",light:"amap://styles/1fd9f8ef9751298f11f5c56968312c70?isPublic=true",normal:"amap://styles/normal",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true"},Za=i("J4zp"),ea=i.n(Za),ca=Math.PI/180,bo=function(){function v(){Oe()(this,v),this.projectionMatrix=ur.b.create(),this.viewMatrix=ur.b.create(),this.viewProjectionMatrix=ur.b.create(),this.ViewProjectionMatrixUncentered=ur.b.create(),this.viewUncenteredMatrix=ur.b.create(),this.zoom=void 0,this.center=void 0}return Qe()(v,[{key:"syncWithMapCamera",value:function(c){var p=c.zoom,y=p===void 0?1:p,P=c.pitch,N=P===void 0?0:P,ee=c.bearing,V=ee===void 0?0:ee,J=c.center,he=J===void 0?[0,0]:J,We=c.offsetOrigin,De=We===void 0?[0,0]:We,It=c.cameraHeight,Kt=It===void 0?1:It,Ht=c.aspect,fr=Ht===void 0?1:Ht,Sr=c.near,ln=Sr===void 0?.1:Sr,jr=c.far,an=jr===void 0?1e3:jr,pn=c.fov,Gn=pn===void 0?0:pn;this.zoom=y,this.center=he;var la=N*ca,ma=(360-V)*ca;ur.b.perspective(this.projectionMatrix,Gn,fr,ln,an);var Oi=ur.d.fromValues(Kt*Math.sin(la)*Math.sin(ma),-Kt*Math.sin(la)*Math.cos(ma),Kt*Math.cos(la)),Ga=ur.d.fromValues(-Math.cos(la)*Math.sin(ma),Math.cos(la)*Math.cos(ma),Math.sin(la));ur.b.lookAt(this.viewMatrix,Oi,ur.d.fromValues(0,0,0),Ga),this.viewUncenteredMatrix=ur.b.clone(this.viewMatrix),ur.b.translate(this.viewMatrix,this.viewMatrix,ur.d.fromValues(-De[0],De[1],0)),ur.b.multiply(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),ur.b.multiply(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 524288}},{key:"getCenter",value:function(){var c=ea()(this.center,2),p=c[0],y=c[1];return[p,y]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(c,p){var y=85.0511287798,P=Math.max(Math.min(y,c[1]),-y),N=256<<20,ee=Math.PI/180,V=c[0]*ee,J=P*ee;J=Math.log(Math.tan(Math.PI/4+J/2));var he=.5/Math.PI,We=.5,De=-.5/Math.PI;return ee=.5,V=N*(he*V+We)-215440491,J=-(N*(De*J+ee)-106744817),[V,J]}}]),v}(),Ri,va,ii,Ia,Ln,Ei,Wi,qa,Oo,Ml,cu,fa,Cs,oo;function Na(v,f){var c=Object.keys(v);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(v);f&&(p=p.filter(function(y){return Object.getOwnPropertyDescriptor(v,y).enumerable})),c.push.apply(c,p)}return c}function Fu(v){for(var f=1;f<arguments.length;f++){var c=arguments[f]!=null?arguments[f]:{};f%2?Na(Object(c),!0).forEach(function(p){ha()(v,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(c)):Na(Object(c)).forEach(function(p){Object.defineProperty(v,p,Object.getOwnPropertyDescriptor(c,p))})}return v}i("BGjm")(`/* @antv/l7-maps */
.amap-logo{
 display: none !important;
}
`);var Ai=0;window.forceWebGL=!0;var li="15cd8a57710d40c9b7c0e3cc120f1200",xo="1.4.15",ms="amap-script",so=!1,Uu=[],Ys=12,Eo=(Ri=Object(kn.injectable)(),va=Object(kn.inject)(me.TYPES.IGlobalConfigService),ii=Object(kn.inject)(me.TYPES.ILogService),Ia=Object(kn.inject)(me.TYPES.MapConfig),Ln=Object(kn.inject)(me.TYPES.ICoordinateSystemService),Ei=Object(kn.inject)(me.TYPES.IEventEmitter),Ri(Wi=(qa=(oo=function(){function v(){var f=this;Oe()(this,v),this.map=void 0,Hn()(this,"configService",Oo,this),Hn()(this,"logger",Ml,this),Hn()(this,"config",cu,this),Hn()(this,"coordinateSystemService",fa,this),Hn()(this,"eventEmitter",Cs,this),this.markerContainer=void 0,this.$mapContainer=void 0,this.viewport=void 0,this.cameraChangedCallback=void 0,this.handleCameraChanged=function(c){var p=c.camera,y=p.fov,P=p.near,N=p.far,ee=p.height,V=p.pitch,J=p.rotation,he=p.aspect,We=p.position,De=f.getCenter(),It=De.lng,Kt=De.lat;f.cameraChangedCallback&&(f.viewport.syncWithMapCamera({aspect:he,bearing:360-J,far:N,fov:y,cameraHeight:ee,near:P,pitch:V,zoom:f.map.getZoom()-1,center:[It,Kt],offsetOrigin:[We.x,We.y]}),f.viewport.getZoom()>Ys?f.coordinateSystemService.setCoordinateSystem(me.CoordinateSystem.P20_OFFSET):f.coordinateSystemService.setCoordinateSystem(me.CoordinateSystem.P20),f.cameraChangedCallback(f.viewport))}}return Qe()(v,[{key:"addMarkerContainer",value:function(){var c=this.map.getContainer();if(c!==null){var p=c.getElementsByClassName("amap-maps")[0];this.markerContainer=gn.a.create("div","l7-marker-container",p)}}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(c,p){me.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.on(c,p):this.map.on(c,p)}},{key:"off",value:function(c,p){me.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.off(c,p):this.map.off(c,p)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){var c;return(c=this.map.getContainer())===null||c===void 0?void 0:c.getElementsByClassName("amap-maps")[0]}},{key:"getSize",value:function(){var c=this.map.getSize();return[c.getWidth(),c.getHeight()]}},{key:"getType",value:function(){return"amap"}},{key:"getZoom",value:function(){return this.map.getZoom()-1}},{key:"setZoom",value:function(c){return this.map.setZoom(c)}},{key:"getCenter",value:function(){var c=this.map.getCenter();return{lng:c.getLng(),lat:c.getLat()}}},{key:"setCenter",value:function(c){this.map.setCenter(c)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return 360-this.map.getRotation()}},{key:"getBounds",value:function(){var c=this.map.getBounds().toBounds(),p=c.getNorthEast(),y=c.getSouthWest(),P=this.getCenter(),N=P.lng>p.getLng()||P.lng<y.getLng()?180-p.getLng():p.getLng(),ee=P.lng<y.getLng()?y.getLng()-180:y.getLng();return[[ee,y.getLat()],[N,p.getLat()]]}},{key:"getMinZoom",value:function(){var c=this.map.get("zooms");return c[0]-1}},{key:"getMaxZoom",value:function(){var c=this.map.get("zooms");return c[1]-1}},{key:"setRotation",value:function(c){return this.map.setRotation(c)}},{key:"setPitch",value:function(c){return this.map.setPitch(c)}},{key:"zoomIn",value:function(){this.map.zoomIn()}},{key:"zoomOut",value:function(){this.map.zoomOut()}},{key:"panTo",value:function(c){this.map.panTo(c)}},{key:"panBy",value:function(c){this.map.panTo(c)}},{key:"fitBounds",value:function(c){this.map.setBounds(new AMap.Bounds([c[0][0],c[0][1],c[1][0],c[1][1]]))}},{key:"setZoomAndCenter",value:function(c,p){this.map.setZoomAndCenter(c,p)}},{key:"setMapStyle",value:function(c){this.map.setMapStyle(this.getMapStyle(c))}},{key:"setMapStatus",value:function(c){this.map.setStatus(c)}},{key:"pixelToLngLat",value:function(c){var p=this.map.pixelToLngLat(new AMap.Pixel(c[0],c[1]));return{lng:p.getLng(),lat:p.getLat()}}},{key:"lngLatToPixel",value:function(c){var p=this.map.lnglatToPixel(new AMap.LngLat(c[0],c[1]));return{x:p.getX(),y:p.getY()}}},{key:"containerToLngLat",value:function(c){var p=new AMap.Pixel(c[0],c[1]),y=this.map.containerToLngLat(p);return{lng:y==null?void 0:y.getLng(),lat:y==null?void 0:y.getLat()}}},{key:"lngLatToContainer",value:function(c){var p=new AMap.LngLat(c[0],c[1]),y=this.map.lngLatToContainer(p);return{x:y.getX(),y:y.getY()}}},{key:"lngLatToMercator",value:function(c,p){return{x:0,y:0,z:0}}},{key:"getModelMatrix",value:function(c,p,y){var P=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],N=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},ee=this.viewport.projectFlat(c),V=ur.b.create();return ur.b.translate(V,V,ur.d.fromValues(ee[0],ee[1],p)),ur.b.scale(V,V,ur.d.fromValues(P[0],P[1],P[2])),ur.b.rotateX(V,V,y[0]),ur.b.rotateY(V,V,y[1]),ur.b.rotateZ(V,V,y[2]),V}},{key:"init",value:function(){var f=Xr()(jt.a.mark(function p(){var y=this,P,N,ee,V,J,he,We,De,It,Kt,Ht,fr,Sr,ln;return jt.a.wrap(function(an){for(;;)switch(an.prev=an.next){case 0:return P=this.config,N=P.id,ee=P.style,V=ee===void 0?"light":ee,J=P.minZoom,he=J===void 0?0:J,We=P.maxZoom,De=We===void 0?18:We,It=P.token,Kt=It===void 0?li:It,Ht=P.mapInstance,fr=P.plugin,Sr=fr===void 0?[]:fr,ln=Tn()(P,["id","style","minZoom","maxZoom","token","mapInstance","plugin"]),an.next=3,new Promise(function(pn){var Gn=function(){if(Ht)y.map=Ht,y.$mapContainer=y.map.getContainer(),setTimeout(function(){y.map.on("camerachange",y.handleCameraChanged),pn()},30);else{y.$mapContainer=y.creatAmapContainer(N);var ma=new AMap.Map(y.$mapContainer,Fu({mapStyle:y.getMapStyle(V),zooms:[he,De],viewMode:"3D"},ln));ma.on("camerachange",y.handleCameraChanged),y.map=ma,setTimeout(function(){pn()},10)}};!so&&!Ht?(Kt===li&&y.logger.warn(y.configService.getSceneWarninfo("MapToken")),so=!0,Sr.push("Map3D"),Kn.a.load({key:Kt,version:xo,plugins:Sr}).then(function(la){Gn(),Uu.length&&(Uu.forEach(function(ma){return ma()}),Uu=[])}).catch(function(la){throw new Error(la)})):so&&window.AMap||Ht?Gn():Uu.push(Gn)});case 3:this.viewport=new bo;case 4:case"end":return an.stop()}},p,this)}));function c(){return f.apply(this,arguments)}return c}()},{key:"exportMap",value:function(c){var p,y=(p=this.getContainer())===null||p===void 0?void 0:p.getElementsByClassName("amap-layer")[0],P=c==="jpg"?y==null?void 0:y.toDataURL("image/jpeg"):y==null?void 0:y.toDataURL("image/png");return P}},{key:"emit",value:function(c){for(var p,y=arguments.length,P=new Array(y>1?y-1:0),N=1;N<y;N++)P[N-1]=arguments[N];(p=this.eventEmitter).emit.apply(p,[c].concat(P))}},{key:"once",value:function(c){for(var p,y=arguments.length,P=new Array(y>1?y-1:0),N=1;N<y;N++)P[N-1]=arguments[N];(p=this.eventEmitter).once.apply(p,[c].concat(P))}},{key:"destroy",value:function(){this.map.destroy(),delete window.initAMap;var c=document.getElementById(ms);c&&document.head.removeChild(c)}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(c){this.cameraChangedCallback=c}},{key:"getMapStyle",value:function(c){return An[c]?An[c]:c}},{key:"creatAmapContainer",value:function(c){var p=c;typeof c=="string"&&(p=document.getElementById(c));var y=document.createElement("div");return y.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,y.id="l7_amap_div"+Ai++,p.appendChild(y),y}}]),v}(),oo),Oo=W()(qa.prototype,"configService",[va],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ml=W()(qa.prototype,"logger",[ii],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cu=W()(qa.prototype,"config",[Ia],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fa=W()(qa.prototype,"coordinateSystemService",[Ln],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cs=W()(qa.prototype,"eventEmitter",[Ei],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qa))||Wi);function fu(v){var f=Ut();return function(){var p=vn()(v),y;if(f){var P=vn()(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return lr()(this,y)}}function Ut(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}var Ie=function(v){vr()(c,v);var f=fu(c);function c(){return Oe()(this,c),f.apply(this,arguments)}return Qe()(c,[{key:"getServiceConstructor",value:function(){return Eo}}]),c}(or);function Mt(v,f){var c=Object.keys(v);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(v);f&&(p=p.filter(function(y){return Object.getOwnPropertyDescriptor(v,y).enumerable})),c.push.apply(c,p)}return c}function cr(v){for(var f=1;f<arguments.length;f++){var c=arguments[f]!=null?arguments[f]:{};f%2?Mt(Object(c),!0).forEach(function(p){en(v,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(c)):Mt(Object(c)).forEach(function(p){Object.defineProperty(v,p,Object.getOwnPropertyDescriptor(c,p))})}return v}function en(v,f,c){return f in v?Object.defineProperty(v,f,{value:c,enumerable:!0,configurable:!0,writable:!0}):v[f]=c,v}function bn(v,f){return To(v)||Mo(v,f)||Fi(v,f)||jn()}function jn(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fi(v,f){if(!v)return;if(typeof v=="string")return qi(v,f);var c=Object.prototype.toString.call(v).slice(8,-1);if(c==="Object"&&v.constructor&&(c=v.constructor.name),c==="Map"||c==="Set")return Array.from(v);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return qi(v,f)}function qi(v,f){(f==null||f>v.length)&&(f=v.length);for(var c=0,p=new Array(f);c<f;c++)p[c]=v[c];return p}function Mo(v,f){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(v)))return;var c=[],p=!0,y=!1,P=void 0;try{for(var N=v[Symbol.iterator](),ee;!(p=(ee=N.next()).done)&&!(c.push(ee.value),f&&c.length===f);p=!0);}catch(V){y=!0,P=V}finally{try{!p&&N.return!=null&&N.return()}finally{if(y)throw P}}return c}function To(v){if(Array.isArray(v))return v}var tl=we.a.memo(function(v){var f=v.style,c=v.className,p=v.map,y=v.option,P=v.onSceneLoaded,N=Object(ye.createRef)(),ee=Object(ye.useState)(),V=bn(ee,2),J=V[0],he=V[1];return Object(ye.useEffect)(function(){var We=new Ct.Scene(cr(cr({id:N.current},y),{},{map:new Ie(p)}));return We.on("loaded",function(){he(We),P&&P(We)}),function(){We.destroy()}},[]),Object(ye.useEffect)(function(){J&&p.style&&J.setMapStyle(p.style)},[JSON.stringify(p.style)]),Object(ye.useEffect)(function(){J&&p.zoom&&J.setZoom(p.zoom)},[p.zoom]),Object(ye.useEffect)(function(){J&&p.center&&J.setCenter(p.center)},[JSON.stringify(p.center)]),Object(ye.useEffect)(function(){J&&p.pitch&&J.setPitch(p.pitch)},[p.pitch]),Object(ye.useEffect)(function(){J&&p.rotation&&J.setRotation(p.rotation)},[p.rotation]),we.a.createElement(ft.Provider,{value:J},Object(ye.createElement)("div",{ref:N,style:f,className:c},J&&v.children))}),ql=tl,Ks=i("4ZJM"),jc=i.n(Ks),vs=i("md7G"),Bu=i("foSv"),ws=i("JX7q"),_o=i("bl9R");function Po(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function $s(v,f){var c=_o.transformMat4([],f,v);return _o.scale(c,c,1/c[3]),c}function bl(v,f){var c=v%f;return c<0?f+c:c}function Su(v,f,c){return c*f+(1-c)*v}var ka=i("ZaHm"),hu=i("ZxFD"),ec=i("n+fv");function Js(v,f){if(!v)throw new Error(f||"viewport-mercator-project: assertion failed.")}var ns=Math.PI,wt=ns/4,er=ns/180,Ar=180/ns,Bn=512,Qa=4003e4,Ii=1.5;function Ki(v){return Math.pow(2,v)}function ja(v){return Math.log2(v)}function pi(v,f){var c=Object(q.a)(v,2),p=c[0],y=c[1];Js(Number.isFinite(p)&&Number.isFinite(f)),Js(Number.isFinite(y)&&y>=-90&&y<=90,"invalid latitude"),f*=Bn;var P=p*er,N=y*er,ee=f*(P+ns)/(2*ns),V=f*(ns-Math.log(Math.tan(wt+N*.5)))/(2*ns);return[ee,V]}function Zo(v,f){var c=Object(q.a)(v,2),p=c[0],y=c[1];f*=Bn;var P=p/f*(2*ns)-ns,N=2*(Math.atan(Math.exp(ns-y/f*(2*ns)))-wt);return[P*Ar,N*Ar]}function Ci(v){var f=v.latitude;Js(Number.isFinite(f));var c=Math.cos(f*er);return ja(Qa*c)-9}function Xo(v){var f=v.latitude,c=v.longitude,p=v.zoom,y=v.scale,P=v.highPrecision,N=P===void 0?!1:P;y=y!==void 0?y:Ki(p),Js(Number.isFinite(f)&&Number.isFinite(c)&&Number.isFinite(y));var ee={},V=Bn*y,J=Math.cos(f*er),he=V/360,We=he/J,De=V/Qa/J;if(ee.pixelsPerMeter=[De,-De,De],ee.metersPerPixel=[1/De,-1/De,1/De],ee.pixelsPerDegree=[he,-We,De],ee.degreesPerPixel=[1/he,-1/We,1/De],N){var It=er*Math.tan(f*er)/J,Kt=he*It/2,Ht=V/Qa*It,fr=Ht/We*De;ee.pixelsPerDegree2=[0,-Kt,Ht],ee.pixelsPerMeter2=[fr,0,fr]}return ee}function Au(v,f){var c=Object(q.a)(v,3),p=c[0],y=c[1],P=c[2],N=Object(q.a)(f,3),ee=N[0],V=N[1],J=N[2],he=1,We=Xo({longitude:p,latitude:y,scale:he,highPrecision:!0}),De=We.pixelsPerMeter,It=We.pixelsPerMeter2,Kt=pi(v,he);Kt[0]+=ee*(De[0]+It[0]*V),Kt[1]+=V*(De[1]+It[1]*V);var Ht=Zo(Kt,he),fr=(P||0)+(J||0);return Number.isFinite(P)||Number.isFinite(J)?[Ht[0],Ht[1],fr]:Ht}function du(v){var f=v.height,c=v.pitch,p=v.bearing,y=v.altitude,P=v.center,N=P===void 0?null:P,ee=v.flipY,V=ee===void 0?!1:ee,J=Po();return ka.translate(J,J,[0,0,-y]),ka.scale(J,J,[1,1,1/f]),ka.rotateX(J,J,-c*er),ka.rotateZ(J,J,p*er),V&&ka.scale(J,J,[1,-1,1]),N&&ka.translate(J,J,ec.negate([],N)),J}function Ds(v){var f=v.width,c=v.height,p=v.altitude,y=p===void 0?Ii:p,P=v.pitch,N=P===void 0?0:P,ee=v.nearZMultiplier,V=ee===void 0?1:ee,J=v.farZMultiplier,he=J===void 0?1:J,We=N*er,De=Math.atan(.5/y),It=Math.sin(De)*y/Math.sin(Math.PI/2-We-De),Kt=Math.cos(Math.PI/2-We)*It+y;return{fov:2*Math.atan(c/2/y),aspect:f/c,focalDistance:y,near:V,far:Kt*he}}function xl(v){var f=v.width,c=v.height,p=v.pitch,y=v.altitude,P=v.nearZMultiplier,N=v.farZMultiplier,ee=Ds({width:f,height:c,altitude:y,pitch:p,nearZMultiplier:P,farZMultiplier:N}),V=ee.fov,J=ee.aspect,he=ee.near,We=ee.far,De=ka.perspective([],V,J,he,We);return De}function Qs(v,f){var c=Object(q.a)(v,3),p=c[0],y=c[1],P=c[2],N=P===void 0?0:P;return Js(Number.isFinite(p)&&Number.isFinite(y)&&Number.isFinite(N)),$s(f,[p,y,N,1])}function rl(v,f){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,p=Object(q.a)(v,3),y=p[0],P=p[1],N=p[2];if(Js(Number.isFinite(y)&&Number.isFinite(P),"invalid pixel coordinate"),Number.isFinite(N)){var ee=$s(f,[y,P,N,1]);return ee}var V=$s(f,[y,P,0,1]),J=$s(f,[y,P,1,1]),he=V[2],We=J[2],De=he===We?0:((c||0)-he)/(We-he);return hu.lerp([],V,J,De)}var qs=Po(),Vu=function(){function v(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=f.width,p=f.height,y=f.viewMatrix,P=y===void 0?qs:y,N=f.projectionMatrix,ee=N===void 0?qs:N;Object(D.a)(this,v),this.width=c||1,this.height=p||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=P,this.projectionMatrix=ee;var V=Po();ka.multiply(V,V,this.projectionMatrix),ka.multiply(V,V,this.viewMatrix),this.viewProjectionMatrix=V;var J=Po();ka.scale(J,J,[this.width/2,-this.height/2,1]),ka.translate(J,J,[1,-1,0]),ka.multiply(J,J,this.viewProjectionMatrix);var he=ka.invert(Po(),J);if(!he)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=J,this.pixelUnprojectionMatrix=he,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return Object(K.a)(v,[{key:"equals",value:function(c){return c instanceof v?c.width===this.width&&c.height===this.height&&ka.equals(c.projectionMatrix,this.projectionMatrix)&&ka.equals(c.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(c){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y=p.topLeft,P=y===void 0?!0:y,N=this.projectPosition(c),ee=Qs(N,this.pixelProjectionMatrix),V=Object(q.a)(ee,2),J=V[0],he=V[1],We=P?he:this.height-he;return c.length===2?[J,We]:[J,We,ee[2]]}},{key:"unproject",value:function(c){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y=p.topLeft,P=y===void 0?!0:y,N=p.targetZ,ee=Object(q.a)(c,3),V=ee[0],J=ee[1],he=ee[2],We=P?J:this.height-J,De=N&&N*this.pixelsPerMeter,It=rl([V,We,he],this.pixelUnprojectionMatrix,De),Kt=this.unprojectPosition(It),Ht=Object(q.a)(Kt,3),fr=Ht[0],Sr=Ht[1],ln=Ht[2];return Number.isFinite(he)?[fr,Sr,ln]:Number.isFinite(N)?[fr,Sr,N]:[fr,Sr]}},{key:"projectPosition",value:function(c){var p=this.projectFlat(c),y=Object(q.a)(p,2),P=y[0],N=y[1],ee=(c[2]||0)*this.pixelsPerMeter;return[P,N,ee]}},{key:"unprojectPosition",value:function(c){var p=this.unprojectFlat(c),y=Object(q.a)(p,2),P=y[0],N=y[1],ee=(c[2]||0)/this.pixelsPerMeter;return[P,N,ee]}},{key:"projectFlat",value:function(c){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return c}},{key:"unprojectFlat",value:function(c){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return c}}]),v}();function tc(v){var f=v.width,c=v.height,p=v.bounds,y=v.minExtent,P=y===void 0?0:y,N=v.maxZoom,ee=N===void 0?24:N,V=v.padding,J=V===void 0?0:V,he=v.offset,We=he===void 0?[0,0]:he,De=Object(q.a)(p,2),It=Object(q.a)(De[0],2),Kt=It[0],Ht=It[1],fr=Object(q.a)(De[1],2),Sr=fr[0],ln=fr[1];if(Number.isFinite(J)){var jr=J;J={top:jr,bottom:jr,left:jr,right:jr}}else Js(Number.isFinite(J.top)&&Number.isFinite(J.bottom)&&Number.isFinite(J.left)&&Number.isFinite(J.right));var an=new vc({width:f,height:c,longitude:0,latitude:0,zoom:0}),pn=an.project([Kt,ln]),Gn=an.project([Sr,Ht]),la=[Math.max(Math.abs(Gn[0]-pn[0]),P),Math.max(Math.abs(Gn[1]-pn[1]),P)],ma=[f-J.left-J.right-Math.abs(We[0])*2,c-J.top-J.bottom-Math.abs(We[1])*2];Js(ma[0]>0&&ma[1]>0);var Oi=ma[0]/la[0],Ga=ma[1]/la[1],Co=(J.right-J.left)/2/Oi,ho=(J.bottom-J.top)/2/Ga,ju=[(Gn[0]+pn[0])/2+Co,(Gn[1]+pn[1])/2+ho],ls=an.unproject(ju),Jl=an.zoom+Math.log2(Math.abs(Math.min(Oi,Ga)));return{longitude:ls[0],latitude:ls[1],zoom:Math.min(Jl,ee)}}var vc=function(v){Object(re.a)(f,v);function f(){var c,p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},y=p.width,P=p.height,N=p.latitude,ee=N===void 0?0:N,V=p.longitude,J=V===void 0?0:V,he=p.zoom,We=he===void 0?0:he,De=p.pitch,It=De===void 0?0:De,Kt=p.bearing,Ht=Kt===void 0?0:Kt,fr=p.altitude,Sr=fr===void 0?1.5:fr,ln=p.nearZMultiplier,jr=p.farZMultiplier;Object(D.a)(this,f),y=y||1,P=P||1;var an=Ki(We);Sr=Math.max(.75,Sr);var pn=pi([J,ee],an);pn[2]=0;var Gn=xl({width:y,height:P,pitch:It,bearing:Ht,altitude:Sr,nearZMultiplier:ln||1/P,farZMultiplier:jr||1.01}),la=du({height:P,center:pn,pitch:It,bearing:Ht,altitude:Sr,flipY:!0});return c=Object(vs.a)(this,Object(Bu.a)(f).call(this,{width:y,height:P,viewMatrix:la,projectionMatrix:Gn})),c.latitude=ee,c.longitude=J,c.zoom=We,c.pitch=It,c.bearing=Ht,c.altitude=Sr,c.scale=an,c.center=pn,c.pixelsPerMeter=Xo(Object(ws.a)(Object(ws.a)(c))).pixelsPerMeter[2],Object.freeze(Object(ws.a)(Object(ws.a)(c))),c}return Object(K.a)(f,[{key:"projectFlat",value:function(p){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return pi(p,y)}},{key:"unprojectFlat",value:function(p){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return Zo(p,y)}},{key:"getMapCenterByLngLatPosition",value:function(p){var y=p.lngLat,P=p.pos,N=rl(P,this.pixelUnprojectionMatrix),ee=pi(y,this.scale),V=hu.add([],ee,hu.negate([],N)),J=hu.add([],this.center,V);return Zo(J,this.scale)}},{key:"getLocationAtPoint",value:function(p){var y=p.lngLat,P=p.pos;return this.getMapCenterByLngLatPosition({lngLat:y,pos:P})}},{key:"fitBounds",value:function(p){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},P=this.width,N=this.height,ee=tc(Object.assign({width:P,height:N,bounds:p},y)),V=ee.longitude,J=ee.latitude,he=ee.zoom;return new f({width:P,height:N,longitude:V,latitude:J,zoom:he})}}]),f}(Vu),gc=function(){function v(){Oe()(this,v),this.viewport=void 0}return Qe()(v,[{key:"syncWithMapCamera",value:function(c){var p=c.center,y=c.zoom,P=c.pitch,N=c.bearing,ee=c.viewportHeight,V=c.viewportWidth;this.viewport=new vc({width:V,height:ee,longitude:p&&p[0],latitude:p&&p[1],zoom:y,pitch:P,bearing:N})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(c,p){return this.viewport.projectFlat(c,p)}}]),v}(),Ui={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},zc,yc,nf,af,of,Ti,Cu,pu,eu,Fc,rc,mu,Uc,nl;function tu(v,f){var c=Object.keys(v);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(v);f&&(p=p.filter(function(y){return Object.getOwnPropertyDescriptor(v,y).enumerable})),c.push.apply(c,p)}return c}function nc(v){for(var f=1;f<arguments.length;f++){var c=arguments[f]!=null?arguments[f]:{};f%2?tu(Object(c),!0).forEach(function(p){ha()(v,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(c)):tu(Object(c)).forEach(function(p){Object.defineProperty(v,p,Object.getOwnPropertyDescriptor(c,p))})}return v}i("BGjm")(`/* @antv/l7-maps */
.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:-webkit-grab;cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:-webkit-grabbing;cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{-ms-touch-action:pan-x pan-y;touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:pinch-zoom;touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:none;touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 2px rgba(0,0,0,.1);box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 0 2px ButtonText;box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-group button:focus{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){-webkit-box-shadow:none;box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:0;margin:10px;position:relative;background-color:#fff;border-radius:3px 12px 12px 3px}.mapboxgl-ctrl-attrib.mapboxgl-compact:hover{padding:2px 24px 2px 4px;visibility:visible;margin-top:6px}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:hover,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:hover{padding:2px 4px 2px 24px;border-radius:12px 3px 3px 12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact:after{content:"";cursor:pointer;position:absolute;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:12px}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;-webkit-box-sizing:border-box;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:-webkit-flex;display:-webkit-box;display:-ms-flexbox;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{-webkit-flex-direction:column;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{-webkit-flex-direction:column-reverse;-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.mapboxgl-popup-anchor-left{-webkit-flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.mapboxgl-popup-anchor-right{-webkit-flex-direction:row-reverse;-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;-webkit-box-shadow:0 1px 2px rgba(0,0,0,.1);box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:"";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 0 3px rgba(0,0,0,.35);box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}`),window.mapboxgl=jc.a;var bc={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},mi=0,xc=12,Rf="pk.eyJ1IjoibHp4dWUiLCJhIjoiYnhfTURyRSJ9.Ugm314vAKPHBzcPmY1p4KQ",Ec=(zc=Object(kn.injectable)(),yc=Object(kn.inject)(me.TYPES.MapConfig),nf=Object(kn.inject)(me.TYPES.IGlobalConfigService),af=Object(kn.inject)(me.TYPES.ILogService),of=Object(kn.inject)(me.TYPES.ICoordinateSystemService),Ti=Object(kn.inject)(me.TYPES.IEventEmitter),zc(Cu=(pu=(nl=function(){function v(){var f=this;Oe()(this,v),this.map=void 0,Hn()(this,"config",eu,this),Hn()(this,"configService",Fc,this),Hn()(this,"logger",rc,this),Hn()(this,"coordinateSystemService",mu,this),Hn()(this,"eventEmitter",Uc,this),this.viewport=void 0,this.markerContainer=void 0,this.cameraChangedCallback=void 0,this.$mapContainer=void 0,this.handleCameraChanged=function(){var c=f.map.getCenter().wrap(),p=c.lat,y=c.lng;f.viewport.syncWithMapCamera({bearing:f.map.getBearing(),center:[y,p],viewportHeight:f.map.transform.height,pitch:f.map.getPitch(),viewportWidth:f.map.transform.width,zoom:f.map.getZoom(),cameraHeight:0}),f.viewport.getZoom()>xc?f.coordinateSystemService.setCoordinateSystem(me.CoordinateSystem.LNGLAT_OFFSET):f.coordinateSystemService.setCoordinateSystem(me.CoordinateSystem.LNGLAT),f.cameraChangedCallback(f.viewport)}}return Qe()(v,[{key:"addMarkerContainer",value:function(){var c=this.map.getCanvasContainer();this.markerContainer=gn.a.create("div","l7-marker-container",c),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(c,p){me.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.on(c,p):this.map.on(bc[c]||c,p)}},{key:"off",value:function(c,p){this.map.off(bc[c]||c,p)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var c=this.map.transform;return[c.width,c.height]}},{key:"getType",value:function(){return"mapbox"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(c){return this.map.setZoom(c)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(c){this.map.setCenter(c)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(c){this.map.setBearing(c)}},{key:"zoomIn",value:function(c,p){this.map.zoomIn(c,p)}},{key:"zoomOut",value:function(c,p){this.map.zoomOut(c,p)}},{key:"setPitch",value:function(c){return this.map.setPitch(c)}},{key:"panTo",value:function(c){this.map.panTo(c)}},{key:"panBy",value:function(c){this.panTo(c)}},{key:"fitBounds",value:function(c,p){this.map.fitBounds(c,p)}},{key:"setMaxZoom",value:function(c){this.map.setMaxZoom(c)}},{key:"setMinZoom",value:function(c){this.map.setMinZoom(c)}},{key:"setMapStatus",value:function(c){c.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),c.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),c.dragEnable===!1&&this.map.dragPan.disable(),c.dragEnable===!0&&this.map.dragPan.enable(),c.rotateEnable===!1&&this.map.dragRotate.disable(),c.rotateEnable===!0&&this.map.dragRotate.enable(),c.keyboardEnable===!1&&this.map.keyboard.disable(),c.keyboardEnable===!0&&this.map.keyboard.enable(),c.zoomEnable===!1&&this.map.scrollZoom.disable(),c.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(c,p){this.map.flyTo({zoom:c,center:p})}},{key:"setMapStyle",value:function(c){this.map.setStyle(this.getMapStyle(c))}},{key:"pixelToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToPixel",value:function(c){return this.map.project(c)}},{key:"containerToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToContainer",value:function(c){return this.map.project(c)}},{key:"lngLatToMercator",value:function(c,p){var y=window.mapboxgl.MercatorCoordinate.fromLngLat(c,p),P=y.x,N=P===void 0?0:P,ee=y.y,V=ee===void 0?0:ee,J=y.z,he=J===void 0?0:J;return{x:N,y:V,z:he}}},{key:"getModelMatrix",value:function(c,p,y){var P=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],N=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},ee=window.mapboxgl.MercatorCoordinate.fromLngLat(c,p),V=ee.meterInMercatorCoordinateUnits(),J=ur.b.create();return ur.b.translate(J,J,ur.d.fromValues(ee.x-N.x,ee.y-N.y,ee.z||0-N.z)),ur.b.scale(J,J,ur.d.fromValues(V*P[0],-V*P[1],V*P[2])),ur.b.rotateX(J,J,y[0]),ur.b.rotateY(J,J,y[1]),ur.b.rotateZ(J,J,y[2]),J}},{key:"init",value:function(){var f=Xr()(jt.a.mark(function p(){var y,P,N,ee,V,J,he,We,De,It,Kt,Ht,fr;return jt.a.wrap(function(ln){for(;;)switch(ln.prev=ln.next){case 0:y=this.config,P=y.id,N=P===void 0?"map":P,ee=y.attributionControl,V=ee===void 0?!1:ee,J=y.style,he=J===void 0?"light":J,We=y.token,De=We===void 0?Rf:We,It=y.rotation,Kt=It===void 0?0:It,Ht=y.mapInstance,fr=Tn()(y,["id","attributionControl","style","token","rotation","mapInstance"]),this.viewport=new gc,!Ht&&!window.mapboxgl&&this.logger.error(this.configService.getSceneWarninfo("SDK")),De===Rf&&he!=="blank"&&!window.mapboxgl.accessToken&&!Ht&&this.logger.warn(this.configService.getSceneWarninfo("MapToken")),!Ht&&!window.mapboxgl.accessToken&&(window.mapboxgl.accessToken=De),Ht?(this.map=Ht,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(N),this.map=new window.mapboxgl.Map(nc({container:this.$mapContainer,style:this.getMapStyle(he),attributionControl:V,bearing:Kt},fr))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 9:case"end":return ln.stop()}},p,this)}));function c(){return f.apply(this,arguments)}return c}()},{key:"destroy",value:function(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(c){for(var p,y=arguments.length,P=new Array(y>1?y-1:0),N=1;N<y;N++)P[N-1]=arguments[N];(p=this.eventEmitter).emit.apply(p,[c].concat(P))}},{key:"once",value:function(c){for(var p,y=arguments.length,P=new Array(y>1?y-1:0),N=1;N<y;N++)P[N-1]=arguments[N];(p=this.eventEmitter).once.apply(p,[c].concat(P))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(c){var p=this.map.getCanvas(),y=c==="jpg"?p==null?void 0:p.toDataURL("image/jpeg"):p==null?void 0:p.toDataURL("image/png");return y}},{key:"onCameraChanged",value:function(c){this.cameraChangedCallback=c}},{key:"creatAmapContainer",value:function(c){var p=c;typeof c=="string"&&(p=document.getElementById(c));var y=document.createElement("div");return y.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,y.id="l7_mapbox_div"+mi++,p.appendChild(y),y}},{key:"getMapStyle",value:function(c){return typeof c!="string"?c:Ui[c]?Ui[c]:c}}]),v}(),nl),eu=W()(pu.prototype,"config",[yc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fc=W()(pu.prototype,"configService",[nf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rc=W()(pu.prototype,"logger",[af],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mu=W()(pu.prototype,"coordinateSystemService",[of],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Uc=W()(pu.prototype,"eventEmitter",[Ti],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pu))||Cu);function If(v){var f=Bc();return function(){var p=vn()(v),y;if(f){var P=vn()(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return lr()(this,y)}}function Bc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}i("BGjm")(`/* @antv/l7-maps */
.mapboxgl-ctrl-logo {
 display: none !important;
}
`);var Pl=function(v){vr()(c,v);var f=If(c);function c(){return Oe()(this,c),f.apply(this,arguments)}return Qe()(c,[{key:"getServiceConstructor",value:function(){return Ec}}]),c}(or);function al(v,f){var c=Object.keys(v);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(v);f&&(p=p.filter(function(y){return Object.getOwnPropertyDescriptor(v,y).enumerable})),c.push.apply(c,p)}return c}function Os(v){for(var f=1;f<arguments.length;f++){var c=arguments[f]!=null?arguments[f]:{};f%2?al(Object(c),!0).forEach(function(p){ac(v,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(c)):al(Object(c)).forEach(function(p){Object.defineProperty(v,p,Object.getOwnPropertyDescriptor(c,p))})}return v}function ac(v,f,c){return f in v?Object.defineProperty(v,f,{value:c,enumerable:!0,configurable:!0,writable:!0}):v[f]=c,v}function No(v,f){return ru(v)||Rl(v,f)||El(v,f)||Ll()}function Ll(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function El(v,f){if(!v)return;if(typeof v=="string")return Vc(v,f);var c=Object.prototype.toString.call(v).slice(8,-1);if(c==="Object"&&v.constructor&&(c=v.constructor.name),c==="Map"||c==="Set")return Array.from(v);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Vc(v,f)}function Vc(v,f){(f==null||f>v.length)&&(f=v.length);for(var c=0,p=new Array(f);c<f;c++)p[c]=v[c];return p}function Rl(v,f){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(v)))return;var c=[],p=!0,y=!1,P=void 0;try{for(var N=v[Symbol.iterator](),ee;!(p=(ee=N.next()).done)&&!(c.push(ee.value),f&&c.length===f);p=!0);}catch(V){y=!0,P=V}finally{try{!p&&N.return!=null&&N.return()}finally{if(y)throw P}}return c}function ru(v){if(Array.isArray(v))return v}var Gc=we.a.memo(function(v){var f=v.style,c=v.className,p=v.map,y=v.option,P=v.onSceneLoaded,N=Object(ye.createRef)(),ee=Object(ye.useState)(),V=No(ee,2),J=V[0],he=V[1];return Object(ye.useEffect)(function(){var We=new Ct.Scene(Os(Os({id:N.current},y),{},{map:new Pl(p)}));return We.on("loaded",function(){he(We),P&&P(We)}),function(){We.destroy()}},[]),Object(ye.useEffect)(function(){J&&p.style&&J.setMapStyle(p.style)},[JSON.stringify(p.style)]),Object(ye.useEffect)(function(){J&&p.zoom&&J.setZoom(p.zoom)},[p.zoom]),Object(ye.useEffect)(function(){J&&p.center&&J.setCenter(p.center)},[JSON.stringify(p.center)]),Object(ye.useEffect)(function(){J&&p.pitch!==void 0&&J.setPitch(p.pitch||0)},[p.pitch]),Object(ye.useEffect)(function(){J&&p.rotation&&J.setRotation(p.rotation)},[p.rotation]),we.a.createElement(ft.Provider,{value:J},Object(ye.createElement)("div",{ref:N,style:f,className:c},J&&v.children))}),bf=Gc,xf=i("PJYZ"),Il=i.n(xf),ic=i("QkVN"),Zi=i.n(ic),Dl=i("uhBA"),Gu=i("cDf5"),Ef=i.n(Gu),Nl=i("zvhG"),oc=i.n(Nl);function Wf(v,f){var c;if(typeof Symbol=="undefined"||v[Symbol.iterator]==null){if(Array.isArray(v)||(c=Df(v))||f&&v&&typeof v.length=="number"){c&&(v=c);var p=0,y=function(){};return{s:y,n:function(){return p>=v.length?{done:!0}:{done:!1,value:v[p++]}},e:function(J){throw J},f:y}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var P=!0,N=!1,ee;return{s:function(){c=v[Symbol.iterator]()},n:function(){var J=c.next();return P=J.done,J},e:function(J){N=!0,ee=J},f:function(){try{!P&&c.return!=null&&c.return()}finally{if(N)throw ee}}}}function Df(v,f){if(!v)return;if(typeof v=="string")return Tc(v,f);var c=Object.prototype.toString.call(v).slice(8,-1);if(c==="Object"&&v.constructor&&(c=v.constructor.name),c==="Map"||c==="Set")return Array.from(v);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Tc(v,f)}function Tc(v,f){(f==null||f>v.length)&&(f=v.length);for(var c=0,p=new Array(f);c<f;c++)p[c]=v[c];return p}var kl;function _c(v,f,c){var p=c-f,y=((v-f)%p+p)%p+f;return y===f?c:y}function wu(v,f,c){return Math.min(c,Math.max(f,v))}function Ns(v,f,c){return v*(1-c)+f*c}function il(v,f,c,p){var y=new oc.a(v,f,c,p);return function(P){return y.solve(P)}}var Tl=il(.25,.1,.25,1);function sc(){return window.matchMedia?(kl==null&&(kl=window.matchMedia("(prefers-reduced-motion: reduce)")),kl.matches):!1}function Bi(v,f){var c={},p=Wf(f),y;try{for(p.s();!(y=p.n()).done;){var P=y.value;P in v&&(c[P]=v[P])}}catch(N){p.e(N)}finally{p.f()}return c}var vu=window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now.bind(Date),ol=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,Yo=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame;function ei(v){var f=ol(v);return{cancel:function(){return Yo(f)}}}var $a=function(){Qe()(v,null,[{key:"convert",value:function(c){return c instanceof v?c:new v(c)}}]);function v(f,c){Oe()(this,v),this.ne=void 0,this.sw=void 0,f&&(c?this.setSouthWest(f).setNorthEast(c):f.length===4?this.setSouthWest([f[0],f[1]]).setNorthEast([f[2],f[3]]):this.setSouthWest(f[0]).setNorthEast(f[1]))}return Qe()(v,[{key:"setNorthEast",value:function(c){return this.ne=c instanceof ti?new ti(c.lng,c.lat):ti.convert(c),this}},{key:"setSouthWest",value:function(c){return this.sw=c instanceof ti?new ti(c.lng,c.lat):ti.convert(c),this}},{key:"extend",value:function(c){var p=this.sw,y=this.ne,P,N;if(c instanceof ti)P=c,N=c;else if(c instanceof v){if(P=c.sw,N=c.ne,!P||!N)return this}else{if(Array.isArray(c))if(c.length===4||c.every(Array.isArray)){var ee=c;return this.extend(v.convert(ee))}else{var V=c;return this.extend(ti.convert(V))}return this}return!p&&!y?(this.sw=new ti(P.lng,P.lat),this.ne=new ti(N.lng,N.lat)):(p.lng=Math.min(P.lng,p.lng),p.lat=Math.min(P.lat,p.lat),y.lng=Math.max(N.lng,y.lng),y.lat=Math.max(N.lat,y.lat)),this}},{key:"getCenter",value:function(){return new ti((this.sw.lng+this.ne.lng)/2,(this.sw.lat+this.ne.lat)/2)}},{key:"getSouthWest",value:function(){return this.sw}},{key:"getNorthEast",value:function(){return this.ne}},{key:"getNorthWest",value:function(){return new ti(this.getWest(),this.getNorth())}},{key:"getSouthEast",value:function(){return new ti(this.getEast(),this.getSouth())}},{key:"getWest",value:function(){return this.sw.lng}},{key:"getSouth",value:function(){return this.sw.lat}},{key:"getEast",value:function(){return this.ne.lng}},{key:"getNorth",value:function(){return this.ne.lat}},{key:"toArray",value:function(){return[this.sw.toArray(),this.ne.toArray()]}},{key:"toString",value:function(){return"LngLatBounds(".concat(this.sw.toString(),", ").concat(this.ne.toString(),")")}},{key:"isEmpty",value:function(){return!(this.sw&&this.ne)}},{key:"contains",value:function(c){var p=ti.convert(c),y=p.lng,P=p.lat,N=this.sw.lat<=P&&P<=this.ne.lat,ee=this.sw.lng<=y&&y<=this.ne.lng;return this.sw.lng>this.ne.lng&&(ee=this.sw.lng>=y&&y>=this.ne.lng),N&&ee}}]),v}(),Hu=63710088e-1,ti=function(){Qe()(v,null,[{key:"convert",value:function(c){if(c instanceof v)return c;if(Array.isArray(c)&&(c.length===2||c.length===3))return new v(Number(c[0]),Number(c[1]));if(!Array.isArray(c)&&Ef()(c)==="object"&&c!==null){var p="lng"in c?c.lng:c.lon;return new v(Number(p),Number(c.lat))}throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}]);function v(f,c){if(Oe()(this,v),this.lng=void 0,this.lat=void 0,isNaN(f)||isNaN(c))throw new Error("Invalid LngLat object: (".concat(f,", ").concat(c,")"));if(this.lng=+f,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}return Qe()(v,[{key:"wrap",value:function(){return new v(_c(this.lng,-180,180),this.lat)}},{key:"toArray",value:function(){return[this.lng,this.lat]}},{key:"toBounds",value:function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,p=40075017,y=360*c/p,P=y/Math.cos(Math.PI/180*this.lat);return new $a(new v(this.lng-P,this.lat-y),new v(this.lng+P,this.lat+y))}},{key:"toString",value:function(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}},{key:"distanceTo",value:function(c){var p=Math.PI/180,y=this.lat*p,P=c.lat*p,N=Math.sin(y)*Math.sin(P)+Math.cos(y)*Math.cos(P)*Math.cos((c.lng-this.lng)*p),ee=Hu*Math.acos(Math.min(N,1));return ee}}]),v}(),Xa=function(){Qe()(v,null,[{key:"convert",value:function(c){return c instanceof v?c:Array.isArray(c)?new v(c[0],c[1]):c}}]);function v(f,c){Oe()(this,v),this.x=void 0,this.y=void 0,this.x=f,this.y=c}return Qe()(v,[{key:"clone",value:function(){return new v(this.x,this.y)}},{key:"_add",value:function(c){return this.x+=c.x,this.y+=c.y,this}},{key:"add",value:function(c){return this.clone()._add(c)}},{key:"_sub",value:function(c){return this.x-=c.x,this.y-=c.y,this}},{key:"sub",value:function(c){return this.clone()._sub(c)}},{key:"_multByPoint",value:function(c){return this.x*=c.x,this.y*=c.y,this}},{key:"multByPoint",value:function(c){return this.clone()._multByPoint(c)}},{key:"_divByPoint",value:function(c){return this.x/=c.x,this.y/=c.y,this}},{key:"divByPoint",value:function(c){return this.clone()._divByPoint(c)}},{key:"_mult",value:function(c){return this.x*=c,this.y*=c,this}},{key:"mult",value:function(c){return this.clone()._mult(c)}},{key:"_div",value:function(c){return this.x/=c,this.y/=c,this}},{key:"div",value:function(c){return this.clone()._div(c)}},{key:"_rotate",value:function(c){var p=Math.cos(c),y=Math.sin(c),P=p*this.x-y*this.y,N=y*this.x+p*this.y;return this.x=P,this.y=N,this}},{key:"rotate",value:function(c){return this.clone()._rotate(c)}},{key:"_rotateAround",value:function(c,p){var y=Math.cos(c),P=Math.sin(c),N=p.x+y*(this.x-p.x)-P*(this.y-p.y),ee=p.y+P*(this.x-p.x)+y*(this.y-p.y);return this.x=N,this.y=ee,this}},{key:"roateAround",value:function(c,p){return this.clone()._rotateAround(c,p)}},{key:"_matMult",value:function(c){var p=c[0]*this.x+c[1]*this.y,y=c[2]*this.x+c[3]*this.y;return this.x=p,this.y=y,this}},{key:"matMult",value:function(c){return this.clone()._matMult(c)}},{key:"_unit",value:function(){return this.div(this.mag()),this}},{key:"unit",value:function(){return this.clone()._unit()}},{key:"_perp",value:function(){var c=this.y;return this.y=this.x,this.x=-c,this}},{key:"perp",value:function(){return this.clone()._perp()}},{key:"_round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"round",value:function(){return this.clone()._round()}},{key:"mag",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"equals",value:function(c){return this.x===c.x&&this.y===c.y}},{key:"dist",value:function(c){return Math.sqrt(this.distSqr(c))}},{key:"distSqr",value:function(c){var p=c.x-this.x,y=c.y-this.y;return p*p+y*y}},{key:"angle",value:function(){return Math.atan2(this.y,this.x)}},{key:"angleTo",value:function(c){return Math.atan2(this.y-c.y,this.x-c.x)}},{key:"angleWith",value:function(c){return this.angleWithSep(c.x,c.y)}},{key:"angleWithSep",value:function(c,p){return Math.atan2(this.x*p-this.y*c,this.x*c+this.y*p)}}]),v}(),Tf=function(){function v(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(Oe()(this,v),this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,isNaN(f)||f<0||isNaN(c)||c<0||isNaN(p)||p<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=f,this.bottom=c,this.left=p,this.right=y}return Qe()(v,[{key:"interpolate",value:function(c,p,y){return p.top!=null&&c.top!=null&&(this.top=Ns(c.top,p.top,y)),p.bottom!=null&&c.bottom!=null&&(this.bottom=Ns(c.bottom,p.bottom,y)),p.left!=null&&c.left!=null&&(this.left=Ns(c.left,p.left,y)),p.right!=null&&c.right!=null&&(this.right=Ns(c.right,p.right,y)),this}},{key:"getCenter",value:function(c,p){var y=wu((this.left+c-this.right)/2,0,c),P=wu((this.top+p-this.bottom)/2,0,p);return new Xa(y,P)}},{key:"equals",value:function(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right}},{key:"clone",value:function(){return new v(this.top,this.bottom,this.left,this.right)}},{key:"toJSON",value:function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}]),v}(),_f=2*Math.PI*Hu;function Ko(v){return _f*Math.cos(v*Math.PI/180)}function Wu(v){return(180+v)/360}function gs(v){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+v*Math.PI/360)))/360}function ks(v,f){return v/Ko(f)}function ys(v){return v*360-180}function $o(v){var f=180-v*360;return 360/Math.PI*Math.atan(Math.exp(f*Math.PI/180))-90}function Zu(v,f){return v*Ko($o(f))}function xn(v){return 1/Math.cos(v*Math.PI/180)}var bs=function(){Qe()(v,null,[{key:"fromLngLat",value:function(c){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,y=ti.convert(c);return new v(Wu(y.lng),gs(y.lat),ks(p,y.lat))}}]);function v(f,c){var p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;Oe()(this,v),this.x=void 0,this.y=void 0,this.z=void 0,this.x=+f,this.y=+c,this.z=+p}return Qe()(v,[{key:"toLngLat",value:function(){return new ti(ys(this.x),$o(this.y))}},{key:"toAltitude",value:function(){return Zu(this.z,this.y)}},{key:"meterInMercatorCoordinateUnits",value:function(){return 1/_f*xn($o(this.y))}}]),v}();function nu(v,f){var c;if(typeof Symbol=="undefined"||v[Symbol.iterator]==null){if(Array.isArray(v)||(c=Sc(v))||f&&v&&typeof v.length=="number"){c&&(v=c);var p=0,y=function(){};return{s:y,n:function(){return p>=v.length?{done:!0}:{done:!1,value:v[p++]}},e:function(J){throw J},f:y}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var P=!0,N=!1,ee;return{s:function(){c=v[Symbol.iterator]()},n:function(){var J=c.next();return P=J.done,J},e:function(J){N=!0,ee=J},f:function(){try{!P&&c.return!=null&&c.return()}finally{if(N)throw ee}}}}function Sc(v,f){if(!v)return;if(typeof v=="string")return Ou(v,f);var c=Object.prototype.toString.call(v).slice(8,-1);if(c==="Object"&&v.constructor&&(c=v.constructor.name),c==="Map"||c==="Set")return Array.from(v);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Ou(v,f)}function Ou(v,f){(f==null||f>v.length)&&(f=v.length);for(var c=0,p=new Array(f);c<f;c++)p[c]=v[c];return p}var Mu=8192,gu=function(){Qe()(v,[{key:"minZoom",get:function(){return this._minZoom},set:function(c){if(this._minZoom===c)return;this._minZoom=c,this.zoom=Math.max(this.zoom,c)}},{key:"maxZoom",get:function(){return this._maxZoom},set:function(c){if(this._maxZoom===c)return;this._maxZoom=c,this.zoom=Math.min(this.zoom,c)}},{key:"minPitch",get:function(){return this._minPitch},set:function(c){if(this._minPitch===c)return;this._minPitch=c,this._pitch=Math.max(this._pitch,c)}},{key:"maxPitch",get:function(){return this._maxPitch},set:function(c){if(this._maxPitch===c)return;this._maxPitch=c,this._pitch=Math.min(this._pitch,c)}},{key:"renderWorldCopies",get:function(){return this._renderWorldCopies},set:function(c){c===void 0?c=!0:c===null&&(c=!1),this._renderWorldCopies=c}},{key:"worldSize",get:function(){return this.tileSize*this.scale}},{key:"centerOffset",get:function(){return this.centerPoint._sub(this.size._div(2))}},{key:"size",get:function(){return new Xa(this.width,this.height)}},{key:"bearing",get:function(){return-this.angle/Math.PI*180},set:function(c){var p=-_c(c,-180,180)*Math.PI/180;if(this.angle===p)return;this.unmodified=!1,this.angle=p,this.calcMatrices(),this.rotationMatrix=ur.a.create(),ur.a.rotate(this.rotationMatrix,this.rotationMatrix,this.angle)}},{key:"pitch",get:function(){return this._pitch/Math.PI*180},set:function(c){var p=wu(c,this._minPitch,this._maxPitch)/180*Math.PI;if(this._pitch===p)return;this.unmodified=!1,this._pitch=p,this.calcMatrices()}},{key:"fov",get:function(){return this._fov/Math.PI*180},set:function(c){if(c=Math.max(.01,Math.min(60,c)),this._fov===c)return;this.unmodified=!1,this._fov=c/180*Math.PI,this.calcMatrices()}},{key:"zoom",get:function(){return this._zoom},set:function(c){var p=Math.min(Math.max(c,this._minZoom),this._maxZoom);if(this._zoom===p)return;this.unmodified=!1,this._zoom=p,this.scale=this.zoomScale(p),this.tileZoom=Math.floor(p),this.zoomFraction=p-this.tileZoom,this.constrain(),this.calcMatrices()}},{key:"center",get:function(){return this._center},set:function(c){if(c.lat===this._center.lat&&c.lng===this._center.lng)return;this.unmodified=!1,this._center=c,this.constrain(),this.calcMatrices()}},{key:"padding",get:function(){return this.edgeInsets.toJSON()},set:function(c){if(this.edgeInsets.equals(c))return;this.unmodified=!1,this.edgeInsets.interpolate(this.edgeInsets,c,1),this.calcMatrices()}},{key:"centerPoint",get:function(){return this.edgeInsets.getCenter(this.width,this.height)}},{key:"point",get:function(){return this.project(this.center)}}]);function v(f,c,p,y,P){Oe()(this,v),this.tileSize=void 0,this.tileZoom=void 0,this.lngRange=void 0,this.latRange=void 0,this.maxValidLatitude=void 0,this.scale=void 0,this.width=void 0,this.height=void 0,this.angle=void 0,this.rotationMatrix=void 0,this.pixelsToGLUnits=void 0,this.cameraToCenterDistance=void 0,this.mercatorMatrix=void 0,this.projMatrix=void 0,this.invProjMatrix=void 0,this.alignedProjMatrix=void 0,this.pixelMatrix=void 0,this.pixelMatrixInverse=void 0,this.glCoordMatrix=void 0,this.labelPlaneMatrix=void 0,this._fov=void 0,this._pitch=void 0,this._zoom=void 0,this._renderWorldCopies=void 0,this._minZoom=void 0,this._maxZoom=void 0,this._minPitch=void 0,this._maxPitch=void 0,this._center=void 0,this.zoomFraction=void 0,this.unmodified=void 0,this.edgeInsets=void 0,this.constraining=void 0,this.posMatrixCache=void 0,this.alignedPosMatrixCache=void 0,this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=P===void 0?!0:P,this._minZoom=f||0,this._maxZoom=c||22,this._minPitch=p==null?0:p,this._maxPitch=y==null?60:y,this.setMaxBounds(),this.width=0,this.height=0,this._center=new ti(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this.unmodified=!0,this.edgeInsets=new Tf,this.posMatrixCache={},this.alignedPosMatrixCache={}}return Qe()(v,[{key:"clone",value:function(){var c=new v(this._minZoom,this._maxZoom,this._minPitch,this._maxPitch,this._renderWorldCopies);return c.tileSize=this.tileSize,c.latRange=this.latRange,c.width=this.width,c.height=this.height,c.center=this._center,c.zoom=this.zoom,c.angle=this.angle,c.fov=this._fov,c.pitch=this._pitch,c.unmodified=this.unmodified,c.edgeInsets=this.edgeInsets.clone(),c.calcMatrices(),c}},{key:"isPaddingEqual",value:function(c){return this.edgeInsets.equals(c)}},{key:"interpolatePadding",value:function(c,p,y){this.unmodified=!1,this.edgeInsets.interpolate(c,p,y),this.constrain(),this.calcMatrices()}},{key:"coveringZoomLevel",value:function(c){var p=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,p)}},{key:"resize",value:function(c,p){this.width=c,this.height=p,this.pixelsToGLUnits=[2/c,-2/p],this.constrain(),this.calcMatrices()}},{key:"zoomScale",value:function(c){return Math.pow(2,c)}},{key:"scaleZoom",value:function(c){return Math.log(c)/Math.LN2}},{key:"project",value:function(c){var p=wu(c.lat,-this.maxValidLatitude,this.maxValidLatitude);return new Xa(Wu(c.lng)*this.worldSize,gs(p)*this.worldSize)}},{key:"unproject",value:function(c){return new bs(c.x/this.worldSize,c.y/this.worldSize).toLngLat()}},{key:"setLocationAtPoint",value:function(c,p){var y=this.pointCoordinate(p),P=this.pointCoordinate(this.centerPoint),N=this.locationCoordinate(c),ee=new bs(N.x-(y.x-P.x),N.y-(y.y-P.y));this.center=this.coordinateLocation(ee),this._renderWorldCopies&&(this.center=this.center.wrap())}},{key:"pointCoordinate",value:function(c){var p=0,y=new Float32Array([c.x,c.y,0,1]),P=new Float32Array([c.x,c.y,1,1]);ur.e.transformMat4(y,y,this.pixelMatrixInverse),ur.e.transformMat4(P,P,this.pixelMatrixInverse);var N=y[3],ee=P[3],V=y[0]/N,J=P[0]/ee,he=y[1]/N,We=P[1]/ee,De=y[2]/N,It=P[2]/ee,Kt=De===It?0:(p-De)/(It-De);return new bs(Ns(V,J,Kt)/this.worldSize,Ns(he,We,Kt)/this.worldSize)}},{key:"getBounds",value:function(){return new $a().extend(this.pointLocation(new Xa(0,0))).extend(this.pointLocation(new Xa(this.width,0))).extend(this.pointLocation(new Xa(this.width,this.height))).extend(this.pointLocation(new Xa(0,this.height)))}},{key:"getMaxBounds",value:function(){return!this.latRange||this.latRange.length!==2||!this.lngRange||this.lngRange.length!==2?null:new $a([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]])}},{key:"setMaxBounds",value:function(c){c?(this.lngRange=[c.getWest(),c.getEast()],this.latRange=[c.getSouth(),c.getNorth()],this.constrain()):(this.lngRange=void 0,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}},{key:"customLayerMatrix",value:function(){return this.mercatorMatrix.slice()}},{key:"maxPitchScaleFactor",value:function(){if(!this.pixelMatrixInverse)return 1;var c=this.pointCoordinate(new Xa(0,0)),p=new Float32Array([c.x*this.worldSize,c.y*this.worldSize,0,1]),y=ur.e.transformMat4(p,p,this.pixelMatrix);return y[3]/this.cameraToCenterDistance}},{key:"getCameraPoint",value:function(){var c=this._pitch,p=Math.tan(c)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new Xa(0,p))}},{key:"getCameraQueryGeometry",value:function(c){var p=this.getCameraPoint();if(c.length===1)return[c[0],p];var y=p.x,P=p.y,N=p.x,ee=p.y,V=nu(c),J;try{for(V.s();!(J=V.n()).done;){var he=J.value;y=Math.min(y,he.x),P=Math.min(P,he.y),N=Math.max(N,he.x),ee=Math.max(ee,he.y)}}catch(We){V.e(We)}finally{V.f()}return[new Xa(y,P),new Xa(N,P),new Xa(N,ee),new Xa(y,ee),new Xa(y,P)]}},{key:"coordinatePoint",value:function(c){var p=ur.e.fromValues(c.x*this.worldSize,c.y*this.worldSize,0,1);return ur.e.transformMat4(p,p,this.pixelMatrix),new Xa(p[0]/p[3],p[1]/p[3])}},{key:"locationPoint",value:function(c){return this.coordinatePoint(this.locationCoordinate(c))}},{key:"pointLocation",value:function(c){return this.coordinateLocation(this.pointCoordinate(c))}},{key:"locationCoordinate",value:function(c){return bs.fromLngLat(c)}},{key:"coordinateLocation",value:function(c){return c.toLngLat()}},{key:"getProjectionMatrix",value:function(){return this.projMatrix}},{key:"constrain",value:function(){if(!this.center||!this.width||!this.height||this.constraining)return;this.constraining=!0;var c=-90,p=90,y=-180,P=180,N,ee,V,J,he=this.size,We=this.unmodified;if(this.latRange){var De=this.latRange;c=gs(De[1])*this.worldSize,p=gs(De[0])*this.worldSize,N=p-c<he.y?he.y/(p-c):0}if(this.lngRange){var It=this.lngRange;y=Wu(It[0])*this.worldSize,P=Wu(It[1])*this.worldSize,ee=P-y<he.x?he.x/(P-y):0}var Kt=this.point,Ht=Math.max(ee||0,N||0);if(Ht){this.center=this.unproject(new Xa(ee?(P+y)/2:Kt.x,N?(p+c)/2:Kt.y)),this.zoom+=this.scaleZoom(Ht),this.unmodified=We,this.constraining=!1;return}if(this.latRange){var fr=Kt.y,Sr=he.y/2;fr-Sr<c&&(J=c+Sr),fr+Sr>p&&(J=p-Sr)}if(this.lngRange){var ln=Kt.x,jr=he.x/2;ln-jr<y&&(V=y+jr),ln+jr>P&&(V=P-jr)}(V!==void 0||J!==void 0)&&(this.center=this.unproject(new Xa(V!==void 0?V:Kt.x,J!==void 0?J:Kt.y))),this.unmodified=We,this.constraining=!1}},{key:"calcMatrices",value:function(){if(!this.height)return;var c=this._fov/2,p=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(c)*this.height;var y=Math.PI/2+this._pitch,P=this._fov*(.5+p.y/this.height),N=Math.sin(P)*this.cameraToCenterDistance/Math.sin(wu(Math.PI-y-P,.01,Math.PI-.01)),ee=this.point,V=ee.x,J=ee.y,he=Math.cos(Math.PI/2-this._pitch)*N+this.cameraToCenterDistance,We=he*1.01,De=this.height/50,It=ur.b.create();ur.b.perspective(It,this._fov,this.width/this.height,De,We),It[8]=-p.x*2/this.width,It[9]=p.y*2/this.height,ur.b.scale(It,It,[1,-1,1]),ur.b.translate(It,It,[0,0,-this.cameraToCenterDistance]),ur.b.rotateX(It,It,this._pitch),ur.b.rotateZ(It,It,this.angle),ur.b.translate(It,It,[-V,-J,0]),this.mercatorMatrix=ur.b.scale(ur.b.create(),It,[this.worldSize,this.worldSize,this.worldSize]),ur.b.scale(It,It,ur.d.fromValues(1,1,ks(1,this.center.lat)*this.worldSize)),this.projMatrix=It,this.invProjMatrix=ur.b.invert(ur.b.create(),this.projMatrix);var Kt=this.width%2/2,Ht=this.height%2/2,fr=Math.cos(this.angle),Sr=Math.sin(this.angle),ln=V-Math.round(V)+fr*Kt+Sr*Ht,jr=J-Math.round(J)+fr*Ht+Sr*Kt,an=ur.b.clone(It);if(ur.b.translate(an,an,[ln>.5?ln-1:ln,jr>.5?jr-1:jr,0]),this.alignedProjMatrix=an,It=ur.b.create(),ur.b.scale(It,It,[this.width/2,-this.height/2,1]),ur.b.translate(It,It,[1,-1,0]),this.labelPlaneMatrix=It,It=ur.b.create(),ur.b.scale(It,It,[1,-1,1]),ur.b.translate(It,It,[-1,-1,0]),ur.b.scale(It,It,[2/this.width,2/this.height,1]),this.glCoordMatrix=It,this.pixelMatrix=ur.b.multiply(ur.b.create(),this.labelPlaneMatrix,this.projMatrix),It=ur.b.invert(ur.b.create(),this.pixelMatrix),!It)throw new Error("failed to invert matrix");this.pixelMatrixInverse=It,this.posMatrixCache={},this.alignedPosMatrixCache={}}}]),v}(),Zr=function v(f){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Oe()(this,v),this.type=void 0,Zi()(this,c),this.type=f};function vi(v){var f=Hc();return function(){var p=vn()(v),y;if(f){var P=vn()(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return lr()(this,y)}}function Hc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}var Wc=function(v){vr()(c,v);var f=vi(c);function c(p){var y;Oe()(this,c),y=f.call(this),y.transform=void 0,y.options=void 0,y.moving=void 0,y.zooming=void 0,y.rotating=void 0,y.pitching=void 0,y.padding=void 0,y.bearingSnap=void 0,y.easeEndTimeoutID=void 0,y.easeStart=void 0,y.easeOptions=void 0,y.easeId=void 0,y.onEaseFrame=void 0,y.onEaseEnd=void 0,y.easeFrameId=void 0,y.renderFrameCallback=function(){var he=Math.min((vu()-y.easeStart)/y.easeOptions.duration,1);y.onEaseFrame(y.easeOptions.easing(he)),he<1?y.easeFrameId=y.requestRenderFrame(y.renderFrameCallback):y.stop()},y.options=p;var P=p.minZoom,N=p.maxZoom,ee=p.minPitch,V=p.maxPitch,J=p.renderWorldCopies;return y.moving=!1,y.zooming=!1,y.bearingSnap=p.bearingSnap,y.transform=new gu(P,N,ee,V,J),y}return Qe()(c,[{key:"requestRenderFrame",value:function(y){return 0}},{key:"cancelRenderFrame",value:function(y){return}},{key:"getCenter",value:function(){var y=this.transform.center,P=y.lng,N=y.lat;return new ti(P,N)}},{key:"getZoom",value:function(){return this.transform.zoom}},{key:"getPitch",value:function(){return this.transform.pitch}},{key:"setCenter",value:function(y,P){return this.jumpTo({center:y},P)}},{key:"setPitch",value:function(y,P){return this.jumpTo({pitch:y},P),this}},{key:"getBearing",value:function(){return this.transform.bearing}},{key:"panTo",value:function(y,P,N){return this.easeTo(Zi()({center:y},P),N)}},{key:"zoomOut",value:function(y,P){return this.zoomTo(this.getZoom()-1,y,P),this}},{key:"setBearing",value:function(y,P){return this.jumpTo({bearing:y},P),this}},{key:"setZoom",value:function(y,P){return this.jumpTo({zoom:y},P),this}},{key:"zoomIn",value:function(y,P){return this.zoomTo(this.getZoom()+1,y,P),this}},{key:"zoomTo",value:function(y,P,N){return this.easeTo(Zi()({zoom:y},P),N)}},{key:"getPadding",value:function(){return this.transform.padding}},{key:"setPadding",value:function(y,P){return this.jumpTo({padding:y},P),this}},{key:"rotateTo",value:function(y,P,N){return this.easeTo(Zi()({bearing:y},P),N)}},{key:"resetNorth",value:function(y,P){return this.rotateTo(0,Zi()({duration:1e3},y),P),this}},{key:"resetNorthPitch",value:function(y,P){return this.easeTo(Zi()({bearing:0,pitch:0,duration:1e3},y),P),this}},{key:"fitBounds",value:function(y,P,N){return this.fitInternal(this.cameraForBounds(y,P),P,N)}},{key:"cameraForBounds",value:function(y,P){return y=$a.convert(y),this.cameraForBoxAndBearing(y.getNorthWest(),y.getSouthEast(),0,P)}},{key:"snapToNorth",value:function(y,P){return Math.abs(this.getBearing())<this.bearingSnap?this.resetNorth(y,P):this}},{key:"jumpTo",value:function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},P=arguments.length>1?arguments[1]:void 0;this.stop();var N=this.transform,ee=!1,V=!1,J=!1;return y.zoom&&N.zoom!==+y.zoom&&(ee=!0,N.zoom=+y.zoom),y.center!==void 0&&(N.center=ti.convert(y.center)),y.bearing&&N.bearing!==+y.bearing&&(V=!0,N.bearing=+y.bearing),y.pitch&&N.pitch!==+y.pitch&&(J=!0,N.pitch=+y.pitch),y.padding!=null&&!N.isPaddingEqual(y.padding)&&(N.padding=y.padding),this.emit("movestart",new Zr("movestart",P)),this.emit("move",new Zr("move",P)),ee&&(this.emit("zoomstart",new Zr("zoomstart",P)),this.emit("zoom",new Zr("zoom",P)),this.emit("zoomend",new Zr("zoomend",P))),V&&(this.emit("rotatestart",new Zr("rotatestart",P)),this.emit("rotate",new Zr("rotate",P)),this.emit("rotateend",new Zr("rotateend",P))),J&&(this.emit("pitchstart",new Zr("pitchstart",P)),this.emit("pitch",new Zr("pitch",P)),this.emit("pitchend",new Zr("pitchend",P))),this.emit("moveend",new Zr("moveend",P))}},{key:"easeTo",value:function(){var y=this,P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},N=arguments.length>1?arguments[1]:void 0;P=Zi()({offset:[0,0],duration:500,easing:Tl},P),(P.animate===!1||!P.essential&&sc())&&(P.duration=0);var ee=this.transform,V=this.getZoom(),J=this.getBearing(),he=this.getPitch(),We=this.getPadding(),De=P.zoom?+P.zoom:V,It=P.bearing?this.normalizeBearing(P.bearing,J):J,Kt=P.pitch?+P.pitch:he,Ht=P.padding?P.padding:ee.padding,fr=Xa.convert(P.offset),Sr=ee.centerPoint.add(fr),ln=ee.pointLocation(Sr),jr=ti.convert(P.center||ln);this.normalizeCenter(jr);var an=ee.project(ln),pn=ee.project(jr).sub(an),Gn=ee.zoomScale(De-V),la,ma;P.around&&(la=ti.convert(P.around),ma=ee.locationPoint(la));var Oi={moving:this.moving,zooming:this.zooming,rotating:this.rotating,pitching:this.pitching};return this.zooming=this.zooming||De!==V,this.rotating=this.rotating||J!==It,this.pitching=this.pitching||Kt!==he,this.padding=!ee.isPaddingEqual(Ht),this.easeId=P.easeId,this.prepareEase(N,P.noMoveStart,Oi),clearTimeout(this.easeEndTimeoutID),this.ease(function(Ga){if(y.zooming&&(ee.zoom=Ns(V,De,Ga)),y.rotating&&(ee.bearing=Ns(J,It,Ga)),y.pitching&&(ee.pitch=Ns(he,Kt,Ga)),y.padding&&(ee.interpolatePadding(We,Ht,Ga),Sr=ee.centerPoint.add(fr)),la)ee.setLocationAtPoint(la,ma);else{var Co=ee.zoomScale(ee.zoom-V),ho=De>V?Math.min(2,Gn):Math.max(.5,Gn),ju=Math.pow(ho,1-Ga),ls=ee.unproject(an.add(pn.mult(Ga*ju)).mult(Co));ee.setLocationAtPoint(ee.renderWorldCopies?ls.wrap():ls,Sr)}y.fireMoveEvents(N)},function(Ga){y.afterEase(N,Ga)},P),this}},{key:"flyTo",value:function(){var y=this,P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},N=arguments.length>1?arguments[1]:void 0;if(!P.essential&&sc()){var ee=Bi(P,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ee,N)}this.stop(),P=Zi()({offset:[0,0],speed:1.2,curve:1.42,easing:Tl},P);var V=this.transform,J=this.getZoom(),he=this.getBearing(),We=this.getPitch(),De=this.getPadding(),It=P.zoom?wu(+P.zoom,V.minZoom,V.maxZoom):J,Kt=P.bearing?this.normalizeBearing(P.bearing,he):he,Ht=P.pitch?+P.pitch:We,fr="padding"in P?P.padding:V.padding,Sr=V.zoomScale(It-J),ln=Xa.convert(P.offset),jr=V.centerPoint.add(ln),an=V.pointLocation(jr),pn=ti.convert(P.center||an);this.normalizeCenter(pn);var Gn=V.project(an),la=V.project(pn).sub(Gn),ma=P.curve,Oi=Math.max(V.width,V.height),Ga=Oi/Sr,Co=la.mag();if("minZoom"in P){var ho=wu(Math.min(P.minZoom,J,It),V.minZoom,V.maxZoom),ju=Oi/V.zoomScale(ho-J);ma=Math.sqrt(ju/Co*2)}var ls=ma*ma;function Jl(Hi){var wl=(Ga*Ga-Oi*Oi+(Hi?-1:1)*ls*ls*Co*Co)/(2*(Hi?Ga:Oi)*ls*Co);return Math.log(Math.sqrt(wl*wl+1)-wl)}function Io(Hi){return(Math.exp(Hi)-Math.exp(-Hi))/2}function xi(Hi){return(Math.exp(Hi)+Math.exp(-Hi))/2}function vf(Hi){return Io(Hi)/xi(Hi)}var Qu=Jl(0),Mf=function(wl){return xi(Qu)/xi(Qu+ma*wl)},mc=function(wl){return Oi*((xi(Qu)*vf(Qu+ma*wl)-Io(Qu))/ls)/Co},Cl=(Jl(1)-Qu)/ma;if(Math.abs(Co)<1e-6||!isFinite(Cl)){if(Math.abs(Oi-Ga)<1e-6)return this.easeTo(P,N);var Rc=Ga<Oi?-1:1;Cl=Math.abs(Math.log(Ga/Oi))/ma,mc=function(){return 0},Mf=function(wl){return Math.exp(Rc*ma*wl)}}if("duration"in P)P.duration=+P.duration;else{var Ic="screenSpeed"in P?+P.screenSpeed/ma:+P.speed;P.duration=1e3*Cl/Ic}return P.maxDuration&&P.duration>P.maxDuration&&(P.duration=0),this.zooming=!0,this.rotating=he!==Kt,this.pitching=Ht!==We,this.padding=!V.isPaddingEqual(fr),this.prepareEase(N,!1),this.ease(function(Hi){var wl=Hi*Cl,Ho=1/Mf(wl);V.zoom=Hi===1?It:J+V.scaleZoom(Ho),y.rotating&&(V.bearing=Ns(he,Kt,Hi)),y.pitching&&(V.pitch=Ns(We,Ht,Hi)),y.padding&&(V.interpolatePadding(De,fr,Hi),jr=V.centerPoint.add(ln));var Pf=Hi===1?pn:V.unproject(Gn.add(la.mult(mc(wl))).mult(Ho));V.setLocationAtPoint(V.renderWorldCopies?Pf.wrap():Pf,jr),y.fireMoveEvents(N)},function(){return y.afterEase(N)},P),this}},{key:"fitScreenCoordinates",value:function(y,P,N,ee,V){return this.fitInternal(this.cameraForBoxAndBearing(this.transform.pointLocation(Xa.convert(y)),this.transform.pointLocation(Xa.convert(P)),N,ee),ee,V)}},{key:"stop",value:function(y,P){if(this.easeFrameId&&(this.cancelRenderFrame(this.easeFrameId),delete this.easeFrameId,delete this.onEaseFrame),this.onEaseEnd){var N=this.onEaseEnd;delete this.onEaseEnd,N.call(this,P)}return this}},{key:"normalizeBearing",value:function(y,P){y=_c(y,-180,180);var N=Math.abs(y-P);return Math.abs(y-360-P)<N&&(y-=360),Math.abs(y+360-P)<N&&(y+=360),y}},{key:"normalizeCenter",value:function(y){var P=this.transform;if(!P.renderWorldCopies||P.lngRange)return;var N=y.lng-P.center.lng;y.lng+=N>180?-360:N<-180?360:0}},{key:"fireMoveEvents",value:function(y){this.emit("move",new Zr("move",y)),this.zooming&&this.emit("zoom",new Zr("zoom",y)),this.rotating&&this.emit("rotate",new Zr("rotate",y)),this.pitching&&this.emit("rotate",new Zr("pitch",y))}},{key:"prepareEase",value:function(y){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,N=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.moving=!0,!P&&!N.moving&&this.emit("movestart",new Zr("movestart",y)),this.zooming&&!N.zooming&&this.emit("zoomstart",new Zr("zoomstart",y)),this.rotating&&!N.rotating&&this.emit("rotatestart",new Zr("rotatestart",y)),this.pitching&&!N.pitching&&this.emit("pitchstart",new Zr("pitchstart",y))}},{key:"afterEase",value:function(y,P){if(this.easeId&&P&&this.easeId===P)return;delete this.easeId;var N=this.zooming,ee=this.rotating,V=this.pitching;this.moving=!1,this.zooming=!1,this.rotating=!1,this.pitching=!1,this.padding=!1,N&&this.emit("zoomend",new Zr("zoomend",y)),ee&&this.emit("rotateend",new Zr("rotateend",y)),V&&this.emit("pitchend",new Zr("pitchend",y)),this.emit("moveend",new Zr("moveend",y))}},{key:"ease",value:function(y,P,N){N.animate===!1||N.duration===0?(y(1),P()):(this.easeStart=vu(),this.easeOptions=N,this.onEaseFrame=y,this.onEaseEnd=P,this.easeFrameId=this.requestRenderFrame(this.renderFrameCallback))}},{key:"cameraForBoxAndBearing",value:function(y,P,N,ee){var V={top:0,bottom:0,right:0,left:0};if(ee=Zi()({padding:V,offset:[0,0],maxZoom:this.transform.maxZoom},ee),typeof ee.padding=="number"){var J=ee.padding;ee.padding={top:J,bottom:J,right:J,left:J}}ee.padding=Zi()(V,ee.padding);var he=this.transform,We=he.padding,De=he.project(ti.convert(y)),It=he.project(ti.convert(P)),Kt=De.rotate(-N*Math.PI/180),Ht=It.rotate(-N*Math.PI/180),fr=new Xa(Math.max(Kt.x,Ht.x),Math.max(Kt.y,Ht.y)),Sr=new Xa(Math.min(Kt.x,Ht.x),Math.min(Kt.y,Ht.y)),ln=fr.sub(Sr),jr=(he.width-(We.left+We.right+ee.padding.left+ee.padding.right))/ln.x,an=(he.height-(We.top+We.bottom+ee.padding.top+ee.padding.bottom))/ln.y;if(an<0||jr<0)return;var pn=Math.min(he.scaleZoom(he.scale*Math.min(jr,an)),ee.maxZoom),Gn=Xa.convert(ee.offset),la=(ee.padding.left-ee.padding.right)/2,ma=(ee.padding.top-ee.padding.bottom)/2,Oi=new Xa(Gn.x+la,Gn.y+ma),Ga=Oi.mult(he.scale/he.zoomScale(pn)),Co=he.unproject(De.add(It).div(2).sub(Ga));return{center:Co,zoom:pn,bearing:N}}},{key:"fitInternal",value:function(y,P,N){return y?(P=Zi()(y,P),delete P.padding,P.linear?this.easeTo(P,N):this.flyTo(P,N)):this}}]),c}(Dl.EventEmitter);function sl(v,f){var c;if(typeof Symbol=="undefined"||v[Symbol.iterator]==null){if(Array.isArray(v)||(c=Pu(v))||f&&v&&typeof v.length=="number"){c&&(v=c);var p=0,y=function(){};return{s:y,n:function(){return p>=v.length?{done:!0}:{done:!1,value:v[p++]}},e:function(J){throw J},f:y}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var P=!0,N=!1,ee;return{s:function(){c=v[Symbol.iterator]()},n:function(){var J=c.next();return P=J.done,J},e:function(J){N=!0,ee=J},f:function(){try{!P&&c.return!=null&&c.return()}finally{if(N)throw ee}}}}function Pu(v,f){if(!v)return;if(typeof v=="string")return Ms(v,f);var c=Object.prototype.toString.call(v).slice(8,-1);if(c==="Object"&&v.constructor&&(c=v.constructor.name),c==="Map"||c==="Set")return Array.from(v);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Ms(v,f)}function Ms(v,f){(f==null||f>v.length)&&(f=v.length);for(var c=0,p=new Array(f);c<f;c++)p[c]=v[c];return p}var as={},wi=as;as.create=function(v,f,c){var p=window.document.createElement(v);return f!==void 0&&(p.className=f),c&&c.appendChild(p),p},as.createNS=function(v,f){var c=window.document.createElementNS(v,f);return c};var js=window.document&&window.document.documentElement.style;function sf(v){if(!js)return v[0];var f=sl(v),c;try{for(f.s();!(c=f.n()).done;){var p=c.value;if(p in js)return p}}catch(y){f.e(y)}finally{f.f()}return v[0]}var ul=sf(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),jl;as.disableDrag=function(){js&&ul&&(jl=js[ul],js[ul]="none")},as.enableDrag=function(){js&&ul&&(js[ul]=jl)};var uf=sf(["transform","WebkitTransform"]);as.setTransform=function(v,f){v.style[uf]=f};var uc=!1;try{var uo=Object.defineProperty({},"passive",{get:function(){uc=!0}});window.addEventListener("test",uo,uo),window.removeEventListener("test",uo,uo)}catch(v){uc=!1}as.addEventListener=function(v,f,c){var p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};"passive"in p&&uc?v.addEventListener(f,c,p):v.addEventListener(f,c,p.capture)},as.removeEventListener=function(v,f,c){var p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};"passive"in p&&uc?v.removeEventListener(f,c,p):v.removeEventListener(f,c,p.capture)};var ci=function v(f){f.preventDefault(),f.stopPropagation(),window.removeEventListener("click",v,!0)};as.suppressClick=function(){window.addEventListener("click",ci,!0),window.setTimeout(function(){window.removeEventListener("click",ci,!0)},0)},as.mousePos=function(v,f){var c=v.getBoundingClientRect();return new Xa(f.clientX-c.left-v.clientLeft,f.clientY-c.top-v.clientTop)},as.touchPos=function(v,f){var c=v.getBoundingClientRect(),p=[],y=sl(f),P;try{for(y.s();!(P=y.n()).done;){var N=P.value;p.push(new Xa(N.clientX-c.left-v.clientLeft,N.clientY-c.top-v.clientTop))}}catch(ee){y.e(ee)}finally{y.f()}return p},as.mouseButton=function(v){return typeof window.InstallTrigger!="undefined"&&v.button===2&&v.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:v.button},as.remove=function(v){v.parentNode&&v.parentNode.removeChild(v)};function mo(v){var f=ll();return function(){var p=vn()(v),y;if(f){var P=vn()(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return lr()(this,y)}}function ll(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}var gi=function(v){vr()(c,v);var f=mo(c);function c(p,y,P){var N,ee=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};Oe()(this,c);var V=wi.mousePos(y.getCanvasContainer(),P),J=y.unproject(V);return N=f.call(this,p,Zi()({point:V,lngLat:J,originalEvent:P},ee)),N.type=void 0,N.target=void 0,N.originalEvent=void 0,N.point=void 0,N.lngLat=void 0,N.defaultPrevented=void 0,N.defaultPrevented=!1,N.target=y,N}return Qe()(c,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),c}(Zr);function Ps(v){var f=cl();return function(){var p=vn()(v),y;if(f){var P=vn()(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return lr()(this,y)}}function cl(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}var au=function(v){vr()(c,v);var f=Ps(c);function c(p,y,P){var N;Oe()(this,c);var ee=p==="touchend"?P.changedTouches:P.touches,V=wi.touchPos(y.getCanvasContainer(),ee),J=V.map(function(De){return y.unproject(De)}),he=V.reduce(function(De,It,Kt,Ht){return De.add(It.div(Ht.length))},new Xa(0,0)),We=y.unproject(he);return N=f.call(this,p,{points:V,point:he,lngLats:J,lngLat:We,originalEvent:P}),N.type=void 0,N.target=void 0,N.originalEvent=void 0,N.lngLat=void 0,N.point=void 0,N.points=void 0,N.lngLats=void 0,N.defaultPrevented=void 0,N.defaultPrevented=!1,N}return Qe()(c,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),c}(Zr);function ko(v){var f=_l();return function(){var p=vn()(v),y;if(f){var P=vn()(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return lr()(this,y)}}function _l(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}var Qn=function(v){vr()(c,v);var f=ko(c);function c(p,y,P){var N;return Oe()(this,c),N=f.call(this,p,{originalEvent:P}),N.type=void 0,N.originalEvent=void 0,N.defaultPrevented=void 0,N.target=void 0,N.defaultPrevented=!1,N}return Qe()(c,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),c}(Zr),ua=function(){function v(f){Oe()(this,v),this.map=void 0,this.delayContextMenu=void 0,this.contextMenuEvent=void 0,this.map=f}return Qe()(v,[{key:"reset",value:function(){this.delayContextMenu=!1,delete this.contextMenuEvent}},{key:"mousemove",value:function(c){this.map.emit(c.type,new gi(c.type,this.map,c))}},{key:"mousedown",value:function(){this.delayContextMenu=!0}},{key:"mouseup",value:function(){this.delayContextMenu=!1,this.contextMenuEvent&&(this.map.emit("contextmenu",new gi("contextmenu",this.map,this.contextMenuEvent)),delete this.contextMenuEvent)}},{key:"contextmenu",value:function(c){this.delayContextMenu?this.contextMenuEvent=c:this.map.emit(c.type,new gi(c.type,this.map,c)),this.map.listeners("contextmenu")&&c.preventDefault()}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){return!0}},{key:"disable",value:function(){return!1}}]),v}(),lo=function(){function v(f,c){Oe()(this,v),this.map=void 0,this.el=void 0,this.container=void 0,this.enabled=void 0,this.active=void 0,this.startPos=void 0,this.lastPos=void 0,this.box=void 0,this.clickTolerance=void 0,this.map=f,this.el=f.getCanvasContainer(),this.container=f.getContainer(),this.clickTolerance=c.clickTolerance||1}return Qe()(v,[{key:"isEnabled",value:function(){return!!this.enabled}},{key:"isActive",value:function(){return!!this.active}},{key:"enable",value:function(){if(this.isEnabled())return;this.enabled=!0}},{key:"disable",value:function(){if(!this.isEnabled())return;this.enabled=!1}},{key:"mousedown",value:function(c,p){if(!this.isEnabled())return;if(!(c.shiftKey&&c.button===0))return;wi.disableDrag(),this.startPos=this.lastPos=p,this.active=!0}},{key:"mousemoveWindow",value:function(c,p){if(!this.active)return;var y=p;if(this.lastPos.equals(y)||!this.box&&y.dist(this.startPos)<this.clickTolerance)return;var P=this.startPos;this.lastPos=y,this.box||(this.box=wi.create("div","l7-boxzoom",this.container),this.container.classList.add("l7-crosshair"),this.fireEvent("boxzoomstart",c));var N=Math.min(P.x,y.x),ee=Math.max(P.x,y.x),V=Math.min(P.y,y.y),J=Math.max(P.y,y.y);wi.setTransform(this.box,"translate(".concat(N,"px,").concat(V,"px)")),this.box&&(this.box.style.width="".concat(ee-N,"px"),this.box.style.height="".concat(J-V,"px"))}},{key:"mouseupWindow",value:function(c,p){var y=this;if(!this.active)return;if(c.button!==0)return;var P=this.startPos,N=p;if(this.reset(),wi.suppressClick(),P.x===N.x&&P.y===N.y)this.fireEvent("boxzoomcancel",c);else return this.map.emit("boxzoomend",new Zr("boxzoomend",{originalEvent:c})),{cameraAnimation:function(V){return V.fitScreenCoordinates(P,N,y.map.getBearing(),{linear:!0})}}}},{key:"keydown",value:function(c){if(!this.active)return;c.keyCode===27&&(this.reset(),this.fireEvent("boxzoomcancel",c))}},{key:"reset",value:function(){this.active=!1,this.container.classList.remove("l7-crosshair"),this.box&&(wi.remove(this.box),this.box=null),wi.enableDrag(),delete this.startPos,delete this.lastPos}},{key:"fireEvent",value:function(c,p){return this.map.emit(c,new Zr(c,{originalEvent:p}))}}]),v}(),zl=lo,zs=function(){function v(){Oe()(this,v),this.enabled=void 0,this.active=void 0,this.reset()}return Qe()(v,[{key:"reset",value:function(){this.active=!1}},{key:"dblclick",value:function(c,p){return c.preventDefault(),{cameraAnimation:function(P){P.easeTo({duration:300,zoom:P.getZoom()+(c.shiftKey?-1:1),around:P.unproject(p)},{originalEvent:c})}}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),v}();function Di(v){var f=is();return function(){var p=vn()(v),y;if(f){var P=vn()(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return lr()(this,y)}}function is(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}var Zc=function(v){vr()(c,v);var f=Di(c);function c(){var p;Oe()(this,c);for(var y=arguments.length,P=new Array(y),N=0;N<y;N++)P[N]=arguments[N];return p=f.call.apply(f,[this].concat(P)),p.type="renderFrame",p.timeStamp=void 0,p}return c}(Zr);function Fs(v,f){var c;if(typeof Symbol=="undefined"||v[Symbol.iterator]==null){if(Array.isArray(v)||(c=_i(v))||f&&v&&typeof v.length=="number"){c&&(v=c);var p=0,y=function(){};return{s:y,n:function(){return p>=v.length?{done:!0}:{done:!1,value:v[p++]}},e:function(J){throw J},f:y}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var P=!0,N=!1,ee;return{s:function(){c=v[Symbol.iterator]()},n:function(){var J=c.next();return P=J.done,J},e:function(J){N=!0,ee=J},f:function(){try{!P&&c.return!=null&&c.return()}finally{if(N)throw ee}}}}function _i(v,f){if(!v)return;if(typeof v=="string")return Si(v,f);var c=Object.prototype.toString.call(v).slice(8,-1);if(c==="Object"&&v.constructor&&(c=v.constructor.name),c==="Map"||c==="Set")return Array.from(v);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Si(v,f)}function Si(v,f){(f==null||f>v.length)&&(f=v.length);for(var c=0,p=new Array(f);c<f;c++)p[c]=v[c];return p}var Xu={linearity:.3,easing:il(0,0,.3,1)},yu=Zi()({deceleration:2500,maxSpeed:1400},Xu),Fl=Zi()({deceleration:20,maxSpeed:1400},Xu),lc=Zi()({deceleration:1e3,maxSpeed:360},Xu),Lu=Zi()({deceleration:1e3,maxSpeed:90},Xu),os=function(){function v(f){Oe()(this,v),this.map=void 0,this.inertiaBuffer=void 0,this.map=f,this.clear()}return Qe()(v,[{key:"clear",value:function(){this.inertiaBuffer=[]}},{key:"record",value:function(c){this.drainInertiaBuffer(),this.inertiaBuffer.push({time:vu(),settings:c})}},{key:"drainInertiaBuffer",value:function(){for(var c=this.inertiaBuffer,p=vu(),y=160;c.length>0&&p-c[0].time>y;)c.shift()}},{key:"onMoveEnd",value:function(c){if(this.drainInertiaBuffer(),this.inertiaBuffer.length<2)return;var p={zoom:0,bearing:0,pitch:0,pan:new Xa(0,0),pinchAround:void 0,around:void 0},y=Fs(this.inertiaBuffer),P;try{for(y.s();!(P=y.n()).done;){var N=P.value.settings;p.zoom+=N.zoomDelta||0,p.bearing+=N.bearingDelta||0,p.pitch+=N.pitchDelta||0,N.panDelta&&p.pan._add(N.panDelta),N.around&&(p.around=N.around),N.pinchAround&&(p.pinchAround=N.pinchAround)}}catch(Ht){y.e(Ht)}finally{y.f()}var ee=this.inertiaBuffer[this.inertiaBuffer.length-1],V=ee.time-this.inertiaBuffer[0].time,J={};if(p.pan.mag()){var he=bu(p.pan.mag(),V,Zi()({},yu,c||{}));J.offset=p.pan.mult(he.amount/p.pan.mag()),J.center=this.map.transform.center,Yu(J,he)}if(p.zoom){var We=bu(p.zoom,V,Fl);J.zoom=this.map.transform.zoom+We.amount,Yu(J,We)}if(p.bearing){var De=bu(p.bearing,V,lc);J.bearing=this.map.transform.bearing+wu(De.amount,-179,179),Yu(J,De)}if(p.pitch){var It=bu(p.pitch,V,Lu);J.pitch=this.map.transform.pitch+It.amount,Yu(J,It)}if(J.zoom||J.bearing){var Kt=p.pinchAround===void 0?p.around:p.pinchAround;J.around=Kt?this.map.unproject(Kt):this.map.getCenter()}return this.clear(),Zi()(J,{noMoveStart:!0})}}]),v}();function Yu(v,f){(!v.duration||v.duration<f.duration)&&(v.duration=f.duration,v.easing=f.easing)}function bu(v,f,c){var p=c.maxSpeed,y=c.linearity,P=c.deceleration,N=wu(v*y/(f/1e3),-p,p),ee=Math.abs(N)/(P*y);return{easing:c.easing,duration:ee*1e3,amount:N*(ee/2)}}var Sf={panStep:100,bearingStep:15,pitchStep:10},Ul=function(){function v(){Oe()(this,v),this.enabled=void 0,this.active=void 0,this.panStep=void 0,this.bearingStep=void 0,this.pitchStep=void 0;var f=Sf;this.panStep=f.panStep,this.bearingStep=f.bearingStep,this.pitchStep=f.pitchStep}return Qe()(v,[{key:"reset",value:function(){this.active=!1}},{key:"keydown",value:function(c){var p=this;if(c.altKey||c.ctrlKey||c.metaKey)return;var y=0,P=0,N=0,ee=0,V=0;switch(c.keyCode){case 61:case 107:case 171:case 187:y=1;break;case 189:case 109:case 173:y=-1;break;case 37:c.shiftKey?P=-1:(c.preventDefault(),ee=-1);break;case 39:c.shiftKey?P=1:(c.preventDefault(),ee=1);break;case 38:c.shiftKey?N=1:(c.preventDefault(),V=-1);break;case 40:c.shiftKey?N=-1:(c.preventDefault(),V=1);break;default:return}return{cameraAnimation:function(he){var We=he.getZoom();he.easeTo({duration:300,easeId:"keyboardHandler",easing:Xc,zoom:y?Math.round(We)+y*(c.shiftKey?2:1):We,bearing:he.getBearing()+P*p.bearingStep,pitch:he.getPitch()+N*p.pitchStep,offset:[-ee*p.panStep,-V*p.panStep],center:he.getCenter()},{originalEvent:c})}}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),v}();function Xc(v){return v*(2-v)}var lf=Ul,iu=function(){function v(f,c){Oe()(this,v),this.mousedownPos=void 0,this.clickTolerance=void 0,this.map=void 0,this.map=f,this.clickTolerance=c.clickTolerance}return Qe()(v,[{key:"reset",value:function(){delete this.mousedownPos}},{key:"wheel",value:function(c){return this.firePreventable(new Qn(c.type,this.map,c))}},{key:"mousedown",value:function(c,p){return this.mousedownPos=p,this.firePreventable(new gi(c.type,this.map,c))}},{key:"mouseup",value:function(c){this.map.emit(c.type,new gi(c.type,this.map,c))}},{key:"click",value:function(c,p){if(this.mousedownPos&&this.mousedownPos.dist(p)>=this.clickTolerance)return;this.map.emit(c.type,new gi(c.type,this.map,c))}},{key:"dblclick",value:function(c){return this.firePreventable(new gi(c.type,this.map,c))}},{key:"mouseover",value:function(c){this.map.emit(c.type,new gi(c.type,this.map,c))}},{key:"mouseout",value:function(c){this.map.emit(c.type,new gi(c.type,this.map,c))}},{key:"touchstart",value:function(c){return this.firePreventable(new au(c.type,this.map,c))}},{key:"touchmove",value:function(c){this.map.emit(c.type,new au(c.type,this.map,c))}},{key:"touchend",value:function(c){this.map.emit(c.type,new au(c.type,this.map,c))}},{key:"touchcancel",value:function(c){this.map.emit(c.type,new au(c.type,this.map,c))}},{key:"firePreventable",value:function(c){if(this.map.emit(c.type,c),c.defaultPrevented)return{}}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){return!1}},{key:"disable",value:function(){return!1}}]),v}(),Sl=i("iWIM"),xu=i.n(Sl),cc,Ru=0,fl=2,hl=(cc={},ha()(cc,Ru,1),ha()(cc,fl,2),cc);function Ls(v,f){var c=hl[f];return v.buttons===void 0||(v.buttons&c)!==c}var Bl=function(){function v(f){Oe()(this,v),this.enabled=void 0,this.active=void 0,this.lastPoint=void 0,this.eventButton=void 0,this.moved=void 0,this.clickTolerance=void 0,this.reset(),this.clickTolerance=f.clickTolerance||1}return Qe()(v,[{key:"reset",value:function(){this.active=!1,this.moved=!1,delete this.lastPoint,delete this.eventButton}},{key:"mousedown",value:function(c,p){if(this.lastPoint)return;var y=wi.mouseButton(c);if(!this.correctButton(c,y))return;this.lastPoint=p,this.eventButton=y}},{key:"mousemoveWindow",value:function(c,p){var y=this.lastPoint;if(!y)return;if(c.preventDefault(),Ls(c,this.eventButton)){this.reset();return}return!this.moved&&p.dist(y)<this.clickTolerance?void 0:(this.moved=!0,this.lastPoint=p,this.move(y,p))}},{key:"mouseupWindow",value:function(c){if(!this.lastPoint)return;var p=wi.mouseButton(c);if(p!==this.eventButton)return;this.moved&&wi.suppressClick(),this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}},{key:"correctButton",value:function(c,p){return!1}},{key:"move",value:function(c,p){return}}]),v}();function Yc(v){var f=Vl();return function(){var p=vn()(v),y;if(f){var P=vn()(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return lr()(this,y)}}function Vl(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}var s=function(v){vr()(c,v);var f=Yc(c);function c(){return Oe()(this,c),f.apply(this,arguments)}return Qe()(c,[{key:"mousedown",value:function(y,P){xu()(vn()(c.prototype),"mousedown",this).call(this,y,P),this.lastPoint&&(this.active=!0)}},{key:"move",value:function(y,P){return{around:P,panDelta:P.sub(y)}}},{key:"correctButton",value:function(y,P){return P===Ru&&!y.ctrlKey}}]),c}(Bl);function a(v){var f=n();return function(){var p=vn()(v),y;if(f){var P=vn()(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return lr()(this,y)}}function n(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}var l=function(v){vr()(c,v);var f=a(c);function c(){return Oe()(this,c),f.apply(this,arguments)}return Qe()(c,[{key:"correctButton",value:function(y,P){return P===Ru&&y.ctrlKey||P===fl}},{key:"move",value:function(y,P){var N=-.5,ee=(P.y-y.y)*N;if(ee)return this.active=!0,{pitchDelta:ee}}},{key:"contextmenu",value:function(y){y.preventDefault()}}]),c}(Bl);function b(v){var f=O();return function(){var p=vn()(v),y;if(f){var P=vn()(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return lr()(this,y)}}function O(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}var R=function(v){vr()(c,v);var f=b(c);function c(){return Oe()(this,c),f.apply(this,arguments)}return Qe()(c,[{key:"contextmenu",value:function(y){y.preventDefault()}},{key:"correctButton",value:function(y,P){return P===Ru&&y.ctrlKey||P===fl}},{key:"move",value:function(y,P){var N=.8,ee=(P.x-y.x)*N;if(ee)return this.active=!0,{bearingDelta:ee}}}]),c}(Bl),j=4.000244140625,ue=1/100,Te=1/450,Ye=2,qe=function(){function v(f,c){var p=this;Oe()(this,v),this.map=void 0,this.el=void 0,this.enabled=void 0,this.active=void 0,this.zooming=void 0,this.aroundCenter=void 0,this.around=void 0,this.aroundPoint=void 0,this.type=void 0,this.lastValue=void 0,this.timeout=void 0,this.finishTimeout=void 0,this.lastWheelEvent=void 0,this.lastWheelEventTime=void 0,this.startZoom=void 0,this.targetZoom=void 0,this.delta=void 0,this.easing=void 0,this.prevEase=void 0,this.frameId=void 0,this.handler=void 0,this.defaultZoomRate=void 0,this.wheelZoomRate=void 0,this.onScrollFrame=function(){if(!p.frameId)return;if(p.frameId=null,!p.isActive())return;var y=p.map.transform;if(p.delta!==0){var P=p.type==="wheel"&&Math.abs(p.delta)>j?p.wheelZoomRate:p.defaultZoomRate,N=Ye/(1+Math.exp(-Math.abs(p.delta*P)));p.delta<0&&N!==0&&(N=1/N);var ee=typeof p.targetZoom=="number"?y.zoomScale(p.targetZoom):y.scale;p.targetZoom=Math.min(y.maxZoom,Math.max(y.minZoom,y.scaleZoom(ee*N))),p.type==="wheel"&&(p.startZoom=y.zoom,p.easing=p.smoothOutEasing(200)),p.delta=0}var V=typeof p.targetZoom=="number"?p.targetZoom:y.zoom,J=p.startZoom,he=p.easing,We=!1,De;if(p.type==="wheel"&&J&&he){var It=Math.min((vu()-p.lastWheelEventTime)/200,1),Kt=he(It);De=Ns(J,V,Kt),It<1?p.frameId||(p.frameId=!0):We=!0}else De=V,We=!0;return p.active=!0,We&&(p.active=!1,p.finishTimeout=setTimeout(function(){p.zooming=!1,p.handler.triggerRenderFrame(),delete p.targetZoom,delete p.finishTimeout},200)),{noInertia:!0,needsRenderFrame:!We,zoomDelta:De-y.zoom,around:p.aroundPoint,originalEvent:p.lastWheelEvent}},this.map=f,this.el=f.getCanvasContainer(),this.handler=c,this.delta=0,this.defaultZoomRate=ue,this.wheelZoomRate=Te}return Qe()(v,[{key:"setZoomRate",value:function(c){this.defaultZoomRate=c}},{key:"setWheelZoomRate",value:function(c){this.wheelZoomRate=c}},{key:"isEnabled",value:function(){return!!this.enabled}},{key:"isActive",value:function(){return!!this.active||this.finishTimeout!==void 0}},{key:"isZooming",value:function(){return!!this.zooming}},{key:"enable",value:function(c){if(this.isEnabled())return;this.enabled=!0,this.aroundCenter=c&&c.around==="center"}},{key:"disable",value:function(){if(!this.isEnabled())return;this.enabled=!1}},{key:"wheel",value:function(c){if(!this.isEnabled())return;var p=c.deltaMode===window.WheelEvent.DOM_DELTA_LINE?c.deltaY*40:c.deltaY,y=vu(),P=y-(this.lastWheelEventTime||0);this.lastWheelEventTime=y,p!==0&&p%j===0?this.type="wheel":p!==0&&Math.abs(p)<4?this.type="trackpad":P>400?(this.type=null,this.lastValue=p,this.timeout=setTimeout(this.onTimeout,40,c)):this.type||(this.type=Math.abs(P*p)<200?"trackpad":"wheel",this.timeout&&(clearTimeout(this.timeout),this.timeout=null,p+=this.lastValue)),c.shiftKey&&p&&(p=p/4),this.type&&(this.lastWheelEvent=c,this.delta-=p,this.active||this.start(c)),c.preventDefault()}},{key:"renderFrame",value:function(){return this.onScrollFrame()}},{key:"reset",value:function(){this.active=!1}},{key:"onTimeout",value:function(c){this.type="wheel",this.delta-=this.lastValue,this.active||this.start(c)}},{key:"start",value:function(c){if(!this.delta)return;this.frameId&&(this.frameId=null),this.active=!0,this.isZooming()||(this.zooming=!0),this.finishTimeout&&(clearTimeout(this.finishTimeout),delete this.finishTimeout);var p=wi.mousePos(this.el,c);this.around=ti.convert(this.aroundCenter?this.map.getCenter():this.map.unproject(p)),this.aroundPoint=this.map.transform.locationPoint(this.around),this.frameId||(this.frameId=!0,this.handler.triggerRenderFrame())}},{key:"smoothOutEasing",value:function(c){var p=Tl;if(this.prevEase){var y=this.prevEase,P=(vu()-y.start)/y.duration,N=y.easing(P+.01)-y.easing(P),ee=.27/Math.sqrt(N*N+1e-4)*.01,V=Math.sqrt(.27*.27-ee*ee);p=il(ee,V,.25,1)}return this.prevEase={start:vu(),duration:c,easing:p},p}}]),v}(),tt=qe,Dt=function(){function v(f,c){Oe()(this,v),this.clickZoom=void 0,this.tapZoom=void 0,this.clickZoom=f,this.tapZoom=c}return Qe()(v,[{key:"enable",value:function(){this.clickZoom.enable(),this.tapZoom.enable()}},{key:"disable",value:function(){this.clickZoom.disable(),this.tapZoom.disable()}},{key:"isEnabled",value:function(){return this.clickZoom.isEnabled()&&this.tapZoom.isEnabled()}},{key:"isActive",value:function(){return this.clickZoom.isActive()||this.tapZoom.isActive()}}]),v}(),Rt=function(){function v(f,c,p){Oe()(this,v),this.inertiaOptions=void 0,this.el=void 0,this.mousePan=void 0,this.touchPan=void 0,this.el=f,this.mousePan=c,this.touchPan=p}return Qe()(v,[{key:"enable",value:function(c){this.inertiaOptions=c||{},this.mousePan.enable(),this.touchPan.enable(),this.el.classList.add("l7-touch-drag-pan")}},{key:"disable",value:function(){this.mousePan.disable(),this.touchPan.disable(),this.el.classList.remove("l7-touch-drag-pan")}},{key:"isEnabled",value:function(){return this.mousePan.isEnabled()&&this.touchPan.isEnabled()}},{key:"isActive",value:function(){return this.mousePan.isActive()||this.touchPan.isActive()}}]),v}(),Wt=function(){function v(f,c,p){Oe()(this,v),this.mouseRotate=void 0,this.mousePitch=void 0,this.pitchWithRotate=void 0,this.pitchWithRotate=f.pitchWithRotate,this.mouseRotate=c,this.mousePitch=p}return Qe()(v,[{key:"enable",value:function(){this.mouseRotate.enable(),this.pitchWithRotate&&this.mousePitch.enable()}},{key:"disable",value:function(){this.mouseRotate.disable(),this.mousePitch.disable()}},{key:"isEnabled",value:function(){return this.mouseRotate.isEnabled()&&(!this.pitchWithRotate||this.mousePitch.isEnabled())}},{key:"isActive",value:function(){return this.mouseRotate.isActive()||this.mousePitch.isActive()}}]),v}(),kt=function(){function v(f,c,p,y){Oe()(this,v),this.el=void 0,this.touchZoom=void 0,this.touchRotate=void 0,this.tapDragZoom=void 0,this.rotationDisabled=void 0,this.enabled=void 0,this.el=f,this.touchZoom=c,this.touchRotate=p,this.tapDragZoom=y,this.rotationDisabled=!1,this.enabled=!0}return Qe()(v,[{key:"enable",value:function(c){this.touchZoom.enable(c),this.rotationDisabled||this.touchRotate.enable(c),this.tapDragZoom.enable(),this.el.classList.add("l7-touch-zoom-rotate")}},{key:"disable",value:function(){this.touchZoom.disable(),this.touchRotate.disable(),this.tapDragZoom.disable(),this.el.classList.remove("l7-touch-zoom-rotate")}},{key:"isEnabled",value:function(){return this.touchZoom.isEnabled()&&(this.rotationDisabled||this.touchRotate.isEnabled())&&this.tapDragZoom.isEnabled()}},{key:"isActive",value:function(){return this.touchZoom.isActive()||this.touchRotate.isActive()||this.tapDragZoom.isActive()}},{key:"disableRotation",value:function(){this.rotationDisabled=!0,this.touchRotate.disable()}},{key:"enableRotation",value:function(){this.rotationDisabled=!1,this.touchZoom.isEnabled()&&this.touchRotate.enable()}}]),v}();function zt(v,f){for(var c={},p=0;p<v.length;p++)c[v[p].identifier]=f[p];return c}function nr(v,f){var c;if(typeof Symbol=="undefined"||v[Symbol.iterator]==null){if(Array.isArray(v)||(c=Jt(v))||f&&v&&typeof v.length=="number"){c&&(v=c);var p=0,y=function(){};return{s:y,n:function(){return p>=v.length?{done:!0}:{done:!1,value:v[p++]}},e:function(J){throw J},f:y}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var P=!0,N=!1,ee;return{s:function(){c=v[Symbol.iterator]()},n:function(){var J=c.next();return P=J.done,J},e:function(J){N=!0,ee=J},f:function(){try{!P&&c.return!=null&&c.return()}finally{if(N)throw ee}}}}function Jt(v,f){if(!v)return;if(typeof v=="string")return Cr(v,f);var c=Object.prototype.toString.call(v).slice(8,-1);if(c==="Object"&&v.constructor&&(c=v.constructor.name),c==="Map"||c==="Set")return Array.from(v);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Cr(v,f)}function Cr(v,f){(f==null||f>v.length)&&(f=v.length);for(var c=0,p=new Array(f);c<f;c++)p[c]=v[c];return p}function pr(v){var f=new Xa(0,0),c=nr(v),p;try{for(c.s();!(p=c.n()).done;){var y=p.value;f._add(y)}}catch(P){c.e(P)}finally{c.f()}return f.div(v.length)}var _r=500,wr=500,Hr=30,Yr=function(){function v(f){Oe()(this,v),this.numTouches=void 0,this.centroid=void 0,this.startTime=void 0,this.aborted=void 0,this.touches=void 0,this.reset(),this.numTouches=f.numTouches}return Qe()(v,[{key:"reset",value:function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}},{key:"touchstart",value:function(c,p,y){if((this.centroid||y.length>this.numTouches)&&(this.aborted=!0),this.aborted)return;this.startTime===void 0&&(this.startTime=c.timeStamp),y.length===this.numTouches&&(this.centroid=pr(p),this.touches=zt(y,p))}},{key:"touchmove",value:function(c,p,y){if(this.aborted||!this.centroid)return;var P=zt(y,p);for(var N in this.touches)if(this.touches[N]){var ee=this.touches[N],V=P[N];(!V||V.dist(ee)>Hr)&&(this.aborted=!0)}}},{key:"touchend",value:function(c,p,y){if((!this.centroid||c.timeStamp-this.startTime>wr)&&(this.aborted=!0),y.length===0){var P=!this.aborted&&this.centroid;if(this.reset(),P)return P}}}]),v}(),un=function(){function v(f){Oe()(this,v),this.singleTap=void 0,this.numTaps=void 0,this.lastTime=void 0,this.lastTap=void 0,this.count=void 0,this.singleTap=new Yr(f),this.numTaps=f.numTaps,this.reset()}return Qe()(v,[{key:"reset",value:function(){this.lastTime=Infinity,delete this.lastTap,this.count=0,this.singleTap.reset()}},{key:"touchstart",value:function(c,p,y){this.singleTap.touchstart(c,p,y)}},{key:"touchmove",value:function(c,p,y){this.singleTap.touchmove(c,p,y)}},{key:"touchend",value:function(c,p,y){var P=this.singleTap.touchend(c,p,y);if(P){var N=c.timeStamp-this.lastTime<_r,ee=!this.lastTap||this.lastTap.dist(P)<Hr;if((!N||!ee)&&this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=P,this.count===this.numTaps)return this.reset(),P}}}]),v}(),_n=function(){function v(){Oe()(this,v),this.enabled=void 0,this.active=void 0,this.swipePoint=void 0,this.swipeTouch=void 0,this.tapTime=void 0,this.tap=void 0,this.tap=new un({numTouches:1,numTaps:1}),this.reset()}return Qe()(v,[{key:"reset",value:function(){this.active=!1,delete this.swipePoint,delete this.swipeTouch,delete this.tapTime,this.tap.reset()}},{key:"touchstart",value:function(c,p,y){if(this.swipePoint)return;this.tapTime&&c.timeStamp-this.tapTime>_r&&this.reset(),this.tapTime?y.length>0&&(this.swipePoint=p[0],this.swipeTouch=y[0].identifier):this.tap.touchstart(c,p,y)}},{key:"touchmove",value:function(c,p,y){if(!this.tapTime)this.tap.touchmove(c,p,y);else if(this.swipePoint){if(y[0].identifier!==this.swipeTouch)return;var P=p[0],N=P.y-this.swipePoint.y;return this.swipePoint=P,c.preventDefault(),this.active=!0,{zoomDelta:N/128}}}},{key:"touchend",value:function(c,p,y){if(this.tapTime)this.swipePoint&&(y.length===0&&this.reset());else{var P=this.tap.touchend(c,p,y);P&&(this.tapTime=c.timeStamp)}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),v}(),ia=function(){function v(){Oe()(this,v),this.enabled=void 0,this.active=void 0,this.zoomIn=void 0,this.zoomOut=void 0,this.zoomIn=new un({numTouches:1,numTaps:2}),this.zoomOut=new un({numTouches:2,numTaps:1}),this.reset()}return Qe()(v,[{key:"reset",value:function(){this.active=!1,this.zoomIn.reset(),this.zoomOut.reset()}},{key:"touchstart",value:function(c,p,y){this.zoomIn.touchstart(c,p,y),this.zoomOut.touchstart(c,p,y)}},{key:"touchmove",value:function(c,p,y){this.zoomIn.touchmove(c,p,y),this.zoomOut.touchmove(c,p,y)}},{key:"touchend",value:function(c,p,y){var P=this,N=this.zoomIn.touchend(c,p,y),ee=this.zoomOut.touchend(c,p,y);if(N)return this.active=!0,c.preventDefault(),setTimeout(function(){return P.reset()},0),{cameraAnimation:function(J){return J.easeTo({duration:300,zoom:J.getZoom()+1,around:J.unproject(N)},{originalEvent:c})}};if(ee)return this.active=!0,c.preventDefault(),setTimeout(function(){return P.reset()},0),{cameraAnimation:function(J){return J.easeTo({duration:300,zoom:J.getZoom()-1,around:J.unproject(ee)},{originalEvent:c})}}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),v}(),pa=function(){function v(f){Oe()(this,v),this.enabled=void 0,this.active=void 0,this.touches=void 0,this.minTouches=void 0,this.clickTolerance=void 0,this.sum=void 0,this.minTouches=1,this.clickTolerance=f.clickTolerance||1,this.reset()}return Qe()(v,[{key:"reset",value:function(){this.active=!1,this.touches={},this.sum=new Xa(0,0)}},{key:"touchstart",value:function(c,p,y){return this.calculateTransform(c,p,y)}},{key:"touchmove",value:function(c,p,y){return this.active?(c.preventDefault(),this.calculateTransform(c,p,y)):void 0}},{key:"touchend",value:function(c,p,y){this.calculateTransform(c,p,y),this.active&&y.length<this.minTouches&&this.reset()}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}},{key:"calculateTransform",value:function(c,p,y){y.length>0&&(this.active=!0);var P=zt(y,p),N=new Xa(0,0),ee=new Xa(0,0),V=0;for(var J in P)if(P[J]){var he=P[J],We=this.touches[J];We&&(N._add(he),ee._add(he.sub(We)),V++,P[J]=he)}if(this.touches=P,V<this.minTouches||!ee.mag())return;var De=ee.div(V);if(this.sum._add(De),this.sum.mag()<this.clickTolerance)return;var It=N.div(V);return{around:It,panDelta:De}}}]),v}(),ya=function(){function v(){Oe()(this,v),this.enabled=void 0,this.active=void 0,this.firstTwoTouches=void 0,this.vector=void 0,this.startVector=void 0,this.aroundCenter=void 0,this.reset()}return Qe()(v,[{key:"reset",value:function(){this.active=!1,delete this.firstTwoTouches}},{key:"start",value:function(c){return}},{key:"move",value:function(c,p,y){return}},{key:"touchstart",value:function(c,p,y){if(this.firstTwoTouches||y.length<2)return;this.firstTwoTouches=[y[0].identifier,y[1].identifier],this.start([p[0],p[1]])}},{key:"touchmove",value:function(c,p,y){if(!this.firstTwoTouches)return;c.preventDefault();var P=ea()(this.firstTwoTouches,2),N=P[0],ee=P[1],V=Pa(y,p,N),J=Pa(y,p,ee);if(!V||!J)return;var he=this.aroundCenter?null:V.add(J).div(2);return this.move([V,J],he,c)}},{key:"touchend",value:function(c,p,y){if(!this.firstTwoTouches)return;var P=ea()(this.firstTwoTouches,2),N=P[0],ee=P[1],V=Pa(y,p,N),J=Pa(y,p,ee);if(V&&J)return;this.active&&wi.suppressClick(),this.reset()}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(c){this.enabled=!0,this.aroundCenter=!!c&&c.around==="center"}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),v}();function Pa(v,f,c){for(var p=0;p<v.length;p++)if(v[p].identifier===c)return f[p]}function Pn(v){var f=ga();return function(){var p=vn()(v),y;if(f){var P=vn()(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return lr()(this,y)}}function ga(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}function aa(v){return Math.abs(v.y)>Math.abs(v.x)}var zn=100,Ca=function(v){vr()(c,v);var f=Pn(c);function c(){var p;Oe()(this,c);for(var y=arguments.length,P=new Array(y),N=0;N<y;N++)P[N]=arguments[N];return p=f.call.apply(f,[this].concat(P)),p.valid=void 0,p.firstMove=void 0,p.lastPoints=void 0,p}return Qe()(c,[{key:"reset",value:function(){xu()(vn()(c.prototype),"reset",this).call(this),this.valid=void 0,delete this.firstMove,delete this.lastPoints}},{key:"start",value:function(y){this.lastPoints=y,aa(y[0].sub(y[1]))&&(this.valid=!1)}},{key:"move",value:function(y,P,N){var ee=y[0].sub(this.lastPoints[0]),V=y[1].sub(this.lastPoints[1]);if(this.valid=this.gestureBeginsVertically(ee,V,N.timeStamp),!this.valid)return;this.lastPoints=y,this.active=!0;var J=(ee.y+V.y)/2,he=-.5;return{pitchDelta:J*he}}},{key:"gestureBeginsVertically",value:function(y,P,N){if(this.valid!==void 0)return this.valid;var ee=2,V=y.mag()>=ee,J=P.mag()>=ee;if(!V&&!J)return;if(!V||!J)return this.firstMove===void 0&&(this.firstMove=N),N-this.firstMove<zn?void 0:!1;var he=y.y>0===P.y>0;return aa(y)&&aa(P)&&he}}]),c}(ya);function qn(v){var f=wa();return function(){var p=vn()(v),y;if(f){var P=vn()(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return lr()(this,y)}}function wa(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}var Ja=25;function co(v,f){return v.angleWith(f)*180/Math.PI}var $i=function(v){vr()(c,v);var f=qn(c);function c(){var p;Oe()(this,c);for(var y=arguments.length,P=new Array(y),N=0;N<y;N++)P[N]=arguments[N];return p=f.call.apply(f,[this].concat(P)),p.minDiameter=void 0,p}return Qe()(c,[{key:"reset",value:function(){xu()(vn()(c.prototype),"reset",this).call(this),delete this.minDiameter,delete this.startVector,delete this.vector}},{key:"start",value:function(y){this.startVector=this.vector=y[0].sub(y[1]),this.minDiameter=y[0].dist(y[1])}},{key:"move",value:function(y,P){var N=this.vector;return this.vector=y[0].sub(y[1]),!this.active&&this.isBelowThreshold(this.vector)?void 0:(this.active=!0,{bearingDelta:co(this.vector,N),pinchAround:P})}},{key:"isBelowThreshold",value:function(y){this.minDiameter=Math.min(this.minDiameter,y.mag());var P=Math.PI*this.minDiameter,N=Ja/P*360,ee=co(y,this.startVector);return Math.abs(ee)<N}}]),c}(ya);function Vi(v){var f=fi();return function(){var p=vn()(v),y;if(f){var P=vn()(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return lr()(this,y)}}function fi(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}var Ji=.1;function Lo(v,f){return Math.log(v/f)/Math.LN2}var Iu=function(v){vr()(c,v);var f=Vi(c);function c(){var p;Oe()(this,c);for(var y=arguments.length,P=new Array(y),N=0;N<y;N++)P[N]=arguments[N];return p=f.call.apply(f,[this].concat(P)),p.distance=void 0,p.startDistance=void 0,p}return Qe()(c,[{key:"reset",value:function(){xu()(vn()(c.prototype),"reset",this).call(this),delete this.distance,delete this.startDistance}},{key:"start",value:function(y){this.startDistance=this.distance=y[0].dist(y[1])}},{key:"move",value:function(y,P){var N=this.distance;return this.distance=y[0].dist(y[1]),!this.active&&Math.abs(Lo(this.distance,this.startDistance))<Ji?void 0:(this.active=!0,{zoomDelta:Lo(this.distance,N),pinchAround:P})}}]),c}(ya);function Us(v,f){var c;if(typeof Symbol=="undefined"||v[Symbol.iterator]==null){if(Array.isArray(v)||(c=Bs(v))||f&&v&&typeof v.length=="number"){c&&(v=c);var p=0,y=function(){};return{s:y,n:function(){return p>=v.length?{done:!0}:{done:!1,value:v[p++]}},e:function(J){throw J},f:y}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var P=!0,N=!1,ee;return{s:function(){c=v[Symbol.iterator]()},n:function(){var J=c.next();return P=J.done,J},e:function(J){N=!0,ee=J},f:function(){try{!P&&c.return!=null&&c.return()}finally{if(N)throw ee}}}}function Bs(v,f){if(!v)return;if(typeof v=="string")return Jo(v,f);var c=Object.prototype.toString.call(v).slice(8,-1);if(c==="Object"&&v.constructor&&(c=v.constructor.name),c==="Map"||c==="Set")return Array.from(v);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Jo(v,f)}function Jo(v,f){(f==null||f>v.length)&&(f=v.length);for(var c=0,p=new Array(f);c<f;c++)p[c]=v[c];return p}var ss=function(f){return f.zoom||f.drag||f.pitch||f.rotate};function Al(v){return v.panDelta&&v.panDelta.mag()||v.zoomDelta||v.bearingDelta||v.pitchDelta}var Eu=function(){function v(f,c){var p=this;Oe()(this,v),this.map=void 0,this.el=void 0,this.handlers=void 0,this.eventsInProgress=void 0,this.frameId=void 0,this.inertia=void 0,this.bearingSnap=void 0,this.handlersById=void 0,this.updatingCamera=void 0,this.changes=void 0,this.previousActiveHandlers=void 0,this.bearingChanged=void 0,this.listeners=void 0,this.handleWindowEvent=function(We){p.handleEvent(We,"".concat(We.type,"Window"))},this.handleEvent=function(We,De){if(We.type==="blur"){p.stop();return}p.updatingCamera=!0;var It=We.type==="renderFrame"?void 0:We,Kt={needsRenderFrame:!1},Ht={},fr={},Sr=We.touches?p.getMapTouches(We.touches):void 0,ln=Sr?wi.touchPos(p.el,Sr):wi.mousePos(p.el,We),jr=Us(p.handlers),an;try{for(jr.s();!(an=jr.n()).done;){var pn=an.value,Gn=pn.handlerName,la=pn.handler,ma=pn.allowed;if(!la.isEnabled())continue;var Oi=void 0;if(p.blockedByActive(fr,ma,Gn))la.reset();else{var Ga=De||We.type;la&&la[Ga]&&(Oi=la[Ga](We,ln,Sr),p.mergeIHandlerResult(Kt,Ht,Oi,Gn,It),Oi&&Oi.needsRenderFrame&&p.triggerRenderFrame())}(Oi||la.isActive())&&(fr[Gn]=la)}}catch(ls){jr.e(ls)}finally{jr.f()}var Co={};for(var ho in p.previousActiveHandlers)fr[ho]||(Co[ho]=It);p.previousActiveHandlers=fr,(Object.keys(Co).length||Al(Kt))&&(p.changes.push([Kt,Ht,Co]),p.triggerRenderFrame()),(Object.keys(fr).length||Al(Kt))&&p.map.stop(!0),p.updatingCamera=!1;var ju=Kt.cameraAnimation;ju&&(p.inertia.clear(),p.fireEvents({},{}),p.changes=[],ju(p.map))},this.map=f,this.el=this.map.getCanvasContainer(),this.handlers=[],this.handlersById={},this.changes=[],this.inertia=new os(f),this.bearingSnap=c.bearingSnap,this.previousActiveHandlers={},this.eventsInProgress={},this.addDefaultHandlers(c);var y=this.el;this.listeners=[[y,"touchstart",{passive:!1}],[y,"touchmove",{passive:!1}],[y,"touchend",void 0],[y,"touchcancel",void 0],[y,"mousedown",void 0],[y,"mousemove",void 0],[y,"mouseup",void 0],[window.document,"mousemove",{capture:!0}],[window.document,"mouseup",void 0],[y,"mouseover",void 0],[y,"mouseout",void 0],[y,"dblclick",void 0],[y,"click",void 0],[y,"keydown",{capture:!1}],[y,"keyup",void 0],[y,"wheel",{passive:!1}],[y,"contextmenu",void 0],[window,"blur",void 0]];var P=Us(this.listeners),N;try{for(P.s();!(N=P.n()).done;){var ee=ea()(N.value,3),V=ee[0],J=ee[1],he=ee[2];wi.addEventListener(V,J,V===window.document?this.handleWindowEvent:this.handleEvent,he)}}catch(We){P.e(We)}finally{P.f()}}return Qe()(v,[{key:"destroy",value:function(){var c=Us(this.listeners),p;try{for(c.s();!(p=c.n()).done;){var y=ea()(p.value,3),P=y[0],N=y[1],ee=y[2];wi.removeEventListener(P,N,P===window.document?this.handleWindowEvent:this.handleEvent,ee)}}catch(V){c.e(V)}finally{c.f()}}},{key:"stop",value:function(){if(this.updatingCamera)return;var c=Us(this.handlers),p;try{for(c.s();!(p=c.n()).done;){var y=p.value.handler;y.reset()}}catch(P){c.e(P)}finally{c.f()}this.inertia.clear(),this.fireEvents({},{}),this.changes=[]}},{key:"isActive",value:function(){var c=Us(this.handlers),p;try{for(c.s();!(p=c.n()).done;){var y=p.value.handler;if(y.isActive())return!0}}catch(P){c.e(P)}finally{c.f()}return!1}},{key:"isZooming",value:function(){return!!this.eventsInProgress.zoom||this.map.scrollZoom.isZooming()}},{key:"isRotating",value:function(){return!!this.eventsInProgress.rotate}},{key:"isMoving",value:function(){return Boolean(ss(this.eventsInProgress))||this.isZooming()}},{key:"mergeIHandlerResult",value:function(c,p,y,P,N){if(!y)return;Zi()(c,y);var ee={handlerName:P,originalEvent:y.originalEvent||N};y.zoomDelta!==void 0&&(p.zoom=ee),y.panDelta!==void 0&&(p.drag=ee),y.pitchDelta!==void 0&&(p.pitch=ee),y.bearingDelta!==void 0&&(p.rotate=ee)}},{key:"triggerRenderFrame",value:function(){var c=this;this.frameId===void 0&&(this.frameId=this.map.requestRenderFrame(function(p){delete c.frameId,c.handleEvent(new Zc("renderFrame",{timeStamp:p})),c.applyChanges()}))}},{key:"addDefaultHandlers",value:function(c){var p=this.map,y=p.getCanvasContainer();this.add("mapEvent",new iu(p,c));var P=p.boxZoom=new zl(p,c);this.add("boxZoom",P);var N=new ia,ee=new zs;p.doubleClickZoom=new Dt(ee,N),this.add("tapZoom",N),this.add("clickZoom",ee);var V=new _n;this.add("tapDragZoom",V);var J=p.touchPitch=new Ca;this.add("touchPitch",J);var he=new l(c),We=new R(c);p.dragRotate=new Wt(c,he,We),this.add("mouseRotate",he,["mousePitch"]),this.add("mousePitch",We,["mouseRotate"]);var De=new s(c),It=new pa(c);p.dragPan=new Rt(y,De,It),this.add("mousePan",De),this.add("touchPan",It,["touchZoom","touchRotate"]);var Kt=new $i,Ht=new Iu;p.touchZoomRotate=new kt(y,Ht,Kt,V),this.add("touchRotate",Kt,["touchPan","touchZoom"]),this.add("touchZoom",Ht,["touchPan","touchRotate"]);var fr=p.scrollZoom=new tt(p,this);this.add("scrollZoom",fr,["mousePan"]);var Sr=p.keyboard=new lf;this.add("keyboard",Sr),this.add("blockableMapEvent",new ua(p));for(var ln=0,jr=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];ln<jr.length;ln++){var an=jr[ln];c.interactive&&c[an]&&p[an].enable(c[an])}}},{key:"add",value:function(c,p,y){this.handlers.push({handlerName:c,handler:p,allowed:y}),this.handlersById[c]=p}},{key:"blockedByActive",value:function(c,p,y){for(var P in c){if(P===y)continue;if(!p||p.indexOf(P)<0)return!0}return!1}},{key:"getMapTouches",value:function(c){var p=[],y=Us(c),P;try{for(y.s();!(P=y.n()).done;){var N=P.value,ee=N.target;this.el.contains(ee)&&p.push(N)}}catch(V){y.e(V)}finally{y.f()}return p}},{key:"applyChanges",value:function(){var c={},p={},y={},P=Us(this.changes),N;try{for(P.s();!(N=P.n()).done;){var ee=ea()(N.value,3),V=ee[0],J=ee[1],he=ee[2];V.panDelta&&(c.panDelta=(c.panDelta||new Xa(0,0))._add(V.panDelta)),V.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+V.zoomDelta),V.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+V.bearingDelta),V.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+V.pitchDelta),V.around!==void 0&&(c.around=V.around),V.pinchAround!==void 0&&(c.pinchAround=V.pinchAround),V.noInertia&&(c.noInertia=V.noInertia),Zi()(p,J),Zi()(y,he)}}catch(We){P.e(We)}finally{P.f()}this.updateMapTransform(c,p,y),this.changes=[]}},{key:"updateMapTransform",value:function(c,p,y){var P=this.map,N=P.transform;if(!Al(c))return this.fireEvents(p,y);var ee=c.panDelta,V=c.zoomDelta,J=c.bearingDelta,he=c.pitchDelta,We=c.pinchAround,De=c.around;We!==void 0&&(De=We),P.stop(!0),De=De||P.transform.centerPoint;var It=N.pointLocation(ee?De.sub(ee):De);J&&(N.bearing+=J),he&&(N.pitch+=he),V&&(N.zoom+=V),N.setLocationAtPoint(It,De),this.map.update(),c.noInertia||this.inertia.record(c),this.fireEvents(p,y)}},{key:"fireEvents",value:function(c,p){var y=this,P=ss(this.eventsInProgress),N=ss(c),ee={};for(var V in c)if(c[V]){var J=c[V].originalEvent;this.eventsInProgress[V]||(ee["".concat(V,"start")]=J),this.eventsInProgress[V]=c[V]}!P&&N&&this.fireEvent("movestart",N.originalEvent);for(var he in ee)ee[he]&&this.fireEvent(he,ee[he]);c.rotate&&(this.bearingChanged=!0),N&&this.fireEvent("move",N.originalEvent);for(var We in c)if(c[We]){var De=c[We].originalEvent;this.fireEvent(We,De)}var It={},Kt;for(var Ht in this.eventsInProgress)if(this.eventsInProgress[Ht]){var fr=this.eventsInProgress[Ht],Sr=fr.handlerName,ln=fr.originalEvent;this.handlersById[Sr].isActive()||(delete this.eventsInProgress[Ht],Kt=p[Sr]||ln,It["".concat(Ht,"end")]=Kt)}for(var jr in It)It[jr]&&this.fireEvent(jr,It[jr]);var an=ss(this.eventsInProgress);if((P||N)&&!an){this.updatingCamera=!0;var pn=this.inertia.onMoveEnd(this.map.dragPan.inertiaOptions),Gn=function(ma){return ma!==0&&-y.bearingSnap<ma&&ma<y.bearingSnap};pn?(Gn(pn.bearing||this.map.getBearing())&&(pn.bearing=0),this.map.easeTo(pn,{originalEvent:Kt})):(this.map.emit("moveend",new Zr("moveend",{originalEvent:Kt})),Gn(this.map.getBearing())&&this.map.resetNorth()),this.bearingChanged=!1,this.updatingCamera=!1}}},{key:"fireEvent",value:function(c,p){this.map.emit(c,new Zr(c,p?{originalEvent:p}:{}))}}]),v}(),dl=Eu,Gl=i("DzJC"),Du=i.n(Gl),Kc=function(){function v(f){var c=this;Oe()(this,v),this.map=void 0,this.updateHash=void 0,this.hashName=void 0,this.onHashChange=function(){var p=c.getCurrentHash();if(p.length>=3&&!p.some(function(P){return isNaN(+P)})){var y=c.map.dragRotate.isEnabled()&&c.map.touchZoomRotate.isEnabled()?+(p[3]||0):c.map.getBearing();return c.map.jumpTo({center:[+p[2],+p[1]],zoom:+p[0],bearing:y,pitch:+(p[4]||0)}),!0}return!1},this.getCurrentHash=function(){var p=window.location.hash.replace("#","");if(c.hashName){var y;return p.split("&").map(function(P){return P.split("=")}).forEach(function(P){P[0]===c.hashName&&(y=P)}),(y&&y[1]||"").split("/")}return p.split("/")},this.updateHashUnthrottled=function(){var p=c.getHashString();try{window.history.replaceState(window.history.state,"",p)}catch(y){}},this.hashName=f&&encodeURIComponent(f),this.updateHash=Du()(this.updateHashUnthrottled,30*1e3/100)}return Qe()(v,[{key:"addTo",value:function(c){return this.map=c,window.addEventListener("hashchange",this.onHashChange,!1),this.map.on("moveend",this.updateHash),this}},{key:"remove",value:function(){return window.removeEventListener("hashchange",this.onHashChange,!1),this.map.off("moveend",this.updateHash),delete this.map,this}},{key:"getHashString",value:function(c){var p=this.map.getCenter(),y=Math.round(this.map.getZoom()*100)/100,P=Math.ceil((y*Math.LN2+Math.log(512/360/.5))/Math.LN10),N=Math.pow(10,P),ee=Math.round(p.lng*N)/N,V=Math.round(p.lat*N)/N,J=this.map.getBearing(),he=this.map.getPitch(),We="";if(c?We+="/".concat(ee,"/").concat(V,"/").concat(y):We+="".concat(y,"/").concat(V,"/").concat(ee),(J||he)&&(We+="/".concat(Math.round(J*10)/10)),he&&(We+="/".concat(Math.round(he))),this.hashName){var De=this.hashName,It=!1,Kt=window.location.hash.slice(1).split("&").map(function(Ht){var fr=Ht.split("=")[0];return fr===De?(It=!0,"".concat(fr,"=").concat(We)):Ht}).filter(function(Ht){return Ht});return It||Kt.push("".concat(De,"=").concat(We)),"#".concat(Kt.join("&"))}return"#".concat(We)}}]),v}(),Ku=Kc,eo=null,Rs=[],Hl=30,fc=1e3/Hl,Xi=window.performance,jo={create:"create",load:"load",fullLoad:"fullLoad"},xs={mark:function(f){Xi.mark(f)},frame:function(f){var c=f;if(eo!=null){var p=c-eo;Rs.push(p)}eo=c},clearMetrics:function(){eo=null,Rs=[],Xi.clearMeasures("loadTime"),Xi.clearMeasures("fullLoadTime");for(var f in jo)Xi.clearMarks(jo[f])},getPerformanceMetrics:function(){var f=Xi.measure("loadTime",jo.create,jo.load).duration,c=Xi.measure("fullLoadTime",jo.create,jo.fullLoad).duration,p=Rs.length,y=Rs.reduce(function(V,J){return V+J},0)/p/1e3,P=1/y,N=Rs.filter(function(V){return V>fc}).reduce(function(V,J){return V+(J-fc)/fc},0),ee=N/(p+N)*100;return{loadTime:f,fullLoadTime:c,fps:P,percentDroppedFrames:ee}}};function to(v,f){var c;if(typeof Symbol=="undefined"||v[Symbol.iterator]==null){if(Array.isArray(v)||(c=Vs(v))||f&&v&&typeof v.length=="number"){c&&(v=c);var p=0,y=function(){};return{s:y,n:function(){return p>=v.length?{done:!0}:{done:!1,value:v[p++]}},e:function(J){throw J},f:y}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var P=!0,N=!1,ee;return{s:function(){c=v[Symbol.iterator]()},n:function(){var J=c.next();return P=J.done,J},e:function(J){N=!0,ee=J},f:function(){try{!P&&c.return!=null&&c.return()}finally{if(N)throw ee}}}}function Vs(v,f){if(!v)return;if(typeof v=="string")return ro(v,f);var c=Object.prototype.toString.call(v).slice(8,-1);if(c==="Object"&&v.constructor&&(c=v.constructor.name),c==="Map"||c==="Set")return Array.from(v);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return ro(v,f)}function ro(v,f){(f==null||f>v.length)&&(f=v.length);for(var c=0,p=new Array(f);c<f;c++)p[c]=v[c];return p}var $u=function(){function v(){Oe()(this,v),this.queue=void 0,this.id=void 0,this.cleared=void 0,this.currentlyRunning=void 0,this.queue=[],this.id=0,this.cleared=!1,this.currentlyRunning=!1}return Qe()(v,[{key:"add",value:function(c){var p=++this.id,y=this.queue;return y.push({callback:c,id:p,cancelled:!1}),p}},{key:"remove",value:function(c){var p=this.currentlyRunning,y=p?this.queue.concat(p):this.queue,P=to(y),N;try{for(P.s();!(N=P.n()).done;){var ee=N.value;if(ee.id===c){ee.cancelled=!0;return}}}catch(V){P.e(V)}finally{P.f()}}},{key:"run",value:function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,p=this.currentlyRunning=this.queue;this.queue=[];var y=to(p),P;try{for(y.s();!(P=y.n()).done;){var N=P.value;if(N.cancelled)continue;if(N.callback(c),this.cleared)break}}catch(ee){y.e(ee)}finally{y.f()}this.cleared=!1,this.currentlyRunning=!1}},{key:"clear",value:function(){this.currentlyRunning&&(this.cleared=!0),this.queue=[]}}]),v}(),pl=$u;function ml(v){var f=Ac();return function(){var p=vn()(v),y;if(f){var P=vn()(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return lr()(this,y)}}function Ac(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}i("BGjm")(`/* @antv/l7-map */
.l7-map {
  font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  overflow: hidden;
  position: relative;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}

.l7-canvas {
  position: absolute;
  left: 0;
  top: 0;
}

.l7-map:-webkit-full-screen {
  width: 100%;
  height: 100%;
}

.l7-canary {
  background-color: salmon;
}

.l7-canvas-container.l7-interactive,
.l7-ctrl-group button.l7-ctrl-compass {
  cursor: -webkit-grab;
  cursor: grab;
  -moz-user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.l7-canvas-container.l7-interactive.l7-track-pointer {
  cursor: pointer;
}

.l7-canvas-container.l7-interactive:active,
.l7-ctrl-group button.l7-ctrl-compass:active {
  cursor: -webkit-grabbing;
  cursor: grabbing;
}

.l7-canvas-container.l7-touch-zoom-rotate,
.l7-canvas-container.l7-touch-zoom-rotate .l7-canvas {
  -ms-touch-action: pan-x pan-y;
      touch-action: pan-x pan-y;
}

.l7-canvas-container.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: pinch-zoom;
      touch-action: pinch-zoom;
}

.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: none;
      touch-action: none;
}

.l7-ctrl-top-left,
.l7-ctrl-top-right,
.l7-ctrl-bottom-left,
.l7-ctrl-bottom-right { position: absolute; pointer-events: none; z-index: 2; }
.l7-ctrl-top-left     { top: 0; left: 0; }
.l7-ctrl-top-right    { top: 0; right: 0; }
.l7-ctrl-bottom-left  { bottom: 0; left: 0; }
.l7-ctrl-bottom-right { right: 0; bottom: 0; }

.l7-ctrl {
  clear: both;
  pointer-events: auto;

  /* workaround for a Safari bug https://github.com/mapbox/mapbox-gl-js/issues/8185 */
  -webkit-transform: translate(0, 0);
          transform: translate(0, 0);
}
.l7-ctrl-top-left .l7-ctrl     { margin: 10px 0 0 10px; float: left; }
.l7-ctrl-top-right .l7-ctrl    { margin: 10px 10px 0 0; float: right; }
.l7-ctrl-bottom-left .l7-ctrl  { margin: 0 0 10px 10px; float: left; }
.l7-ctrl-bottom-right .l7-ctrl { margin: 0 10px 10px 0; float: right; }


.l7-crosshair,
.l7-crosshair .l7-interactive,
.l7-crosshair .l7-interactive:active {
    cursor: crosshair;
}

.l7-boxzoom {
    position: absolute;
    top: 0;
    left: 0;
    width: 0;
    height: 0;
    background: #fff;
    border: 2px dotted #202020;
    opacity: 0.5;
    z-index: 10;
}
`);var Ju=-2,Wl=22,Uo=0,vo=60,$c={hash:!1,zoom:-1,center:[112,32],pitch:0,bearing:0,interactive:!0,minZoom:Ju,maxZoom:Wl,minPitch:Uo,maxPitch:vo,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,trackResize:!0,renderWorldCopies:!0},Zl=function(v){vr()(c,v);var f=ml(c);function c(p){var y;Oe()(this,c),y=f.call(this,Zi()({},$c,p)),y.doubleClickZoom=void 0,y.dragRotate=void 0,y.dragPan=void 0,y.touchZoomRotate=void 0,y.scrollZoom=void 0,y.keyboard=void 0,y.touchPitch=void 0,y.boxZoom=void 0,y.handlers=void 0,y.container=void 0,y.canvas=void 0,y.canvasContainer=void 0,y.renderTaskQueue=new pl,y.frame=void 0,y.trackResize=!0,y.hash=void 0,y.onWindowOnline=function(){y.update()},y.onWindowResize=function(N){y.trackResize&&y.resize({originalEvent:N}).update()},y.initContainer(),y.resize(),y.handlers=new dl(Il()(y),y.options),typeof window!="undefined"&&(window.addEventListener("online",y.onWindowOnline,!1),window.addEventListener("resize",y.onWindowResize,!1),window.addEventListener("orientationchange",y.onWindowResize,!1));var P=typeof p.hash=="string"&&p.hash||void 0;return p.hash&&(y.hash=new Ku(P).addTo(Il()(y))),(!y.hash||!y.hash.onHashChange())&&(y.jumpTo({center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch}),p.bounds&&(y.resize(),y.fitBounds(p.bounds,Zi()({},p.fitBoundsOptions,{duration:0})))),y}return Qe()(c,[{key:"resize",value:function(y){var P=this.containerDimensions(),N=P[0],ee=P[1];this.transform.resize(N,ee);var V=!this.moving;return V&&(this.stop(),this.emit("movestart",new Event("movestart",y)),this.emit("move",new Event("move",y))),this.emit("resize",new Event("resize",y)),V&&this.emit("moveend",new Event("moveend",y)),this}},{key:"getContainer",value:function(){return this.container}},{key:"getCanvas",value:function(){return this.canvas}},{key:"getCanvasContainer",value:function(){return this.canvasContainer}},{key:"project",value:function(y){return this.transform.locationPoint(ti.convert(y))}},{key:"unproject",value:function(y){return this.transform.pointLocation(Xa.convert(y))}},{key:"getBounds",value:function(){return this.transform.getBounds()}},{key:"getMaxBounds",value:function(){return this.transform.getMaxBounds()}},{key:"setMaxBounds",value:function(y){this.transform.setMaxBounds($a.convert(y))}},{key:"setStyle",value:function(y){return}},{key:"setMinZoom",value:function(y){if(y=y==null?Ju:y,y>=Ju&&y<=this.transform.maxZoom)return this.transform.minZoom=y,this.getZoom()<y&&this.setZoom(y),this;throw new Error("minZoom must be between ".concat(Ju," and the current maxZoom, inclusive"))}},{key:"getMinZoom",value:function(){return this.transform.minZoom}},{key:"setMaxZoom",value:function(y){if(y=y==null?Wl:y,y>=this.transform.minZoom)return this.transform.maxZoom=y,this.getZoom()>y&&this.setZoom(y),this;throw new Error("maxZoom must be greater than the current minZoom")}},{key:"getMaxZoom",value:function(){return this.transform.maxZoom}},{key:"setMinPitch",value:function(y){if(y=y==null?Uo:y,y<Uo)throw new Error("minPitch must be greater than or equal to ".concat(Uo));if(y>=Uo&&y<=this.transform.maxPitch)return this.transform.minPitch=y,this.getPitch()<y&&this.setPitch(y),this;throw new Error("minPitch must be between ".concat(Uo," and the current maxPitch, inclusive"))}},{key:"getMinPitch",value:function(){return this.transform.minPitch}},{key:"setMaxPitch",value:function(y){if(y=y==null?vo:y,y>vo)throw new Error("maxPitch must be less than or equal to ".concat(vo));if(y>=this.transform.minPitch)return this.transform.maxPitch=y,this.getPitch()>y&&this.setPitch(y),this;throw new Error("maxPitch must be greater than the current minPitch")}},{key:"getMaxPitch",value:function(){return this.transform.maxPitch}},{key:"getRenderWorldCopies",value:function(){return this.transform.renderWorldCopies}},{key:"setRenderWorldCopies",value:function(y){this.transform.renderWorldCopies=!!y}},{key:"remove",value:function(){this.frame&&(this.frame.cancel(),this.frame=null),this.renderTaskQueue.clear()}},{key:"requestRenderFrame",value:function(y){return this.update(),this.renderTaskQueue.add(y)}},{key:"cancelRenderFrame",value:function(y){return this.renderTaskQueue.remove(y)}},{key:"triggerRepaint",value:function(){var y=this;this.frame||(this.frame=ei(function(P){xs.frame(P),y.frame=null,y.update(P)}))}},{key:"update",value:function(y){var P=this;this.frame||(this.frame=ei(function(N){xs.frame(N),P.frame=null,P.renderTaskQueue.run(y)}))}},{key:"initContainer",value:function(){if(typeof this.options.container=="string"){if(this.container=window.document.getElementById(this.options.container),!this.container)throw new Error("Container '".concat(this.options.container,"' not found."))}else if(this.options.container instanceof HTMLElement)this.container=this.options.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");var y=this.container;y.classList.add("l7-map");var P=this.canvasContainer=gn.a.create("div","l7-canvas-container",y);this.options.interactive&&P.classList.add("l7-interactive")}},{key:"containerDimensions",value:function(){var y=0,P=0;return this.container&&(y=this.container.clientWidth||400,P=this.container.clientHeight||300),[y,P]}},{key:"resizeCanvas",value:function(y,P){var N=window.devicePixelRatio||1;this.canvas.width=N*y,this.canvas.height=N*P,this.canvas.style.width="".concat(y,"px"),this.canvas.style.height="".concat(P,"px")}}]),c}(Wc),Jc=function(){function v(){Oe()(this,v),this.viewport=void 0}return Qe()(v,[{key:"syncWithMapCamera",value:function(c){var p=c.center,y=c.zoom,P=c.pitch,N=c.bearing,ee=c.viewportHeight,V=c.viewportWidth;this.viewport=new vc({width:V,height:ee,longitude:p&&p[0],latitude:p&&p[1],zoom:y,pitch:P,bearing:N})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(c,p){return this.viewport.projectFlat(c,p)}}]),v}(),Es={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},cf,Nf,ff,Zf,Nu,hf,Xl,vl,Qc,Af,Xf,Cc,wc,Yf;function Kf(v,f){var c=Object.keys(v);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(v);f&&(p=p.filter(function(y){return Object.getOwnPropertyDescriptor(v,y).enumerable})),c.push.apply(c,p)}return c}function kf(v){for(var f=1;f<arguments.length;f++){var c=arguments[f]!=null?arguments[f]:{};f%2?Kf(Object(c),!0).forEach(function(p){ha()(v,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(c)):Kf(Object(c)).forEach(function(p){Object.defineProperty(v,p,Object.getOwnPropertyDescriptor(c,p))})}return v}var $f={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},qc=12,fh=(cf=Object(kn.injectable)(),Nf=Object(kn.inject)(me.TYPES.MapConfig),ff=Object(kn.inject)(me.TYPES.IGlobalConfigService),Zf=Object(kn.inject)(me.TYPES.ILogService),Nu=Object(kn.inject)(me.TYPES.ICoordinateSystemService),hf=Object(kn.inject)(me.TYPES.IEventEmitter),cf(Xl=(vl=(Yf=function(){function v(){var f=this;Oe()(this,v),this.map=void 0,Hn()(this,"config",Qc,this),Hn()(this,"configService",Af,this),Hn()(this,"logger",Xf,this),Hn()(this,"coordinateSystemService",Cc,this),Hn()(this,"eventEmitter",wc,this),this.viewport=void 0,this.markerContainer=void 0,this.cameraChangedCallback=void 0,this.$mapContainer=void 0,this.handleCameraChanged=function(){var c=f.map.getCenter(),p=c.lat,y=c.lng;f.viewport.syncWithMapCamera({bearing:f.map.getBearing(),center:[y,p],viewportHeight:f.map.transform.height,pitch:f.map.getPitch(),viewportWidth:f.map.transform.width,zoom:f.map.getZoom(),cameraHeight:0}),f.viewport.getZoom()>qc?f.coordinateSystemService.setCoordinateSystem(me.CoordinateSystem.LNGLAT_OFFSET):f.coordinateSystemService.setCoordinateSystem(me.CoordinateSystem.LNGLAT),f.cameraChangedCallback(f.viewport)}}return Qe()(v,[{key:"addMarkerContainer",value:function(){var c=this.map.getCanvasContainer();this.markerContainer=gn.a.create("div","l7-marker-container",c),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(c,p){me.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.on(c,p):this.map.on($f[c]||c,p)}},{key:"off",value:function(c,p){this.map.off($f[c]||c,p)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var c=this.map.transform;return[c.width,c.height]}},{key:"getType",value:function(){return"default"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(c){return this.map.setZoom(c)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(c){this.map.setCenter(c)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(c){this.map.setBearing(c)}},{key:"zoomIn",value:function(c,p){this.map.zoomIn(c,p)}},{key:"zoomOut",value:function(c,p){this.map.zoomOut(c,p)}},{key:"setPitch",value:function(c){return this.map.setPitch(c)}},{key:"panTo",value:function(c){this.map.panTo(c)}},{key:"panBy",value:function(c){this.panTo(c)}},{key:"fitBounds",value:function(c,p){this.map.fitBounds(c,p)}},{key:"setMaxZoom",value:function(c){this.map.setMaxZoom(c)}},{key:"setMinZoom",value:function(c){this.map.setMinZoom(c)}},{key:"setMapStatus",value:function(c){c.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),c.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),c.dragEnable===!1&&this.map.dragPan.disable(),c.dragEnable===!0&&this.map.dragPan.enable(),c.rotateEnable===!1&&this.map.dragRotate.disable(),c.dragEnable===!0&&this.map.dragRotate.enable(),c.keyboardEnable===!1&&this.map.keyboard.disable(),c.keyboardEnable===!0&&this.map.keyboard.enable(),c.zoomEnable===!1&&this.map.scrollZoom.disable(),c.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(c,p){this.map.flyTo({zoom:c,center:p})}},{key:"setMapStyle",value:function(c){this.map.setStyle(this.getMapStyle(c))}},{key:"pixelToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToPixel",value:function(c){return this.map.project(c)}},{key:"containerToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToContainer",value:function(c){return this.map.project(c)}},{key:"lngLatToMercator",value:function(c,p){throw new Error("not implement")}},{key:"getModelMatrix",value:function(c,p,y){var P=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],N=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0};throw new Error("not implement")}},{key:"init",value:function(){var f=Xr()(jt.a.mark(function p(){var y,P,N,ee,V,J,he,We,De,It,Kt;return jt.a.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:y=this.config,P=y.id,N=P===void 0?"map":P,ee=y.attributionControl,V=ee===void 0?!1:ee,J=y.style,he=J===void 0?"light":J,We=y.rotation,De=We===void 0?0:We,It=y.mapInstance,Kt=Tn()(y,["id","attributionControl","style","rotation","mapInstance"]),this.viewport=new Jc,It?(this.map=It,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(N),this.map=new Zl(kf({container:this.$mapContainer,style:this.getMapStyle(he),bearing:De},Kt))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 6:case"end":return fr.stop()}},p,this)}));function c(){return f.apply(this,arguments)}return c}()},{key:"destroy",value:function(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(c){for(var p,y=arguments.length,P=new Array(y>1?y-1:0),N=1;N<y;N++)P[N-1]=arguments[N];(p=this.eventEmitter).emit.apply(p,[c].concat(P))}},{key:"once",value:function(c){for(var p,y=arguments.length,P=new Array(y>1?y-1:0),N=1;N<y;N++)P[N-1]=arguments[N];(p=this.eventEmitter).once.apply(p,[c].concat(P))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(c){var p=this.map.getCanvas(),y=c==="jpg"?p==null?void 0:p.toDataURL("image/jpeg"):p==null?void 0:p.toDataURL("image/png");return y}},{key:"onCameraChanged",value:function(c){this.cameraChangedCallback=c}},{key:"creatAmapContainer",value:function(c){var p=c;return typeof c=="string"&&(p=document.getElementById(c)),p}},{key:"getMapStyle",value:function(c){return typeof c!="string"?c:Es[c]?Es[c]:c}}]),v}(),Yf),Qc=W()(vl.prototype,"config",[Nf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Af=W()(vl.prototype,"configService",[ff],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xf=W()(vl.prototype,"logger",[Zf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cc=W()(vl.prototype,"coordinateSystemService",[Nu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wc=W()(vl.prototype,"eventEmitter",[hf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vl))||Xl);function go(v){var f=hc();return function(){var p=vn()(v),y;if(f){var P=vn()(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return lr()(this,y)}}function hc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}var df=function(v){vr()(c,v);var f=go(c);function c(){return Oe()(this,c),f.apply(this,arguments)}return Qe()(c,[{key:"getServiceConstructor",value:function(){return fh}}]),c}(or);function Yl(v,f){var c=Object.keys(v);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(v);f&&(p=p.filter(function(y){return Object.getOwnPropertyDescriptor(v,y).enumerable})),c.push.apply(c,p)}return c}function Oc(v){for(var f=1;f<arguments.length;f++){var c=arguments[f]!=null?arguments[f]:{};f%2?Yl(Object(c),!0).forEach(function(p){Mc(v,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(c)):Yl(Object(c)).forEach(function(p){Object.defineProperty(v,p,Object.getOwnPropertyDescriptor(c,p))})}return v}function Mc(v,f,c){return f in v?Object.defineProperty(v,f,{value:c,enumerable:!0,configurable:!0,writable:!0}):v[f]=c,v}function ku(v,f){return jf(v)||Cf(v,f)||Lc(v,f)||Pc()}function Pc(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Lc(v,f){if(!v)return;if(typeof v=="string")return pf(v,f);var c=Object.prototype.toString.call(v).slice(8,-1);if(c==="Object"&&v.constructor&&(c=v.constructor.name),c==="Map"||c==="Set")return Array.from(v);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return pf(v,f)}function pf(v,f){(f==null||f>v.length)&&(f=v.length);for(var c=0,p=new Array(f);c<f;c++)p[c]=v[c];return p}function Cf(v,f){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(v)))return;var c=[],p=!0,y=!1,P=void 0;try{for(var N=v[Symbol.iterator](),ee;!(p=(ee=N.next()).done)&&!(c.push(ee.value),f&&c.length===f);p=!0);}catch(V){y=!0,P=V}finally{try{!p&&N.return!=null&&N.return()}finally{if(y)throw P}}return c}function jf(v){if(Array.isArray(v))return v}var dc=we.a.memo(function(v){var f=v.style,c=v.className,p=v.map,y=v.option,P=v.onSceneLoaded,N=Object(ye.createRef)(),ee=Object(ye.useState)(),V=ku(ee,2),J=V[0],he=V[1];return Object(ye.useEffect)(function(){var We=new Ct.Scene(Oc(Oc({id:N.current},y),{},{map:new df(p)}));return We.on("loaded",function(){he(We),P&&P(We)}),function(){We.destroy()}},[]),Object(ye.useEffect)(function(){J&&p.style&&J.setMapStyle(p.style)},[JSON.stringify(p.style)]),Object(ye.useEffect)(function(){J&&p.zoom&&J.setZoom(p.zoom)},[p.zoom]),Object(ye.useEffect)(function(){J&&p.center&&J.setCenter(p.center)},[JSON.stringify(p.center)]),Object(ye.useEffect)(function(){J&&p.pitch&&J.setPitch(p.pitch)},[p.pitch]),Object(ye.useEffect)(function(){J&&p.rotation&&J.setRotation(p.rotation)},[p.rotation]),we.a.createElement(ft.Provider,{value:J},Object(ye.createElement)("div",{ref:N,style:f,className:c},J&&v.children))}),Kl=dc;function ne(v,f){return ot(v)||_e(v,f)||k(v,f)||se()}function se(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k(v,f){if(!v)return;if(typeof v=="string")return G(v,f);var c=Object.prototype.toString.call(v).slice(8,-1);if(c==="Object"&&v.constructor&&(c=v.constructor.name),c==="Map"||c==="Set")return Array.from(v);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return G(v,f)}function G(v,f){(f==null||f>v.length)&&(f=v.length);for(var c=0,p=new Array(f);c<f;c++)p[c]=v[c];return p}function _e(v,f){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(v)))return;var c=[],p=!0,y=!1,P=void 0;try{for(var N=v[Symbol.iterator](),ee;!(p=(ee=N.next()).done)&&!(c.push(ee.value),f&&c.length===f);p=!0);}catch(V){y=!0,P=V}finally{try{!p&&N.return!=null&&N.return()}finally{if(y)throw P}}return c}function ot(v){if(Array.isArray(v))return v}var Xt=we.a.memo(function(v){var f=v.style,c=v.className,p=v.map,y=Object(ye.createRef)(),P=Object(ye.useState)(),N=ne(P,2),ee=N[0],V=N[1];return Object(ye.useEffect)(function(){var J=new Ct.Scene({id:y.current,map:p});return J.on("loaded",function(){V(J)}),function(){J.destroy()}},[]),we.a.createElement(ft.Provider,{value:ee},Object(ye.createElement)("div",{ref:y,style:f,className:c},ee&&v.children))});function rr(v,f){return ta(v)||Vn(v,f)||Dr(v,f)||tr()}function tr(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dr(v,f){if(!v)return;if(typeof v=="string")return tn(v,f);var c=Object.prototype.toString.call(v).slice(8,-1);if(c==="Object"&&v.constructor&&(c=v.constructor.name),c==="Map"||c==="Set")return Array.from(v);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return tn(v,f)}function tn(v,f){(f==null||f>v.length)&&(f=v.length);for(var c=0,p=new Array(f);c<f;c++)p[c]=v[c];return p}function Vn(v,f){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(v)))return;var c=[],p=!0,y=!1,P=void 0;try{for(var N=v[Symbol.iterator](),ee;!(p=(ee=N.next()).done)&&!(c.push(ee.value),f&&c.length===f);p=!0);}catch(V){y=!0,P=V}finally{try{!p&&N.return!=null&&N.return()}finally{if(y)throw P}}return c}function ta(v){if(Array.isArray(v))return v}var oa=we.a.memo(function(f){var c=mt(),p=Object(ye.useState)(),y=rr(p,2),P=y[1],N=f.type,ee=f.position;return Object(ye.useEffect)(function(){var V;switch(N){case"scale":V=new Ct.Scale({position:ee||"bottomright"});break;case"zoom":V=new Ct.Zoom({position:ee||"topright"});break;case"logo":V=new Ct.Logo({position:ee||"bottomleft"})}return P(V),c.addControl(V),function(){c.removeControl(V)}},[N,ee]),null}),Ya=i("i8i4"),za=ye.useEffect,Ni=ye.useState;function Fa(v){var f=v.className,c=v.style,p=v.children,y=v.position,P=mt(),N=document.createElement("div");return za(function(){var ee=new Ct.Control({position:y});return ee.onAdd=function(){if(f&&(N.className=f),c){var V=Object.keys(c).map(function(J){return"".concat(J,":").concat(c[J])}).join(";");N.style.cssText=V}return N},P.addControl(ee),function(){P.removeControl(ee)}},[]),Object(Ya.createPortal)(p,N)}var Gi=Object(ye.createContext)({});function Qo(){return Object(ye.useContext)(Gi)}var Qi=ye.useEffect,oi=ye.memo(function(f){var c=f.layer,p=f.active;return Qi(function(){c.active(p.option)},[JSON.stringify(p)]),null}),Ts=ye.useEffect,ki=ye.memo(function(f){var c=f.layer,p=f.animate;return Ts(function(){c.animate(p)},[JSON.stringify(p)]),null}),yo=ye.useEffect,us=ye.memo(function(f){var c=f.layer,p=f.color;return yo(function(){p.field?c.color(p.field,p.values):c.color(p.values)},[p.field,p.scale,JSON.stringify(p.values),JSON.stringify(p.options)]),null}),yi=ye.useEffect,fo=ye.memo(function(f){var c=f.layer,p=f.filter;return yi(function(){p.field&&c.filter(p.field,p.values)},[p.field,p.values,JSON.stringify(p.values),JSON.stringify(p.options)]),null}),Ta=ye.useEffect,Ro=ye.memo(function(f){var c=f.layer,p=f.scale;return Ta(function(){c.scale(p.values)},[p.values]),null}),pc=ye.useEffect,zf=ye.memo(function(f){var c=f.layer,p=f.select;return pc(function(){c.select(p.option)},[JSON.stringify(p)]),null}),Gs=ye.useEffect,ah=ye.memo(function(f){var c=f.layer,p=f.shape;return Gs(function(){p.field?c.shape(p.field,p.values):c.shape(p.values)},[p.field,JSON.stringify(p.values),JSON.stringify(p.options)]),null}),Fh=ye.useEffect,Ff=ye.memo(function(f){var c=f.layer,p=f.size;return Fh(function(){p.field?c.size(p.field,p.values):c.size(p.values)},[p.field,p.scale,JSON.stringify(p.values),JSON.stringify(p.options)]),null});function wf(v,f){if(v==null)return{};var c=Jf(v,f),p,y;if(Object.getOwnPropertySymbols){var P=Object.getOwnPropertySymbols(v);for(y=0;y<P.length;y++){if(p=P[y],f.indexOf(p)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(v,p))continue;c[p]=v[p]}}return c}function Jf(v,f){if(v==null)return{};var c={},p=Object.keys(v),y,P;for(P=0;P<p.length;P++){if(y=p[P],f.indexOf(y)>=0)continue;c[y]=v[y]}return c}var Th=ye.useEffect,_h=ye.memo(function(f){var c=f.layer,p=f.source,y=p.data,P=wf(p,["data"]);return Th(function(){c.inited?c.setData(y,P):c.source(y,P),P.autoFit&&c.fitBounds(P&&P.fitBoundsOptions)},[y,JSON.stringify(P)]),null}),Of=ye.useEffect,Qf=ye.memo(function(f){var c=f.layer,p=f.style;return Of(function(){c.style(p)},Object.keys(p).map(function(y){return p[y]})),null});function qf(v,f){return ih(v)||hh(v,f)||eh(v,f)||Sh()}function Sh(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eh(v,f){if(!v)return;if(typeof v=="string")return mf(v,f);var c=Object.prototype.toString.call(v).slice(8,-1);if(c==="Object"&&v.constructor&&(c=v.constructor.name),c==="Map"||c==="Set")return Array.from(v);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return mf(v,f)}function mf(v,f){(f==null||f>v.length)&&(f=v.length);for(var c=0,p=new Array(f);c<f;c++)p[c]=v[c];return p}function hh(v,f){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(v)))return;var c=[],p=!0,y=!1,P=void 0;try{for(var N=v[Symbol.iterator](),ee;!(p=(ee=N.next()).done)&&!(c.push(ee.value),f&&c.length===f);p=!0);}catch(V){y=!0,P=V}finally{try{!p&&N.return!=null&&N.return()}finally{if(y)throw P}}return c}function ih(v){if(Array.isArray(v))return v}var fe=ye.useEffect,ze=ye.useState;function Pt(v,f){var c=f.source,p=f.color,y=f.shape,P=f.style,N=f.size,ee=f.scale,V=f.active,J=f.select,he=f.filter,We=f.animate,De=f.options,It=f.onLayerLoaded,Kt=mt(),Ht=ze(),fr=qf(Ht,2),Sr=fr[0],ln=fr[1];if(!Sr){var jr;switch(v){case"polygonLayer":jr=new Ct.PolygonLayer(De);break;case"lineLayer":jr=new Ct.LineLayer(De);break;case"pointLayer":jr=new Ct.PointLayer(De);break;case"heatmapLayer":jr=new Ct.HeatmapLayer(De);break;case"rasterLayer":jr=new Ct.RasterLayer(De);break;case"imageLayer":jr=new Ct.ImageLayer(De);break;case"citybuildingLayer":jr=new Ct.CityBuildingLayer(De);break;default:jr=new Ct.PolygonLayer(De)}jr.on("inited",function(){It&&It(jr,Kt)}),ln(jr)}return fe(function(){if(Sr!==void 0)return Kt.addLayer(Sr),function(){Kt.removeLayer(Sr)}},[]),fe(function(){Sr&&Kt.render()}),fe(function(){Sr&&Sr.inited&&De&&Sr.updateLayerConfig(De)},[De==null?void 0:De.minZoom,De==null?void 0:De.maxZoom,De==null?void 0:De.visible]),fe(function(){Sr&&Sr.inited&&De&&De.zIndex&&Sr.setIndex(De.zIndex)},[De==null?void 0:De.zIndex]),fe(function(){Sr&&Sr.inited&&De&&De.blend&&Sr.setBlend(De.blend)},[De==null?void 0:De.blend]),Sr!=null?ye.createElement(Gi.Provider,{value:Sr},ye.createElement(_h,{layer:Sr,source:c}),ee&&ye.createElement(Ro,{layer:Sr,scale:ee}),p&&ye.createElement(us,{layer:Sr,color:p}),N&&ye.createElement(Ff,{layer:Sr,size:N}),y&&ye.createElement(ah,{layer:Sr,shape:y}),P&&ye.createElement(Qf,{layer:Sr,style:P}),V&&ye.createElement(oi,{layer:Sr,active:V}),J&&ye.createElement(zf,{layer:Sr,select:J}),he&&ye.createElement(fo,{layer:Sr,filter:he}),We&&ye.createElement(ki,{layer:Sr,animate:We}),f.children):null}var gr=ye.memo(function(f){return Pt("polygonLayer",f)}),kr=ye.memo(function(f){return Pt("lineLayer",f)}),Or=ye.memo(function(f){return Pt("pointLayer",f)}),xr=ye.memo(function(f){return Pt("heatmapLayer",f)}),Wr=ye.memo(function(f){return Pt("rasterLayer",f)}),on=ye.memo(function(f){return Pt("imagelayer",f)}),rn=ye.memo(function(f){return Pt("citybuildinglayer",f)}),Qr=ye.useEffect,cn=ye.memo(function(v){var f=v.type,c=v.handler,p=Qo();return Qr(function(){return p.off(f,c),p.on(f,c),function(){p.off(f,c)}},[f,c]),null}),Sn=i("dgMf"),fn=ye.memo(function(v){var f=v.className,c=v.style,p=v.title,y=[{title:"1",color:"rgb(239,243,255)"},{title:"10",color:"rgb(198,219,239)"},{title:"30",color:"rgb(158,202,225)"},{title:"50",color:"rgb(107,174,214)"},{title:"60",color:"rgb(49,130,189)"},{title:"100",color:"rgb(8,81,156)"}];return ye.createElement("div",null,ye.createElement("div",null,y.map(function(P,N){return ye.createElement("div",{key:N.toString(),style:{background:P.color,height:"100%",display:"inline-block",cursor:"pointer",width:""+(100-y.length)/y.length+"%",marginRight:"1%",padding:5}})})),ye.createElement("div",null,y.map(function(P,N){return ye.createElement("div",{key:N.toString()+"122",style:{background:"#fff",height:"100%",display:"inline-block",textAlign:"left",cursor:"pointer",width:""+(100-y.length)/y.length+"%",marginRight:"1%"}},P.title)})))});function Kr(v){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Kr=function(c){return typeof c}:Kr=function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},Kr(v)}function br(v,f){var c=Object.keys(v);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(v);f&&(p=p.filter(function(y){return Object.getOwnPropertyDescriptor(v,y).enumerable})),c.push.apply(c,p)}return c}function mr(v){for(var f=1;f<arguments.length;f++){var c=arguments[f]!=null?arguments[f]:{};f%2?br(Object(c),!0).forEach(function(p){Jr(v,p,c[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(c)):br(Object(c)).forEach(function(p){Object.defineProperty(v,p,Object.getOwnPropertyDescriptor(c,p))})}return v}function Jr(v,f,c){return f in v?Object.defineProperty(v,f,{value:c,enumerable:!0,configurable:!0,writable:!0}):v[f]=c,v}function wn(v,f){if(!(v instanceof f))throw new TypeError("Cannot call a class as a function")}function Lr(v,f){for(var c=0;c<f.length;c++){var p=f[c];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(v,p.key,p)}}function Xn(v,f,c){return f&&Lr(v.prototype,f),c&&Lr(v,c),v}function $r(v,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function");v.prototype=Object.create(f&&f.prototype,{constructor:{value:v,writable:!0,configurable:!0}}),f&&zr(v,f)}function zr(v,f){return zr=Object.setPrototypeOf||function(p,y){return p.__proto__=y,p},zr(v,f)}function Ur(v){var f=$n();return function(){var p=sn(v),y;if(f){var P=sn(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return Gr(this,y)}}function Gr(v,f){return f&&(Kr(f)==="object"||typeof f=="function")?f:Wn(v)}function Wn(v){if(v===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v}function $n(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}function sn(v){return sn=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)},sn(v)}var nn=function(v){$r(c,v);var f=Ur(c);function c(p){var y;return wn(this,c),y=f.call(this,p),y.el=document.createElement("div"),y}return Xn(c,[{key:"componentDidMount",value:function(){var y=this.props,P=y.lnglat,N=y.children,ee=y.option,V=new Ct.Popup(mr(mr({},ee),{},{stopPropagation:!1}));P&&V.setLnglat(P),N&&V.setDOMContent(this.el),this.popup=V,this.scene.addPopup(V)}},{key:"componentDidUpdate",value:function(y){var P,N,ee,V,J,he,We=Array.isArray(y.lnglat)?y.lnglat:[y==null||((P=y.lnglat)===null||P===void 0)?void 0:P.lng,y==null||((N=y.lnglat)===null||N===void 0)?void 0:N.lat],De=Array.isArray(this.props.lnglat)?this.props.lnglat:[(ee=this.props)===null||ee===void 0||((V=ee.lnglat)===null||V===void 0)?void 0:V.lng,(J=this.props)===null||J===void 0||((he=J.lnglat)===null||he===void 0)?void 0:he.lat],It=We.toString()!==De.toString();It&&(this.popup.remove(),this.popup=new Ct.Popup(mr(mr({},this.props.option),{},{stopPropagation:!1})),this.popup.setLnglat(this.props.lnglat),this.popup.setDOMContent(this.el),this.scene.addPopup(this.popup))}},{key:"componentWillUnmount",value:function(){this.popup.remove()}},{key:"render",value:function(){var y=this;return ye.createElement(ft.Consumer,{},function(P){return P&&(y.scene=P),Object(Ya.createPortal)(y.props.children,y.el)})}}]),c}(ye.PureComponent);function Rr(v){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Rr=function(c){return typeof c}:Rr=function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},Rr(v)}function ba(v,f){if(!(v instanceof f))throw new TypeError("Cannot call a class as a function")}function La(v,f){for(var c=0;c<f.length;c++){var p=f[c];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(v,p.key,p)}}function Fn(v,f,c){return f&&La(v.prototype,f),c&&La(v,c),v}function Ua(v,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function");v.prototype=Object.create(f&&f.prototype,{constructor:{value:v,writable:!0,configurable:!0}}),f&&Ea(v,f)}function Ea(v,f){return Ea=Object.setPrototypeOf||function(p,y){return p.__proto__=y,p},Ea(v,f)}function Da(v){var f=So();return function(){var p=Ba(v),y;if(f){var P=Ba(this).constructor;y=Reflect.construct(p,arguments,P)}else y=p.apply(this,arguments);return bi(this,y)}}function bi(v,f){return f&&(Rr(f)==="object"||typeof f=="function")?f:Bo(v)}function Bo(v){if(v===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v}function So(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}function Ba(v){return Ba=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)},Ba(v)}var qo=function(v){Ua(c,v);var f=Da(c);function c(p){var y;return ba(this,c),y=f.call(this,p),y.el=document.createElement("div"),y}return Fn(c,[{key:"componentDidMount",value:function(){var y=this.props,P=y.lnglat,N=y.children,ee=y.option,V=y.onMarkerLoaded,J=new Ct.Marker(ee);P&&J.setLnglat(P),N&&J.setElement(this.el),this.marker=J,V&&V(J),this.scene.addMarker(J)}},{key:"componentDidUpdate",value:function(y){var P,N=(y==null?void 0:y.lnglat.toString())!==((P=this.props)===null||P===void 0?void 0:P.lnglat.toString());N&&this.marker.setLnglat(this.props.lnglat)}},{key:"componentWillUnmount",value:function(){this.marker&&this.marker.remove()}},{key:"render",value:function(){var y=this;return ye.createElement(ft.Consumer,{},function(P){return P&&(y.scene=P),Object(Ya.createPortal)(y.props.children,y.el)})}}]),c}(ye.PureComponent),ji=ye.useEffect,_s=ye.memo(function(v){var f=v.type,c=v.handler,p=mt();return ji(function(){return p.on(f,c),function(){p.off(f,c)}},[f]),null}),es=_s,Vo=ye.useEffect,ts=ye.memo(function(f){var c=f.name,p=f.url,y=mt();return Vo(function(){y.addImage(c,p)},[c,p]),null}),Hs=i("tbuW"),Go=["#eff3ff","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],ra=function(v){Object(re.a)(c,v);var f=Object(de.a)(c);function c(){var p;Object(D.a)(this,c);for(var y=arguments.length,P=new Array(y),N=0;N<y;N++)P[N]=arguments[N];return p=f.call.apply(f,[this].concat(P)),p.state={data:null,grid:null,loading:!1},p}return Object(K.a)(c,[{key:"componentDidMount",value:function(){var p=Object(sr.a)(jt.a.mark(function P(){var N,ee,V,J;return jt.a.wrap(function(We){for(;;)switch(We.prev=We.next){case 0:return We.next=2,Promise.all([fetch("https://gw.alipayobjects.com/os/bmw-prod/c5dba875-b6ea-4e88-b778-66a862906c93.json").then(function(De){return De.json()}),fetch("https://gw.alipayobjects.com/os/bmw-prod/8990e8b4-c58e-419b-afb9-8ea3daff2dd1.json").then(function(De){return De.json()})]);case 2:N=We.sent,ee=Object(q.a)(N,2),V=ee[0],J=ee[1],this.setState({data:V,grid:J,loading:!0});case 7:case"end":return We.stop()}},P,this)}));function y(){return p.apply(this,arguments)}return y}()},{key:"render",value:function(){var y=this.state,P=y.data,N=y.grid,ee=y.loading;return ee===!1?ye.createElement(Hs.a,null):ye.createElement(bf,{map:{center:[110.19382669582967,50.258134],pitch:0,style:"blank",zoom:1},style:{position:"relative",width:"100%",height:"452px"}},N&&ye.createElement(xr,{key:"1",source:{data:N,transforms:[{type:"hexagon",size:8e5,field:"capacity",method:"sum"}]},color:{values:"#ddd"},shape:{values:"hexagon"},style:{coverage:.7,opacity:.8}}),P&&[ye.createElement(Or,{key:"2",options:{autoFit:!0},source:{data:P},scale:{values:{color:{field:"cum_conf",type:"quantile"},size:{field:"cum_conf",type:"log"}}},color:{field:"cum_conf",values:Go},shape:{values:"circle"},active:{option:{color:"#0c2c84"}},size:{field:"cum_conf",values:[0,30]},style:{opacity:.8}}),ye.createElement(Or,{key:"5",source:{data:P},color:{values:"#fff"},shape:{field:"Short_Name_ZH",values:"text"},filter:{field:"cum_conf",values:function(J){return J>2e3}},size:{values:12},style:{opacity:1,strokeOpacity:1,strokeWidth:0}})])}}]),c}(ye.Component),ou={Pie:I,WaterWave:ae,Gauge:Vt,MiniArea:H,TagCloud:nt,Map:ra},hi=i("KQm4"),En=i("H+7v"),xa=i.n(En);function Va(v){return v*1<10?"0".concat(v):v}function Ao(){for(var v=[],f=0;f<24;f+=1)v.push({x:"".concat(Va(f),":00"),y:Math.floor(Math.random()*200)+f*50});return v}var su=function(v){Object(re.a)(c,v);var f=Object(de.a)(c);function c(){var p;Object(D.a)(this,c);for(var y=arguments.length,P=new Array(y),N=0;N<y;N++)P[N]=arguments[N];return p=f.call.apply(f,[this].concat(P)),p.state={activeData:Ao()},p.timer=void 0,p.requestRef=void 0,p.loopData=function(){p.requestRef=requestAnimationFrame(function(){p.timer=window.setTimeout(function(){p.setState({activeData:Ao()},function(){p.loopData()})},1e3)})},p}return Object(K.a)(c,[{key:"componentDidMount",value:function(){this.loopData()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer),this.requestRef&&cancelAnimationFrame(this.requestRef)}},{key:"render",value:function(){var y=this.state.activeData,P=y===void 0?[]:y;return we.a.createElement("div",{className:xa.a.activeChart},we.a.createElement(Fe.a,{title:"\u76EE\u6807\u8BC4\u4F30",value:"\u6709\u671B\u8FBE\u5230\u9884\u671F"}),we.a.createElement("div",{style:{marginTop:32}},we.a.createElement(H,{animate:!1,line:!0,borderWidth:2,height:84,scale:{y:{tickCount:3}},yAxis:{tickLine:void 0,label:void 0,title:void 0,line:void 0},data:P})),P&&we.a.createElement("div",null,we.a.createElement("div",{className:xa.a.activeChartGrid},we.a.createElement("p",null,Object(hi.a)(P).sort()[P.length-1].y+200," \u4EBF\u5143"),we.a.createElement("p",null,Object(hi.a)(P).sort()[Math.floor(P.length/2)].y," \u4EBF\u5143")),we.a.createElement("div",{className:xa.a.dashedLine},we.a.createElement("div",{className:xa.a.line})),we.a.createElement("div",{className:xa.a.dashedLine},we.a.createElement("div",{className:xa.a.line}))),P&&we.a.createElement("div",{className:xa.a.activeChartLegend},we.a.createElement("span",null,"00:00"),we.a.createElement("span",null,P[Math.floor(P.length/2)].x),we.a.createElement("span",null,P[P.length-1].x)))}}]),c}(ye.Component),$l=i("Wnft"),Ot=i.n($l),Er=Fe.a.Countdown,yr=Date.now()+1e3*60*60*24*2+1e3*30,Cn=function(v){Object(re.a)(c,v);var f=Object(de.a)(c);function c(){return Object(D.a)(this,c),f.apply(this,arguments)}return Object(K.a)(c,[{key:"componentDidMount",value:function(){var y=this.props.dispatch;y({type:"dashboardAndmonitor/fetchTags"})}},{key:"render",value:function(){var y=this.props,P=y.dashboardAndmonitor,N=y.loading,ee=P.tags;return we.a.createElement(pt.a,null,we.a.createElement(we.a.Fragment,null,we.a.createElement(z.a,{gutter:24},we.a.createElement(Z.a,{xl:18,lg:24,md:24,sm:24,xs:24,style:{marginBottom:24}},we.a.createElement(m.a,{title:we.a.createElement(Ze.a,{id:"dashboardandmonitor.monitor.trading-activity",defaultMessage:"Real-Time Trading Activity"}),bordered:!1},we.a.createElement(z.a,null,we.a.createElement(Z.a,{md:6,sm:12,xs:24},we.a.createElement(Fe.a,{title:we.a.createElement(Ze.a,{id:"dashboardandmonitor.monitor.total-transactions",defaultMessage:"Total transactions today"}),suffix:"\u5143",value:Tt()(124543233).format("0,0")})),we.a.createElement(Z.a,{md:6,sm:12,xs:24},we.a.createElement(Fe.a,{title:we.a.createElement(Ze.a,{id:"dashboardandmonitor.monitor.sales-target",defaultMessage:"Sales target completion rate"}),value:"92%"})),we.a.createElement(Z.a,{md:6,sm:12,xs:24},we.a.createElement(Er,{title:we.a.createElement(Ze.a,{id:"dashboardandmonitor.monitor.remaining-time",defaultMessage:"Remaining time of activity"}),value:yr,format:"HH:mm:ss:SSS"})),we.a.createElement(Z.a,{md:6,sm:12,xs:24},we.a.createElement(Fe.a,{title:we.a.createElement(Ze.a,{id:"dashboardandmonitor.monitor.total-transactions-per-second",defaultMessage:"Total transactions per second"}),suffix:"\u5143",value:Tt()(234).format("0,0")}))),we.a.createElement("div",{className:Ot.a.mapChart},we.a.createElement(ra,null)))),we.a.createElement(Z.a,{xl:6,lg:24,md:24,sm:24,xs:24},we.a.createElement(m.a,{title:we.a.createElement(Ze.a,{id:"dashboardandmonitor.monitor.activity-forecast",defaultMessage:"Activity forecast"}),style:{marginBottom:24},bordered:!1},we.a.createElement(su,null)),we.a.createElement(m.a,{title:we.a.createElement(Ze.a,{id:"dashboardandmonitor.monitor.efficiency",defaultMessage:"Efficiency"}),style:{marginBottom:24},bodyStyle:{textAlign:"center"},bordered:!1},we.a.createElement(Vt,{title:Object(Ze.d)({id:"dashboardandmonitor.monitor.ratio",defaultMessage:"Ratio"}),height:180,percent:87})))),we.a.createElement(z.a,{gutter:24},we.a.createElement(Z.a,{xl:12,lg:24,sm:24,xs:24,style:{marginBottom:24}},we.a.createElement(m.a,{title:we.a.createElement(Ze.a,{id:"dashboardandmonitor.monitor.proportion-per-category",defaultMessage:"Proportion Per Category"}),bordered:!1,className:Ot.a.pieCard},we.a.createElement(z.a,{style:{padding:"16px 0"}},we.a.createElement(Z.a,{span:8},we.a.createElement(I,{animate:!1,percent:28,title:we.a.createElement(Ze.a,{id:"dashboardandmonitor.monitor.fast-food",defaultMessage:"Fast food"}),total:"28%",height:128,lineWidth:2})),we.a.createElement(Z.a,{span:8},we.a.createElement(I,{animate:!1,color:"#5DDECF",percent:22,title:we.a.createElement(Ze.a,{id:"dashboardandmonitor.monitor.western-food",defaultMessage:"Western food"}),total:"22%",height:128,lineWidth:2})),we.a.createElement(Z.a,{span:8},we.a.createElement(I,{animate:!1,color:"#2FC25B",percent:32,title:we.a.createElement(Ze.a,{id:"dashboardandmonitor.monitor.hot-pot",defaultMessage:"Hot pot"}),total:"32%",height:128,lineWidth:2}))))),we.a.createElement(Z.a,{xl:6,lg:12,sm:24,xs:24,style:{marginBottom:24}},we.a.createElement(m.a,{title:we.a.createElement(Ze.a,{id:"dashboardandmonitor.monitor.popular-searches",defaultMessage:"Popular Searches"}),loading:N,bordered:!1,bodyStyle:{overflow:"hidden"}},we.a.createElement(nt,{data:ee||[],height:161}))),we.a.createElement(Z.a,{xl:6,lg:12,sm:24,xs:24,style:{marginBottom:24}},we.a.createElement(m.a,{title:we.a.createElement(Ze.a,{id:"dashboardandmonitor.monitor.resource-surplus",defaultMessage:"Resource Surplus"}),bodyStyle:{textAlign:"center",fontSize:0},bordered:!1},we.a.createElement(ae,{height:161,title:we.a.createElement(Ze.a,{id:"dashboardandmonitor.monitor.fund-surplus",defaultMessage:"Fund Surplus"}),percent:34}))))))}}]),c}(ye.Component),Oa=E.default=Object(Ze.c)(function(v){var f=v.dashboardAndmonitor,c=v.loading;return{dashboardAndmonitor:f,loading:c.models.dashboardAndmonitor}})(Cn)},aF1E:function(Re,E,i){"use strict";i.d(E,"a",function(){return o});var T=i("lSNA"),m=i.n(T);function X(Z,D){var K=Object.keys(Z);if(Object.getOwnPropertySymbols){var re=Object.getOwnPropertySymbols(Z);D&&(re=re.filter(function(de){return Object.getOwnPropertyDescriptor(Z,de).enumerable})),K.push.apply(K,re)}return K}function z(Z){for(var D=1;D<arguments.length;D++){var K=arguments[D]!=null?arguments[D]:{};D%2?X(Object(K),!0).forEach(function(re){m()(Z,re,K[re])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Z,Object.getOwnPropertyDescriptors(K)):X(Object(K)).forEach(function(re){Object.defineProperty(Z,re,Object.getOwnPropertyDescriptor(K,re))})}return Z}function o(Z,D){var K=D.sourceField,re=D.targetField,de=D.data,Y={};return de.forEach(function(Fe){Y[Fe[K]]=Fe}),Z.dataArray=Z.dataArray.map(function(Fe){var Ze=Fe[re];return z(z({},Fe),Y[Ze])}),Z}},aHsQ:function(Re,E,i){"use strict";var T=i("cIOH"),m=i.n(T),X=i("6D9b"),z=i.n(X),o=i("cWXX")},aPG5:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("MON2"),m=i("FV85"),X=i("qK8v"),z=i("ujMp"),o=i("cSJO"),Z=function(de,Y,Fe){try{return Fe()}catch(Ze){throw X.isStackOverflowExeption(Ze)?new Error(T.CIRCULAR_DEPENDENCY_IN_FACTORY(de,Y.toString())):Ze}},D=function re(de){return function(Y){Y.parentContext.setCurrentRequest(Y);var Fe=Y.bindings,Ze=Y.childRequests,ye=Y.target&&Y.target.isArray(),we=!Y.parentRequest||!Y.parentRequest.target||!Y.target||!Y.parentRequest.target.matchesArray(Y.target.serviceIdentifier);if(ye&&we)return Ze.map(function(Je){var Et=re(de);return Et(Je)});var pt=null;if(Y.target.isOptional()&&Fe.length===0)return;var je=Fe[0],Tt=je.scope===m.BindingScopeEnum.Singleton,Xe=je.scope===m.BindingScopeEnum.Request;if(Tt&&je.activated)return je.cache;if(Xe&&de!==null&&de.has(je.id))return de.get(je.id);if(je.type===m.BindingTypeEnum.ConstantValue)pt=je.cache;else if(je.type===m.BindingTypeEnum.Function)pt=je.cache;else if(je.type===m.BindingTypeEnum.Constructor)pt=je.implementationType;else if(je.type===m.BindingTypeEnum.DynamicValue&&je.dynamicValue!==null)pt=Z("toDynamicValue",je.serviceIdentifier,function(){return je.dynamicValue(Y.parentContext)});else if(je.type===m.BindingTypeEnum.Factory&&je.factory!==null)pt=Z("toFactory",je.serviceIdentifier,function(){return je.factory(Y.parentContext)});else if(je.type===m.BindingTypeEnum.Provider&&je.provider!==null)pt=Z("toProvider",je.serviceIdentifier,function(){return je.provider(Y.parentContext)});else if(je.type===m.BindingTypeEnum.Instance&&je.implementationType!==null)pt=o.resolveInstance(je.implementationType,Ze,re(de));else{var gt=z.getServiceIdentifierAsString(Y.serviceIdentifier);throw new Error(T.INVALID_BINDING_TYPE+" "+gt)}return typeof je.onActivation=="function"&&(pt=je.onActivation(Y.parentContext,pt)),Tt&&(je.cache=pt,je.activated=!0),Xe&&de!==null&&!de.has(je.id)&&de.set(je.id,pt),pt}};function K(re){var de=D(re.plan.rootRequest.requestScope);return de(re.plan.rootRequest)}E.resolve=K},asDA:function(Re,E){function i(T,m,X,z){var o=-1,Z=T==null?0:T.length;for(z&&Z&&(X=T[++o]);++o<Z;)X=m(X,T[o],o,T);return X}Re.exports=i},b2z7:function(Re,E){var i=/\w*$/;function T(m){var X=new m.constructor(m.source,i.exec(m));return X.lastIndex=m.lastIndex,X}Re.exports=T},bB6j:function(Re,E,i){"use strict";i.d(E,"a",function(){return T});var T={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),ILogService:Symbol.for("ILogService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")}},bPkA:function(Re,E,i){"use strict";i.d(E,"a",function(){return T});var T;(function(m){m.Normal="normal",m.PostProcessing="post-processing"})(T||(T={}))},bTtR:function(Re,E){},bYl4:function(Re,E){},bahg:function(Re,E){function i(T){return T.split("")}Re.exports=i},bl9R:function(Re,E,i){"use strict";i.r(E),i.d(E,"create",function(){return m}),i.d(E,"clone",function(){return X}),i.d(E,"fromValues",function(){return z}),i.d(E,"copy",function(){return o}),i.d(E,"set",function(){return Z}),i.d(E,"add",function(){return D}),i.d(E,"subtract",function(){return K}),i.d(E,"multiply",function(){return re}),i.d(E,"divide",function(){return de}),i.d(E,"ceil",function(){return Y}),i.d(E,"floor",function(){return Fe}),i.d(E,"min",function(){return Ze}),i.d(E,"max",function(){return ye}),i.d(E,"round",function(){return we}),i.d(E,"scale",function(){return pt}),i.d(E,"scaleAndAdd",function(){return je}),i.d(E,"distance",function(){return Tt}),i.d(E,"squaredDistance",function(){return Xe}),i.d(E,"length",function(){return gt}),i.d(E,"squaredLength",function(){return Je}),i.d(E,"negate",function(){return Et}),i.d(E,"inverse",function(){return _t}),i.d(E,"normalize",function(){return Ne}),i.d(E,"dot",function(){return ke}),i.d(E,"cross",function(){return Ue}),i.d(E,"lerp",function(){return st}),i.d(E,"random",function(){return Le}),i.d(E,"transformMat4",function(){return ut}),i.d(E,"transformQuat",function(){return Vt}),i.d(E,"zero",function(){return Zt}),i.d(E,"str",function(){return ir}),i.d(E,"exactEquals",function(){return oe}),i.d(E,"equals",function(){return Q}),i.d(E,"sub",function(){return H}),i.d(E,"mul",function(){return Ce}),i.d(E,"div",function(){return Ee}),i.d(E,"dist",function(){return Ae}),i.d(E,"sqrDist",function(){return ge}),i.d(E,"len",function(){return rt}),i.d(E,"sqrLen",function(){return Yt}),i.d(E,"forEach",function(){return At});var T=i("yU0y");function m(){var be=new T.a(4);return T.a!=Float32Array&&(be[0]=0,be[1]=0,be[2]=0,be[3]=0),be}function X(be){var xe=new T.a(4);return xe[0]=be[0],xe[1]=be[1],xe[2]=be[2],xe[3]=be[3],xe}function z(be,xe,Ve,lt){var Pe=new T.a(4);return Pe[0]=be,Pe[1]=xe,Pe[2]=Ve,Pe[3]=lt,Pe}function o(be,xe){return be[0]=xe[0],be[1]=xe[1],be[2]=xe[2],be[3]=xe[3],be}function Z(be,xe,Ve,lt,Pe){return be[0]=xe,be[1]=Ve,be[2]=lt,be[3]=Pe,be}function D(be,xe,Ve){return be[0]=xe[0]+Ve[0],be[1]=xe[1]+Ve[1],be[2]=xe[2]+Ve[2],be[3]=xe[3]+Ve[3],be}function K(be,xe,Ve){return be[0]=xe[0]-Ve[0],be[1]=xe[1]-Ve[1],be[2]=xe[2]-Ve[2],be[3]=xe[3]-Ve[3],be}function re(be,xe,Ve){return be[0]=xe[0]*Ve[0],be[1]=xe[1]*Ve[1],be[2]=xe[2]*Ve[2],be[3]=xe[3]*Ve[3],be}function de(be,xe,Ve){return be[0]=xe[0]/Ve[0],be[1]=xe[1]/Ve[1],be[2]=xe[2]/Ve[2],be[3]=xe[3]/Ve[3],be}function Y(be,xe){return be[0]=Math.ceil(xe[0]),be[1]=Math.ceil(xe[1]),be[2]=Math.ceil(xe[2]),be[3]=Math.ceil(xe[3]),be}function Fe(be,xe){return be[0]=Math.floor(xe[0]),be[1]=Math.floor(xe[1]),be[2]=Math.floor(xe[2]),be[3]=Math.floor(xe[3]),be}function Ze(be,xe,Ve){return be[0]=Math.min(xe[0],Ve[0]),be[1]=Math.min(xe[1],Ve[1]),be[2]=Math.min(xe[2],Ve[2]),be[3]=Math.min(xe[3],Ve[3]),be}function ye(be,xe,Ve){return be[0]=Math.max(xe[0],Ve[0]),be[1]=Math.max(xe[1],Ve[1]),be[2]=Math.max(xe[2],Ve[2]),be[3]=Math.max(xe[3],Ve[3]),be}function we(be,xe){return be[0]=Math.round(xe[0]),be[1]=Math.round(xe[1]),be[2]=Math.round(xe[2]),be[3]=Math.round(xe[3]),be}function pt(be,xe,Ve){return be[0]=xe[0]*Ve,be[1]=xe[1]*Ve,be[2]=xe[2]*Ve,be[3]=xe[3]*Ve,be}function je(be,xe,Ve,lt){return be[0]=xe[0]+Ve[0]*lt,be[1]=xe[1]+Ve[1]*lt,be[2]=xe[2]+Ve[2]*lt,be[3]=xe[3]+Ve[3]*lt,be}function Tt(be,xe){var Ve=xe[0]-be[0],lt=xe[1]-be[1],Pe=xe[2]-be[2],dt=xe[3]-be[3];return Math.hypot(Ve,lt,Pe,dt)}function Xe(be,xe){var Ve=xe[0]-be[0],lt=xe[1]-be[1],Pe=xe[2]-be[2],dt=xe[3]-be[3];return Ve*Ve+lt*lt+Pe*Pe+dt*dt}function gt(be){var xe=be[0],Ve=be[1],lt=be[2],Pe=be[3];return Math.hypot(xe,Ve,lt,Pe)}function Je(be){var xe=be[0],Ve=be[1],lt=be[2],Pe=be[3];return xe*xe+Ve*Ve+lt*lt+Pe*Pe}function Et(be,xe){return be[0]=-xe[0],be[1]=-xe[1],be[2]=-xe[2],be[3]=-xe[3],be}function _t(be,xe){return be[0]=1/xe[0],be[1]=1/xe[1],be[2]=1/xe[2],be[3]=1/xe[3],be}function Ne(be,xe){var Ve=xe[0],lt=xe[1],Pe=xe[2],dt=xe[3],w=Ve*Ve+lt*lt+Pe*Pe+dt*dt;return w>0&&(w=1/Math.sqrt(w)),be[0]=Ve*w,be[1]=lt*w,be[2]=Pe*w,be[3]=dt*w,be}function ke(be,xe){return be[0]*xe[0]+be[1]*xe[1]+be[2]*xe[2]+be[3]*xe[3]}function Ue(be,xe,Ve,lt){var Pe=Ve[0]*lt[1]-Ve[1]*lt[0],dt=Ve[0]*lt[2]-Ve[2]*lt[0],w=Ve[0]*lt[3]-Ve[3]*lt[0],I=Ve[1]*lt[2]-Ve[2]*lt[1],q=Ve[1]*lt[3]-Ve[3]*lt[1],ce=Ve[2]*lt[3]-Ve[3]*lt[2],Ge=xe[0],$e=xe[1],yt=xe[2],nt=xe[3];return be[0]=$e*ce-yt*q+nt*I,be[1]=-(Ge*ce)+yt*w-nt*dt,be[2]=Ge*q-$e*w+nt*Pe,be[3]=-(Ge*I)+$e*dt-yt*Pe,be}function st(be,xe,Ve,lt){var Pe=xe[0],dt=xe[1],w=xe[2],I=xe[3];return be[0]=Pe+lt*(Ve[0]-Pe),be[1]=dt+lt*(Ve[1]-dt),be[2]=w+lt*(Ve[2]-w),be[3]=I+lt*(Ve[3]-I),be}function Le(be,xe){xe=xe||1;var Ve,lt,Pe,dt,w,I;do Ve=T.c()*2-1,lt=T.c()*2-1,w=Ve*Ve+lt*lt;while(w>=1);do Pe=T.c()*2-1,dt=T.c()*2-1,I=Pe*Pe+dt*dt;while(I>=1);var q=Math.sqrt((1-w)/I);return be[0]=xe*Ve,be[1]=xe*lt,be[2]=xe*Pe*q,be[3]=xe*dt*q,be}function ut(be,xe,Ve){var lt=xe[0],Pe=xe[1],dt=xe[2],w=xe[3];return be[0]=Ve[0]*lt+Ve[4]*Pe+Ve[8]*dt+Ve[12]*w,be[1]=Ve[1]*lt+Ve[5]*Pe+Ve[9]*dt+Ve[13]*w,be[2]=Ve[2]*lt+Ve[6]*Pe+Ve[10]*dt+Ve[14]*w,be[3]=Ve[3]*lt+Ve[7]*Pe+Ve[11]*dt+Ve[15]*w,be}function Vt(be,xe,Ve){var lt=xe[0],Pe=xe[1],dt=xe[2],w=Ve[0],I=Ve[1],q=Ve[2],ce=Ve[3],Ge=ce*lt+I*dt-q*Pe,$e=ce*Pe+q*lt-w*dt,yt=ce*dt+w*Pe-I*lt,nt=-w*lt-I*Pe-q*dt;return be[0]=Ge*ce+nt*-w+$e*-q-yt*-I,be[1]=$e*ce+nt*-I+yt*-w-Ge*-q,be[2]=yt*ce+nt*-q+Ge*-I-$e*-w,be[3]=xe[3],be}function Zt(be){return be[0]=0,be[1]=0,be[2]=0,be[3]=0,be}function ir(be){return"vec4("+be[0]+", "+be[1]+", "+be[2]+", "+be[3]+")"}function oe(be,xe){return be[0]===xe[0]&&be[1]===xe[1]&&be[2]===xe[2]&&be[3]===xe[3]}function Q(be,xe){var Ve=be[0],lt=be[1],Pe=be[2],dt=be[3],w=xe[0],I=xe[1],q=xe[2],ce=xe[3];return Math.abs(Ve-w)<=T.b*Math.max(1,Math.abs(Ve),Math.abs(w))&&Math.abs(lt-I)<=T.b*Math.max(1,Math.abs(lt),Math.abs(I))&&Math.abs(Pe-q)<=T.b*Math.max(1,Math.abs(Pe),Math.abs(q))&&Math.abs(dt-ce)<=T.b*Math.max(1,Math.abs(dt),Math.abs(ce))}var H=K,Ce=re,Ee=de,Ae=Tt,ge=Xe,rt=gt,Yt=Je,At=function(){var be=m();return function(xe,Ve,lt,Pe,dt,w){var I,q;for(Ve||(Ve=4),lt||(lt=0),Pe?q=Math.min(Pe*Ve+lt,xe.length):q=xe.length,I=lt;I<q;I+=Ve)be[0]=xe[I],be[1]=xe[I+1],be[2]=xe[I+2],be[3]=xe[I+3],dt(be,be,w),xe[I]=be[0],xe[I+1]=be[1],xe[I+2]=be[2],xe[I+3]=be[3];return xe}}()},bzyH:function(Re,E){},cSJO:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("MON2"),m=i("FV85"),X=i("xfSm");function z(K,re,de){var Y=re.filter(function(Ze){return Ze.target!==null&&Ze.target.type===m.TargetTypeEnum.ClassProperty}),Fe=Y.map(de);return Y.forEach(function(Ze,ye){var we="";we=Ze.target.name.value();var pt=Fe[ye];K[we]=pt}),K}function o(K,re){return new(K.bind.apply(K,[void 0].concat(re)))}function Z(K,re){if(Reflect.hasMetadata(X.POST_CONSTRUCT,K)){var de=Reflect.getMetadata(X.POST_CONSTRUCT,K);try{re[de.value]()}catch(Y){throw new Error(T.POST_CONSTRUCT_ERROR(K.name,Y.message))}}}function D(K,re,de){var Y=null;if(re.length>0){var Fe=re.filter(function(ye){return ye.target!==null&&ye.target.type===m.TargetTypeEnum.ConstructorArgument}),Ze=Fe.map(de);Y=o(K,Ze),Y=z(Y,re,de)}else Y=new K;return Z(K,Y),Y}E.resolveInstance=D},cWXX:function(Re,E,i){"use strict";var T=i("cIOH"),m=i.n(T),X=i("oIFs"),z=i.n(X)},cWyK:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("/rf6");function m(Xe,gt,Je){if(Xe===null)return;for(var Et,_t,Ne,ke,Ue,st,Le,ut=0,Vt=0,Zt,ir=Xe.type,oe=ir==="FeatureCollection",Q=ir==="Feature",H=oe?Xe.features.length:1,Ce=0;Ce<H;Ce++){Le=oe?Xe.features[Ce].geometry:Q?Xe.geometry:Xe,Zt=Le?Le.type==="GeometryCollection":!1,Ue=Zt?Le.geometries.length:1;for(var Ee=0;Ee<Ue;Ee++){var Ae=0,ge=0;if(ke=Zt?Le.geometries[Ee]:Le,ke===null)continue;st=ke.coordinates;var rt=ke.type;ut=Je&&(rt==="Polygon"||rt==="MultiPolygon")?1:0;switch(rt){case null:break;case"Point":if(gt(st,Vt,Ce,Ae,ge)===!1)return!1;Vt++,Ae++;break;case"LineString":case"MultiPoint":for(Et=0;Et<st.length;Et++){if(gt(st[Et],Vt,Ce,Ae,ge)===!1)return!1;Vt++,rt==="MultiPoint"&&Ae++}rt==="LineString"&&Ae++;break;case"Polygon":case"MultiLineString":for(Et=0;Et<st.length;Et++){for(_t=0;_t<st[Et].length-ut;_t++){if(gt(st[Et][_t],Vt,Ce,Ae,ge)===!1)return!1;Vt++}rt==="MultiLineString"&&Ae++,rt==="Polygon"&&ge++}rt==="Polygon"&&Ae++;break;case"MultiPolygon":for(Et=0;Et<st.length;Et++){for(ge=0,_t=0;_t<st[Et].length;_t++){for(Ne=0;Ne<st[Et][_t].length-ut;Ne++){if(gt(st[Et][_t][Ne],Vt,Ce,Ae,ge)===!1)return!1;Vt++}ge++}Ae++}break;case"GeometryCollection":for(Et=0;Et<ke.geometries.length;Et++)if(m(ke.geometries[Et],gt,Je)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}function X(Xe,gt,Je,Et){var _t=Je;return m(Xe,function(Ne,ke,Ue,st,Le){ke===0&&Je===void 0?_t=Ne:_t=gt(_t,Ne,ke,Ue,st,Le)},Et),_t}function z(Xe,gt){var Je;switch(Xe.type){case"FeatureCollection":for(Je=0;Je<Xe.features.length&&!(gt(Xe.features[Je].properties,Je)===!1);Je++);break;case"Feature":gt(Xe.properties,0);break}}function o(Xe,gt,Je){var Et=Je;return z(Xe,function(_t,Ne){Ne===0&&Je===void 0?Et=_t:Et=gt(Et,_t,Ne)}),Et}function Z(Xe,gt){if(Xe.type==="Feature")gt(Xe,0);else if(Xe.type==="FeatureCollection")for(var Je=0;Je<Xe.features.length&&!(gt(Xe.features[Je],Je)===!1);Je++);}function D(Xe,gt,Je){var Et=Je;return Z(Xe,function(_t,Ne){Ne===0&&Je===void 0?Et=_t:Et=gt(Et,_t,Ne)}),Et}function K(Xe){var gt=[];return m(Xe,function(Je){gt.push(Je)}),gt}function re(Xe,gt){var Je,Et,_t,Ne,ke,Ue,st,Le,ut,Vt,Zt=0,ir=Xe.type==="FeatureCollection",oe=Xe.type==="Feature",Q=ir?Xe.features.length:1;for(Je=0;Je<Q;Je++){for(Ue=ir?Xe.features[Je].geometry:oe?Xe.geometry:Xe,Le=ir?Xe.features[Je].properties:oe?Xe.properties:{},ut=ir?Xe.features[Je].bbox:oe?Xe.bbox:void 0,Vt=ir?Xe.features[Je].id:oe?Xe.id:void 0,st=Ue?Ue.type==="GeometryCollection":!1,ke=st?Ue.geometries.length:1,_t=0;_t<ke;_t++){if(Ne=st?Ue.geometries[_t]:Ue,Ne===null){if(gt(null,Zt,Le,ut,Vt)===!1)return!1;continue}switch(Ne.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(gt(Ne,Zt,Le,ut,Vt)===!1)return!1;break}case"GeometryCollection":{for(Et=0;Et<Ne.geometries.length;Et++)if(gt(Ne.geometries[Et],Zt,Le,ut,Vt)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}Zt++}}function de(Xe,gt,Je){var Et=Je;return re(Xe,function(_t,Ne,ke,Ue,st){Ne===0&&Je===void 0?Et=_t:Et=gt(Et,_t,Ne,ke,Ue,st)}),Et}function Y(Xe,gt){re(Xe,function(Je,Et,_t,Ne,ke){var Ue=Je===null?null:Je.type;switch(Ue){case null:case"Point":case"LineString":case"Polygon":return gt(T.feature(Je,_t,{bbox:Ne,id:ke}),Et,0)===!1?!1:void 0}var st;switch(Ue){case"MultiPoint":st="Point";break;case"MultiLineString":st="LineString";break;case"MultiPolygon":st="Polygon";break}for(var Le=0;Le<Je.coordinates.length;Le++){var ut=Je.coordinates[Le],Vt={type:st,coordinates:ut};if(gt(T.feature(Vt,_t),Et,Le)===!1)return!1}})}function Fe(Xe,gt,Je){var Et=Je;return Y(Xe,function(_t,Ne,ke){Ne===0&&ke===0&&Je===void 0?Et=_t:Et=gt(Et,_t,Ne,ke)}),Et}function Ze(Xe,gt){Y(Xe,function(Je,Et,_t){var Ne=0;if(!Je.geometry)return;var ke=Je.geometry.type;if(ke==="Point"||ke==="MultiPoint")return;var Ue,st=0,Le=0,ut=0;if(m(Je,function(Vt,Zt,ir,oe,Q){if(Ue===void 0||Et>st||oe>Le||Q>ut){Ue=Vt,st=Et,Le=oe,ut=Q,Ne=0;return}var H=T.lineString([Ue,Vt],Je.properties);if(gt(H,Et,_t,Q,Ne)===!1)return!1;Ne++,Ue=Vt})===!1)return!1})}function ye(Xe,gt,Je){var Et=Je,_t=!1;return Ze(Xe,function(Ne,ke,Ue,st,Le){_t===!1&&Je===void 0?Et=Ne:Et=gt(Et,Ne,ke,Ue,st,Le),_t=!0}),Et}function we(Xe,gt){if(!Xe)throw new Error("geojson is required");Y(Xe,function(Je,Et,_t){if(Je.geometry===null)return;var Ne=Je.geometry.type,ke=Je.geometry.coordinates;switch(Ne){case"LineString":if(gt(Je,Et,_t,0,0)===!1)return!1;break;case"Polygon":for(var Ue=0;Ue<ke.length;Ue++)if(gt(T.lineString(ke[Ue],Je.properties),Et,_t,Ue)===!1)return!1;break}})}function pt(Xe,gt,Je){var Et=Je;return we(Xe,function(_t,Ne,ke,Ue){Ne===0&&Je===void 0?Et=_t:Et=gt(Et,_t,Ne,ke,Ue)}),Et}function je(Xe,gt){if(gt=gt||{},!T.isObject(gt))throw new Error("options is invalid");var Je=gt.featureIndex||0,Et=gt.multiFeatureIndex||0,_t=gt.geometryIndex||0,Ne=gt.segmentIndex||0,ke=gt.properties,Ue;switch(Xe.type){case"FeatureCollection":Je<0&&(Je=Xe.features.length+Je),ke=ke||Xe.features[Je].properties,Ue=Xe.features[Je].geometry;break;case"Feature":ke=ke||Xe.properties,Ue=Xe.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Ue=Xe;break;default:throw new Error("geojson is invalid")}if(Ue===null)return null;var st=Ue.coordinates;switch(Ue.type){case"Point":case"MultiPoint":return null;case"LineString":return Ne<0&&(Ne=st.length+Ne-1),T.lineString([st[Ne],st[Ne+1]],ke,gt);case"Polygon":return _t<0&&(_t=st.length+_t),Ne<0&&(Ne=st[_t].length+Ne-1),T.lineString([st[_t][Ne],st[_t][Ne+1]],ke,gt);case"MultiLineString":return Et<0&&(Et=st.length+Et),Ne<0&&(Ne=st[Et].length+Ne-1),T.lineString([st[Et][Ne],st[Et][Ne+1]],ke,gt);case"MultiPolygon":return Et<0&&(Et=st.length+Et),_t<0&&(_t=st[Et].length+_t),Ne<0&&(Ne=st[Et][_t].length-Ne-1),T.lineString([st[Et][_t][Ne],st[Et][_t][Ne+1]],ke,gt)}throw new Error("geojson is invalid")}function Tt(Xe,gt){if(gt=gt||{},!T.isObject(gt))throw new Error("options is invalid");var Je=gt.featureIndex||0,Et=gt.multiFeatureIndex||0,_t=gt.geometryIndex||0,Ne=gt.coordIndex||0,ke=gt.properties,Ue;switch(Xe.type){case"FeatureCollection":Je<0&&(Je=Xe.features.length+Je),ke=ke||Xe.features[Je].properties,Ue=Xe.features[Je].geometry;break;case"Feature":ke=ke||Xe.properties,Ue=Xe.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Ue=Xe;break;default:throw new Error("geojson is invalid")}if(Ue===null)return null;var st=Ue.coordinates;switch(Ue.type){case"Point":return T.point(st,ke,gt);case"MultiPoint":return Et<0&&(Et=st.length+Et),T.point(st[Et],ke,gt);case"LineString":return Ne<0&&(Ne=st.length+Ne),T.point(st[Ne],ke,gt);case"Polygon":return _t<0&&(_t=st.length+_t),Ne<0&&(Ne=st[_t].length+Ne),T.point(st[_t][Ne],ke,gt);case"MultiLineString":return Et<0&&(Et=st.length+Et),Ne<0&&(Ne=st[Et].length+Ne),T.point(st[Et][Ne],ke,gt);case"MultiPolygon":return Et<0&&(Et=st.length+Et),_t<0&&(_t=st[Et].length+_t),Ne<0&&(Ne=st[Et][_t].length-Ne),T.point(st[Et][_t][Ne],ke,gt)}throw new Error("geojson is invalid")}E.coordEach=m,E.coordReduce=X,E.propEach=z,E.propReduce=o,E.featureEach=Z,E.featureReduce=D,E.coordAll=K,E.geomEach=re,E.geomReduce=de,E.flattenEach=Y,E.flattenReduce=Fe,E.segmentEach=Ze,E.segmentReduce=ye,E.lineEach=we,E.lineReduce=pt,E.findSegment=je,E.findPoint=Tt},cZ5Q:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("MON2"),m=i("xfSm");function X(){return function(z){if(Reflect.hasOwnMetadata(m.PARAM_TYPES,z))throw new Error(T.DUPLICATED_INJECTABLE_DECORATOR);var o=Reflect.getMetadata(m.DESIGN_PARAM_TYPES,z)||[];return Reflect.defineMetadata(m.PARAM_TYPES,o,z),z}}E.injectable=X},cZlC:function(Re,E,i){"use strict";i.d(E,"b",function(){return T}),i.d(E,"c",function(){return m}),i.d(E,"a",function(){return X});var T;(function(z){z.LINEAR="linear",z.POWER="power",z.LOG="log",z.IDENTITY="identity",z.TIME="time",z.QUANTILE="quantile",z.QUANTIZE="quantize",z.THRESHOLD="threshold",z.CAT="cat"})(T||(T={}));var m;(function(z){z.CONSTANT="constant",z.VARIABLE="variable"})(m||(m={}));var X;(function(z){z[z.Attribute=0]="Attribute",z[z.InstancedAttribute=1]="InstancedAttribute",z[z.Uniform=2]="Uniform"})(X||(X={}))},"cq/+":function(Re,E,i){var T=i("mc0g"),m=T();Re.exports=m},cvCv:function(Re,E){function i(T){return function(){return T}}Re.exports=i},d9O0:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=0;function m(){return T++}E.id=m},d9mD:function(Re,E,i){Re.exports={pie:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-pie",chart:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-chart",hasLegend:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-hasLegend",legend:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-legend",dot:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-dot",line:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-line",legendTitle:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-legendTitle",percent:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-percent",value:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-value",title:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-title",total:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-total",legendBlock:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-legendBlock"}},dQpi:function(Re,E,i){var T=i("yGk4"),m=i("vN+2"),X=i("rEGp"),z=1/0,o=T&&1/X(new T([,-0]))[1]==z?function(Z){return new T(Z)}:m;Re.exports=o},dTAl:function(Re,E,i){var T=i("GoyQ"),m=Object.create,X=function(){function z(){}return function(o){if(!T(o))return{};if(m)return m(o);z.prototype=o;var Z=new z;return z.prototype=void 0,Z}}();Re.exports=X},dVn5:function(Re,E){var i=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function T(m){return m.match(i)||[]}Re.exports=T},dX1H:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("xfSm"),m=i("d9O0"),X=i("GXnB"),z=i("zxMA"),o=function(){function Z(D,K,re,de){this.id=m.id(),this.type=D,this.serviceIdentifier=re,this.name=new z.QueryableString(K||""),this.metadata=new Array;var Y=null;typeof de=="string"?Y=new X.Metadata(T.NAMED_TAG,de):de instanceof X.Metadata&&(Y=de),Y!==null&&this.metadata.push(Y)}return Z.prototype.hasTag=function(D){for(var K=0,re=this.metadata;K<re.length;K++){var de=re[K];if(de.key===D)return!0}return!1},Z.prototype.isArray=function(){return this.hasTag(T.MULTI_INJECT_TAG)},Z.prototype.matchesArray=function(D){return this.matchesTag(T.MULTI_INJECT_TAG)(D)},Z.prototype.isNamed=function(){return this.hasTag(T.NAMED_TAG)},Z.prototype.isTagged=function(){return this.metadata.some(function(D){return D.key!==T.INJECT_TAG&&D.key!==T.MULTI_INJECT_TAG&&D.key!==T.NAME_TAG&&D.key!==T.UNMANAGED_TAG&&D.key!==T.NAMED_TAG})},Z.prototype.isOptional=function(){return this.matchesTag(T.OPTIONAL_TAG)(!0)},Z.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(D){return D.key===T.NAMED_TAG})[0]:null},Z.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(D){return D.key!==T.INJECT_TAG&&D.key!==T.MULTI_INJECT_TAG&&D.key!==T.NAME_TAG&&D.key!==T.UNMANAGED_TAG&&D.key!==T.NAMED_TAG}):null},Z.prototype.matchesNamedTag=function(D){return this.matchesTag(T.NAMED_TAG)(D)},Z.prototype.matchesTag=function(D){var K=this;return function(re){for(var de=0,Y=K.metadata;de<Y.length;de++){var Fe=Y[de];if(Fe.key===D&&Fe.value===re)return!0}return!1}},Z}();E.Target=o},dgMf:function(Re,E,i){Re.exports={color:"color"}},doU7:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};E.BindingCount=T},dt0z:function(Re,E,i){var T=i("zoYe");function m(X){return X==null?"":T(X)}Re.exports=m},dxzI:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("d9O0"),m=function(){function z(o){this.id=T.id(),this.registry=o}return z}();E.ContainerModule=m;var X=function(){function z(o){this.id=T.id(),this.registry=o}return z}();E.AsyncContainerModule=X},eUgh:function(Re,E){function i(T,m){for(var X=-1,z=T==null?0:T.length,o=Array(z);++X<z;)o[X]=m(T[X],X,T);return o}Re.exports=i},"eg+a":function(Re,E,i){"use strict";i.d(E,"a",function(){return T});var T=["loaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"]},fX6N:function(Re,E,i){"use strict";i.d(E,"d",function(){return Lc}),i.d(E,"b",function(){return dc}),i.d(E,"a",function(){return Kl});var T=i("mNvP"),m=i("uhBA"),X=i.n(m),z=i("4cb6"),o=i("APxj"),Z=i.n(o),D=i("bB6j"),K=i("lSNA"),re=i.n(K),de=i("lwsE"),Y=i.n(de),Fe=i("W8MJ"),Ze=i.n(Fe),ye=i("Hel2"),we=i("rxlC"),pt=i.n(we);function je(ne,se){var k=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(_e){return Object.getOwnPropertyDescriptor(ne,_e).enumerable})),k.push.apply(k,G)}return k}function Tt(ne){for(var se=1;se<arguments.length;se++){var k=arguments[se]!=null?arguments[se]:{};se%2?je(Object(k),!0).forEach(function(G){re()(ne,G,k[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(k)):je(Object(k)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(k,G))})}return ne}function Xe(ne,se){var k;if(typeof Symbol=="undefined"||ne[Symbol.iterator]==null){if(Array.isArray(ne)||(k=gt(ne))||se&&ne&&typeof ne.length=="number"){k&&(ne=k);var G=0,_e=function(){};return{s:_e,n:function(){return G>=ne.length?{done:!0}:{done:!1,value:ne[G++]}},e:function(Dr){throw Dr},f:_e}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ot=!0,Xt=!1,rr;return{s:function(){k=ne[Symbol.iterator]()},n:function(){var Dr=k.next();return ot=Dr.done,Dr},e:function(Dr){Xt=!0,rr=Dr},f:function(){try{!ot&&k.return!=null&&k.return()}finally{if(Xt)throw rr}}}}function gt(ne,se){if(!ne)return;if(typeof ne=="string")return Je(ne,se);var k=Object.prototype.toString.call(ne).slice(8,-1);if(k==="Object"&&ne.constructor&&(k=ne.constructor.name),k==="Map"||k==="Set")return Array.from(ne);if(k==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(k))return Je(ne,se)}function Je(ne,se){(se==null||se>ne.length)&&(se=ne.length);for(var k=0,G=new Array(se);k<se;k++)G[k]=ne[k];return G}var Et=30;function _t(ne){var se=ne.characterSet,k=ne.getFontWidth,G=ne.fontHeight,_e=ne.buffer,ot=ne.maxCanvasWidth,Xt=ne.mapping,rr=Xt===void 0?{}:Xt,tr=ne.xOffset,Dr=tr===void 0?0:tr,tn=ne.yOffset,Vn=tn===void 0?0:tn,ta=0,oa=Dr;Array.from(se).forEach(function(za,Ni){if(!rr[za]){var Fa=k(za,Ni);oa+Et>ot&&(oa=0,ta++),rr[za]={x:oa,y:Vn+ta*Et,width:Et,height:Et,advance:Fa},oa+=Et}});var Ya=G+_e*2;return{mapping:rr,xOffset:oa,yOffset:Vn+ta*Ya,canvasHeight:Ue(Vn+(ta+1)*Ya)}}function Ne(ne,se,k){var G=0,_e=0,ot=0,Xt=[],rr={},tr=Xe(ne),Dr;try{for(tr.s();!(Dr=tr.n()).done;){var tn=Dr.value;if(!rr[tn.id]){var Vn=tn.height,ta=tn.width;G+ta+se>k&&(ke(rr,Xt,_e),G=0,_e=ot+_e+se,ot=0,Xt=[]),Xt.push({icon:tn,xOffset:G}),G=G+ta+se,ot=Math.max(ot,Vn)}}}catch(Ya){tr.e(Ya)}finally{tr.f()}Xt.length>0&&ke(rr,Xt,_e);var oa=Ue(ot+_e+se);return{mapping:rr,canvasHeight:oa}}function ke(ne,se,k){var G=Xe(se),_e;try{for(G.s();!(_e=G.n()).done;){var ot=_e.value,Xt=ot.icon,rr=ot.xOffset;ne[Xt.id]=Tt(Tt({},Xt),{},{x:rr,y:k,image:Xt.image})}}catch(tr){G.e(tr)}finally{G.f()}}function Ue(ne){return Math.pow(2,Math.ceil(Math.log2(ne)))}var st,Le,ut;function Vt(ne,se){var k;if(typeof Symbol=="undefined"||ne[Symbol.iterator]==null){if(Array.isArray(ne)||(k=Zt(ne))||se&&ne&&typeof ne.length=="number"){k&&(ne=k);var G=0,_e=function(){};return{s:_e,n:function(){return G>=ne.length?{done:!0}:{done:!1,value:ne[G++]}},e:function(Dr){throw Dr},f:_e}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ot=!0,Xt=!1,rr;return{s:function(){k=ne[Symbol.iterator]()},n:function(){var Dr=k.next();return ot=Dr.done,Dr},e:function(Dr){Xt=!0,rr=Dr},f:function(){try{!ot&&k.return!=null&&k.return()}finally{if(Xt)throw rr}}}}function Zt(ne,se){if(!ne)return;if(typeof ne=="string")return ir(ne,se);var k=Object.prototype.toString.call(ne).slice(8,-1);if(k==="Object"&&ne.constructor&&(k=ne.constructor.name),k==="Map"||k==="Set")return Array.from(ne);if(k==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(k))return ir(ne,se)}function ir(ne,se){(se==null||se>ne.length)&&(se=ne.length);for(var k=0,G=new Array(se);k<se;k++)G[k]=ne[k];return G}function oe(ne,se){var k=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(_e){return Object.getOwnPropertyDescriptor(ne,_e).enumerable})),k.push.apply(k,G)}return k}function Q(ne){for(var se=1;se<arguments.length;se++){var k=arguments[se]!=null?arguments[se]:{};se%2?oe(Object(k),!0).forEach(function(G){re()(ne,G,k[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(k)):oe(Object(k)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(k,G))})}return ne}var H=Pe(),Ce="sans-serif",Ee="normal",Ae=24,ge=3,rt=.25,Yt=8,At=1024,be=1,xe=1,Ve=3,lt=["fontFamily","fontWeight","characterSet","fontSize","sdf","buffer","cutoff","radius"];function Pe(){for(var ne=[],se=32;se<128;se++)ne.push(String.fromCharCode(se));return ne}function dt(ne,se,k,G){ne.font="".concat(G," ").concat(k,"px ").concat(se),ne.fillStyle="black",ne.textBaseline="middle"}function w(ne,se){for(var k=0;k<ne.length;k++)se.data[4*k+3]=ne[k]}var I=(st=Object(z.injectable)(),st(Le=(ut=function(){function ne(){Y()(this,ne),this.fontAtlas=void 0,this.iconFontGlyphs={},this.fontOptions=void 0,this.key=void 0,this.cache=new ye.b(Ve)}return Ze()(ne,[{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:Ce,fontWeight:Ee,characterSet:H,fontSize:Ae,buffer:ge,sdf:!0,cutoff:rt,radius:Yt},this.key=""}},{key:"addIconGlyphs",value:function(k){var G=this;k.forEach(function(_e){G.iconFontGlyphs[_e.name]=_e.unicode})}},{key:"getGlyph",value:function(k){return this.iconFontGlyphs[k]?String.fromCharCode(parseInt(this.iconFontGlyphs[k],16)):""}},{key:"setFontOptions",value:function(k){this.fontOptions=Q(Q({},this.fontOptions),k),this.key=this.getKey();var G=this.getNewChars(this.key,this.fontOptions.characterSet),_e=this.cache.get(this.key);if(_e&&G.length===0)return;var ot=this.generateFontAtlas(this.key,G,_e);this.fontAtlas=ot,this.cache.set(this.key,ot)}},{key:"destroy",value:function(){this.cache.clear()}},{key:"generateFontAtlas",value:function(k,G,_e){var ot=this.fontOptions,Xt=ot.fontFamily,rr=ot.fontWeight,tr=ot.fontSize,Dr=ot.buffer,tn=ot.sdf,Vn=ot.radius,ta=ot.cutoff,oa=_e&&_e.data;oa||(oa=document.createElement("canvas"),oa.width=At);var Ya=oa.getContext("2d");dt(Ya,Xt,tr,rr);var za=_t(Q({getFontWidth:function(pc){return Ya.measureText(pc).width},fontHeight:tr*xe,buffer:Dr,characterSet:G,maxCanvasWidth:At},_e&&{mapping:_e.mapping,xOffset:_e.xOffset,yOffset:_e.yOffset})),Ni=za.mapping,Fa=za.canvasHeight,Gi=za.xOffset,Qo=za.yOffset;if(oa.height!==Fa){var Qi=Ya.getImageData(0,0,oa.width,oa.height);oa.height=Fa,Ya.putImageData(Qi,0,0)}if(dt(Ya,Xt,tr,rr),tn){var oi=new pt.a(tr,Dr,Vn,ta,Xt,rr),Ts=Ya.getImageData(0,0,oi.size,oi.size),ki=Vt(G),yo;try{for(ki.s();!(yo=ki.n()).done;){var us=yo.value;w(oi.draw(us),Ts),Ya.putImageData(Ts,Ni[us].x,Ni[us].y)}}catch(Ro){ki.e(Ro)}finally{ki.f()}}else{var yi=Vt(G),fo;try{for(yi.s();!(fo=yi.n()).done;){var Ta=fo.value;Ya.fillText(Ta,Ni[Ta].x,Ni[Ta].y+tr*be)}}catch(Ro){yi.e(Ro)}finally{yi.f()}}return{xOffset:Gi,yOffset:Qo,mapping:Ni,data:oa,width:oa.width,height:oa.height}}},{key:"getKey",value:function(){var k=this.fontOptions,G=k.fontFamily,_e=k.fontWeight,ot=k.fontSize,Xt=k.buffer,rr=k.sdf,tr=k.radius,Dr=k.cutoff;return rr?"".concat(G," ").concat(_e," ").concat(ot," ").concat(Xt," ").concat(tr," ").concat(Dr):"".concat(G," ").concat(_e," ").concat(ot," ").concat(Xt)}},{key:"getNewChars",value:function(k,G){var _e=this.cache.get(k);if(!_e)return G;var ot=[],Xt=_e.mapping,rr=new Set(Object.keys(Xt)),tr=new Set(G);return tr.forEach(function(Dr){rr.has(Dr)||ot.push(Dr)}),ot}},{key:"scale",get:function(){return xe}},{key:"canvas",get:function(){var k=this.cache.get(this.key);return k&&k.data}},{key:"mapping",get:function(){var k=this.cache.get(this.key);return k&&k.mapping}}]),ne}(),ut))||Le),q=i("7W2i"),ce=i.n(q),Ge=i("a1gu"),$e=i.n(Ge),yt=i("Nsbk"),nt=i.n(yt),Nt,$,Ke;function ae(ne){var se=et();return function(){var G=nt()(ne),_e;if(se){var ot=nt()(this).constructor;_e=Reflect.construct(G,arguments,ot)}else _e=G.apply(this,arguments);return $e()(this,_e)}}function et(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var jt=3,sr=1024,ft=64,mt=(Nt=Object(z.injectable)(),Nt($=(Ke=function(ne){ce()(k,ne);var se=ae(k);function k(){var G;Y()(this,k);for(var _e=arguments.length,ot=new Array(_e),Xt=0;Xt<_e;Xt++)ot[Xt]=arguments[Xt];return G=se.call.apply(se,[this].concat(ot)),G.canvasHeight=void 0,G.texture=void 0,G.canvas=void 0,G.iconData=void 0,G.iconMap=void 0,G.ctx=void 0,G}return Ze()(k,[{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(_e,ot){var Xt=this,rr=new Image;if(this.hasImage(_e))throw new Error("Image Id already exists");this.iconData.push({id:_e,width:ft,height:ft}),this.updateIconMap(),this.loadImage(ot).then(function(tr){rr=tr;var Dr=Xt.iconData.find(function(tn){return tn.id===_e});Dr&&(Dr.image=rr),Xt.update()})}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(_e){return this.iconMap.hasOwnProperty(_e)}},{key:"removeImage",value:function(_e){this.hasImage(_e)&&(this.iconData=this.iconData.filter(function(ot){return ot.id!==_e}),delete this.iconMap[_e],this.update())}},{key:"destroy",value:function(){this.iconData=[],this.iconMap={}}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var _e=this;this.canvas.width=sr,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(function(ot){var Xt=_e.iconMap[ot],rr=Xt.x,tr=Xt.y,Dr=Xt.image;Dr&&_e.ctx.drawImage(Dr,rr,tr,ft,ft)})}},{key:"updateIconMap",value:function(){var _e=Ne(this.iconData,jt,sr),ot=_e.mapping,Xt=_e.canvasHeight;this.iconMap=ot,this.canvasHeight=Xt}},{key:"loadImage",value:function(_e){return new Promise(function(ot,Xt){if(_e instanceof HTMLImageElement){ot(_e);return}var rr=new Image;rr.crossOrigin="anonymous",rr.onload=function(){ot(rr)},rr.onerror=function(){Xt(new Error("Could not load image at "+_e))},rr.src=_e instanceof File?URL.createObjectURL(_e):_e})}}]),k}(m.EventEmitter),Ke))||$),Ct=i("J4zp"),vt=i.n(Ct),Oe=i("IOcx"),ct,Qe,Ft,vr=(ct=Object(z.injectable)(),ct(Qe=(Ft=function(){function ne(){Y()(this,ne),this.viewport=void 0,this.overridedViewProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0,this.jitteredProjectionMatrix=void 0,this.viewMatrixInverse=void 0,this.cameraPosition=void 0}return Ze()(ne,[{key:"init",value:function(){}},{key:"update",value:function(k){this.viewport=k,this.viewMatrixInverse=Oe.b.invert(Oe.b.create(),this.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var k=this.viewport.getCenter(),G=vt()(k,2),_e=G[0],ot=G[1];return[_e,ot]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(k,G){return this.viewport.projectFlat(k,G)}},{key:"setViewProjectionMatrix",value:function(k){this.overridedViewProjectionMatrix=k}},{key:"jitterProjectionMatrix",value:function(k,G){var _e=Oe.b.fromTranslation(Oe.b.create(),[k,G,0]);this.jitteredProjectionMatrix=Oe.b.multiply(Oe.b.create(),_e,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=Oe.b.multiply(Oe.b.create(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),ne}(),Ft))||Qe),Vr,lr,Nn;function vn(ne,se){var k;if(typeof Symbol=="undefined"||ne[Symbol.iterator]==null){if(Array.isArray(ne)||(k=na(ne))||se&&ne&&typeof ne.length=="number"){k&&(ne=k);var G=0,_e=function(){};return{s:_e,n:function(){return G>=ne.length?{done:!0}:{done:!1,value:ne[G++]}},e:function(Dr){throw Dr},f:_e}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ot=!0,Xt=!1,rr;return{s:function(){k=ne[Symbol.iterator]()},n:function(){var Dr=k.next();return ot=Dr.done,Dr},e:function(Dr){Xt=!0,rr=Dr},f:function(){try{!ot&&k.return!=null&&k.return()}finally{if(Xt)throw rr}}}}function na(ne,se){if(!ne)return;if(typeof ne=="string")return ha(ne,se);var k=Object.prototype.toString.call(ne).slice(8,-1);if(k==="Object"&&ne.constructor&&(k=ne.constructor.name),k==="Map"||k==="Set")return Array.from(ne);if(k==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(k))return ha(ne,se)}function ha(ne,se){(se==null||se>ne.length)&&(se=ne.length);for(var k=0,G=new Array(se);k<se;k++)G[k]=ne[k];return G}var Zn=(Vr=Object(z.injectable)(),Vr(lr=(Nn=function(){function ne(){Y()(this,ne),this.container=void 0,this.controlCorners=void 0,this.controlContainer=void 0,this.scene=void 0,this.mapsService=void 0,this.controls=[],this.unAddControls=[]}return Ze()(ne,[{key:"init",value:function(k,G){this.container=k.container,this.scene=G,this.mapsService=G.get(D.a.IMapService),this.initControlPos()}},{key:"addControl",value:function(k,G){var _e=G.get(D.a.IMapService);_e.map?(k.addTo(this.scene),this.controls.push(k)):this.unAddControls.push(k)}},{key:"getControlByName",value:function(k){return this.controls.find(function(G){return G.controlOption.name===k})}},{key:"removeControl",value:function(k){var G=this.controls.indexOf(k);return G>-1&&this.controls.splice(G,1),k.remove(),this}},{key:"addControls",value:function(){var k=this;this.unAddControls.forEach(function(G){G.addTo(k.scene),k.controls.push(G)}),this.unAddControls=[]}},{key:"destroy",value:function(){var k=vn(this.controls),G;try{for(k.s();!(G=k.n()).done;){var _e=G.value;_e.remove()}}catch(ot){k.e(ot)}finally{k.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var k=this.controlCorners={},G="l7-",_e=this.controlContainer=ye.a.create("div",G+"control-container",this.container);function ot(Xt,rr){var tr=G+Xt+" "+G+rr;k[Xt+rr]=ye.a.create("div",tr,_e)}ot("top","left"),ot("top","right"),ot("bottom","left"),ot("bottom","right")}},{key:"clearControlPos",value:function(){for(var k in this.controlCorners)this.controlCorners[k]&&ye.a.remove(this.controlCorners[k]);this.controlContainer&&ye.a.remove(this.controlContainer),delete this.controlCorners,delete this.controlContainer}}]),ne}(),Nn))||lr),Hn,F,W,le=(Hn=Object(z.injectable)(),Hn(F=(W=function(){function ne(){Y()(this,ne),this.container=void 0,this.scene=void 0,this.mapsService=void 0,this.markers=[],this.markerLayers=[],this.unAddMarkers=[],this.unAddMarkerLayers=[]}return Ze()(ne,[{key:"addMarkerLayer",value:function(k){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(k),k.addTo(this.scene)):this.unAddMarkerLayers.push(k)}},{key:"removeMarkerLayer",value:function(k){k.destroy(),this.markerLayers.indexOf(k);var G=this.markerLayers.indexOf(k);G>-1&&this.markerLayers.splice(G,1)}},{key:"addMarker",value:function(k){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(k),k.addTo(this.scene)):this.unAddMarkers.push(k)}},{key:"addMarkers",value:function(){var k=this;this.unAddMarkers.forEach(function(G){G.addTo(k.scene),k.markers.push(G)}),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var k=this;this.unAddMarkerLayers.forEach(function(G){k.markerLayers.push(G),G.addTo(k.scene)}),this.unAddMarkers=[]}},{key:"removeMarker",value:function(k){k.remove(),this.markers.indexOf(k);var G=this.markers.indexOf(k);G>-1&&this.markers.splice(G,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(k){this.scene=k,this.mapsService=k.get(D.a.IMapService)}},{key:"destroy",value:function(){this.markers.forEach(function(k){k.remove()}),this.markers=[],this.markerLayers.forEach(function(k){k.destroy()}),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(k){k.destroy()}}]),ne}(),W))||F),me,at,bt,He=(me=Object(z.injectable)(),me(at=(bt=function(){function ne(){Y()(this,ne),this.scene=void 0,this.popup=void 0,this.mapsService=void 0,this.unAddPopup=void 0}return Ze()(ne,[{key:"removePopup",value:function(k){k.remove()}},{key:"destroy",value:function(){this.popup.remove()}},{key:"addPopup",value:function(k){this.popup&&this.popup.remove(),this.mapsService.map&&this.mapsService.getMarkerContainer()?(k.addTo(this.scene),this.popup=k):this.unAddPopup=k}},{key:"initPopup",value:function(){this.unAddPopup&&(this.addPopup(this.unAddPopup),this.unAddPopup=null)}},{key:"init",value:function(k){this.scene=k,this.mapsService=k.get(D.a.IMapService)}}]),ne}(),bt))||at),ht=i("QkVN"),Qt=i.n(ht),qt={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo\u6D4B\u8BD5\u5730\u56FEtoken\uFF0C\u5982\u679C\u751F\u4EA7\u73AF\u5883\u4E2D\u4F7F\u7528\u53BB\u5BF9\u5E94\u5730\u56FE\u8BF7\u6CE8\u518CToken",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"},Nr=qt,qr,or,Br;function Tn(ne,se){var k=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(_e){return Object.getOwnPropertyDescriptor(ne,_e).enumerable})),k.push.apply(k,G)}return k}function dr(ne){for(var se=1;se<arguments.length;se++){var k=arguments[se]!=null?arguments[se]:{};se%2?Tn(Object(k),!0).forEach(function(G){re()(ne,G,k[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(k)):Tn(Object(k)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(k,G))})}return ne}var Xr={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},dn={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",selectColor:"blue",enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15}},Kn=(qr=Object(z.injectable)(),qr(or=(Br=function(){function ne(){Y()(this,ne),this.sceneConfigCache={},this.layerConfigCache={}}return Ze()(ne,[{key:"getSceneConfig",value:function(k){return this.sceneConfigCache[k]}},{key:"getSceneWarninfo",value:function(k){return Nr[k]}},{key:"setSceneConfig",value:function(k,G){this.sceneConfigCache[k]=dr(dr({},Xr),G)}},{key:"getLayerConfig",value:function(k){return this.layerConfigCache[k]}},{key:"setLayerConfig",value:function(k,G,_e){this.layerConfigCache[G]=dr({},Qt()({},this.sceneConfigCache[k],dn,_e))}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),ne}(),Br))||or),gn=i("yG8O"),ur=i.n(gn),kn=i("U+yc"),An=i.n(kn),Za=i("1ABj"),ea=Math.PI/180,ca=512,bo=4003e4;function Ri(ne){var se=ne.latitude,k=se===void 0?0:se,G=ne.zoom,_e=G===void 0?0:G,ot=ne.scale,Xt=ne.highPrecision,rr=Xt===void 0?!1:Xt,tr=ne.flipY,Dr=tr===void 0?!1:tr;ot=ot!==void 0?ot:Math.pow(2,_e);var tn={},Vn=ca*ot,ta=Math.cos(k*ea),oa=Vn/360,Ya=oa/ta,za=Vn/bo/ta;if(tn.pixelsPerMeter=[za,-za,za],tn.metersPerPixel=[1/za,-1/za,1/za],tn.pixelsPerDegree=[oa,-Ya,za],tn.degreesPerPixel=[1/oa,-1/Ya,1/za],rr){var Ni=ea*Math.tan(k*ea)/ta,Fa=oa*Ni/2,Gi=Vn/bo*Ni,Qo=Gi/Ya*za;tn.pixelsPerDegree2=[0,-Fa,Gi],tn.pixelsPerMeter2=[Qo,0,Qo],Dr&&(tn.pixelsPerDegree2[1]=-tn.pixelsPerDegree2[1],tn.pixelsPerMeter2[1]=-tn.pixelsPerMeter2[1])}return Dr&&(tn.pixelsPerMeter[1]=-tn.pixelsPerMeter[1],tn.metersPerPixel[1]=-tn.metersPerPixel[1],tn.pixelsPerDegree[1]=-tn.pixelsPerDegree[1],tn.degreesPerPixel[1]=-tn.degreesPerPixel[1]),tn}var va=i("HthE"),ii,Ia,Ln,Ei,Wi,qa,Oo=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Ml=(ii=Object(z.injectable)(),Ia=Object(z.inject)(D.a.ICameraService),ii(Ln=(Ei=(qa=function(){function ne(){Y()(this,ne),this.needRefresh=!0,ur()(this,"cameraService",Wi,this),this.coordinateSystem=void 0,this.viewportCenter=void 0,this.viewportCenterProjection=void 0,this.pixelsPerDegree=void 0,this.pixelsPerDegree2=void 0,this.pixelsPerMeter=void 0}return Ze()(ne,[{key:"refresh",value:function(){var k=this.cameraService.getZoom(),G=this.cameraService.getZoomScale(),_e=this.cameraService.getCenter(),ot=Ri({latitude:_e[1],zoom:k}),Xt=ot.pixelsPerMeter,rr=ot.pixelsPerDegree;this.viewportCenter=_e,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=Xt,this.pixelsPerDegree=rr,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===va.a.LNGLAT||this.coordinateSystem===va.a.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===va.a.LNGLAT_OFFSET?this.calculateLnglatOffset(_e,k):this.coordinateSystem===va.a.P20_OFFSET&&this.calculateLnglatOffset(_e,k,G,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(k){this.coordinateSystem=k}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(k,G,_e,ot){var Xt=Ri({latitude:k[1],zoom:G,scale:_e,flipY:ot,highPrecision:!0}),rr=Xt.pixelsPerMeter,tr=Xt.pixelsPerDegree,Dr=Xt.pixelsPerDegree2,tn=this.cameraService.getViewMatrix(),Vn=this.cameraService.getProjectionMatrix(),ta=Oe.b.multiply([],Vn,tn),oa=this.cameraService.projectFlat([Math.fround(k[0]),Math.fround(k[1])],Math.pow(2,G));this.viewportCenterProjection=Oe.e.transformMat4([],[oa[0],oa[1],0,1],ta),tn=this.cameraService.getViewMatrixUncentered()||tn,ta=Oe.b.multiply([],Vn,tn),ta=Oe.b.multiply([],ta,Oo),this.cameraService.setViewProjectionMatrix(ta),this.pixelsPerMeter=rr,this.pixelsPerDegree=tr,this.pixelsPerDegree2=Dr}}]),ne}(),qa),Wi=An()(Ei.prototype,"cameraService",[Ia],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ei))||Ln),cu=i("PJYZ"),fa=i.n(cu),Cs=i("yLV6"),oo=i.n(Cs),Na=i("V1cb"),Fu,Ai,li,xo,ms,so,Uu,Ys;function Eo(ne){var se=fu();return function(){var G=nt()(ne),_e;if(se){var ot=nt()(this).constructor;_e=Reflect.construct(G,arguments,ot)}else _e=G.apply(this,arguments);return $e()(this,_e)}}function fu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Ut={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancle"},Ie=(Fu=Object(z.injectable)(),Ai=Object(z.inject)(D.a.IMapService),li=Object(z.inject)(D.a.ILogService),Fu(xo=(ms=(Ys=function(ne){ce()(k,ne);var se=Eo(k);function k(){var G;Y()(this,k);for(var _e=arguments.length,ot=new Array(_e),Xt=0;Xt<_e;Xt++)ot[Xt]=arguments[Xt];return G=se.call.apply(se,[this].concat(ot)),ur()(G,"mapService",so,fa()(G)),ur()(G,"logger",Uu,fa()(G)),G.hammertime=void 0,G.lastClickTime=0,G.lastClickXY=[-1,-1],G.clickTimer=void 0,G.$containter=void 0,G.onDrag=function(rr){var tr=G.interactionEvent(rr);tr.type=Ut[tr.type],G.emit(Na.a.Drag,tr)},G.onHammer=function(rr){rr.srcEvent.stopPropagation();var tr=G.interactionEvent(rr);G.emit(Na.a.Hover,tr)},G.onTouch=function(rr){var tr=rr.touches[0];G.onHover({x:tr.pageX,y:tr.pageY,type:"touch"})},G.onHover=function(rr){var tr=rr.clientX,Dr=rr.clientY,tn=tr,Vn=Dr,ta=rr.type,oa=G.mapService.getMapContainer();if(oa){var Ya=oa.getBoundingClientRect(),za=Ya.top,Ni=Ya.left;tn=tn-Ni-oa.clientLeft,Vn=Vn-za-oa.clientTop}var Fa=G.mapService.containerToLngLat([tn,Vn]);if(ta==="click"){if("ontouchstart"in document.documentElement===!0)return;G.isDoubleTap(tn,Vn,Fa);return}if(ta==="touch"){G.isDoubleTap(tn,Vn,Fa);return}ta!=="click"&&ta!=="dblclick"&&G.emit(Na.a.Hover,{x:tn,y:Vn,lngLat:Fa,type:ta,target:rr})},G}return Ze()(k,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(Na.a.Hover)}},{key:"triggerHover",value:function(_e){var ot=_e.x,Xt=_e.y;this.emit(Na.a.Hover,{x:ot,y:Xt})}},{key:"triggerSelect",value:function(_e){this.emit(Na.a.Select,{featureId:_e})}},{key:"triggerActive",value:function(_e){this.emit(Na.a.Active,{featureId:_e})}},{key:"addEventListenerOnMap",value:function(){var _e=this.mapService.getMapContainer();if(_e){var ot=new oo.a.Manager(_e);ot.add(new oo.a.Tap({event:"dblclick",taps:2})),ot.add(new oo.a.Tap({event:"click"})),ot.add(new oo.a.Pan({threshold:0,pointers:0})),ot.add(new oo.a.Press({})),ot.on("dblclick click",this.onHammer),ot.on("panstart panmove panend pancancel",this.onDrag),_e.addEventListener("mousemove",this.onHover),_e.addEventListener("mousedown",this.onHover),_e.addEventListener("mouseup",this.onHover),_e.addEventListener("contextmenu",this.onHover),this.hammertime=ot,this.logger.debug("add event listeners on canvas")}}},{key:"removeEventListenerOnMap",value:function(){var _e=this.mapService.getMapContainer();_e&&(_e.removeEventListener("mousemove",this.onHover),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),_e.removeEventListener("mousedown",this.onHover),_e.removeEventListener("mouseup",this.onHover),_e.removeEventListener("contextmenu",this.onHover))}},{key:"interactionEvent",value:function(_e){var ot=_e.type,Xt=_e.pointerType,rr,tr;Xt==="touch"?(tr=Math.floor(_e.pointers[0].clientY),rr=Math.floor(_e.pointers[0].clientX)):(tr=Math.floor(_e.srcEvent.y),rr=Math.floor(_e.srcEvent.x));var Dr=this.mapService.getMapContainer();if(Dr){var tn=Dr.getBoundingClientRect(),Vn=tn.top,ta=tn.left;rr-=ta,tr-=Vn}var oa=this.mapService.containerToLngLat([rr,tr]);return{x:rr,y:tr,lngLat:oa,type:ot,target:_e.srcEvent}}},{key:"isDoubleTap",value:function(_e,ot,Xt){var rr=this,tr=new Date().getTime(),Dr="click";tr-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-_e)<10&&Math.abs(this.lastClickXY[1]-ot)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),Dr="dblclick",this.emit(Na.a.Hover,{x:_e,y:ot,lngLat:Xt,type:Dr})):(this.lastClickTime=tr,this.lastClickXY=[_e,ot],this.clickTimer=setTimeout(function(){Dr="click",rr.emit(Na.a.Hover,{x:_e,y:ot,lngLat:Xt,type:Dr})},400))}}]),k}(X.a),Ys),so=An()(ms.prototype,"mapService",[Ai],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Uu=An()(ms.prototype,"logger",[li],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ms))||xo),Mt=i("o0o1"),cr=i.n(Mt),en=i("yXPU"),bn=i.n(en),jn=i("o+pz"),Fi,qi,Mo,To,tl,ql,Ks,jc,vs,Bu,ws,_o;function Po(ne,se){var k=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(_e){return Object.getOwnPropertyDescriptor(ne,_e).enumerable})),k.push.apply(k,G)}return k}function $s(ne){for(var se=1;se<arguments.length;se++){var k=arguments[se]!=null?arguments[se]:{};se%2?Po(Object(k),!0).forEach(function(G){re()(ne,G,k[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(k)):Po(Object(k)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(k,G))})}return ne}var bl=(Fi=Object(z.injectable)(),qi=Object(z.inject)(D.a.IRendererService),Mo=Object(z.inject)(D.a.IGlobalConfigService),To=Object(z.inject)(D.a.IInteractionService),tl=Object(z.inject)(D.a.ILayerService),Fi(ql=(Ks=(_o=function(){function ne(){var se=this;Y()(this,ne),ur()(this,"rendererService",jc,this),ur()(this,"configService",vs,this),ur()(this,"interactionService",Bu,this),ur()(this,"layerService",ws,this),this.pickingFBO=void 0,this.width=0,this.height=0,this.alreadyInPicking=!1,this.pickBufferScale=1,this.pickFromPickingFBO=function(k,G){var _e,ot=G.x,Xt=G.y,rr=G.lngLat,tr=G.type,Dr=G.target,tn=!1,Vn=se.rendererService,ta=Vn.getViewportSize,oa=Vn.readPixels,Ya=Vn.getContainer,za=Ya().getBoundingClientRect(),Ni=za.width,Fa=za.height;Ni*=window.devicePixelRatio,Fa*=window.devicePixelRatio;var Gi=k.getLayerConfig(),Qo=Gi.enableHighlight,Qi=Gi.enableSelect,oi=ot*window.devicePixelRatio,Ts=Xt*window.devicePixelRatio;if(oi>Ni-1*window.devicePixelRatio||oi<0||Ts>Fa-1*window.devicePixelRatio||Ts<0)return!1;var ki;if(ki=oa({x:Math.floor(oi/se.pickBufferScale),y:Math.floor((Fa-(Xt+1)*window.devicePixelRatio)/se.pickBufferScale),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:se.pickingFBO}),ki[0]!==0||ki[1]!==0||ki[2]!==0){var yo=Object(ye.k)(ki),us=k.getSource().getFeatureById(yo);yo!==k.getCurrentPickId()&&tr==="mousemove"&&(tr="mouseenter");var yi={x:ot,y:Xt,type:tr,lngLat:rr,featureId:yo,feature:us,target:Dr};us&&(tn=!0,k.setCurrentPickId(yo),se.triggerHoverOnLayer(k,yi))}else{var fo={x:ot,y:Xt,lngLat:rr,type:k.getCurrentPickId()!==null&&tr==="mousemove"?"mouseout":"un"+tr,featureId:null,target:Dr,feature:null};se.triggerHoverOnLayer(k,$s($s({},fo),{},{type:"unpick"})),se.triggerHoverOnLayer(k,fo),k.setCurrentPickId(null)}if(Qo&&se.highlightPickedFeature(k,ki),Qi&&tr==="click"&&((_e=ki)===null||_e===void 0?void 0:_e.toString())!==[0,0,0,0].toString()){var Ta=Object(ye.k)(ki);k.getCurrentSelectedId()===null||Ta!==k.getCurrentSelectedId()?(se.selectFeature(k,ki),k.setCurrentSelectedId(Ta)):(se.selectFeature(k,new Uint8Array([0,0,0,0])),k.setCurrentSelectedId(null))}return tn}}return Ze()(ne,[{key:"init",value:function(k){var G=this.rendererService,_e=G.createTexture2D,ot=G.createFramebuffer,Xt=G.getViewportSize,rr=G.getContainer,tr=rr().getBoundingClientRect(),Dr=tr.width,tn=tr.height;Dr*=window.devicePixelRatio,tn*=window.devicePixelRatio,this.pickBufferScale=this.configService.getSceneConfig(k).pickBufferScale||1,this.pickingFBO=ot({color:_e({width:Math.round(Dr/this.pickBufferScale),height:Math.round(tn/this.pickBufferScale),wrapS:jn.a.CLAMP_TO_EDGE,wrapT:jn.a.CLAMP_TO_EDGE})}),this.interactionService.on(Na.a.Hover,this.pickingAllLayer.bind(this))}},{key:"pickingAllLayer",value:function(){var se=bn()(cr.a.mark(function G(_e){return cr.a.wrap(function(Xt){for(;;)switch(Xt.prev=Xt.next){case 0:if(!(this.alreadyInPicking||this.layerService.alreadyInRendering)){Xt.next=2;break}return Xt.abrupt("return");case 2:return this.alreadyInPicking=!0,Xt.next=5,this.pickingLayers(_e);case 5:this.layerService.renderLayers(),this.alreadyInPicking=!1;case 7:case"end":return Xt.stop()}},G,this)}));function k(G){return se.apply(this,arguments)}return k}()},{key:"pickingLayers",value:function(){var se=bn()(cr.a.mark(function G(_e){var ot=this,Xt,rr,tr,Dr,tn,Vn,ta,oa;return cr.a.wrap(function(za){for(;;)switch(za.prev=za.next){case 0:Xt=this.rendererService,rr=Xt.getViewportSize,tr=Xt.useFramebuffer,Dr=Xt.clear,tn=Xt.getContainer,Vn=tn().getBoundingClientRect(),ta=Vn.width,oa=Vn.height,ta*=window.devicePixelRatio,oa*=window.devicePixelRatio,(this.width!==ta||this.height!==oa)&&(this.pickingFBO.resize({width:Math.round(ta/this.pickBufferScale),height:Math.round(oa/this.pickBufferScale)}),this.width=ta,this.height=oa),tr(this.pickingFBO,function(){var Ni=ot.layerService.getLayers();Ni.filter(function(Fa){return Fa.needPick(_e.type)}).reverse().some(function(Fa){Dr({framebuffer:ot.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),Fa.hooks.beforePickingEncode.call(),Fa.renderModels(),Fa.hooks.afterPickingEncode.call();var Gi=ot.pickFromPickingFBO(Fa,_e);return Gi&&!Fa.getLayerConfig().enablePropagation})});case 6:case"end":return za.stop()}},G,this)}));function k(G){return se.apply(this,arguments)}return k}()},{key:"triggerHoverOnLayer",value:function(k,G){k.emit(G.type,G)}},{key:"highlightPickedFeature",value:function(k,G){var _e=vt()(G,3),ot=_e[0],Xt=_e[1],rr=_e[2];k.hooks.beforeHighlight.call([ot,Xt,rr])}},{key:"selectFeature",value:function(k,G){var _e=vt()(G,3),ot=_e[0],Xt=_e[1],rr=_e[2];k.hooks.beforeSelect.call([ot,Xt,rr])}}]),ne}(),_o),jc=An()(Ks.prototype,"rendererService",[qi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vs=An()(Ks.prototype,"configService",[Mo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bu=An()(Ks.prototype,"interactionService",[To],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ws=An()(Ks.prototype,"layerService",[tl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ks))||ql),Su=function(){function ne(){var se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;Y()(this,ne),this.autoStart=void 0,this.startTime=0,this.oldTime=0,this.running=!1,this.elapsedTime=0,this.autoStart=se}return Ze()(ne,[{key:"start",value:function(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var k=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var G=(typeof performance=="undefined"?Date:performance).now();k=(G-this.oldTime)/1e3,this.oldTime=G,this.elapsedTime+=k}return k}}]),ne}(),ka,hu,ec,Js,ns,wt,er,Ar,Bn=(ka=Object(z.injectable)(),hu=Object(z.inject)(D.a.IRendererService),ec=Object(z.inject)(D.a.IGlobalConfigService),ka(Js=(ns=(Ar=function(){function ne(){Y()(this,ne),this.clock=new Su,this.alreadyInRendering=!1,this.layers=[],this.layerRenderID=void 0,this.sceneInited=!1,this.animateInstanceCount=0,ur()(this,"renderService",wt,this),ur()(this,"configService",er,this)}return Ze()(ne,[{key:"add",value:function(k){this.sceneInited&&k.init(),this.layers.push(k)}},{key:"initLayers",value:function(){this.sceneInited=!0,this.layers.forEach(function(k){k.inited||k.init()})}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(k){return this.layers.find(function(G){return G.id===k})}},{key:"getLayerByName",value:function(k){return this.layers.find(function(G){return G.name===k})}},{key:"remove",value:function(k){var G=this.layers.indexOf(k);G>-1&&this.layers.splice(G,1),k.emit("remove",null),k.destroy(),this.renderLayers()}},{key:"removeAllLayers",value:function(){this.destroy()}},{key:"renderLayers",value:function(){if(this.alreadyInRendering)return;this.alreadyInRendering=!0,this.clear(),this.updateRenderOrder(),this.layers.filter(function(k){return k.inited}).filter(function(k){return k.isVisible()}).forEach(function(k){k.hooks.beforeRenderData.call(),k.hooks.beforeRender.call(),k.render(),k.hooks.afterRender.call()}),this.alreadyInRendering=!1}},{key:"updateRenderOrder",value:function(){this.layers.sort(function(k,G){return k.zIndex-G.zIndex})}},{key:"destroy",value:function(){this.layers.forEach(function(k){return k.destroy()}),this.layers=[],this.renderLayers()}},{key:"startAnimate",value:function(){this.animateInstanceCount++===0&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){--this.animateInstanceCount===0&&(this.stopRender(),this.clock.stop())}},{key:"clear",value:function(){this.renderService.clear({color:[0,0,0,0],depth:1,stencil:0,framebuffer:null})}},{key:"runRender",value:function(){this.renderLayers(),this.layerRenderID=requestAnimationFrame(this.runRender.bind(this))}},{key:"stopRender",value:function(){cancelAnimationFrame(this.layerRenderID)}}]),ne}(),Ar),wt=An()(ns.prototype,"renderService",[hu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),er=An()(ns.prototype,"configService",[ec],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ns))||Js),Qa=i("QILm"),Ii=i.n(Qa),Ki=i("RIqP"),ja=i.n(Ki),pi=i("J2iB"),Zo=i.n(pi),Ci=function(){function ne(se){var k=this;Y()(this,ne),this.name=void 0,this.type=void 0,this.scale=void 0,this.descriptor=void 0,this.featureBufferLayout=[],this.needRescale=!1,this.needRemapping=!1,this.needRegenerateVertices=!1,this.featureRange={startIndex:0,endIndex:Infinity},this.vertexAttribute=void 0,this.defaultCallback=function(G){if(G.length===0){var _e;return((_e=k.scale)===null||_e===void 0?void 0:_e.defaultValues)||[]}return G.map(function(ot,Xt){var rr,tr=(rr=k.scale)===null||rr===void 0?void 0:rr.scalers[Xt].func,Dr=tr(ot);return Dr})},this.setProps(se)}return Ze()(ne,[{key:"setProps",value:function(k){Object.assign(this,k)}},{key:"mapping",value:function(k){var G;if((G=this.scale)===null||G===void 0?void 0:G.callback){var _e,ot=(_e=this.scale)===null||_e===void 0?void 0:_e.callback.apply(_e,ja()(k));if(!Zo()(ot))return[ot]}return this.defaultCallback(k)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),ne}(),Xo,Au,du,Ds,xl,Qs,rl;function qs(ne,se){var k=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(_e){return Object.getOwnPropertyDescriptor(ne,_e).enumerable})),k.push.apply(k,G)}return k}function Vu(ne){for(var se=1;se<arguments.length;se++){var k=arguments[se]!=null?arguments[se]:{};se%2?qs(Object(k),!0).forEach(function(G){re()(ne,G,k[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(k)):qs(Object(k)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(k,G))})}return ne}function tc(ne){return new Promise(function(se){return setTimeout(se,ne)})}var vc=(Xo={},re()(Xo,jn.a.FLOAT,4),re()(Xo,jn.a.UNSIGNED_BYTE,1),re()(Xo,jn.a.UNSIGNED_SHORT,2),Xo),gc=(Au=Object(z.injectable)(),du=Object(z.inject)(D.a.IRendererService),Au(Ds=(xl=(rl=function(){function ne(){Y()(this,ne),this.attributesAndIndices=void 0,ur()(this,"rendererService",Qs,this),this.attributes=[],this.triangulation=void 0,this.featureLayout={sizePerElement:0,elements:[]}}return Ze()(ne,[{key:"registerStyleAttribute",value:function(k){var G=this.getLayerStyleAttribute(k.name||"");return G?G.setProps(k):(G=new Ci(k),this.attributes.push(G)),G}},{key:"updateStyleAttribute",value:function(k,G,_e){var ot=this.getLayerStyleAttribute(k);ot||(ot=this.registerStyleAttribute(Vu(Vu({},G),{},{name:k})));var Xt=G.scale;Xt&&ot&&(ot.scale=Xt,ot.needRescale=!0,ot.needRemapping=!0,ot.needRegenerateVertices=!0,_e&&_e.featureRange&&(ot.featureRange=_e.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(k){return this.attributes.find(function(G){return G.name===k})}},{key:"getLayerAttributeScale",value:function(k){var G,_e=this.getLayerStyleAttribute(k),ot=_e==null||((G=_e.scale)===null||G===void 0)?void 0:G.scalers;return ot&&ot[0]?ot[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(k,G){var _e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,ot=arguments.length>3?arguments[3]:void 0,Xt=this.attributes.find(function(Qi){return Qi.name===k});if(Xt&&Xt.descriptor){var rr=Xt.descriptor,tr=rr.update,Dr=rr.buffer,tn=rr.size,Vn=tn===void 0?0:tn,ta=vc[Dr.type||jn.a.FLOAT];if(tr){var oa=this.featureLayout,Ya=oa.elements,za=oa.sizePerElement,Ni=Ya.slice(_e,ot);if(!Ni.length)return;var Fa=Ni[0].offset,Gi=Fa*Vn*ta,Qo=Ni.map(function(Qi,oi){for(var Ts=Qi.featureIdx,ki=Qi.vertices,yo=Qi.normals,us=ki.length/za,yi=[],fo=0;fo<us;fo++){var Ta=yo?yo.slice(fo*3,fo*3+3):[];yi.push.apply(yi,ja()(tr(G[Ts],Ts,ki.slice(fo*za,fo*za+za),oi,Ta)))}return yi}).reduce(function(Qi,oi){return Qi.push.apply(Qi,ja()(oi)),Qi},[]);Xt.vertexAttribute.updateBuffer({data:Qo,offset:Gi})}}}},{key:"createAttributesAndIndices",value:function(k,G){var _e=this;this.featureLayout={sizePerElement:0,elements:[]},G&&(this.triangulation=G);var ot=this.attributes.map(function(Fa){return Fa.resetDescriptor(),Fa.descriptor}),Xt=0,rr=[],tr=[],Dr=[],tn=3;k.forEach(function(Fa,Gi){var Qo=_e.triangulation(Fa),Qi=Qo.indices,oi=Qo.vertices,Ts=Qo.normals,ki=Qo.size;Qi.forEach(function(fo){tr.push(fo+Xt)}),tn=ki;var yo=oi.length/ki;_e.featureLayout.sizePerElement=tn,_e.featureLayout.elements.push({featureIdx:Gi,vertices:oi,normals:Ts,offset:Xt}),Xt+=yo;for(var us=function(Ta){var Ro=(Ts==null?void 0:Ts.slice(Ta*3,Ta*3+3))||[],pc=oi.slice(Ta*ki,Ta*ki+ki);ot.forEach(function(zf,Gs){if(zf&&zf.update){var ah;(ah=zf.buffer.data).push.apply(ah,ja()(zf.update(Fa,Gi,pc,Ta,Ro)))}})},yi=0;yi<yo;yi++)us(yi)});var Vn=this.rendererService,ta=Vn.createAttribute,oa=Vn.createBuffer,Ya=Vn.createElements,za={};ot.forEach(function(Fa,Gi){if(Fa){var Qo=Fa.buffer,Qi=Fa.update,oi=Fa.name,Ts=Ii()(Fa,["buffer","update","name"]),ki=ta(Vu({buffer:oa(Qo)},Ts));za[Fa.name||""]=ki,_e.attributes[Gi].vertexAttribute=ki}});var Ni=Ya({data:tr,type:jn.a.UNSIGNED_INT,count:tr.length});return this.attributesAndIndices={attributes:za,elements:Ni},this.attributesAndIndices}},{key:"clearAllAttributes",value:function(){var k;this.attributes.forEach(function(G){G.vertexAttribute&&G.vertexAttribute.destroy()}),(k=this.attributesAndIndices)===null||k===void 0||k.elements.destroy(),this.attributes=[]}}]),ne}(),rl),Qs=An()(xl.prototype,"rendererService",[du],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xl))||Ds),Ui=i("U8pU"),zc=i("KQm4"),yc=i("rePB"),nf=i("1OyB"),af=i("vuIU"),of=i("5ku3"),Ti=typeof __VERSION__!="undefined"?__VERSION__:"untranspiled source",Cu=Object(of.a)();function pu(ne){try{var se=window[ne],k="__storage_test__";return se.setItem(k,k),se.removeItem(k),se}catch(G){return null}}var eu=function(){function ne(se,k){var G=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";Object(nf.a)(this,ne),this.storage=pu(G),this.id=se,this.config={},Object.assign(this.config,k),this._loadConfiguration()}return Object(af.a)(ne,[{key:"getConfiguration",value:function(){return this.config}},{key:"setConfiguration",value:function(k){return this.config={},this.updateConfiguration(k)}},{key:"updateConfiguration",value:function(k){if(Object.assign(this.config,k),this.storage){var G=JSON.stringify(this.config);this.storage.setItem(this.id,G)}return this}},{key:"_loadConfiguration",value:function(){var k={};if(this.storage){var G=this.storage.getItem(this.id);k=G?JSON.parse(G):{}}return Object.assign(this.config,k),this}}]),ne}();function Fc(ne){var se;return ne<10?se="".concat(ne.toFixed(2),"ms"):ne<100?se="".concat(ne.toFixed(1),"ms"):ne<1e3?se="".concat(ne.toFixed(0),"ms"):se="".concat((ne/1e3).toFixed(2),"s"),se}function rc(ne){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8,k=Math.max(se-ne.length,0);return"".concat(" ".repeat(k)).concat(ne)}function mu(ne){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8,k=Math.max(se-ne.length,0);return"".concat(ne).concat(" ".repeat(k))}function Uc(ne){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},k=1e-16,G=se.isInteger,_e=G===void 0?!1:G;if(Array.isArray(ne)||ArrayBuffer.isView(ne))return nl(ne,se);if(!Number.isFinite(ne))return String(ne);if(Math.abs(ne)<k)return _e?"0":"0.";if(_e)return ne.toFixed(0);if(Math.abs(ne)>100&&Math.abs(ne)<1e4)return ne.toFixed(0);var ot=ne.toPrecision(2),Xt=ot.indexOf(".0");return Xt===ot.length-2?ot.slice(0,-1):ot}function nl(ne,se){for(var k=se.maxElts,G=k===void 0?16:k,_e=se.size,ot=_e===void 0?1:_e,Xt="[",rr=0;rr<ne.length&&rr<G;++rr)rr>0&&(Xt+=",".concat(rr%ot===0?" ":"")),Xt+=Uc(ne[rr],se);var tr=ne.length>G?"...":"]";return"".concat(Xt).concat(tr)}function tu(ne,se,k){var G=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600,_e=ne.src.replace(/\(/g,"%28").replace(/\)/g,"%29");ne.width>G&&(k=Math.min(k,G/ne.width));var ot=ne.width*k,Xt=ne.height*k,rr=["font-size:1px;","padding:".concat(Math.floor(Xt/2),"px ").concat(Math.floor(ot/2),"px;"),"line-height:".concat(Xt,"px;"),"background:url(".concat(_e,");"),"background-size:".concat(ot,"px ").concat(Xt,"px;"),"color:transparent;"].join("");return["".concat(se," %c+"),rr]}var nc={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function bc(ne){return typeof ne=="string"?nc[ne.toUpperCase()]||nc.WHITE:ne}function mi(ne,se,k){return!Cu&&typeof ne=="string"&&(se&&(se=bc(se),ne="[".concat(se,"m").concat(ne,"[39m")),k&&(se=bc(k),ne="[".concat(k+10,"m").concat(ne,"[49m"))),ne}function xc(ne){if(typeof Symbol=="undefined"||ne[Symbol.iterator]==null){if(Array.isArray(ne)||(ne=Rf(ne))){var se=0,k=function(){};return{s:k,n:function(){return se>=ne.length?{done:!0}:{done:!1,value:ne[se++]}},e:function(tr){throw tr},f:k}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var G,_e=!0,ot=!1,Xt;return{s:function(){G=ne[Symbol.iterator]()},n:function(){var tr=G.next();return _e=tr.done,tr},e:function(tr){ot=!0,Xt=tr},f:function(){try{!_e&&G.return!=null&&G.return()}finally{if(ot)throw Xt}}}}function Rf(ne,se){if(!ne)return;if(typeof ne=="string")return Ec(ne,se);var k=Object.prototype.toString.call(ne).slice(8,-1);if(k==="Object"&&ne.constructor&&(k=ne.constructor.name),k==="Map"||k==="Set")return Array.from(k);if(k==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(k))return Ec(ne,se)}function Ec(ne,se){(se==null||se>ne.length)&&(se=ne.length);for(var k=0,G=new Array(se);k<se;k++)G[k]=ne[k];return G}function If(ne){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"],k=Object.getPrototypeOf(ne),G=Object.getOwnPropertyNames(k),_e=xc(G),ot;try{var Xt=function(){var tr=ot.value;typeof ne[tr]=="function"&&(se.find(function(Dr){return tr===Dr})||(ne[tr]=ne[tr].bind(ne)))};for(_e.s();!(ot=_e.n()).done;)Xt()}catch(rr){_e.e(rr)}finally{_e.f()}}function Bc(ne,se){if(!ne)throw new Error(se||"Assertion failed")}var Pl=i("K9nA");function al(){var ne;if(Cu&&Pl.b.performance)ne=Pl.b.performance.now();else if(Pl.a.hrtime){var se=Pl.a.hrtime();ne=se[0]*1e3+se[1]/1e6}else ne=Date.now();return ne}var Os={debug:Cu&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},ac={enabled:!0,level:0};function No(){}var Ll={},El={once:!0};function Vc(ne){for(var se in ne)for(var k in ne[se])return k||"untitled";return"empty"}var Rl=function(){function ne(){var se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},k=se.id;Object(nf.a)(this,ne),this.id=k,this.VERSION=Ti,this._startTs=al(),this._deltaTs=al(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new eu("__probe-".concat(this.id,"__"),ac),this.userData={},this.timeStamp("".concat(this.id," started")),If(this),Object.seal(this)}return Object(af.a)(ne,[{key:"isEnabled",value:function(){return this._storage.config.enabled}},{key:"getLevel",value:function(){return this._storage.config.level}},{key:"getTotal",value:function(){return Number((al()-this._startTs).toPrecision(10))}},{key:"getDelta",value:function(){return Number((al()-this._deltaTs).toPrecision(10))}},{key:"getPriority",value:function(){return this.level}},{key:"enable",value:function(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.updateConfiguration({enabled:k}),this}},{key:"setLevel",value:function(k){return this._storage.updateConfiguration({level:k}),this}},{key:"assert",value:function(k,G){Bc(k,G)}},{key:"warn",value:function(k){return this._getLogFunction(0,k,Os.warn,arguments,El)}},{key:"error",value:function(k){return this._getLogFunction(0,k,Os.error,arguments)}},{key:"deprecated",value:function(k,G){return this.warn("`".concat(k,"` is deprecated and will be removed in a later version. Use `").concat(G,"` instead"))}},{key:"removed",value:function(k,G){return this.error("`".concat(k,"` has been removed. Use `").concat(G,"` instead"))}},{key:"probe",value:function(k,G){return this._getLogFunction(k,G,Os.log,arguments,{time:!0,once:!0})}},{key:"log",value:function(k,G){return this._getLogFunction(k,G,Os.debug,arguments)}},{key:"info",value:function(k,G){return this._getLogFunction(k,G,console.info,arguments)}},{key:"once",value:function(k,G){return this._getLogFunction(k,G,Os.debug||Os.info,arguments,El)}},{key:"table",value:function(k,G,_e){return G?this._getLogFunction(k,G,console.table||No,_e&&[_e],{tag:Vc(G)}):No}},{key:"image",value:function(k){var G=k.logLevel,_e=k.priority,ot=k.image,Xt=k.message,rr=Xt===void 0?"":Xt,tr=k.scale,Dr=tr===void 0?1:tr;return this._shouldLog(G||_e)?Cu?Il({image:ot,message:rr,scale:Dr}):xf({image:ot,message:rr,scale:Dr}):No}},{key:"settings",value:function(){console.table?console.table(this._storage.config):console.log(this._storage.config)}},{key:"get",value:function(k){return this._storage.config[k]}},{key:"set",value:function(k,G){this._storage.updateConfiguration(Object(yc.a)({},k,G))}},{key:"time",value:function(k,G){return this._getLogFunction(k,G,console.time?console.time:console.info)}},{key:"timeEnd",value:function(k,G){return this._getLogFunction(k,G,console.timeEnd?console.timeEnd:console.info)}},{key:"timeStamp",value:function(k,G){return this._getLogFunction(k,G,console.timeStamp||No)}},{key:"group",value:function(k,G){var _e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};_e=Gc({logLevel:k,message:G,opts:_e});var ot=_e,Xt=ot.collapsed;return _e.method=(Xt?console.groupCollapsed:console.group)||console.info,this._getLogFunction(_e)}},{key:"groupCollapsed",value:function(k,G){var _e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(k,G,Object.assign({},_e,{collapsed:!0}))}},{key:"groupEnd",value:function(k){return this._getLogFunction(k,"",console.groupEnd||No)}},{key:"withGroup",value:function(k,G,_e){this.group(k,G)();try{_e()}finally{this.groupEnd(k)()}}},{key:"trace",value:function(){console.trace&&console.trace()}},{key:"_shouldLog",value:function(k){return this.isEnabled()&&this.getLevel()>=ru(k)}},{key:"_getLogFunction",value:function(k,G,_e){var ot=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],Xt=arguments.length>4?arguments[4]:void 0;if(this._shouldLog(k)){var rr;Xt=Gc({logLevel:k,message:G,args:ot,opts:Xt}),_e=_e||Xt.method,Bc(_e),Xt.total=this.getTotal(),Xt.delta=this.getDelta(),this._deltaTs=al();var tr=Xt.tag||Xt.message;if(Xt.once)if(!Ll[tr])Ll[tr]=al();else return No;return G=bf(this.id,Xt.message,Xt),(rr=_e).bind.apply(rr,[console,G].concat(Object(zc.a)(Xt.args)))}return No}},{key:"level",set:function(k){this.setLevel(k)},get:function(){return this.getLevel()}},{key:"priority",set:function(k){this.level=k},get:function(){return this.level}}]),ne}();Rl.VERSION=Ti;function ru(ne){if(!ne)return 0;var se;switch(Object(Ui.a)(ne)){case"number":se=ne;break;case"object":se=ne.logLevel||ne.priority||0;break;default:return 0}return Bc(Number.isFinite(se)&&se>=0),se}function Gc(ne){var se=ne.logLevel,k=ne.message;ne.logLevel=ru(se);for(var G=ne.args?Array.from(ne.args):[];G.length&&G.shift()!==k;);ne.args=G;switch(Object(Ui.a)(se)){case"string":case"function":k!==void 0&&G.unshift(k),ne.message=se;break;case"object":Object.assign(ne,se);break;default:}typeof ne.message=="function"&&(ne.message=ne.message());var _e=Object(Ui.a)(ne.message);return Bc(_e==="string"||_e==="object"),Object.assign(ne,ne.opts)}function bf(ne,se,k){if(typeof se=="string"){var G=k.time?rc(Fc(k.total)):"";se=k.time?"".concat(ne,": ").concat(G,"  ").concat(se):"".concat(ne,": ").concat(se),se=mi(se,k.color,k.background)}return se}function xf(ne){var se=ne.image,k=ne.message,G=k===void 0?"":k,_e=ne.scale,ot=_e===void 0?1:_e,Xt=null;try{Xt=i(2)}catch(rr){}return Xt?function(){return Xt(se,{fit:"box",width:"".concat(Math.round(80*ot),"%")}).then(function(rr){return console.log(rr)})}:No}function Il(ne){var se=ne.image,k=ne.message,G=k===void 0?"":k,_e=ne.scale,ot=_e===void 0?1:_e;if(typeof se=="string"){var Xt=new Image;return Xt.onload=function(){var tn,Vn=tu(Xt,G,ot);(tn=console).log.apply(tn,Object(zc.a)(Vn))},Xt.src=se,No}var rr=se.nodeName||"";if(rr.toLowerCase()==="img"){var tr;return(tr=console).log.apply(tr,Object(zc.a)(tu(se,G,ot))),No}if(rr.toLowerCase()==="canvas"){var Dr=new Image;return Dr.onload=function(){var tn;return(tn=console).log.apply(tn,Object(zc.a)(tu(Dr,G,ot)))},Dr.src=se.toDataURL(),No}return No}var ic,Zi,Dl=new Rl({id:"L7"}).enable(!1);Dl.priority=5;var Gu=(ic=Object(z.injectable)(),ic(Zi=function(){function ne(){Y()(this,ne)}return Ze()(ne,[{key:"error",value:function(k){Dl.error(k)()}},{key:"warn",value:function(k){Dl.probe(1,k)()}},{key:"info",value:function(k){Dl.info(3,k)()}},{key:"debug",value:function(k){Dl.probe(4,k)()}}]),ne}())||Zi),Ef=i("xp6e"),Nl=i("iegG"),oc=i.n(Nl),Wf=window.document.documentElement.style,Df=0;function Tc(ne){var se=ne;if(typeof ne=="string"&&(se=document.getElementById(ne)),se){var k=document.createElement("div");return k.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,k.id="l7-scene-".concat(Df++),k.classList.add("l7-scene"),se.appendChild(k),k}return null}var kl,_c,wu,Ns,il,Tl,sc,Bi,vu,ol,Yo,ei,$a,Hu,ti,Xa,Tf,_f,Ko,Wu,gs,ks,ys,$o,Zu,xn,bs,nu,Sc,Ou,Mu,gu,Zr,vi,Hc,Wc;function sl(ne){var se=Pu();return function(){var G=nt()(ne),_e;if(se){var ot=nt()(this).constructor;_e=Reflect.construct(G,arguments,ot)}else _e=G.apply(this,arguments);return $e()(this,_e)}}function Pu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Ms=(kl=Object(z.injectable)(),_c=Object(z.inject)(D.a.SceneID),wu=Object(z.inject)(D.a.IIconService),Ns=Object(z.inject)(D.a.IFontService),il=Object(z.inject)(D.a.IControlService),Tl=Object(z.inject)(D.a.ILogService),sc=Object(z.inject)(D.a.IGlobalConfigService),Bi=Object(z.inject)(D.a.IMapService),vu=Object(z.inject)(D.a.ICoordinateSystemService),ol=Object(z.inject)(D.a.IRendererService),Yo=Object(z.inject)(D.a.ILayerService),ei=Object(z.inject)(D.a.ICameraService),$a=Object(z.inject)(D.a.IInteractionService),Hu=Object(z.inject)(D.a.IPickingService),ti=Object(z.inject)(D.a.IShaderModuleService),Xa=Object(z.inject)(D.a.IMarkerService),Tf=Object(z.inject)(D.a.IPopupService),kl(_f=(Ko=(Wc=function(ne){ce()(k,ne);var se=sl(k);function k(){var G;return Y()(this,k),G=se.call(this),G.destroyed=!1,G.loaded=!1,ur()(G,"id",Wu,fa()(G)),ur()(G,"iconService",gs,fa()(G)),ur()(G,"fontService",ks,fa()(G)),ur()(G,"controlService",ys,fa()(G)),ur()(G,"logger",$o,fa()(G)),ur()(G,"configService",Zu,fa()(G)),ur()(G,"map",xn,fa()(G)),ur()(G,"coordinateSystemService",bs,fa()(G)),ur()(G,"rendererService",nu,fa()(G)),ur()(G,"layerService",Sc,fa()(G)),ur()(G,"cameraService",Ou,fa()(G)),ur()(G,"interactionService",Mu,fa()(G)),ur()(G,"pickingService",gu,fa()(G)),ur()(G,"shaderModuleService",Zr,fa()(G)),ur()(G,"markerService",vi,fa()(G)),ur()(G,"popupService",Hc,fa()(G)),G.inited=!1,G.initPromise=void 0,G.rendering=!1,G.$container=void 0,G.canvas=void 0,G.markerContainer=void 0,G.hooks=void 0,G.handleWindowResized=function(){G.emit("resize"),G.$container&&(G.initContainer(),ye.a.triggerResize(),G.coordinateSystemService.needRefresh=!0,G.render())},G.handleMapCameraChanged=function(_e){G.cameraService.update(_e),G.render()},G.hooks={init:new Ef.a},G}return Ze()(k,[{key:"init",value:function(_e){var ot=this;this.configService.setSceneConfig(this.id,_e),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.fontService.init(),this.hooks.init.tapPromise("initMap",bn()(cr.a.mark(function Xt(){return cr.a.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return tr.next=2,new Promise(function(Dr){ot.map.onCameraChanged(function(tn){ot.cameraService.init(),ot.cameraService.update(tn),Dr()}),ot.map.init()});case 2:ot.map.onCameraChanged(ot.handleMapCameraChanged),ot.map.addMarkerContainer(),ot.markerService.addMarkers(),ot.markerService.addMarkerLayers(),ot.popupService.initPopup(),ot.interactionService.init(),ot.interactionService.on(Na.a.Drag,ot.addSceneEvent.bind(ot)),ot.logger.debug("map ".concat(ot.id," loaded"));case 10:case"end":return tr.stop()}},Xt)}))),this.hooks.init.tapPromise("initRenderer",bn()(cr.a.mark(function Xt(){var rr;return cr.a.wrap(function(Dr){for(;;)switch(Dr.prev=Dr.next){case 0:if(rr=Tc(ot.configService.getSceneConfig(ot.id).id||""),ot.$container=rr,!rr){Dr.next=11;break}return ot.canvas=ye.a.create("canvas","",rr),ot.setCanvas(),Dr.next=7,ot.rendererService.init(ot.canvas,ot.configService.getSceneConfig(ot.id));case 7:oc()(ot.$container,ot.handleWindowResized),window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)").addListener(ot.handleWindowResized),Dr.next=12;break;case 11:ot.logger.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 12:ot.pickingService.init(ot.id),ot.logger.debug("scene ".concat(ot.id," renderer loaded"));case 14:case"end":return Dr.stop()}},Xt)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(_e){this.logger.debug("add layer ".concat(_e.name," to scene ").concat(this.id)),this.layerService.add(_e),this.render()}},{key:"render",value:function(){var G=bn()(cr.a.mark(function ot(){return cr.a.wrap(function(rr){for(;;)switch(rr.prev=rr.next){case 0:if(!(this.rendering||this.destroyed)){rr.next=2;break}return rr.abrupt("return");case 2:if(this.rendering=!0,this.inited){rr.next=13;break}return rr.next=6,this.initPromise;case 6:this.destroyed&&this.destroy(),this.logger.info(" render inited"),this.layerService.initLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0;case 13:this.layerService.renderLayers(),this.logger.debug("scene ".concat(this.id," render")),this.rendering=!1;case 16:case"end":return rr.stop()}},ot,this)}));function _e(){return G.apply(this,arguments)}return _e}()},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(_e){var ot,Xt=(ot=this.$container)===null||ot===void 0?void 0:ot.getElementsByTagName("canvas")[0];this.render();var rr=_e==="jpg"?Xt==null?void 0:Xt.toDataURL("image/jpeg"):Xt==null?void 0:Xt.toDataURL("image/png");return rr}},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"addMarkerContainer",value:function(){var _e=this.$container.parentElement;_e!==null&&(this.markerContainer=ye.a.create("div","l7-marker-container",_e))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){if(!this.inited){this.destroyed=!0;return}this.emit("destroy"),this.layerService.destroy(),this.rendererService.destroy(),this.map.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.removeAllListeners(),this.inited=!1,Object(Nl.unbind)(this.$container,this.handleWindowResized),window.matchMedia("screen and (min-resolution: 2dppx)").removeListener(this.handleWindowResized)}},{key:"initContainer",value:function(){var _e,ot,Xt=window.devicePixelRatio,rr=((_e=this.$container)===null||_e===void 0?void 0:_e.clientWidth)||400,tr=((ot=this.$container)===null||ot===void 0?void 0:ot.clientHeight)||300,Dr=this.canvas;Dr&&(Dr.width=rr*Xt,Dr.height=tr*Xt,Dr.style.width="".concat(rr,"px"),Dr.style.height="".concat(tr,"px")),this.rendererService.viewport({x:0,y:0,width:Xt*rr,height:Xt*tr})}},{key:"setCanvas",value:function(){var _e,ot,Xt=window.devicePixelRatio,rr=((_e=this.$container)===null||_e===void 0?void 0:_e.clientWidth)||400,tr=((ot=this.$container)===null||ot===void 0?void 0:ot.clientHeight)||300,Dr=this.canvas;Dr.width=rr*Xt,Dr.height=tr*Xt,Dr.style.width="".concat(rr,"px"),Dr.style.height="".concat(tr,"px")}},{key:"addSceneEvent",value:function(_e){this.emit(_e.type,_e)}}]),k}(m.EventEmitter),Wc),Wu=An()(Ko.prototype,"id",[_c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gs=An()(Ko.prototype,"iconService",[wu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ks=An()(Ko.prototype,"fontService",[Ns],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ys=An()(Ko.prototype,"controlService",[il],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$o=An()(Ko.prototype,"logger",[Tl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zu=An()(Ko.prototype,"configService",[sc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xn=An()(Ko.prototype,"map",[Bi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bs=An()(Ko.prototype,"coordinateSystemService",[vu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nu=An()(Ko.prototype,"rendererService",[ol],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sc=An()(Ko.prototype,"layerService",[Yo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ou=An()(Ko.prototype,"cameraService",[ei],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mu=An()(Ko.prototype,"interactionService",[$a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gu=An()(Ko.prototype,"pickingService",[Hu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zr=An()(Ko.prototype,"shaderModuleService",[ti],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vi=An()(Ko.prototype,"markerService",[Xa],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hc=An()(Ko.prototype,"popupService",[Tf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ko))||_f),as=i("7tbW"),wi=i.n(as);function js(ne){var se=0;switch(ne){case"vec2":case"ivec2":se=2;break;case"vec3":case"ivec3":se=3;break;case"vec4":case"ivec4":case"mat2":se=4;break;case"mat3":se=9;break;case"mat4":se=16;break;default:}return se}var sf=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function ul(ne){var se={};return ne=ne.replace(sf,function(k,G,_e){var ot=_e.split(":"),Xt=ot[0].trim(),rr="";ot.length>1&&(rr=ot[1].trim());switch(G){case"bool":rr=rr==="true";break;case"float":case"int":rr=Number(rr);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":rr?rr=rr.replace("[","").replace("]","").split(",").reduce(function(tr,Dr){return tr.push(Number(Dr.trim())),tr},[]):rr=new Array(js(G)).fill(0);break;default:}return se[Xt]=rr,"uniform ".concat(G," ").concat(Xt,`;
`)}),{content:ne,uniforms:se}}var jl,uf,uc;function uo(ne,se){var k=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(_e){return Object.getOwnPropertyDescriptor(ne,_e).enumerable})),k.push.apply(k,G)}return k}function ci(ne){for(var se=1;se<arguments.length;se++){var k=arguments[se]!=null?arguments[se]:{};se%2?uo(Object(k),!0).forEach(function(G){re()(ne,G,k[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(k)):uo(Object(k)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(k,G))})}return ne}var mo="#define PI 3.14159265359",ll=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,gi=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,Ps=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}

// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {
//   vec3 lightDir = normalize(light.position - fragPos);
//   // diffuse shading
//   float diff = max(dot(normal, lightDir), 0.0);
//   // specular shading
//   vec3 reflectDir = reflect(-lightDir, normal);
//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);
//   // attenuation
//   float distance = length(light.position - fragPos);
//   float attenuation = 1.0 / (light.constant + light.linear * distance +
//           light.quadratic * (distance * distance));

//   vec3 ambient = light.ambient * u_Ambient;
//   vec3 diffuse = light.diffuse * diff * u_Diffuse;
//   vec3 specular = light.specular * spec * u_Specular;

//   float spotEffect = dot(normalize(light.direction), -lightDir);
//   float spotCosCutoff = cos(light.angle / 180.0 * PI);
//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);
//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);
//   if (spotEffect > spotCosCutoff) {
//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);
//   } else {
//     spotEffect = 0.0;
//   }

//   return ambient + attenuation * (spotEffect * diffuse + specular);
// }

vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {
  //   if (i >= u_NumOfSpotLights) {
  //     break;
  //   }
  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);
  // }
  return weight;
}
`,cl=`varying vec4 v_PickingResult;
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color) {
  bool selected = bool(v_PickingResult.a);

  if (selected) {
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(resultRGB, color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  return filterPickingColor(filterHighlightColor(color));
}
`,au=`attribute vec3 a_PickingColor;
varying vec4 v_PickingResult;

uniform vec3 u_PickingColor : [0, 0, 0];
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_PickingThreshold : 1.0;
uniform float u_PickingBuffer: 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

bool isVertexPicked(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;
}

void setPickingColor(vec3 pickingColor) {
  // compares only in highlight stage
  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}
`,ko=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}
`,_l=`#define TILE_SIZE 512.0
#define PI 3.1415926536
#define WORLD_SCALE TILE_SIZE / (PI * 2.0)

#define COORDINATE_SYSTEM_LNGLAT 1.0
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0
#define COORDINATE_SYSTEM_P20_OFFSET 6.0
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

uniform mat4 u_ViewMatrix;
uniform mat4 u_ProjectionMatrix;
uniform mat4 u_ViewProjectionMatrix;
uniform float u_Zoom : 1;
uniform float u_ZoomScale : 1;

uniform float u_CoordinateSystem;
uniform vec2 u_ViewportCenter;
uniform vec4 u_ViewportCenterProjection;
uniform vec3 u_PixelsPerDegree;
uniform vec3 u_PixelsPerDegree2;
uniform vec3 u_PixelsPerMeter;

uniform vec2 u_ViewportSize;
uniform float u_DevicePixelRatio;
uniform float u_FocalDistance;
uniform vec3 u_CameraPosition;

// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
  float x = lnglat.x;
  return vec2(
    radians(x) + PI,
    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))
  );
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}


// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1., 1.);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01
    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}
// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01
// reverse Y
vec3 reverse_offset_normal(vec3 vector) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {
    return vector * vec3(1.0, -1.0, 1.0);
  }
  return vector;
}

vec4 project_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(vec4(X, Y, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return vec4(
      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),
      project_scale(position.z),
      position.w
    );
  }
  return position;

  // TODO: \u74E6\u7247\u5750\u6807\u7CFB & \u5E38\u89C4\u4E16\u754C\u5750\u6807\u7CFB
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}

float project_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  return pixel;
}
vec2 project_pixel(vec2 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  return pixel * -1.;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }
  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
     pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}


bool isEqual( float a,  float b) {
    return  a< b + 0.001 && a > b - 0.001;
}

`,Qn=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,ua=/precision\s+(high|low|medium)p\s+float/,lo=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,zl=/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,zs=(jl=Object(z.injectable)(),jl(uf=(uc=function(){function ne(){Y()(this,ne),this.moduleCache={},this.rawContentCache={}}return Ze()(ne,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:mo,fs:mo}),this.registerModule("decode",{vs:ll,fs:""}),this.registerModule("projection",{vs:_l,fs:""}),this.registerModule("project",{vs:ko,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:Qn}),this.registerModule("lighting",{vs:Ps,fs:""}),this.registerModule("light",{vs:gi,fs:""}),this.registerModule("picking",{vs:au,fs:cl})}},{key:"registerModule",value:function(k,G){if(this.rawContentCache[k])return;var _e=G.vs,ot=G.fs,Xt=G.uniforms,rr=ul(_e),tr=rr.content,Dr=rr.uniforms,tn=ul(ot),Vn=tn.content,ta=tn.uniforms;this.rawContentCache[k]={fs:Vn,uniforms:ci(ci(ci({},Dr),ta),Xt),vs:tr}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(k){var G=this;if(this.moduleCache[k])return this.moduleCache[k];var _e=this.rawContentCache[k].vs,ot=this.rawContentCache[k].fs,Xt=this.processModule(_e,[],"vs"),rr=Xt.content,tr=Xt.includeList,Dr=this.processModule(ot,[],"fs"),tn=Dr.content,Vn=Dr.includeList,ta=tn,oa=wi()(tr.concat(Vn).concat(k)).reduce(function(Ya,za){return ci(ci({},Ya),G.rawContentCache[za].uniforms)},{});return ua.test(tn)||(ta=lo+tn),this.moduleCache[k]={fs:ta.trim(),uniforms:oa,vs:rr.trim()},this.moduleCache[k]}},{key:"processModule",value:function(k,G,_e){var ot=this,Xt=k.replace(zl,function(rr,tr){var Dr=tr.split(" "),tn=Dr[0].replace(/"/g,"");if(G.indexOf(tn)>-1)return"";var Vn=ot.rawContentCache[tn][_e];G.push(tn);var ta=ot.processModule(Vn,G,_e),oa=ta.content;return oa});return{content:Xt,includeList:G}}}]),ne}(),uc))||uf),Di=i("iWIM"),is=i.n(Di),Zc=i("bPkA"),Fs,_i,Si,Xu,yu,Fl,lc=(Fs=Object(z.injectable)(),_i=Object(z.inject)(D.a.IShaderModuleService),Fs(Si=(Xu=(Fl=function(){function ne(){Y()(this,ne),ur()(this,"shaderModuleService",yu,this),this.rendererService=void 0,this.cameraService=void 0,this.mapService=void 0,this.interactionService=void 0,this.layerService=void 0,this.config=void 0}return Ze()(ne,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return Zc.a.Normal}},{key:"init",value:function(k,G){this.config=G,this.rendererService=k.getContainer().get(D.a.IRendererService),this.cameraService=k.getContainer().get(D.a.ICameraService),this.mapService=k.getContainer().get(D.a.IMapService),this.interactionService=k.getContainer().get(D.a.IInteractionService),this.layerService=k.getContainer().get(D.a.ILayerService)}},{key:"render",value:function(k){}}]),ne}(),Fl),yu=An()(Xu.prototype,"shaderModuleService",[_i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xu))||Si),Lu,os;function Yu(ne){var se=bu();return function(){var G=nt()(ne),_e;if(se){var ot=nt()(this).constructor;_e=Reflect.construct(G,arguments,ot)}else _e=G.apply(this,arguments);return $e()(this,_e)}}function bu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Sf=(Lu=Object(z.injectable)(),Lu(os=function(ne){ce()(k,ne);var se=Yu(k);function k(){return Y()(this,k),se.apply(this,arguments)}return Ze()(k,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(_e,ot){is()(nt()(k.prototype),"init",this).call(this,_e,ot)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),k}(lc))||os),Ul,Xc,lf,iu,Sl,xu;function cc(ne,se){var k;if(typeof Symbol=="undefined"||ne[Symbol.iterator]==null){if(Array.isArray(ne)||(k=Ru(ne))||se&&ne&&typeof ne.length=="number"){k&&(ne=k);var G=0,_e=function(){};return{s:_e,n:function(){return G>=ne.length?{done:!0}:{done:!1,value:ne[G++]}},e:function(Dr){throw Dr},f:_e}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ot=!0,Xt=!1,rr;return{s:function(){k=ne[Symbol.iterator]()},n:function(){var Dr=k.next();return ot=Dr.done,Dr},e:function(Dr){Xt=!0,rr=Dr},f:function(){try{!ot&&k.return!=null&&k.return()}finally{if(Xt)throw rr}}}}function Ru(ne,se){if(!ne)return;if(typeof ne=="string")return fl(ne,se);var k=Object.prototype.toString.call(ne).slice(8,-1);if(k==="Object"&&ne.constructor&&(k=ne.constructor.name),k==="Map"||k==="Set")return Array.from(ne);if(k==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(k))return fl(ne,se)}function fl(ne,se){(se==null||se>ne.length)&&(se=ne.length);for(var k=0,G=new Array(se);k<se;k++)G[k]=ne[k];return G}var hl=(Ul=Object(z.injectable)(),Xc=Object(z.inject)(D.a.IPostProcessor),Ul(lf=(iu=(xu=function(){function ne(){Y()(this,ne),this.passes=[],ur()(this,"postProcessor",Sl,this),this.layer=void 0,this.renderFlag=void 0,this.width=0,this.height=0}return Ze()(ne,[{key:"setLayer",value:function(k){this.layer=k}},{key:"setRenderFlag",value:function(k){this.renderFlag=k}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:function(){var se=bn()(cr.a.mark(function G(){var _e,ot,Xt;return cr.a.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:_e=cc(this.passes),tr.prev=1,_e.s();case 3:if((ot=_e.n()).done){tr.next=9;break}return Xt=ot.value,tr.next=7,Xt.render(this.layer);case 7:tr.next=3;break;case 9:tr.next=14;break;case 11:tr.prev=11,tr.t0=tr.catch(1),_e.e(tr.t0);case 14:return tr.prev=14,_e.f(),tr.finish(14);case 17:this.layer.renderModels();case 18:case"end":return tr.stop()}},G,this,[[1,11,14,17]])}));function k(){return se.apply(this,arguments)}return k}()},{key:"resize",value:function(k,G){(this.width!==k||this.height!==G)&&(this.width=k,this.height=G)}},{key:"add",value:function(k,G){k.getType()===Zc.a.PostProcessing?this.postProcessor.add(k,this.layer,G):(k.init(this.layer,G),this.passes.push(k))}},{key:"insert",value:function(k,G,_e){k.init(this.layer,G),this.passes.splice(_e,0,k)}},{key:"destroy",value:function(){this.passes.length=0}}]),ne}(),xu),Sl=An()(iu.prototype,"postProcessor",[Xc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iu))||lf),Ls,Bl,Yc,Vl,s,a;function n(ne,se){var k=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(_e){return Object.getOwnPropertyDescriptor(ne,_e).enumerable})),k.push.apply(k,G)}return k}function l(ne){for(var se=1;se<arguments.length;se++){var k=arguments[se]!=null?arguments[se]:{};se%2?n(Object(k),!0).forEach(function(G){re()(ne,G,k[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(k)):n(Object(k)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(k,G))})}return ne}function b(ne){var se=O();return function(){var G=nt()(ne),_e;if(se){var ot=nt()(this).constructor;_e=Reflect.construct(G,arguments,ot)}else _e=G.apply(this,arguments);return $e()(this,_e)}}function O(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var R=(Ls=Object(z.injectable)(),Bl=Object(z.inject)(D.a.ILogService),Ls(Yc=(Vl=(a=function(ne){ce()(k,ne);var se=b(k);function k(){var G;Y()(this,k);for(var _e=arguments.length,ot=new Array(_e),Xt=0;Xt<_e;Xt++)ot[Xt]=arguments[Xt];return G=se.call.apply(se,[this].concat(ot)),ur()(G,"logger",s,fa()(G)),G.pickingFBO=void 0,G.layer=void 0,G.width=0,G.height=0,G.alreadyInRendering=!1,G.pickFromPickingFBO=function(rr){var tr=rr.x,Dr=rr.y,tn=rr.lngLat,Vn=rr.type;if(!G.layer.isVisible()||!G.layer.needPick(Vn))return;var ta=G.rendererService,oa=ta.getViewportSize,Ya=ta.readPixels,za=ta.useFramebuffer,Ni=oa(),Fa=Ni.width,Gi=Ni.height,Qo=G.layer.getLayerConfig(),Qi=Qo.enableHighlight,oi=Qo.enableSelect,Ts=tr*window.devicePixelRatio,ki=Dr*window.devicePixelRatio;if(Ts>Fa||Ts<0||ki>Gi||ki<0)return;var yo;za(G.pickingFBO,function(){var us;if(yo=Ya({x:Math.round(Ts),y:Math.round(Gi-(Dr+1)*window.devicePixelRatio),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:G.pickingFBO}),yo[0]!==0||yo[1]!==0||yo[2]!==0){G.logger.debug("picked");var yi=Object(ye.k)(yo),fo=G.layer.getSource().getFeatureById(yi),Ta={x:tr,y:Dr,type:Vn,lngLat:tn,featureId:yi,feature:fo};fo&&(G.layer.setCurrentPickId(yi),G.triggerHoverOnLayer(Ta))}else{var Ro={x:tr,y:Dr,lngLat:tn,type:G.layer.getCurrentPickId()===null?"un"+Vn:"mouseout",featureId:null,feature:null};G.triggerHoverOnLayer(l(l({},Ro),{},{type:"unpick"})),G.triggerHoverOnLayer(Ro),G.layer.setCurrentPickId(null)}Qi&&G.highlightPickedFeature(yo),oi&&Vn==="click"&&((us=yo)===null||us===void 0?void 0:us.toString())!==[0,0,0,0].toString()&&G.selectFeature(yo)})},G}return Ze()(k,[{key:"getType",value:function(){return Zc.a.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(_e,ot){is()(nt()(k.prototype),"init",this).call(this,_e,ot),this.layer=_e;var Xt=this.rendererService,rr=Xt.createTexture2D,tr=Xt.createFramebuffer,Dr=Xt.getViewportSize,tn=Dr(),Vn=tn.width,ta=tn.height;this.pickingFBO=tr({color:rr({width:Vn,height:ta,wrapS:jn.a.CLAMP_TO_EDGE,wrapT:jn.a.CLAMP_TO_EDGE})}),this.interactionService.on(Na.a.Hover,this.pickFromPickingFBO),this.interactionService.on(Na.a.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(Na.a.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(_e){var ot=this;if(this.alreadyInRendering)return;var Xt=this.rendererService,rr=Xt.getViewportSize,tr=Xt.useFramebuffer,Dr=Xt.clear,tn=rr(),Vn=tn.width,ta=tn.height;this.alreadyInRendering=!0,(this.width!==Vn||this.height!==ta)&&(this.pickingFBO.resize({width:Vn,height:ta}),this.width=Vn,this.height=ta),tr(this.pickingFBO,function(){Dr({framebuffer:ot.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var oa=ot.layer.multiPassRenderer.getRenderFlag();ot.layer.multiPassRenderer.setRenderFlag(!1),_e.hooks.beforePickingEncode.call(),_e.render(),_e.hooks.afterPickingEncode.call(),ot.layer.multiPassRenderer.setRenderFlag(oa),ot.alreadyInRendering=!1})}},{key:"triggerHoverOnLayer",value:function(_e){this.layer.emit(_e.type,_e)}},{key:"highlightPickedFeature",value:function(_e){var ot=vt()(_e,3),Xt=ot[0],rr=ot[1],tr=ot[2];this.layer.hooks.beforeHighlight.call([Xt,rr,tr]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(_e){var ot=vt()(_e,3),Xt=ot[0],rr=ot[1],tr=ot[2];this.layer.hooks.beforeSelect.call([Xt,rr,tr]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(_e){var ot=_e.featureId,Xt=Object(ye.l)(ot);this.selectFeature(new Uint8Array(Xt))}},{key:"highlightFeatureHandle",value:function(_e){var ot=_e.featureId,Xt=Object(ye.l)(ot);this.highlightPickedFeature(new Uint8Array(Xt))}}]),k}(lc),a),s=An()(Vl.prototype,"logger",[Bl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vl))||Yc),j=i("+em5"),ue,Te;function Ye(ne,se){var k=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(_e){return Object.getOwnPropertyDescriptor(ne,_e).enumerable})),k.push.apply(k,G)}return k}function qe(ne){for(var se=1;se<arguments.length;se++){var k=arguments[se]!=null?arguments[se]:{};se%2?Ye(Object(k),!0).forEach(function(G){re()(ne,G,k[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(k)):Ye(Object(k)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(k,G))})}return ne}function tt(ne){var se=Dt();return function(){var G=nt()(ne),_e;if(se){var ot=nt()(this).constructor;_e=Reflect.construct(G,arguments,ot)}else _e=G.apply(this,arguments);return $e()(this,_e)}}function Dt(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Rt=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,Wt=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,kt=(ue=Object(z.injectable)(),ue(Te=function(ne){ce()(k,ne);var se=tt(k);function k(){return Y()(this,k),se.apply(this,arguments)}return Ze()(k,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:Wt,fs:Rt});var _e=this.shaderModuleService.getModule("blur-pass"),ot=_e.vs,Xt=_e.fs,rr=_e.uniforms,tr=this.rendererService.getViewportSize(),Dr=tr.width,tn=tr.height;return{vs:ot,fs:Xt,uniforms:qe(qe({},rr),{},{u_ViewportSize:[Dr,tn]})}}},{key:"convertOptionsToUniforms",value:function(_e){var ot={};return Zo()(_e.blurRadius)||(ot.u_BlurDir=[_e.blurRadius,0]),ot}}]),k}(j.a))||Te),zt,nr;function Jt(ne,se){var k=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(_e){return Object.getOwnPropertyDescriptor(ne,_e).enumerable})),k.push.apply(k,G)}return k}function Cr(ne){for(var se=1;se<arguments.length;se++){var k=arguments[se]!=null?arguments[se]:{};se%2?Jt(Object(k),!0).forEach(function(G){re()(ne,G,k[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(k)):Jt(Object(k)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(k,G))})}return ne}function pr(ne){var se=_r();return function(){var G=nt()(ne),_e;if(se){var ot=nt()(this).constructor;_e=Reflect.construct(G,arguments,ot)}else _e=G.apply(this,arguments);return $e()(this,_e)}}function _r(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var wr=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,Hr=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Yr=(zt=Object(z.injectable)(),zt(nr=function(ne){ce()(k,ne);var se=pr(k);function k(){return Y()(this,k),se.apply(this,arguments)}return Ze()(k,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:Hr,fs:wr});var _e=this.shaderModuleService.getModule("blur-pass"),ot=_e.vs,Xt=_e.fs,rr=_e.uniforms,tr=this.rendererService.getViewportSize(),Dr=tr.width,tn=tr.height;return{vs:ot,fs:Xt,uniforms:Cr(Cr({},rr),{},{u_ViewportSize:[Dr,tn]})}}},{key:"convertOptionsToUniforms",value:function(_e){var ot={};return Zo()(_e.blurRadius)||(ot.u_BlurDir=[0,_e.blurRadius]),ot}}]),k}(j.a))||nr),un,_n;function ia(ne,se){var k=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(_e){return Object.getOwnPropertyDescriptor(ne,_e).enumerable})),k.push.apply(k,G)}return k}function pa(ne){for(var se=1;se<arguments.length;se++){var k=arguments[se]!=null?arguments[se]:{};se%2?ia(Object(k),!0).forEach(function(G){re()(ne,G,k[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(k)):ia(Object(k)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(k,G))})}return ne}function ya(ne){var se=Pa();return function(){var G=nt()(ne),_e;if(se){var ot=nt()(this).constructor;_e=Reflect.construct(G,arguments,ot)}else _e=G.apply(this,arguments);return $e()(this,_e)}}function Pa(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Pn=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,ga=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,aa=(un=Object(z.injectable)(),un(_n=function(ne){ce()(k,ne);var se=ya(k);function k(){return Y()(this,k),se.apply(this,arguments)}return Ze()(k,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:ga,fs:Pn});var _e=this.shaderModuleService.getModule("colorhalftone-pass"),ot=_e.vs,Xt=_e.fs,rr=_e.uniforms,tr=this.rendererService.getViewportSize(),Dr=tr.width,tn=tr.height;return{vs:ot,fs:Xt,uniforms:pa(pa({},rr),{},{u_ViewportSize:[Dr,tn]})}}}]),k}(j.a))||_n),zn,Ca;function qn(ne){var se=wa();return function(){var G=nt()(ne),_e;if(se){var ot=nt()(this).constructor;_e=Reflect.construct(G,arguments,ot)}else _e=G.apply(this,arguments);return $e()(this,_e)}}function wa(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Ja=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,co=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,$i=(zn=Object(z.injectable)(),zn(Ca=function(ne){ce()(k,ne);var se=qn(k);function k(){return Y()(this,k),se.apply(this,arguments)}return Ze()(k,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:co,fs:Ja}),this.shaderModuleService.getModule("copy-pass")}}]),k}(j.a))||Ca),Vi,fi;function Ji(ne,se){var k=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(_e){return Object.getOwnPropertyDescriptor(ne,_e).enumerable})),k.push.apply(k,G)}return k}function Lo(ne){for(var se=1;se<arguments.length;se++){var k=arguments[se]!=null?arguments[se]:{};se%2?Ji(Object(k),!0).forEach(function(G){re()(ne,G,k[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(k)):Ji(Object(k)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(k,G))})}return ne}function Iu(ne){var se=Us();return function(){var G=nt()(ne),_e;if(se){var ot=nt()(this).constructor;_e=Reflect.construct(G,arguments,ot)}else _e=G.apply(this,arguments);return $e()(this,_e)}}function Us(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Bs=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,Jo=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,ss=(Vi=Object(z.injectable)(),Vi(fi=function(ne){ce()(k,ne);var se=Iu(k);function k(){return Y()(this,k),se.apply(this,arguments)}return Ze()(k,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:Jo,fs:Bs});var _e=this.shaderModuleService.getModule("hexagonalpixelate-pass"),ot=_e.vs,Xt=_e.fs,rr=_e.uniforms,tr=this.rendererService.getViewportSize(),Dr=tr.width,tn=tr.height;return{vs:ot,fs:Xt,uniforms:Lo(Lo({},rr),{},{u_ViewportSize:[Dr,tn]})}}}]),k}(j.a))||fi),Al,Eu;function dl(ne,se){var k=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(_e){return Object.getOwnPropertyDescriptor(ne,_e).enumerable})),k.push.apply(k,G)}return k}function Gl(ne){for(var se=1;se<arguments.length;se++){var k=arguments[se]!=null?arguments[se]:{};se%2?dl(Object(k),!0).forEach(function(G){re()(ne,G,k[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(k)):dl(Object(k)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(k,G))})}return ne}function Du(ne){var se=Kc();return function(){var G=nt()(ne),_e;if(se){var ot=nt()(this).constructor;_e=Reflect.construct(G,arguments,ot)}else _e=G.apply(this,arguments);return $e()(this,_e)}}function Kc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Ku=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,eo=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Rs=(Al=Object(z.injectable)(),Al(Eu=function(ne){ce()(k,ne);var se=Du(k);function k(){return Y()(this,k),se.apply(this,arguments)}return Ze()(k,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:eo,fs:Ku});var _e=this.shaderModuleService.getModule("ink-pass"),ot=_e.vs,Xt=_e.fs,rr=_e.uniforms,tr=this.rendererService.getViewportSize(),Dr=tr.width,tn=tr.height;return{vs:ot,fs:Xt,uniforms:Gl(Gl({},rr),{},{u_ViewportSize:[Dr,tn]})}}}]),k}(j.a))||Eu),Hl,fc;function Xi(ne){var se=jo();return function(){var G=nt()(ne),_e;if(se){var ot=nt()(this).constructor;_e=Reflect.construct(G,arguments,ot)}else _e=G.apply(this,arguments);return $e()(this,_e)}}function jo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var xs=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,to=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Vs=(Hl=Object(z.injectable)(),Hl(fc=function(ne){ce()(k,ne);var se=Xi(k);function k(){return Y()(this,k),se.apply(this,arguments)}return Ze()(k,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:to,fs:xs}),this.shaderModuleService.getModule("noise-pass")}}]),k}(j.a))||fc),ro,$u;function pl(ne){var se=ml();return function(){var G=nt()(ne),_e;if(se){var ot=nt()(this).constructor;_e=Reflect.construct(G,arguments,ot)}else _e=G.apply(this,arguments);return $e()(this,_e)}}function ml(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Ac=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Ju=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`,Wl=(ro=Object(z.injectable)(),ro($u=function(ne){ce()(k,ne);var se=pl(k);function k(){return Y()(this,k),se.apply(this,arguments)}return Ze()(k,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:Ac,fs:Ju}),this.shaderModuleService.getModule("sepia-pass")}}]),k}(j.a))||$u),Uo,vo,$c,Zl,Jc,Es,cf,Nf=(Uo=Object(z.injectable)(),vo=Object(z.inject)(D.a.IRendererService),$c=Object(z.postConstruct)(),Uo(Zl=(Jc=(cf=function(){function ne(){Y()(this,ne),ur()(this,"rendererService",Es,this),this.passes=[],this.readFBO=void 0,this.writeFBO=void 0}return Ze()(ne,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"render",value:function(){var se=bn()(cr.a.mark(function G(_e){var ot,Xt;return cr.a.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:ot=0;case 1:if(!(ot<this.passes.length)){tr.next=10;break}return Xt=this.passes[ot],Xt.setRenderToScreen(this.isLastEnabledPass(ot)),tr.next=6,Xt.render(_e);case 6:ot!==this.passes.length-1&&this.swap();case 7:ot++,tr.next=1;break;case 10:case"end":return tr.stop()}},G,this)}));function k(G){return se.apply(this,arguments)}return k}()},{key:"resize",value:function(k,G){this.readFBO.resize({width:k,height:G}),this.writeFBO.resize({width:k,height:G})}},{key:"add",value:function(k,G,_e){k.init(G,_e),this.passes.push(k)}},{key:"insert",value:function(k,G,_e,ot){k.init(_e,ot),this.passes.splice(G,0,k)}},{key:"getPostProcessingPassByName",value:function(k){return this.passes.find(function(G){return G.getName()===k})}},{key:"init",value:function(){}},{key:"isLastEnabledPass",value:function(k){for(var G=k+1;G<this.passes.length;G++)if(this.passes[G].isEnabled())return!1;return!0}},{key:"swap",value:function(){var k=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=k}}]),ne}(),cf),Es=An()(Jc.prototype,"rendererService",[vo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),An()(Jc.prototype,"init",[$c],Object.getOwnPropertyDescriptor(Jc.prototype,"init"),Jc.prototype),Jc))||Zl),ff,Zf;function Nu(ne){var se=hf();return function(){var G=nt()(ne),_e;if(se){var ot=nt()(this).constructor;_e=Reflect.construct(G,arguments,ot)}else _e=G.apply(this,arguments);return $e()(this,_e)}}function hf(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Xl=(ff=Object(z.injectable)(),ff(Zf=function(ne){ce()(k,ne);var se=Nu(k);function k(){return Y()(this,k),se.apply(this,arguments)}return Ze()(k,[{key:"getType",value:function(){return Zc.a.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(_e,ot){is()(nt()(k.prototype),"init",this).call(this,_e,ot)}},{key:"render",value:function(_e){var ot=this.rendererService,Xt=ot.useFramebuffer,rr=ot.clear;Xt(null,function(){rr({color:[0,0,0,0],depth:1,stencil:0}),_e.multiPassRenderer.setRenderFlag(!1),_e.render(),_e.multiPassRenderer.setRenderFlag(!0)})}}]),k}(lc))||Zf),vl,Qc,Af,Xf,Cc,wc,Yf,Kf;function kf(ne,se){var k=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(_e){return Object.getOwnPropertyDescriptor(ne,_e).enumerable})),k.push.apply(k,G)}return k}function $f(ne){for(var se=1;se<arguments.length;se++){var k=arguments[se]!=null?arguments[se]:{};se%2?kf(Object(k),!0).forEach(function(G){re()(ne,G,k[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(k)):kf(Object(k)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(k,G))})}return ne}function qc(ne){var se=fh();return function(){var G=nt()(ne),_e;if(se){var ot=nt()(this).constructor;_e=Reflect.construct(G,arguments,ot)}else _e=G.apply(this,arguments);return $e()(this,_e)}}function fh(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var go=`uniform float u_opacity : 1.0;
uniform float u_MixRatio : 0.5;

uniform sampler2D u_Diffuse1;
uniform sampler2D u_Diffuse2;

varying vec2 v_UV;

void main() {
  vec4 texel1 = texture2D(u_Diffuse1, v_UV);
  vec4 texel2 = texture2D(u_Diffuse2, v_UV);
  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);
}
`,hc=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,df=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;function Yl(ne,se){for(var k=0,G=1/se,_e=ne;_e>0;)k=k+G*(_e%se),_e=Math.floor(_e/se),G=G/se;return k}var Oc=1,Mc=(vl=Object(z.injectable)(),Qc=Object(z.inject)(D.a.IShaderModuleService),Af=Object(z.inject)(D.a.ILogService),vl(Xf=(Cc=(Kf=function(ne){ce()(k,ne);var se=qc(k);function k(){var G;Y()(this,k);for(var _e=arguments.length,ot=new Array(_e),Xt=0;Xt<_e;Xt++)ot[Xt]=arguments[Xt];return G=se.call.apply(se,[this].concat(ot)),ur()(G,"shaderModuleService",wc,fa()(G)),ur()(G,"logger",Yf,fa()(G)),G.haltonSequence=[],G.accumulatingId=0,G.frame=0,G.timer=void 0,G.sampleRenderTarget=void 0,G.prevRenderTarget=void 0,G.outputRenderTarget=void 0,G.copyRenderTarget=void 0,G.blendModel=void 0,G.outputModel=void 0,G.copyModel=void 0,G}return Ze()(k,[{key:"getType",value:function(){return Zc.a.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(_e,ot){is()(nt()(k.prototype),"init",this).call(this,_e,ot);var Xt=this.rendererService,rr=Xt.createFramebuffer,tr=Xt.createTexture2D;this.sampleRenderTarget=rr({color:tr({width:1,height:1,wrapS:jn.a.CLAMP_TO_EDGE,wrapT:jn.a.CLAMP_TO_EDGE})}),this.prevRenderTarget=rr({color:tr({width:1,height:1,wrapS:jn.a.CLAMP_TO_EDGE,wrapT:jn.a.CLAMP_TO_EDGE})}),this.outputRenderTarget=rr({color:tr({width:1,height:1,wrapS:jn.a.CLAMP_TO_EDGE,wrapT:jn.a.CLAMP_TO_EDGE})}),this.copyRenderTarget=rr({color:tr({width:1,height:1,wrapS:jn.a.CLAMP_TO_EDGE,wrapT:jn.a.CLAMP_TO_EDGE})});for(var Dr=0;Dr<30;Dr++)this.haltonSequence.push([Yl(Dr,2),Yl(Dr,3)]);this.blendModel=this.createTriangleModel("blend-pass",go),this.outputModel=this.createTriangleModel("copy-pass",hc,{blend:{enable:!0,func:{srcRGB:jn.a.ONE,dstRGB:jn.a.ONE_MINUS_SRC_ALPHA,srcAlpha:jn.a.ONE,dstAlpha:jn.a.ONE_MINUS_SRC_ALPHA},equation:{rgb:jn.a.FUNC_ADD,alpha:jn.a.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",hc)}},{key:"render",value:function(_e){var ot=this,Xt=this.rendererService,rr=Xt.clear,tr=Xt.getViewportSize,Dr=Xt.useFramebuffer,tn=tr(),Vn=tn.width,ta=tn.height;this.sampleRenderTarget.resize({width:Vn,height:ta}),this.prevRenderTarget.resize({width:Vn,height:ta}),this.outputRenderTarget.resize({width:Vn,height:ta}),this.copyRenderTarget.resize({width:Vn,height:ta}),this.resetFrame(),this.stopAccumulating();var oa=_e.multiPassRenderer.getPostProcessor().getReadFBO();Dr(oa,function(){rr({color:[0,0,0,0],depth:1,stencil:0,framebuffer:oa}),_e.multiPassRenderer.setRenderFlag(!1),_e.render(),_e.multiPassRenderer.setRenderFlag(!0)});var Ya=function za(Ni){if(!ot.accumulatingId||Ni!==ot.accumulatingId)return;ot.isFinished()||(ot.doRender(_e),requestAnimationFrame(function(){za(Ni)}))};this.accumulatingId=Oc++,this.timer=window.setTimeout(function(){Ya(ot.accumulatingId)},50)}},{key:"doRender",value:function(_e){var ot=this;this.logger.debug("accumulatingId: ".concat(this.accumulatingId));var Xt=this.rendererService,rr=Xt.clear,tr=Xt.getViewportSize,Dr=Xt.useFramebuffer,tn=tr(),Vn=tn.width,ta=tn.height,oa=_e.getLayerConfig(),Ya=oa.jitterScale,za=Ya===void 0?1:Ya,Ni=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((Ni[0]*2-1)/Vn*za,(Ni[1]*2-1)/ta*za),_e.multiPassRenderer.setRenderFlag(!1),_e.hooks.beforeRender.call(),Dr(this.sampleRenderTarget,function(){rr({color:[0,0,0,0],depth:1,stencil:0,framebuffer:ot.sampleRenderTarget}),_e.render()}),_e.hooks.afterRender.call(),_e.multiPassRenderer.setRenderFlag(!0);var Fa=_e.getLayerConfig();Dr(this.outputRenderTarget,function(){ot.blendModel.draw({uniforms:{u_opacity:Fa.opacity||1,u_MixRatio:ot.frame===0?1:.9,u_Diffuse1:ot.sampleRenderTarget,u_Diffuse2:ot.frame===0?_e.multiPassRenderer.getPostProcessor().getReadFBO():ot.prevRenderTarget}})}),this.frame===0&&rr({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(Dr(this.copyRenderTarget,function(){ot.outputModel.draw({uniforms:{u_Texture:ot.outputRenderTarget}})}),Dr(_e.multiPassRenderer.getPostProcessor().getReadFBO(),function(){ot.copyModel.draw({uniforms:{u_Texture:ot.copyRenderTarget}})}),_e.multiPassRenderer.getPostProcessor().render(_e));var Gi=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=Gi,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,window.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(_e,ot,Xt){this.shaderModuleService.registerModule(_e,{vs:df,fs:ot});var rr=this.shaderModuleService.getModule(_e),tr=rr.vs,Dr=rr.fs,tn=rr.uniforms,Vn=this.rendererService,ta=Vn.createAttribute,oa=Vn.createBuffer,Ya=Vn.createModel;return Ya($f({vs:tr,fs:Dr,attributes:{a_Position:ta({buffer:oa({data:[-4,-4,4,-4,0,4],type:jn.a.FLOAT}),size:2})},uniforms:$f({},tn),depth:{enable:!1},count:3},Xt))}}]),k}(lc),Kf),wc=An()(Cc.prototype,"shaderModuleService",[Qc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yf=An()(Cc.prototype,"logger",[Af],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cc))||Xf),ku=new z.Container;ku.bind(D.a.IGlobalConfigService).to(Kn).inSingletonScope(),ku.bind(D.a.IShaderModuleService).to(zs).inSingletonScope(),ku.bind(D.a.ILogService).to(Gu).inSingletonScope(),Object(z.decorate)(Object(z.injectable)(),m.EventEmitter),ku.bind(D.a.IEventEmitter).to(m.EventEmitter);var Pc=Z()(ku,!1),Lc=function(se){var k=Pc.lazyInject(se);return function(G,_e,ot){k.call(this,G,_e),ot&&(ot.initializer=function(){return G[_e]})}},pf=function(se){var k=Pc.lazyMultiInject(se);return function(G,_e,ot){k.call(this,G,_e),ot&&(ot.initializer=function(){return G[_e]})}},Cf=E.c=ku,jf=0;function dc(){var ne=new z.Container;return ne.parent=ku,ne.bind(D.a.SceneID).toConstantValue("".concat(jf++)),ne.bind(D.a.ILayerService).to(Bn).inSingletonScope(),ne.bind(D.a.ISceneService).to(Ms).inSingletonScope(),ne.bind(D.a.ICameraService).to(vr).inSingletonScope(),ne.bind(D.a.ICoordinateSystemService).to(Ml).inSingletonScope(),ne.bind(D.a.IInteractionService).to(Ie).inSingletonScope(),ne.bind(D.a.IPickingService).to(bl).inSingletonScope(),ne.bind(D.a.IControlService).to(Zn).inSingletonScope(),ne.bind(D.a.IMarkerService).to(le).inSingletonScope(),ne.bind(D.a.IIconService).to(mt).inSingletonScope(),ne.bind(D.a.IFontService).to(I).inSingletonScope(),ne.bind(D.a.IPopupService).to(He).inSingletonScope(),ne.bind(D.a.INormalPass).to(Sf).whenTargetNamed("clear"),ne.bind(D.a.INormalPass).to(R).whenTargetNamed("pixelPicking"),ne.bind(D.a.INormalPass).to(Xl).whenTargetNamed("render"),ne.bind(D.a.INormalPass).to(Mc).whenTargetNamed("taa"),ne.bind(D.a.IFactoryNormalPass).toFactory(function(se){return function(k){return se.container.getNamed(D.a.INormalPass,k)}}),ne.bind(D.a.IPostProcessingPass).to($i).whenTargetNamed("copy"),ne.bind(D.a.IPostProcessingPass).to(kt).whenTargetNamed("blurH"),ne.bind(D.a.IPostProcessingPass).to(Yr).whenTargetNamed("blurV"),ne.bind(D.a.IPostProcessingPass).to(Vs).whenTargetNamed("noise"),ne.bind(D.a.IPostProcessingPass).to(Wl).whenTargetNamed("sepia"),ne.bind(D.a.IPostProcessingPass).to(aa).whenTargetNamed("colorHalftone"),ne.bind(D.a.IPostProcessingPass).to(ss).whenTargetNamed("hexagonalPixelate"),ne.bind(D.a.IPostProcessingPass).to(Rs).whenTargetNamed("ink"),ne.bind(D.a.IFactoryPostProcessingPass).toFactory(function(se){return function(k){var G=se.container.getNamed(D.a.IPostProcessingPass,k);return G.setName(k),G}}),ne}function Kl(ne){var se=new z.Container;return se.parent=ne,se.bind(D.a.IStyleAttributeService).to(gc).inSingletonScope(),se.bind(D.a.IMultiPassRenderer).to(hl).inSingletonScope(),se.bind(D.a.IPostProcessor).to(Nf).inSingletonScope(),se}},fbrv:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("Yk9n"),m=i("MON2"),X=i("FV85"),z=i("xfSm"),o=i("ujMp");E.getFunctionName=o.getFunctionName;var Z=i("dX1H");function D(ye,we){var pt=o.getFunctionName(we),je=K(ye,pt,we,!1);return je}E.getDependencies=D;function K(ye,we,pt,je){var Tt=ye.getConstructorMetadata(pt),Xe=Tt.compilerGeneratedMetadata;if(Xe===void 0){var gt=m.MISSING_INJECTABLE_ANNOTATION+" "+we+".";throw new Error(gt)}var Je=Tt.userGeneratedMetadata,Et=Object.keys(Je),_t=pt.length===0&&Et.length>0,Ne=_t?Et.length:pt.length,ke=de(je,we,Xe,Je,Ne),Ue=Y(ye,pt),st=ke.concat(Ue);return st}function re(ye,we,pt,je,Tt){var Xe=Tt[ye.toString()]||[],gt=Ze(Xe),Je=gt.unmanaged!==!0,Et=je[ye],_t=gt.inject||gt.multiInject;if(Et=_t||Et,Et instanceof T.LazyServiceIdentifer&&(Et=Et.unwrap()),Je){var Ne=Et===Object,ke=Et===Function,Ue=Et===void 0,st=Ne||ke||Ue;if(!we&&st){var Le=m.MISSING_INJECT_ANNOTATION+" argument "+ye+" in class "+pt+".";throw new Error(Le)}var ut=new Z.Target(X.TargetTypeEnum.ConstructorArgument,gt.targetName,Et);return ut.metadata=Xe,ut}return null}function de(ye,we,pt,je,Tt){for(var Xe=[],gt=0;gt<Tt;gt++){var Je=gt,Et=re(Je,ye,we,pt,je);Et!==null&&Xe.push(Et)}return Xe}function Y(ye,we){for(var pt=ye.getPropertiesMetadata(we),je=[],Tt=Object.keys(pt),Xe=0,gt=Tt;Xe<gt.length;Xe++){var Je=gt[Xe],Et=pt[Je],_t=Ze(pt[Je]),Ne=_t.targetName||Je,ke=_t.inject||_t.multiInject,Ue=new Z.Target(X.TargetTypeEnum.ClassProperty,Ne,ke);Ue.metadata=Et,je.push(Ue)}var st=Object.getPrototypeOf(we.prototype).constructor;if(st!==Object){var Le=Y(ye,st);je=je.concat(Le)}return je}function Fe(ye,we){var pt=Object.getPrototypeOf(we.prototype).constructor;if(pt!==Object){var je=o.getFunctionName(pt),Tt=K(ye,je,pt,!0),Xe=Tt.map(function(Et){return Et.metadata.filter(function(_t){return _t.key===z.UNMANAGED_TAG})}),gt=[].concat.apply([],Xe).length,Je=Tt.length-gt;return Je>0?Je:Fe(ye,pt)}else return 0}E.getBaseClassDependencyCount=Fe;function Ze(ye){var we={};return ye.forEach(function(pt){we[pt.key.toString()]=pt.value}),{inject:we[z.INJECT_TAG],multiInject:we[z.MULTI_INJECT_TAG],targetName:we[z.NAME_TAG],unmanaged:we[z.UNMANAGED_TAG]}}},fbvF:function(Re,E,i){(function(T,m){Re.exports=m()})(this,function(){"use strict";var T=function(ze){return ze instanceof Uint8Array||ze instanceof Uint16Array||ze instanceof Uint32Array||ze instanceof Int8Array||ze instanceof Int16Array||ze instanceof Int32Array||ze instanceof Float32Array||ze instanceof Float64Array||ze instanceof Uint8ClampedArray},m=function(ze,Pt){for(var gr=Object.keys(Pt),kr=0;kr<gr.length;++kr)ze[gr[kr]]=Pt[gr[kr]];return ze},X=`
`;function z(fe){return typeof atob!="undefined"?atob(fe):"base64:"+fe}function o(fe){var ze=new Error("(regl) "+fe);throw console.error(ze),ze}function Z(fe,ze){fe||o(ze)}function D(fe){return fe?": "+fe:""}function K(fe,ze,Pt){fe in ze||o("unknown parameter ("+fe+")"+D(Pt)+". possible values: "+Object.keys(ze).join())}function re(fe,ze){T(fe)||o("invalid parameter type"+D(ze)+". must be a typed array")}function de(fe,ze){switch(ze){case"number":return typeof fe=="number";case"object":return typeof fe=="object";case"string":return typeof fe=="string";case"boolean":return typeof fe=="boolean";case"function":return typeof fe=="function";case"undefined":return typeof fe=="undefined";case"symbol":return typeof fe=="symbol"}}function Y(fe,ze,Pt){de(fe,ze)||o("invalid parameter type"+D(Pt)+". expected "+ze+", got "+typeof fe)}function Fe(fe,ze){fe>=0&&(fe|0)===fe||o("invalid parameter type, ("+fe+")"+D(ze)+". must be a nonnegative integer")}function Ze(fe,ze,Pt){ze.indexOf(fe)<0&&o("invalid value"+D(Pt)+". must be one of: "+ze)}var ye=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function we(fe){Object.keys(fe).forEach(function(ze){ye.indexOf(ze)<0&&o('invalid regl constructor argument "'+ze+'". must be one of '+ye)})}function pt(fe,ze){for(fe=fe+"";fe.length<ze;)fe=" "+fe;return fe}function je(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function Tt(fe,ze){this.number=fe,this.line=ze,this.errors=[]}function Xe(fe,ze,Pt){this.file=fe,this.line=ze,this.message=Pt}function gt(){var fe=new Error,ze=(fe.stack||fe).toString(),Pt=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(ze);if(Pt)return Pt[1];var gr=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(ze);return gr?gr[1]:"unknown"}function Je(){var fe=new Error,ze=(fe.stack||fe).toString(),Pt=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(ze);if(Pt)return Pt[1];var gr=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(ze);return gr?gr[1]:"unknown"}function Et(fe,ze){var Pt=fe.split(`
`),gr=1,kr=0,Or={unknown:new je,0:new je};Or.unknown.name=Or[0].name=ze||gt(),Or.unknown.lines.push(new Tt(0,""));for(var xr=0;xr<Pt.length;++xr){var Wr=Pt[xr],on=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Wr);if(on)switch(on[1]){case"line":var rn=/(\d+)(\s+\d+)?/.exec(on[2]);rn&&(gr=rn[1]|0,rn[2]&&(kr=rn[2]|0,kr in Or||(Or[kr]=new je)));break;case"define":var Qr=/SHADER_NAME(_B64)?\s+(.*)$/.exec(on[2]);Qr&&(Or[kr].name=Qr[1]?z(Qr[2]):Qr[2]);break}Or[kr].lines.push(new Tt(gr++,Wr))}return Object.keys(Or).forEach(function(cn){var Sn=Or[cn];Sn.lines.forEach(function(fn){Sn.index[fn.number]=fn})}),Or}function _t(fe){var ze=[];return fe.split(`
`).forEach(function(Pt){if(Pt.length<5)return;var gr=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(Pt);gr?ze.push(new Xe(gr[1]|0,gr[2]|0,gr[3].trim())):Pt.length>0&&ze.push(new Xe("unknown",0,Pt))}),ze}function Ne(fe,ze){ze.forEach(function(Pt){var gr=fe[Pt.file];if(gr){var kr=gr.index[Pt.line];if(kr){kr.errors.push(Pt),gr.hasErrors=!0;return}}fe.unknown.hasErrors=!0,fe.unknown.lines[0].errors.push(Pt)})}function ke(fe,ze,Pt,gr,kr){if(!fe.getShaderParameter(ze,fe.COMPILE_STATUS)){var Or=fe.getShaderInfoLog(ze),xr=gr===fe.FRAGMENT_SHADER?"fragment":"vertex";ir(Pt,"string",xr+" shader source must be a string",kr);var Wr=Et(Pt,kr),on=_t(Or);Ne(Wr,on),Object.keys(Wr).forEach(function(rn){var Qr=Wr[rn];if(!Qr.hasErrors)return;var cn=[""],Sn=[""];function fn(Kr,br){cn.push(Kr),Sn.push(br||"")}fn("file number "+rn+": "+Qr.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),Qr.lines.forEach(function(Kr){if(Kr.errors.length>0){fn(pt(Kr.number,4)+"|  ","background-color:yellow; font-weight:bold"),fn(Kr.line+X,"color:red; background-color:yellow; font-weight:bold");var br=0;Kr.errors.forEach(function(mr){var Jr=mr.message,wn=/^\s*'(.*)'\s*:\s*(.*)$/.exec(Jr);if(wn){var Lr=wn[1];Jr=wn[2];switch(Lr){case"assign":Lr="=";break}br=Math.max(Kr.line.indexOf(Lr,br),0)}else br=0;fn(pt("| ",6)),fn(pt("^^^",br+3)+X,"font-weight:bold"),fn(pt("| ",6)),fn(Jr+X,"font-weight:bold")}),fn(pt("| ",6)+X)}else fn(pt(Kr.number,4)+"|  "),fn(Kr.line+X,"color:red")}),typeof document!="undefined"&&!window.chrome?(Sn[0]=cn.join("%c"),console.log.apply(console,Sn)):console.log(cn.join(""))}),Z.raise("Error compiling "+xr+" shader, "+Wr[0].name)}}function Ue(fe,ze,Pt,gr,kr){if(!fe.getProgramParameter(ze,fe.LINK_STATUS)){var Or=fe.getProgramInfoLog(ze),xr=Et(Pt,kr),Wr=Et(gr,kr),on='Error linking program with vertex shader, "'+Wr[0].name+'", and fragment shader "'+xr[0].name+'"';typeof document!="undefined"?console.log("%c"+on+X+"%c"+Or,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(on+X+Or),Z.raise(on)}}function st(fe){fe._commandRef=gt()}function Le(fe,ze,Pt,gr){st(fe);function kr(on){return on?gr.id(on):0}fe._fragId=kr(fe.static.frag),fe._vertId=kr(fe.static.vert);function Or(on,rn){Object.keys(rn).forEach(function(Qr){on[gr.id(Qr)]=!0})}var xr=fe._uniformSet={};Or(xr,ze.static),Or(xr,ze.dynamic);var Wr=fe._attributeSet={};Or(Wr,Pt.static),Or(Wr,Pt.dynamic),fe._hasCount="count"in fe.static||"count"in fe.dynamic||"elements"in fe.static||"elements"in fe.dynamic}function ut(fe,ze){var Pt=Je();o(fe+" in command "+(ze||gt())+(Pt==="unknown"?"":" called from "+Pt))}function Vt(fe,ze,Pt){fe||ut(ze,Pt||gt())}function Zt(fe,ze,Pt,gr){fe in ze||ut("unknown parameter ("+fe+")"+D(Pt)+". possible values: "+Object.keys(ze).join(),gr||gt())}function ir(fe,ze,Pt,gr){de(fe,ze)||ut("invalid parameter type"+D(Pt)+". expected "+ze+", got "+typeof fe,gr||gt())}function oe(fe){fe()}function Q(fe,ze,Pt){fe.texture?Ze(fe.texture._texture.internalformat,ze,"unsupported texture format for attachment"):Ze(fe.renderbuffer._renderbuffer.format,Pt,"unsupported renderbuffer format for attachment")}var H=33071,Ce=9728,Ee=9984,Ae=9985,ge=9986,rt=9987,Yt=5120,At=5121,be=5122,xe=5123,Ve=5124,lt=5125,Pe=5126,dt=32819,w=32820,I=33635,q=34042,ce=36193,Ge={};Ge[Yt]=Ge[At]=1,Ge[be]=Ge[xe]=Ge[ce]=Ge[I]=Ge[dt]=Ge[w]=2,Ge[Ve]=Ge[lt]=Ge[Pe]=Ge[q]=4;function $e(fe,ze){return fe===w||fe===dt||fe===I?2:fe===q?4:Ge[fe]*ze}function yt(fe){return!(fe&fe-1)&&!!fe}function nt(fe,ze,Pt){var gr,kr=ze.width,Or=ze.height,xr=ze.channels;Z(kr>0&&kr<=Pt.maxTextureSize&&Or>0&&Or<=Pt.maxTextureSize,"invalid texture shape"),(fe.wrapS!==H||fe.wrapT!==H)&&Z(yt(kr)&&yt(Or),"incompatible wrap mode for texture, both width and height must be power of 2"),ze.mipmask===1?kr!==1&&Or!==1&&Z(fe.minFilter!==Ee&&fe.minFilter!==ge&&fe.minFilter!==Ae&&fe.minFilter!==rt,"min filter requires mipmap"):(Z(yt(kr)&&yt(Or),"texture must be a square power of 2 to support mipmapping"),Z(ze.mipmask===(kr<<1)-1,"missing or incomplete mipmap data")),ze.type===Pe&&(Pt.extensions.indexOf("oes_texture_float_linear")<0&&Z(fe.minFilter===Ce&&fe.magFilter===Ce,"filter not supported, must enable oes_texture_float_linear"),Z(!fe.genMipmaps,"mipmap generation not supported with float textures"));var Wr=ze.images;for(gr=0;gr<16;++gr)if(Wr[gr]){var on=kr>>gr,rn=Or>>gr;Z(ze.mipmask&1<<gr,"missing mipmap data");var Qr=Wr[gr];if(Z(Qr.width===on&&Qr.height===rn,"invalid shape for mip images"),Z(Qr.format===ze.format&&Qr.internalformat===ze.internalformat&&Qr.type===ze.type,"incompatible type for mip image"),!Qr.compressed)if(Qr.data){var cn=Math.ceil($e(Qr.type,xr)*on/Qr.unpackAlignment)*Qr.unpackAlignment;Z(Qr.data.byteLength===cn*rn,"invalid data for image, buffer size is inconsistent with image format")}else Qr.element||Qr.copy}else fe.genMipmaps||Z((ze.mipmask&1<<gr)===0,"extra mipmap data");ze.compressed&&Z(!fe.genMipmaps,"mipmap generation for compressed images not supported")}function Nt(fe,ze,Pt,gr){var kr=fe.width,Or=fe.height,xr=fe.channels;Z(kr>0&&kr<=gr.maxTextureSize&&Or>0&&Or<=gr.maxTextureSize,"invalid texture shape"),Z(kr===Or,"cube map must be square"),Z(ze.wrapS===H&&ze.wrapT===H,"wrap mode not supported by cube map");for(var Wr=0;Wr<Pt.length;++Wr){var on=Pt[Wr];Z(on.width===kr&&on.height===Or,"inconsistent cube map face shape"),ze.genMipmaps&&(Z(!on.compressed,"can not generate mipmap for compressed textures"),Z(on.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var rn=on.images,Qr=0;Qr<16;++Qr){var cn=rn[Qr];if(cn){var Sn=kr>>Qr,fn=Or>>Qr;Z(on.mipmask&1<<Qr,"missing mipmap data"),Z(cn.width===Sn&&cn.height===fn,"invalid shape for mip images"),Z(cn.format===fe.format&&cn.internalformat===fe.internalformat&&cn.type===fe.type,"incompatible type for mip image"),cn.compressed||(cn.data?Z(cn.data.byteLength===Sn*fn*Math.max($e(cn.type,xr),cn.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):cn.element||cn.copy)}}}}var $=m(Z,{optional:oe,raise:o,commandRaise:ut,command:Vt,parameter:K,commandParameter:Zt,constructor:we,type:Y,commandType:ir,isTypedArray:re,nni:Fe,oneOf:Ze,shaderError:ke,linkError:Ue,callSite:Je,saveCommandRef:st,saveDrawInfo:Le,framebufferFormat:Q,guessCommand:gt,texture2D:nt,textureCube:Nt}),Ke=0,ae=0,et=5,jt=6;function sr(fe,ze){this.id=Ke++,this.type=fe,this.data=ze}function ft(fe){return fe.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function mt(fe){if(fe.length===0)return[];var ze=fe.charAt(0),Pt=fe.charAt(fe.length-1);if(fe.length>1&&ze===Pt&&(ze==='"'||ze==="'"))return['"'+ft(fe.substr(1,fe.length-2))+'"'];var gr=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(fe);if(gr)return mt(fe.substr(0,gr.index)).concat(mt(gr[1])).concat(mt(fe.substr(gr.index+gr[0].length)));var kr=fe.split(".");if(kr.length===1)return['"'+ft(fe)+'"'];for(var Or=[],xr=0;xr<kr.length;++xr)Or=Or.concat(mt(kr[xr]));return Or}function Ct(fe){return"["+mt(fe).join("][")+"]"}function vt(fe,ze){return new sr(fe,Ct(ze+""))}function Oe(fe){return typeof fe=="function"&&!fe._reglType||fe instanceof sr}function ct(fe,ze){if(typeof fe=="function")return new sr(ae,fe);if(typeof fe=="number"||typeof fe=="boolean")return new sr(et,fe);if(Array.isArray(fe))return new sr(jt,fe.map(function(Pt,gr){return ct(Pt,ze+"["+gr+"]")}));if(fe instanceof sr)return fe;$(!1,"invalid option type in uniform "+ze)}var Qe={DynamicVariable:sr,define:vt,isDynamic:Oe,unbox:ct,accessor:Ct},Ft={next:typeof requestAnimationFrame=="function"?function(fe){return requestAnimationFrame(fe)}:function(fe){return setTimeout(fe,16)},cancel:typeof cancelAnimationFrame=="function"?function(fe){return cancelAnimationFrame(fe)}:clearTimeout},vr=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function Vr(){var fe={"":0},ze=[""];return{id:function(gr){var kr=fe[gr];return kr||(kr=fe[gr]=ze.length,ze.push(gr),kr)},str:function(gr){return ze[gr]}}}function lr(fe,ze,Pt){var gr=document.createElement("canvas");m(gr.style,{border:0,margin:0,padding:0,top:0,left:0}),fe.appendChild(gr),fe===document.body&&(gr.style.position="absolute",m(fe.style,{margin:0,padding:0}));function kr(){var Wr=window.innerWidth,on=window.innerHeight;if(fe!==document.body){var rn=fe.getBoundingClientRect();Wr=rn.right-rn.left,on=rn.bottom-rn.top}gr.width=Pt*Wr,gr.height=Pt*on,m(gr.style,{width:Wr+"px",height:on+"px"})}var Or;fe!==document.body&&typeof ResizeObserver=="function"?(Or=new ResizeObserver(function(){setTimeout(kr)}),Or.observe(fe)):window.addEventListener("resize",kr,!1);function xr(){Or?Or.disconnect():window.removeEventListener("resize",kr),fe.removeChild(gr)}return kr(),{canvas:gr,onDestroy:xr}}function Nn(fe,ze){function Pt(gr){try{return fe.getContext(gr,ze)}catch(kr){return null}}return Pt("webgl")||Pt("experimental-webgl")||Pt("webgl-experimental")}function vn(fe){return typeof fe.nodeName=="string"&&typeof fe.appendChild=="function"&&typeof fe.getBoundingClientRect=="function"}function na(fe){return typeof fe.drawArrays=="function"||typeof fe.drawElements=="function"}function ha(fe){return typeof fe=="string"?fe.split():($(Array.isArray(fe),"invalid extension array"),fe)}function Zn(fe){return typeof fe=="string"?($(typeof document!="undefined","not supported outside of DOM"),document.querySelector(fe)):fe}function Hn(fe){var ze=fe||{},Pt,gr,kr,Or,xr={},Wr=[],on=[],rn=typeof window=="undefined"?1:window.devicePixelRatio,Qr=!1,cn=function(br){br&&$.raise(br)},Sn=function(){};if(typeof ze=="string"?($(typeof document!="undefined","selector queries only supported in DOM enviroments"),Pt=document.querySelector(ze),$(Pt,"invalid query string for element")):typeof ze=="object"?vn(ze)?Pt=ze:na(ze)?(Or=ze,kr=Or.canvas):($.constructor(ze),"gl"in ze?Or=ze.gl:"canvas"in ze?kr=Zn(ze.canvas):"container"in ze&&(gr=Zn(ze.container)),"attributes"in ze&&(xr=ze.attributes,$.type(xr,"object","invalid context attributes")),"extensions"in ze&&(Wr=ha(ze.extensions)),"optionalExtensions"in ze&&(on=ha(ze.optionalExtensions)),"onDone"in ze&&($.type(ze.onDone,"function","invalid or missing onDone callback"),cn=ze.onDone),"profile"in ze&&(Qr=!!ze.profile),"pixelRatio"in ze&&(rn=+ze.pixelRatio,$(rn>0,"invalid pixel ratio"))):$.raise("invalid arguments to regl"),Pt&&(Pt.nodeName.toLowerCase()==="canvas"?kr=Pt:gr=Pt),!Or){if(!kr){$(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var fn=lr(gr||document.body,cn,rn);if(!fn)return null;kr=fn.canvas,Sn=fn.onDestroy}xr.premultipliedAlpha===void 0&&(xr.premultipliedAlpha=!0),Or=Nn(kr,xr)}return Or?{gl:Or,canvas:kr,container:gr,extensions:Wr,optionalExtensions:on,pixelRatio:rn,profile:Qr,onDone:cn,onDestroy:Sn}:(Sn(),cn("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function F(fe,ze){var Pt={};function gr(xr){$.type(xr,"string","extension name must be string");var Wr=xr.toLowerCase(),on;try{on=Pt[Wr]=fe.getExtension(Wr)}catch(rn){}return!!on}for(var kr=0;kr<ze.extensions.length;++kr){var Or=ze.extensions[kr];if(!gr(Or))return ze.onDestroy(),ze.onDone('"'+Or+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return ze.optionalExtensions.forEach(gr),{extensions:Pt,restore:function(){Object.keys(Pt).forEach(function(Wr){if(Pt[Wr]&&!gr(Wr))throw new Error("(regl): error restoring extension "+Wr)})}}}function W(fe,ze){for(var Pt=Array(fe),gr=0;gr<fe;++gr)Pt[gr]=ze(gr);return Pt}var le=5120,me=5121,at=5122,bt=5123,He=5124,ht=5125,Qt=5126;function qt(fe){for(var ze=16;ze<=1<<28;ze*=16)if(fe<=ze)return ze;return 0}function Nr(fe){var ze,Pt;return ze=(fe>65535)<<4,fe>>>=ze,Pt=(fe>255)<<3,fe>>>=Pt,ze|=Pt,Pt=(fe>15)<<2,fe>>>=Pt,ze|=Pt,Pt=(fe>3)<<1,fe>>>=Pt,ze|=Pt,ze|fe>>1}function qr(){var fe=W(8,function(){return[]});function ze(Or){var xr=qt(Or),Wr=fe[Nr(xr)>>2];return Wr.length>0?Wr.pop():new ArrayBuffer(xr)}function Pt(Or){fe[Nr(Or.byteLength)>>2].push(Or)}function gr(Or,xr){var Wr=null;switch(Or){case le:Wr=new Int8Array(ze(xr),0,xr);break;case me:Wr=new Uint8Array(ze(xr),0,xr);break;case at:Wr=new Int16Array(ze(2*xr),0,xr);break;case bt:Wr=new Uint16Array(ze(2*xr),0,xr);break;case He:Wr=new Int32Array(ze(4*xr),0,xr);break;case ht:Wr=new Uint32Array(ze(4*xr),0,xr);break;case Qt:Wr=new Float32Array(ze(4*xr),0,xr);break;default:return null}return Wr.length!==xr?Wr.subarray(0,xr):Wr}function kr(Or){Pt(Or.buffer)}return{alloc:ze,free:Pt,allocType:gr,freeType:kr}}var or=qr();or.zero=qr();var Br=3408,Tn=3410,dr=3411,Xr=3412,dn=3413,Kn=3414,gn=3415,ur=33901,kn=33902,An=3379,Za=3386,ea=34921,ca=36347,bo=36348,Ri=35661,va=35660,ii=34930,Ia=36349,Ln=34076,Ei=34024,Wi=7936,qa=7937,Oo=7938,Ml=35724,cu=34047,fa=36063,Cs=34852,oo=3553,Na=34067,Fu=34069,Ai=33984,li=6408,xo=5126,ms=5121,so=36160,Uu=36053,Ys=36064,Eo=16384,fu=function(ze,Pt){var gr=1;Pt.ext_texture_filter_anisotropic&&(gr=ze.getParameter(cu));var kr=1,Or=1;Pt.webgl_draw_buffers&&(kr=ze.getParameter(Cs),Or=ze.getParameter(fa));var xr=!!Pt.oes_texture_float;if(xr){var Wr=ze.createTexture();ze.bindTexture(oo,Wr),ze.texImage2D(oo,0,li,1,1,0,li,xo,null);var on=ze.createFramebuffer();if(ze.bindFramebuffer(so,on),ze.framebufferTexture2D(so,Ys,oo,Wr,0),ze.bindTexture(oo,null),ze.checkFramebufferStatus(so)!==Uu)xr=!1;else{ze.viewport(0,0,1,1),ze.clearColor(1,0,0,1),ze.clear(Eo);var rn=or.allocType(xo,4);ze.readPixels(0,0,1,1,li,xo,rn),ze.getError()?xr=!1:(ze.deleteFramebuffer(on),ze.deleteTexture(Wr),xr=rn[0]===1),or.freeType(rn)}}var Qr=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),cn=!0;if(!Qr){var Sn=ze.createTexture(),fn=or.allocType(ms,36);ze.activeTexture(Ai),ze.bindTexture(Na,Sn),ze.texImage2D(Fu,0,li,3,3,0,li,ms,fn),or.freeType(fn),ze.bindTexture(Na,null),ze.deleteTexture(Sn),cn=!ze.getError()}return{colorBits:[ze.getParameter(Tn),ze.getParameter(dr),ze.getParameter(Xr),ze.getParameter(dn)],depthBits:ze.getParameter(Kn),stencilBits:ze.getParameter(gn),subpixelBits:ze.getParameter(Br),extensions:Object.keys(Pt).filter(function(Kr){return!!Pt[Kr]}),maxAnisotropic:gr,maxDrawbuffers:kr,maxColorAttachments:Or,pointSizeDims:ze.getParameter(ur),lineWidthDims:ze.getParameter(kn),maxViewportDims:ze.getParameter(Za),maxCombinedTextureUnits:ze.getParameter(Ri),maxCubeMapSize:ze.getParameter(Ln),maxRenderbufferSize:ze.getParameter(Ei),maxTextureUnits:ze.getParameter(ii),maxTextureSize:ze.getParameter(An),maxAttributes:ze.getParameter(ea),maxVertexUniforms:ze.getParameter(ca),maxVertexTextureUnits:ze.getParameter(va),maxVaryingVectors:ze.getParameter(bo),maxFragmentUniforms:ze.getParameter(Ia),glsl:ze.getParameter(Ml),renderer:ze.getParameter(qa),vendor:ze.getParameter(Wi),version:ze.getParameter(Oo),readFloat:xr,npotTextureCube:cn}};function Ut(fe){return!!fe&&typeof fe=="object"&&Array.isArray(fe.shape)&&Array.isArray(fe.stride)&&typeof fe.offset=="number"&&fe.shape.length===fe.stride.length&&(Array.isArray(fe.data)||T(fe.data))}var Ie=function(ze){return Object.keys(ze).map(function(Pt){return ze[Pt]})},Mt={shape:qi,flatten:Fi};function cr(fe,ze,Pt){for(var gr=0;gr<ze;++gr)Pt[gr]=fe[gr]}function en(fe,ze,Pt,gr){for(var kr=0,Or=0;Or<ze;++Or)for(var xr=fe[Or],Wr=0;Wr<Pt;++Wr)gr[kr++]=xr[Wr]}function bn(fe,ze,Pt,gr,kr,Or){for(var xr=Or,Wr=0;Wr<ze;++Wr)for(var on=fe[Wr],rn=0;rn<Pt;++rn)for(var Qr=on[rn],cn=0;cn<gr;++cn)kr[xr++]=Qr[cn]}function jn(fe,ze,Pt,gr,kr){for(var Or=1,xr=Pt+1;xr<ze.length;++xr)Or*=ze[xr];var Wr=ze[Pt];if(ze.length-Pt===4){var on=ze[Pt+1],rn=ze[Pt+2],Qr=ze[Pt+3];for(xr=0;xr<Wr;++xr)bn(fe[xr],on,rn,Qr,gr,kr),kr+=Or}else for(xr=0;xr<Wr;++xr)jn(fe[xr],ze,Pt+1,gr,kr),kr+=Or}function Fi(fe,ze,Pt,gr){var kr=1;if(ze.length)for(var Or=0;Or<ze.length;++Or)kr*=ze[Or];else kr=0;var xr=gr||or.allocType(Pt,kr);switch(ze.length){case 0:break;case 1:cr(fe,ze[0],xr);break;case 2:en(fe,ze[0],ze[1],xr);break;case 3:bn(fe,ze[0],ze[1],ze[2],xr,0);break;default:jn(fe,ze,0,xr,0)}return xr}function qi(fe){for(var ze=[],Pt=fe;Pt.length;Pt=Pt[0])ze.push(Pt.length);return ze}var Mo={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},To=5120,tl=5122,ql=5124,Ks=5121,jc=5123,vs=5125,Bu=5126,ws=5126,_o={int8:To,int16:tl,int32:ql,uint8:Ks,uint16:jc,uint32:vs,float:Bu,float32:ws},Po=35048,$s=35040,bl={dynamic:Po,stream:$s,static:35044},Su=Mt.flatten,ka=Mt.shape,hu=35044,ec=35040,Js=5121,ns=5126,wt=[];wt[5120]=1,wt[5122]=2,wt[5124]=4,wt[5121]=1,wt[5123]=2,wt[5125]=4,wt[5126]=4;function er(fe){return Mo[Object.prototype.toString.call(fe)]|0}function Ar(fe,ze){for(var Pt=0;Pt<ze.length;++Pt)fe[Pt]=ze[Pt]}function Bn(fe,ze,Pt,gr,kr,Or,xr){for(var Wr=0,on=0;on<Pt;++on)for(var rn=0;rn<gr;++rn)fe[Wr++]=ze[kr*on+Or*rn+xr]}function Qa(fe,ze,Pt,gr){var kr=0,Or={};function xr(br){this.id=kr++,this.buffer=fe.createBuffer(),this.type=br,this.usage=hu,this.byteLength=0,this.dimension=1,this.dtype=Js,this.persistentData=null,Pt.profile&&(this.stats={size:0})}xr.prototype.bind=function(){fe.bindBuffer(this.type,this.buffer)},xr.prototype.destroy=function(){Sn(this)};var Wr=[];function on(br,mr){var Jr=Wr.pop();return Jr||(Jr=new xr(br)),Jr.bind(),cn(Jr,mr,ec,0,1,!1),Jr}function rn(br){Wr.push(br)}function Qr(br,mr,Jr){br.byteLength=mr.byteLength,fe.bufferData(br.type,mr,Jr)}function cn(br,mr,Jr,wn,Lr,Xn){var $r;if(br.usage=Jr,Array.isArray(mr)){if(br.dtype=wn||ns,mr.length>0){var zr;if(Array.isArray(mr[0])){$r=ka(mr);for(var Ur=1,Gr=1;Gr<$r.length;++Gr)Ur*=$r[Gr];br.dimension=Ur,zr=Su(mr,$r,br.dtype),Qr(br,zr,Jr),Xn?br.persistentData=zr:or.freeType(zr)}else if(typeof mr[0]=="number"){br.dimension=Lr;var Wn=or.allocType(br.dtype,mr.length);Ar(Wn,mr),Qr(br,Wn,Jr),Xn?br.persistentData=Wn:or.freeType(Wn)}else T(mr[0])?(br.dimension=mr[0].length,br.dtype=wn||er(mr[0])||ns,zr=Su(mr,[mr.length,mr[0].length],br.dtype),Qr(br,zr,Jr),Xn?br.persistentData=zr:or.freeType(zr)):$.raise("invalid buffer data")}}else if(T(mr))br.dtype=wn||er(mr),br.dimension=Lr,Qr(br,mr,Jr),Xn&&(br.persistentData=new Uint8Array(new Uint8Array(mr.buffer)));else if(Ut(mr)){$r=mr.shape;var $n=mr.stride,sn=mr.offset,nn=0,Rr=0,ba=0,La=0;$r.length===1?(nn=$r[0],Rr=1,ba=$n[0],La=0):$r.length===2?(nn=$r[0],Rr=$r[1],ba=$n[0],La=$n[1]):$.raise("invalid shape"),br.dtype=wn||er(mr.data)||ns,br.dimension=Rr;var Fn=or.allocType(br.dtype,nn*Rr);Bn(Fn,mr.data,nn,Rr,ba,La,sn),Qr(br,Fn,Jr),Xn?br.persistentData=Fn:or.freeType(Fn)}else mr instanceof ArrayBuffer?(br.dtype=Js,br.dimension=Lr,Qr(br,mr,Jr),Xn&&(br.persistentData=new Uint8Array(new Uint8Array(mr)))):$.raise("invalid buffer data")}function Sn(br){ze.bufferCount--,gr(br);var mr=br.buffer;$(mr,"buffer must not be deleted already"),fe.deleteBuffer(mr),br.buffer=null,delete Or[br.id]}function fn(br,mr,Jr,wn){ze.bufferCount++;var Lr=new xr(mr);Or[Lr.id]=Lr;function Xn(Ur){var Gr=hu,Wn=null,$n=0,sn=0,nn=1;return Array.isArray(Ur)||T(Ur)||Ut(Ur)||Ur instanceof ArrayBuffer?Wn=Ur:typeof Ur=="number"?$n=Ur|0:Ur&&($.type(Ur,"object","buffer arguments must be an object, a number or an array"),"data"in Ur&&($(Wn===null||Array.isArray(Wn)||T(Wn)||Ut(Wn),"invalid data for buffer"),Wn=Ur.data),"usage"in Ur&&($.parameter(Ur.usage,bl,"invalid buffer usage"),Gr=bl[Ur.usage]),"type"in Ur&&($.parameter(Ur.type,_o,"invalid buffer type"),sn=_o[Ur.type]),"dimension"in Ur&&($.type(Ur.dimension,"number","invalid dimension"),nn=Ur.dimension|0),"length"in Ur&&($.nni($n,"buffer length must be a nonnegative integer"),$n=Ur.length|0)),Lr.bind(),Wn?cn(Lr,Wn,Gr,sn,nn,wn):($n&&fe.bufferData(Lr.type,$n,Gr),Lr.dtype=sn||Js,Lr.usage=Gr,Lr.dimension=nn,Lr.byteLength=$n),Pt.profile&&(Lr.stats.size=Lr.byteLength*wt[Lr.dtype]),Xn}function $r(Ur,Gr){$(Gr+Ur.byteLength<=Lr.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+Ur.byteLength+" starting from offset "+Gr+" to a buffer of size "+Lr.byteLength),fe.bufferSubData(Lr.type,Gr,Ur)}function zr(Ur,Gr){var Wn=(Gr||0)|0,$n;if(Lr.bind(),T(Ur)||Ur instanceof ArrayBuffer)$r(Ur,Wn);else if(Array.isArray(Ur)){if(Ur.length>0)if(typeof Ur[0]=="number"){var sn=or.allocType(Lr.dtype,Ur.length);Ar(sn,Ur),$r(sn,Wn),or.freeType(sn)}else if(Array.isArray(Ur[0])||T(Ur[0])){$n=ka(Ur);var nn=Su(Ur,$n,Lr.dtype);$r(nn,Wn),or.freeType(nn)}else $.raise("invalid buffer data")}else if(Ut(Ur)){$n=Ur.shape;var Rr=Ur.stride,ba=0,La=0,Fn=0,Ua=0;$n.length===1?(ba=$n[0],La=1,Fn=Rr[0],Ua=0):$n.length===2?(ba=$n[0],La=$n[1],Fn=Rr[0],Ua=Rr[1]):$.raise("invalid shape");var Ea=Array.isArray(Ur.data)?Lr.dtype:er(Ur.data),Da=or.allocType(Ea,ba*La);Bn(Da,Ur.data,ba,La,Fn,Ua,Ur.offset),$r(Da,Wn),or.freeType(Da)}else $.raise("invalid data for buffer subdata");return Xn}return Jr||Xn(br),Xn._reglType="buffer",Xn._buffer=Lr,Xn.subdata=zr,Pt.profile&&(Xn.stats=Lr.stats),Xn.destroy=function(){Sn(Lr)},Xn}function Kr(){Ie(Or).forEach(function(br){br.buffer=fe.createBuffer(),fe.bindBuffer(br.type,br.buffer),fe.bufferData(br.type,br.persistentData||br.byteLength,br.usage)})}return Pt.profile&&(ze.getTotalBufferSize=function(){var br=0;return Object.keys(Or).forEach(function(mr){br+=Or[mr].stats.size}),br}),{create:fn,createStream:on,destroyStream:rn,clear:function(){Ie(Or).forEach(Sn),Wr.forEach(Sn)},getBuffer:function(mr){return mr&&mr._buffer instanceof xr?mr._buffer:null},restore:Kr,_initBuffer:cn}}var Ii=0,Ki=0,ja=1,pi=1,Zo=4,Ci=4,Xo={points:Ii,point:Ki,lines:ja,line:pi,triangles:Zo,triangle:Ci,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Au=0,du=1,Ds=4,xl=5120,Qs=5121,rl=5122,qs=5123,Vu=5124,tc=5125,vc=34963,gc=35040,Ui=35044;function zc(fe,ze,Pt,gr){var kr={},Or=0,xr={uint8:Qs,uint16:qs};ze.oes_element_index_uint&&(xr.uint32=tc);function Wr(Kr){this.id=Or++,kr[this.id]=this,this.buffer=Kr,this.primType=Ds,this.vertCount=0,this.type=0}Wr.prototype.bind=function(){this.buffer.bind()};var on=[];function rn(Kr){var br=on.pop();return br||(br=new Wr(Pt.create(null,vc,!0,!1)._buffer)),cn(br,Kr,gc,-1,-1,0,0),br}function Qr(Kr){on.push(Kr)}function cn(Kr,br,mr,Jr,wn,Lr,Xn){Kr.buffer.bind();var $r;if(br){var zr=Xn;!Xn&&(!T(br)||Ut(br)&&!T(br.data))&&(zr=ze.oes_element_index_uint?tc:qs),Pt._initBuffer(Kr.buffer,br,mr,zr,3)}else fe.bufferData(vc,Lr,mr),Kr.buffer.dtype=$r||Qs,Kr.buffer.usage=mr,Kr.buffer.dimension=3,Kr.buffer.byteLength=Lr;if($r=Xn,!Xn){switch(Kr.buffer.dtype){case Qs:case xl:$r=Qs;break;case qs:case rl:$r=qs;break;case tc:case Vu:$r=tc;break;default:$.raise("unsupported type for element array")}Kr.buffer.dtype=$r}Kr.type=$r,$($r!==tc||!!ze.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var Ur=wn;Ur<0&&(Ur=Kr.buffer.byteLength,$r===qs?Ur>>=1:$r===tc&&(Ur>>=2)),Kr.vertCount=Ur;var Gr=Jr;if(Jr<0){Gr=Ds;var Wn=Kr.buffer.dimension;Wn===1&&(Gr=Au),Wn===2&&(Gr=du),Wn===3&&(Gr=Ds)}Kr.primType=Gr}function Sn(Kr){gr.elementsCount--,$(Kr.buffer!==null,"must not double destroy elements"),delete kr[Kr.id],Kr.buffer.destroy(),Kr.buffer=null}function fn(Kr,br){var mr=Pt.create(null,vc,!0),Jr=new Wr(mr._buffer);gr.elementsCount++;function wn(Lr){if(!Lr)mr(),Jr.primType=Ds,Jr.vertCount=0,Jr.type=Qs;else if(typeof Lr=="number")mr(Lr),Jr.primType=Ds,Jr.vertCount=Lr|0,Jr.type=Qs;else{var Xn=null,$r=Ui,zr=-1,Ur=-1,Gr=0,Wn=0;Array.isArray(Lr)||T(Lr)||Ut(Lr)?Xn=Lr:($.type(Lr,"object","invalid arguments for elements"),"data"in Lr&&(Xn=Lr.data,$(Array.isArray(Xn)||T(Xn)||Ut(Xn),"invalid data for element buffer")),"usage"in Lr&&($.parameter(Lr.usage,bl,"invalid element buffer usage"),$r=bl[Lr.usage]),"primitive"in Lr&&($.parameter(Lr.primitive,Xo,"invalid element buffer primitive"),zr=Xo[Lr.primitive]),"count"in Lr&&($(typeof Lr.count=="number"&&Lr.count>=0,"invalid vertex count for elements"),Ur=Lr.count|0),"type"in Lr&&($.parameter(Lr.type,xr,"invalid buffer type"),Wn=xr[Lr.type]),"length"in Lr?Gr=Lr.length|0:(Gr=Ur,Wn===qs||Wn===rl?Gr*=2:(Wn===tc||Wn===Vu)&&(Gr*=4))),cn(Jr,Xn,$r,zr,Ur,Gr,Wn)}return wn}return wn(Kr),wn._reglType="elements",wn._elements=Jr,wn.subdata=function(Lr,Xn){return mr.subdata(Lr,Xn),wn},wn.destroy=function(){Sn(Jr)},wn}return{create:fn,createStream:rn,destroyStream:Qr,getElements:function(br){return typeof br=="function"&&br._elements instanceof Wr?br._elements:null},clear:function(){Ie(kr).forEach(Sn)}}}var yc=new Float32Array(1),nf=new Uint32Array(yc.buffer),af=5123;function of(fe){for(var ze=or.allocType(af,fe.length),Pt=0;Pt<fe.length;++Pt)if(isNaN(fe[Pt]))ze[Pt]=65535;else if(fe[Pt]===Infinity)ze[Pt]=31744;else if(fe[Pt]===-Infinity)ze[Pt]=64512;else{yc[0]=fe[Pt];var gr=nf[0],kr=gr>>>31<<15,Or=(gr<<1>>>24)-127,xr=gr>>13&(1<<10)-1;if(Or<-24)ze[Pt]=kr;else if(Or<-14){var Wr=-14-Or;ze[Pt]=kr+(xr+(1<<10)>>Wr)}else Or>15?ze[Pt]=kr+31744:ze[Pt]=kr+(Or+15<<10)+xr}return ze}function Ti(fe){return Array.isArray(fe)||T(fe)}var Cu=function(ze){return!(ze&ze-1)&&!!ze},pu=34467,eu=3553,Fc=34067,rc=34069,mu=6408,Uc=6406,nl=6407,tu=6409,nc=6410,bc=32854,mi=32855,xc=36194,Rf=32819,Ec=32820,If=33635,Bc=34042,Pl=6402,al=34041,Os=35904,ac=35906,No=36193,Ll=33776,El=33777,Vc=33778,Rl=33779,ru=35986,Gc=35987,bf=34798,xf=35840,Il=35841,ic=35842,Zi=35843,Dl=36196,Gu=5121,Ef=5123,Nl=5125,oc=5126,Wf=10242,Df=10243,Tc=10497,kl=33071,_c=33648,wu=10240,Ns=10241,il=9728,Tl=9729,sc=9984,Bi=9985,vu=9986,ol=9987,Yo=33170,ei=4352,$a=4353,Hu=4354,ti=34046,Xa=3317,Tf=37440,_f=37441,Ko=37443,Wu=37444,gs=33984,ks=[sc,vu,Bi,ol],ys=[0,tu,nc,nl,mu],$o={};$o[tu]=$o[Uc]=$o[Pl]=1,$o[al]=$o[nc]=2,$o[nl]=$o[Os]=3,$o[mu]=$o[ac]=4;function Zu(fe){return"[object "+fe+"]"}var xn=Zu("HTMLCanvasElement"),bs=Zu("OffscreenCanvas"),nu=Zu("CanvasRenderingContext2D"),Sc=Zu("ImageBitmap"),Ou=Zu("HTMLImageElement"),Mu=Zu("HTMLVideoElement"),gu=Object.keys(Mo).concat([xn,bs,nu,Sc,Ou,Mu]),Zr=[];Zr[Gu]=1,Zr[oc]=4,Zr[No]=2,Zr[Ef]=2,Zr[Nl]=4;var vi=[];vi[bc]=2,vi[mi]=2,vi[xc]=2,vi[al]=4,vi[Ll]=.5,vi[El]=.5,vi[Vc]=1,vi[Rl]=1,vi[ru]=.5,vi[Gc]=1,vi[bf]=1,vi[xf]=.5,vi[Il]=.25,vi[ic]=.5,vi[Zi]=.25,vi[Dl]=.5;function Hc(fe){return Array.isArray(fe)&&(fe.length===0||typeof fe[0]=="number")}function Wc(fe){if(!Array.isArray(fe))return!1;var ze=fe.length;return!(ze===0||!Ti(fe[0]))}function sl(fe){return Object.prototype.toString.call(fe)}function Pu(fe){return sl(fe)===xn}function Ms(fe){return sl(fe)===bs}function as(fe){return sl(fe)===nu}function wi(fe){return sl(fe)===Sc}function js(fe){return sl(fe)===Ou}function sf(fe){return sl(fe)===Mu}function ul(fe){if(!fe)return!1;var ze=sl(fe);return gu.indexOf(ze)>=0?!0:Hc(fe)||Wc(fe)||Ut(fe)}function jl(fe){return Mo[Object.prototype.toString.call(fe)]|0}function uf(fe,ze){var Pt=ze.length;switch(fe.type){case Gu:case Ef:case Nl:case oc:var gr=or.allocType(fe.type,Pt);gr.set(ze),fe.data=gr;break;case No:fe.data=of(ze);break;default:$.raise("unsupported texture type, must specify a typed array")}}function uc(fe,ze){return or.allocType(fe.type===No?oc:fe.type,ze)}function uo(fe,ze){fe.type===No?(fe.data=of(ze),or.freeType(ze)):fe.data=ze}function ci(fe,ze,Pt,gr,kr,Or){for(var xr=fe.width,Wr=fe.height,on=fe.channels,rn=xr*Wr*on,Qr=uc(fe,rn),cn=0,Sn=0;Sn<Wr;++Sn)for(var fn=0;fn<xr;++fn)for(var Kr=0;Kr<on;++Kr)Qr[cn++]=ze[Pt*fn+gr*Sn+kr*Kr+Or];uo(fe,Qr)}function mo(fe,ze,Pt,gr,kr,Or){var xr;if(typeof vi[fe]!="undefined"?xr=vi[fe]:xr=$o[fe]*Zr[ze],Or&&(xr*=6),kr){for(var Wr=0,on=Pt;on>=1;)Wr+=xr*on*on,on/=2;return Wr}else return xr*Pt*gr}function ll(fe,ze,Pt,gr,kr,Or,xr){var Wr={"don't care":ei,"dont care":ei,nice:Hu,fast:$a},on={repeat:Tc,clamp:kl,mirror:_c},rn={nearest:il,linear:Tl},Qr=m({mipmap:ol,"nearest mipmap nearest":sc,"linear mipmap nearest":Bi,"nearest mipmap linear":vu,"linear mipmap linear":ol},rn),cn={none:0,browser:Wu},Sn={uint8:Gu,rgba4:Rf,rgb565:If,"rgb5 a1":Ec},fn={alpha:Uc,luminance:tu,"luminance alpha":nc,rgb:nl,rgba:mu,rgba4:bc,"rgb5 a1":mi,rgb565:xc},Kr={};ze.ext_srgb&&(fn.srgb=Os,fn.srgba=ac),ze.oes_texture_float&&(Sn.float32=Sn.float=oc),ze.oes_texture_half_float&&(Sn.float16=Sn["half float"]=No),ze.webgl_depth_texture&&(m(fn,{depth:Pl,"depth stencil":al}),m(Sn,{uint16:Ef,uint32:Nl,"depth stencil":Bc})),ze.webgl_compressed_texture_s3tc&&m(Kr,{"rgb s3tc dxt1":Ll,"rgba s3tc dxt1":El,"rgba s3tc dxt3":Vc,"rgba s3tc dxt5":Rl}),ze.webgl_compressed_texture_atc&&m(Kr,{"rgb atc":ru,"rgba atc explicit alpha":Gc,"rgba atc interpolated alpha":bf}),ze.webgl_compressed_texture_pvrtc&&m(Kr,{"rgb pvrtc 4bppv1":xf,"rgb pvrtc 2bppv1":Il,"rgba pvrtc 4bppv1":ic,"rgba pvrtc 2bppv1":Zi}),ze.webgl_compressed_texture_etc1&&(Kr["rgb etc1"]=Dl);var br=Array.prototype.slice.call(fe.getParameter(pu));Object.keys(Kr).forEach(function(Ot){var Er=Kr[Ot];br.indexOf(Er)>=0&&(fn[Ot]=Er)});var mr=Object.keys(fn);Pt.textureFormats=mr;var Jr=[];Object.keys(fn).forEach(function(Ot){var Er=fn[Ot];Jr[Er]=Ot});var wn=[];Object.keys(Sn).forEach(function(Ot){var Er=Sn[Ot];wn[Er]=Ot});var Lr=[];Object.keys(rn).forEach(function(Ot){var Er=rn[Ot];Lr[Er]=Ot});var Xn=[];Object.keys(Qr).forEach(function(Ot){var Er=Qr[Ot];Xn[Er]=Ot});var $r=[];Object.keys(on).forEach(function(Ot){var Er=on[Ot];$r[Er]=Ot});var zr=mr.reduce(function(Ot,Er){var yr=fn[Er];return yr===tu||yr===Uc||yr===tu||yr===nc||yr===Pl||yr===al||ze.ext_srgb&&(yr===Os||yr===ac)?Ot[yr]=yr:yr===mi||Er.indexOf("rgba")>=0?Ot[yr]=mu:Ot[yr]=nl,Ot},{});function Ur(){this.internalformat=mu,this.format=mu,this.type=Gu,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Wu,this.width=0,this.height=0,this.channels=0}function Gr(Ot,Er){Ot.internalformat=Er.internalformat,Ot.format=Er.format,Ot.type=Er.type,Ot.compressed=Er.compressed,Ot.premultiplyAlpha=Er.premultiplyAlpha,Ot.flipY=Er.flipY,Ot.unpackAlignment=Er.unpackAlignment,Ot.colorSpace=Er.colorSpace,Ot.width=Er.width,Ot.height=Er.height,Ot.channels=Er.channels}function Wn(Ot,Er){if(typeof Er!="object"||!Er)return;if("premultiplyAlpha"in Er&&($.type(Er.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),Ot.premultiplyAlpha=Er.premultiplyAlpha),"flipY"in Er&&($.type(Er.flipY,"boolean","invalid texture flip"),Ot.flipY=Er.flipY),"alignment"in Er&&($.oneOf(Er.alignment,[1,2,4,8],"invalid texture unpack alignment"),Ot.unpackAlignment=Er.alignment),"colorSpace"in Er&&($.parameter(Er.colorSpace,cn,"invalid colorSpace"),Ot.colorSpace=cn[Er.colorSpace]),"type"in Er){var yr=Er.type;$(ze.oes_texture_float||!(yr==="float"||yr==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),$(ze.oes_texture_half_float||!(yr==="half float"||yr==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),$(ze.webgl_depth_texture||!(yr==="uint16"||yr==="uint32"||yr==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),$.parameter(yr,Sn,"invalid texture type"),Ot.type=Sn[yr]}var Cn=Ot.width,Oa=Ot.height,v=Ot.channels,f=!1;"shape"in Er?($(Array.isArray(Er.shape)&&Er.shape.length>=2,"shape must be an array"),Cn=Er.shape[0],Oa=Er.shape[1],Er.shape.length===3&&(v=Er.shape[2],$(v>0&&v<=4,"invalid number of channels"),f=!0),$(Cn>=0&&Cn<=Pt.maxTextureSize,"invalid width"),$(Oa>=0&&Oa<=Pt.maxTextureSize,"invalid height")):("radius"in Er&&(Cn=Oa=Er.radius,$(Cn>=0&&Cn<=Pt.maxTextureSize,"invalid radius")),"width"in Er&&(Cn=Er.width,$(Cn>=0&&Cn<=Pt.maxTextureSize,"invalid width")),"height"in Er&&(Oa=Er.height,$(Oa>=0&&Oa<=Pt.maxTextureSize,"invalid height")),"channels"in Er&&(v=Er.channels,$(v>0&&v<=4,"invalid number of channels"),f=!0)),Ot.width=Cn|0,Ot.height=Oa|0,Ot.channels=v|0;var c=!1;if("format"in Er){var p=Er.format;$(ze.webgl_depth_texture||!(p==="depth"||p==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),$.parameter(p,fn,"invalid texture format");var y=Ot.internalformat=fn[p];Ot.format=zr[y],p in Sn&&("type"in Er||(Ot.type=Sn[p])),p in Kr&&(Ot.compressed=!0),c=!0}!f&&c?Ot.channels=$o[Ot.format]:f&&!c?Ot.channels!==ys[Ot.format]&&(Ot.format=Ot.internalformat=ys[Ot.channels]):c&&f&&$(Ot.channels===$o[Ot.format],"number of channels inconsistent with specified format")}function $n(Ot){fe.pixelStorei(Tf,Ot.flipY),fe.pixelStorei(_f,Ot.premultiplyAlpha),fe.pixelStorei(Ko,Ot.colorSpace),fe.pixelStorei(Xa,Ot.unpackAlignment)}function sn(){Ur.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function nn(Ot,Er){var yr=null;if(ul(Er)?yr=Er:Er&&($.type(Er,"object","invalid pixel data type"),Wn(Ot,Er),"x"in Er&&(Ot.xOffset=Er.x|0),"y"in Er&&(Ot.yOffset=Er.y|0),ul(Er.data)&&(yr=Er.data)),$(!Ot.compressed||yr instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),Er.copy){$(!yr,"can not specify copy and data field for the same texture");var Cn=kr.viewportWidth,Oa=kr.viewportHeight;Ot.width=Ot.width||Cn-Ot.xOffset,Ot.height=Ot.height||Oa-Ot.yOffset,Ot.needsCopy=!0,$(Ot.xOffset>=0&&Ot.xOffset<Cn&&Ot.yOffset>=0&&Ot.yOffset<Oa&&Ot.width>0&&Ot.width<=Cn&&Ot.height>0&&Ot.height<=Oa,"copy texture read out of bounds")}else if(!yr)Ot.width=Ot.width||1,Ot.height=Ot.height||1,Ot.channels=Ot.channels||4;else if(T(yr))Ot.channels=Ot.channels||4,Ot.data=yr,!("type"in Er)&&Ot.type===Gu&&(Ot.type=jl(yr));else if(Hc(yr))Ot.channels=Ot.channels||4,uf(Ot,yr),Ot.alignment=1,Ot.needsFree=!0;else if(Ut(yr)){var v=yr.data;!Array.isArray(v)&&Ot.type===Gu&&(Ot.type=jl(v));var f=yr.shape,c=yr.stride,p,y,P,N,ee,V;f.length===3?(P=f[2],V=c[2]):($(f.length===2,"invalid ndarray pixel data, must be 2 or 3D"),P=1,V=1),p=f[0],y=f[1],N=c[0],ee=c[1],Ot.alignment=1,Ot.width=p,Ot.height=y,Ot.channels=P,Ot.format=Ot.internalformat=ys[P],Ot.needsFree=!0,ci(Ot,v,N,ee,V,yr.offset)}else if(Pu(yr)||Ms(yr)||as(yr))Pu(yr)||Ms(yr)?Ot.element=yr:Ot.element=yr.canvas,Ot.width=Ot.element.width,Ot.height=Ot.element.height,Ot.channels=4;else if(wi(yr))Ot.element=yr,Ot.width=yr.width,Ot.height=yr.height,Ot.channels=4;else if(js(yr))Ot.element=yr,Ot.width=yr.naturalWidth,Ot.height=yr.naturalHeight,Ot.channels=4;else if(sf(yr))Ot.element=yr,Ot.width=yr.videoWidth,Ot.height=yr.videoHeight,Ot.channels=4;else if(Wc(yr)){var J=Ot.width||yr[0].length,he=Ot.height||yr.length,We=Ot.channels;Ti(yr[0][0])?We=We||yr[0][0].length:We=We||1;for(var De=Mt.shape(yr),It=1,Kt=0;Kt<De.length;++Kt)It*=De[Kt];var Ht=uc(Ot,It);Mt.flatten(yr,De,"",Ht),uo(Ot,Ht),Ot.alignment=1,Ot.width=J,Ot.height=he,Ot.channels=We,Ot.format=Ot.internalformat=ys[We],Ot.needsFree=!0}Ot.type===oc?$(Pt.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):Ot.type===No&&$(Pt.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function Rr(Ot,Er,yr){var Cn=Ot.element,Oa=Ot.data,v=Ot.internalformat,f=Ot.format,c=Ot.type,p=Ot.width,y=Ot.height;$n(Ot),Cn?fe.texImage2D(Er,yr,f,f,c,Cn):Ot.compressed?fe.compressedTexImage2D(Er,yr,v,p,y,0,Oa):Ot.needsCopy?(gr(),fe.copyTexImage2D(Er,yr,f,Ot.xOffset,Ot.yOffset,p,y,0)):fe.texImage2D(Er,yr,f,p,y,0,f,c,Oa||null)}function ba(Ot,Er,yr,Cn,Oa){var v=Ot.element,f=Ot.data,c=Ot.internalformat,p=Ot.format,y=Ot.type,P=Ot.width,N=Ot.height;$n(Ot),v?fe.texSubImage2D(Er,Oa,yr,Cn,p,y,v):Ot.compressed?fe.compressedTexSubImage2D(Er,Oa,yr,Cn,c,P,N,f):Ot.needsCopy?(gr(),fe.copyTexSubImage2D(Er,Oa,yr,Cn,Ot.xOffset,Ot.yOffset,P,N)):fe.texSubImage2D(Er,Oa,yr,Cn,P,N,p,y,f)}var La=[];function Fn(){return La.pop()||new sn}function Ua(Ot){Ot.needsFree&&or.freeType(Ot.data),sn.call(Ot),La.push(Ot)}function Ea(){Ur.call(this),this.genMipmaps=!1,this.mipmapHint=ei,this.mipmask=0,this.images=Array(16)}function Da(Ot,Er,yr){var Cn=Ot.images[0]=Fn();Ot.mipmask=1,Cn.width=Ot.width=Er,Cn.height=Ot.height=yr,Cn.channels=Ot.channels=4}function bi(Ot,Er){var yr=null;if(ul(Er))yr=Ot.images[0]=Fn(),Gr(yr,Ot),nn(yr,Er),Ot.mipmask=1;else if(Wn(Ot,Er),Array.isArray(Er.mipmap))for(var Cn=Er.mipmap,Oa=0;Oa<Cn.length;++Oa)yr=Ot.images[Oa]=Fn(),Gr(yr,Ot),yr.width>>=Oa,yr.height>>=Oa,nn(yr,Cn[Oa]),Ot.mipmask|=1<<Oa;else yr=Ot.images[0]=Fn(),Gr(yr,Ot),nn(yr,Er),Ot.mipmask=1;Gr(Ot,Ot.images[0]),Ot.compressed&&(Ot.internalformat===Ll||Ot.internalformat===El||Ot.internalformat===Vc||Ot.internalformat===Rl)&&$(Ot.width%4===0&&Ot.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Bo(Ot,Er){for(var yr=Ot.images,Cn=0;Cn<yr.length;++Cn){if(!yr[Cn])return;Rr(yr[Cn],Er,Cn)}}var So=[];function Ba(){var Ot=So.pop()||new Ea;Ur.call(Ot),Ot.mipmask=0;for(var Er=0;Er<16;++Er)Ot.images[Er]=null;return Ot}function qo(Ot){for(var Er=Ot.images,yr=0;yr<Er.length;++yr)Er[yr]&&Ua(Er[yr]),Er[yr]=null;So.push(Ot)}function ji(){this.minFilter=il,this.magFilter=il,this.wrapS=kl,this.wrapT=kl,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=ei}function _s(Ot,Er){if("min"in Er){var yr=Er.min;$.parameter(yr,Qr),Ot.minFilter=Qr[yr],ks.indexOf(Ot.minFilter)>=0&&!("faces"in Er)&&(Ot.genMipmaps=!0)}if("mag"in Er){var Cn=Er.mag;$.parameter(Cn,rn),Ot.magFilter=rn[Cn]}var Oa=Ot.wrapS,v=Ot.wrapT;if("wrap"in Er){var f=Er.wrap;typeof f=="string"?($.parameter(f,on),Oa=v=on[f]):Array.isArray(f)&&($.parameter(f[0],on),$.parameter(f[1],on),Oa=on[f[0]],v=on[f[1]])}else{if("wrapS"in Er){var c=Er.wrapS;$.parameter(c,on),Oa=on[c]}if("wrapT"in Er){var p=Er.wrapT;$.parameter(p,on),v=on[p]}}if(Ot.wrapS=Oa,Ot.wrapT=v,"anisotropic"in Er){var y=Er.anisotropic;$(typeof y=="number"&&y>=1&&y<=Pt.maxAnisotropic,"aniso samples must be between 1 and "),Ot.anisotropic=Er.anisotropic}if("mipmap"in Er){var P=!1;switch(typeof Er.mipmap){case"string":$.parameter(Er.mipmap,Wr,"invalid mipmap hint"),Ot.mipmapHint=Wr[Er.mipmap],Ot.genMipmaps=!0,P=!0;break;case"boolean":P=Ot.genMipmaps=Er.mipmap;break;case"object":$(Array.isArray(Er.mipmap),"invalid mipmap type"),Ot.genMipmaps=!1,P=!0;break;default:$.raise("invalid mipmap type")}P&&!("min"in Er)&&(Ot.minFilter=sc)}}function es(Ot,Er){fe.texParameteri(Er,Ns,Ot.minFilter),fe.texParameteri(Er,wu,Ot.magFilter),fe.texParameteri(Er,Wf,Ot.wrapS),fe.texParameteri(Er,Df,Ot.wrapT),ze.ext_texture_filter_anisotropic&&fe.texParameteri(Er,ti,Ot.anisotropic),Ot.genMipmaps&&(fe.hint(Yo,Ot.mipmapHint),fe.generateMipmap(Er))}var Vo=0,ts={},Hs=Pt.maxTextureUnits,Go=Array(Hs).map(function(){return null});function ra(Ot){Ur.call(this),this.mipmask=0,this.internalformat=mu,this.id=Vo++,this.refCount=1,this.target=Ot,this.texture=fe.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new ji,xr.profile&&(this.stats={size:0})}function ou(Ot){fe.activeTexture(gs),fe.bindTexture(Ot.target,Ot.texture)}function hi(){var Ot=Go[0];Ot?fe.bindTexture(Ot.target,Ot.texture):fe.bindTexture(eu,null)}function En(Ot){var Er=Ot.texture;$(Er,"must not double destroy texture");var yr=Ot.unit,Cn=Ot.target;yr>=0&&(fe.activeTexture(gs+yr),fe.bindTexture(Cn,null),Go[yr]=null),fe.deleteTexture(Er),Ot.texture=null,Ot.params=null,Ot.pixels=null,Ot.refCount=0,delete ts[Ot.id],Or.textureCount--}m(ra.prototype,{bind:function(){var Er=this;Er.bindCount+=1;var yr=Er.unit;if(yr<0){for(var Cn=0;Cn<Hs;++Cn){var Oa=Go[Cn];if(Oa){if(Oa.bindCount>0)continue;Oa.unit=-1}Go[Cn]=Er,yr=Cn;break}yr>=Hs&&$.raise("insufficient number of texture units"),xr.profile&&Or.maxTextureUnits<yr+1&&(Or.maxTextureUnits=yr+1),Er.unit=yr,fe.activeTexture(gs+yr),fe.bindTexture(Er.target,Er.texture)}return yr},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&En(this)}});function xa(Ot,Er){var yr=new ra(eu);ts[yr.id]=yr,Or.textureCount++;function Cn(f,c){var p=yr.texInfo;ji.call(p);var y=Ba();return typeof f=="number"?typeof c=="number"?Da(y,f|0,c|0):Da(y,f|0,f|0):f?($.type(f,"object","invalid arguments to regl.texture"),_s(p,f),bi(y,f)):Da(y,1,1),p.genMipmaps&&(y.mipmask=(y.width<<1)-1),yr.mipmask=y.mipmask,Gr(yr,y),$.texture2D(p,y,Pt),yr.internalformat=y.internalformat,Cn.width=y.width,Cn.height=y.height,ou(yr),Bo(y,eu),es(p,eu),hi(),qo(y),xr.profile&&(yr.stats.size=mo(yr.internalformat,yr.type,y.width,y.height,p.genMipmaps,!1)),Cn.format=Jr[yr.internalformat],Cn.type=wn[yr.type],Cn.mag=Lr[p.magFilter],Cn.min=Xn[p.minFilter],Cn.wrapS=$r[p.wrapS],Cn.wrapT=$r[p.wrapT],Cn}function Oa(f,c,p,y){$(!!f,"must specify image data");var P=c|0,N=p|0,ee=y|0,V=Fn();return Gr(V,yr),V.width=0,V.height=0,nn(V,f),V.width=V.width||(yr.width>>ee)-P,V.height=V.height||(yr.height>>ee)-N,$(yr.type===V.type&&yr.format===V.format&&yr.internalformat===V.internalformat,"incompatible format for texture.subimage"),$(P>=0&&N>=0&&P+V.width<=yr.width&&N+V.height<=yr.height,"texture.subimage write out of bounds"),$(yr.mipmask&1<<ee,"missing mipmap data"),$(V.data||V.element||V.needsCopy,"missing image data"),ou(yr),ba(V,eu,P,N,ee),hi(),Ua(V),Cn}function v(f,c){var p=f|0,y=c|0||p;if(p===yr.width&&y===yr.height)return Cn;Cn.width=yr.width=p,Cn.height=yr.height=y,ou(yr);for(var P=0;yr.mipmask>>P;++P){var N=p>>P,ee=y>>P;if(!N||!ee)break;fe.texImage2D(eu,P,yr.format,N,ee,0,yr.format,yr.type,null)}return hi(),xr.profile&&(yr.stats.size=mo(yr.internalformat,yr.type,p,y,!1,!1)),Cn}return Cn(Ot,Er),Cn.subimage=Oa,Cn.resize=v,Cn._reglType="texture2d",Cn._texture=yr,xr.profile&&(Cn.stats=yr.stats),Cn.destroy=function(){yr.decRef()},Cn}function Va(Ot,Er,yr,Cn,Oa,v){var f=new ra(Fc);ts[f.id]=f,Or.cubeCount++;var c=new Array(6);function p(N,ee,V,J,he,We){var De,It=f.texInfo;for(ji.call(It),De=0;De<6;++De)c[De]=Ba();if(typeof N=="number"||!N){var Kt=N|0||1;for(De=0;De<6;++De)Da(c[De],Kt,Kt)}else if(typeof N=="object")if(ee)bi(c[0],N),bi(c[1],ee),bi(c[2],V),bi(c[3],J),bi(c[4],he),bi(c[5],We);else if(_s(It,N),Wn(f,N),"faces"in N){var Ht=N.faces;for($(Array.isArray(Ht)&&Ht.length===6,"cube faces must be a length 6 array"),De=0;De<6;++De)$(typeof Ht[De]=="object"&&!!Ht[De],"invalid input for cube map face"),Gr(c[De],f),bi(c[De],Ht[De])}else for(De=0;De<6;++De)bi(c[De],N);else $.raise("invalid arguments to cube map");for(Gr(f,c[0]),Pt.npotTextureCube||$(Cu(f.width)&&Cu(f.height),"your browser does not support non power or two texture dimensions"),It.genMipmaps?f.mipmask=(c[0].width<<1)-1:f.mipmask=c[0].mipmask,$.textureCube(f,It,c,Pt),f.internalformat=c[0].internalformat,p.width=c[0].width,p.height=c[0].height,ou(f),De=0;De<6;++De)Bo(c[De],rc+De);for(es(It,Fc),hi(),xr.profile&&(f.stats.size=mo(f.internalformat,f.type,p.width,p.height,It.genMipmaps,!0)),p.format=Jr[f.internalformat],p.type=wn[f.type],p.mag=Lr[It.magFilter],p.min=Xn[It.minFilter],p.wrapS=$r[It.wrapS],p.wrapT=$r[It.wrapT],De=0;De<6;++De)qo(c[De]);return p}function y(N,ee,V,J,he){$(!!ee,"must specify image data"),$(typeof N=="number"&&N===(N|0)&&N>=0&&N<6,"invalid face");var We=V|0,De=J|0,It=he|0,Kt=Fn();return Gr(Kt,f),Kt.width=0,Kt.height=0,nn(Kt,ee),Kt.width=Kt.width||(f.width>>It)-We,Kt.height=Kt.height||(f.height>>It)-De,$(f.type===Kt.type&&f.format===Kt.format&&f.internalformat===Kt.internalformat,"incompatible format for texture.subimage"),$(We>=0&&De>=0&&We+Kt.width<=f.width&&De+Kt.height<=f.height,"texture.subimage write out of bounds"),$(f.mipmask&1<<It,"missing mipmap data"),$(Kt.data||Kt.element||Kt.needsCopy,"missing image data"),ou(f),ba(Kt,rc+N,We,De,It),hi(),Ua(Kt),p}function P(N){var ee=N|0;if(ee===f.width)return;p.width=f.width=ee,p.height=f.height=ee,ou(f);for(var V=0;V<6;++V)for(var J=0;f.mipmask>>J;++J)fe.texImage2D(rc+V,J,f.format,ee>>J,ee>>J,0,f.format,f.type,null);return hi(),xr.profile&&(f.stats.size=mo(f.internalformat,f.type,p.width,p.height,!1,!0)),p}return p(Ot,Er,yr,Cn,Oa,v),p.subimage=y,p.resize=P,p._reglType="textureCube",p._texture=f,xr.profile&&(p.stats=f.stats),p.destroy=function(){f.decRef()},p}function Ao(){for(var Ot=0;Ot<Hs;++Ot)fe.activeTexture(gs+Ot),fe.bindTexture(eu,null),Go[Ot]=null;Ie(ts).forEach(En),Or.cubeCount=0,Or.textureCount=0}xr.profile&&(Or.getTotalTextureSize=function(){var Ot=0;return Object.keys(ts).forEach(function(Er){Ot+=ts[Er].stats.size}),Ot});function su(){for(var Ot=0;Ot<Hs;++Ot){var Er=Go[Ot];Er&&(Er.bindCount=0,Er.unit=-1,Go[Ot]=null)}Ie(ts).forEach(function(yr){yr.texture=fe.createTexture(),fe.bindTexture(yr.target,yr.texture);for(var Cn=0;Cn<32;++Cn){if((yr.mipmask&1<<Cn)===0)continue;if(yr.target===eu)fe.texImage2D(eu,Cn,yr.internalformat,yr.width>>Cn,yr.height>>Cn,0,yr.internalformat,yr.type,null);else for(var Oa=0;Oa<6;++Oa)fe.texImage2D(rc+Oa,Cn,yr.internalformat,yr.width>>Cn,yr.height>>Cn,0,yr.internalformat,yr.type,null)}es(yr.texInfo,yr.target)})}function $l(){for(var Ot=0;Ot<Hs;++Ot){var Er=Go[Ot];Er&&(Er.bindCount=0,Er.unit=-1,Go[Ot]=null),fe.activeTexture(gs+Ot),fe.bindTexture(eu,null),fe.bindTexture(Fc,null)}}return{create2D:xa,createCube:Va,clear:Ao,getTexture:function(Er){return null},restore:su,refresh:$l}}var gi=36161,Ps=32854,cl=32855,au=36194,ko=33189,_l=36168,Qn=34041,ua=35907,lo=34836,zl=34842,zs=34843,Di=[];Di[Ps]=2,Di[cl]=2,Di[au]=2,Di[ko]=2,Di[_l]=1,Di[Qn]=4,Di[ua]=4,Di[lo]=16,Di[zl]=8,Di[zs]=6;function is(fe,ze,Pt){return Di[fe]*ze*Pt}var Zc=function(ze,Pt,gr,kr,Or){var xr={rgba4:Ps,rgb565:au,"rgb5 a1":cl,depth:ko,stencil:_l,"depth stencil":Qn};Pt.ext_srgb&&(xr.srgba=ua),Pt.ext_color_buffer_half_float&&(xr.rgba16f=zl,xr.rgb16f=zs),Pt.webgl_color_buffer_float&&(xr.rgba32f=lo);var Wr=[];Object.keys(xr).forEach(function(Kr){var br=xr[Kr];Wr[br]=Kr});var on=0,rn={};function Qr(Kr){this.id=on++,this.refCount=1,this.renderbuffer=Kr,this.format=Ps,this.width=0,this.height=0,Or.profile&&(this.stats={size:0})}Qr.prototype.decRef=function(){--this.refCount<=0&&cn(this)};function cn(Kr){var br=Kr.renderbuffer;$(br,"must not double destroy renderbuffer"),ze.bindRenderbuffer(gi,null),ze.deleteRenderbuffer(br),Kr.renderbuffer=null,Kr.refCount=0,delete rn[Kr.id],kr.renderbufferCount--}function Sn(Kr,br){var mr=new Qr(ze.createRenderbuffer());rn[mr.id]=mr,kr.renderbufferCount++;function Jr(Lr,Xn){var $r=0,zr=0,Ur=Ps;if(typeof Lr=="object"&&Lr){var Gr=Lr;if("shape"in Gr){var Wn=Gr.shape;$(Array.isArray(Wn)&&Wn.length>=2,"invalid renderbuffer shape"),$r=Wn[0]|0,zr=Wn[1]|0}else"radius"in Gr&&($r=zr=Gr.radius|0),"width"in Gr&&($r=Gr.width|0),"height"in Gr&&(zr=Gr.height|0);"format"in Gr&&($.parameter(Gr.format,xr,"invalid renderbuffer format"),Ur=xr[Gr.format])}else typeof Lr=="number"?($r=Lr|0,typeof Xn=="number"?zr=Xn|0:zr=$r):Lr?$.raise("invalid arguments to renderbuffer constructor"):$r=zr=1;return $($r>0&&zr>0&&$r<=gr.maxRenderbufferSize&&zr<=gr.maxRenderbufferSize,"invalid renderbuffer size"),$r===mr.width&&zr===mr.height&&Ur===mr.format?void 0:(Jr.width=mr.width=$r,Jr.height=mr.height=zr,mr.format=Ur,ze.bindRenderbuffer(gi,mr.renderbuffer),ze.renderbufferStorage(gi,Ur,$r,zr),$(ze.getError()===0,"invalid render buffer format"),Or.profile&&(mr.stats.size=is(mr.format,mr.width,mr.height)),Jr.format=Wr[mr.format],Jr)}function wn(Lr,Xn){var $r=Lr|0,zr=Xn|0||$r;return $r===mr.width&&zr===mr.height||($($r>0&&zr>0&&$r<=gr.maxRenderbufferSize&&zr<=gr.maxRenderbufferSize,"invalid renderbuffer size"),Jr.width=mr.width=$r,Jr.height=mr.height=zr,ze.bindRenderbuffer(gi,mr.renderbuffer),ze.renderbufferStorage(gi,mr.format,$r,zr),$(ze.getError()===0,"invalid render buffer format"),Or.profile&&(mr.stats.size=is(mr.format,mr.width,mr.height))),Jr}return Jr(Kr,br),Jr.resize=wn,Jr._reglType="renderbuffer",Jr._renderbuffer=mr,Or.profile&&(Jr.stats=mr.stats),Jr.destroy=function(){mr.decRef()},Jr}Or.profile&&(kr.getTotalRenderbufferSize=function(){var Kr=0;return Object.keys(rn).forEach(function(br){Kr+=rn[br].stats.size}),Kr});function fn(){Ie(rn).forEach(function(Kr){Kr.renderbuffer=ze.createRenderbuffer(),ze.bindRenderbuffer(gi,Kr.renderbuffer),ze.renderbufferStorage(gi,Kr.format,Kr.width,Kr.height)}),ze.bindRenderbuffer(gi,null)}return{create:Sn,clear:function(){Ie(rn).forEach(cn)},restore:fn}},Fs=36160,_i=36161,Si=3553,Xu=34069,yu=36064,Fl=36096,lc=36128,Lu=33306,os=36053,Yu=36054,bu=36055,Sf=36057,Ul=36061,Xc=36193,lf=5121,iu=5126,Sl=6407,xu=6408,cc=6402,Ru=[Sl,xu],fl=[];fl[xu]=4,fl[Sl]=3;var hl=[];hl[lf]=1,hl[iu]=4,hl[Xc]=2;var Ls=32854,Bl=32855,Yc=36194,Vl=33189,s=36168,a=34041,n=35907,l=34836,b=34842,O=34843,R=[Ls,Bl,Yc,n,b,O,l],j={};j[os]="complete",j[Yu]="incomplete attachment",j[Sf]="incomplete dimensions",j[bu]="incomplete, missing attachment",j[Ul]="unsupported";function ue(fe,ze,Pt,gr,kr,Or){var xr={cur:null,next:null,dirty:!1,setFBO:null},Wr=["rgba"],on=["rgba4","rgb565","rgb5 a1"];ze.ext_srgb&&on.push("srgba"),ze.ext_color_buffer_half_float&&on.push("rgba16f","rgb16f"),ze.webgl_color_buffer_float&&on.push("rgba32f");var rn=["uint8"];ze.oes_texture_half_float&&rn.push("half float","float16"),ze.oes_texture_float&&rn.push("float","float32");function Qr(sn,nn,Rr){this.target=sn,this.texture=nn,this.renderbuffer=Rr;var ba=0,La=0;nn?(ba=nn.width,La=nn.height):Rr&&(ba=Rr.width,La=Rr.height),this.width=ba,this.height=La}function cn(sn){sn&&(sn.texture&&sn.texture._texture.decRef(),sn.renderbuffer&&sn.renderbuffer._renderbuffer.decRef())}function Sn(sn,nn,Rr){if(!sn)return;if(sn.texture){var ba=sn.texture._texture,La=Math.max(1,ba.width),Fn=Math.max(1,ba.height);$(La===nn&&Fn===Rr,"inconsistent width/height for supplied texture"),ba.refCount+=1}else{var Ua=sn.renderbuffer._renderbuffer;$(Ua.width===nn&&Ua.height===Rr,"inconsistent width/height for renderbuffer"),Ua.refCount+=1}}function fn(sn,nn){nn&&(nn.texture?fe.framebufferTexture2D(Fs,sn,nn.target,nn.texture._texture.texture,0):fe.framebufferRenderbuffer(Fs,sn,_i,nn.renderbuffer._renderbuffer.renderbuffer))}function Kr(sn){var nn=Si,Rr=null,ba=null,La=sn;typeof sn=="object"&&(La=sn.data,"target"in sn&&(nn=sn.target|0)),$.type(La,"function","invalid attachment data");var Fn=La._reglType;return Fn==="texture2d"?(Rr=La,$(nn===Si)):Fn==="textureCube"?(Rr=La,$(nn>=Xu&&nn<Xu+6,"invalid cube map target")):Fn==="renderbuffer"?(ba=La,nn=_i):$.raise("invalid regl object for attachment"),new Qr(nn,Rr,ba)}function br(sn,nn,Rr,ba,La){if(Rr){var Fn=gr.create2D({width:sn,height:nn,format:ba,type:La});return Fn._texture.refCount=0,new Qr(Si,Fn,null)}else{var Ua=kr.create({width:sn,height:nn,format:ba});return Ua._renderbuffer.refCount=0,new Qr(_i,null,Ua)}}function mr(sn){return sn&&(sn.texture||sn.renderbuffer)}function Jr(sn,nn,Rr){sn&&(sn.texture?sn.texture.resize(nn,Rr):sn.renderbuffer&&sn.renderbuffer.resize(nn,Rr),sn.width=nn,sn.height=Rr)}var wn=0,Lr={};function Xn(){this.id=wn++,Lr[this.id]=this,this.framebuffer=fe.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function $r(sn){sn.colorAttachments.forEach(cn),cn(sn.depthAttachment),cn(sn.stencilAttachment),cn(sn.depthStencilAttachment)}function zr(sn){var nn=sn.framebuffer;$(nn,"must not double destroy framebuffer"),fe.deleteFramebuffer(nn),sn.framebuffer=null,Or.framebufferCount--,delete Lr[sn.id]}function Ur(sn){var nn;fe.bindFramebuffer(Fs,sn.framebuffer);var Rr=sn.colorAttachments;for(nn=0;nn<Rr.length;++nn)fn(yu+nn,Rr[nn]);for(nn=Rr.length;nn<Pt.maxColorAttachments;++nn)fe.framebufferTexture2D(Fs,yu+nn,Si,null,0);fe.framebufferTexture2D(Fs,Lu,Si,null,0),fe.framebufferTexture2D(Fs,Fl,Si,null,0),fe.framebufferTexture2D(Fs,lc,Si,null,0),fn(Fl,sn.depthAttachment),fn(lc,sn.stencilAttachment),fn(Lu,sn.depthStencilAttachment);var ba=fe.checkFramebufferStatus(Fs);!fe.isContextLost()&&ba!==os&&$.raise("framebuffer configuration not supported, status = "+j[ba]),fe.bindFramebuffer(Fs,xr.next?xr.next.framebuffer:null),xr.cur=xr.next,fe.getError()}function Gr(sn,nn){var Rr=new Xn;Or.framebufferCount++;function ba(Fn,Ua){var Ea;$(xr.next!==Rr,"can not update framebuffer which is currently in use");var Da=0,bi=0,Bo=!0,So=!0,Ba=null,qo=!0,ji="rgba",_s="uint8",es=1,Vo=null,ts=null,Hs=null,Go=!1;if(typeof Fn=="number")Da=Fn|0,bi=Ua|0||Da;else if(!Fn)Da=bi=1;else{$.type(Fn,"object","invalid arguments for framebuffer");var ra=Fn;if("shape"in ra){var ou=ra.shape;$(Array.isArray(ou)&&ou.length>=2,"invalid shape for framebuffer"),Da=ou[0],bi=ou[1]}else"radius"in ra&&(Da=bi=ra.radius),"width"in ra&&(Da=ra.width),"height"in ra&&(bi=ra.height);("color"in ra||"colors"in ra)&&(Ba=ra.color||ra.colors,Array.isArray(Ba)&&$(Ba.length===1||ze.webgl_draw_buffers,"multiple render targets not supported")),Ba||("colorCount"in ra&&(es=ra.colorCount|0,$(es>0,"invalid color buffer count")),"colorTexture"in ra&&(qo=!!ra.colorTexture,ji="rgba4"),"colorType"in ra&&(_s=ra.colorType,qo?($(ze.oes_texture_float||!(_s==="float"||_s==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),$(ze.oes_texture_half_float||!(_s==="half float"||_s==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):_s==="half float"||_s==="float16"?($(ze.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),ji="rgba16f"):(_s==="float"||_s==="float32")&&($(ze.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),ji="rgba32f"),$.oneOf(_s,rn,"invalid color type")),"colorFormat"in ra&&(ji=ra.colorFormat,Wr.indexOf(ji)>=0?qo=!0:on.indexOf(ji)>=0?qo=!1:qo?$.oneOf(ra.colorFormat,Wr,"invalid color format for texture"):$.oneOf(ra.colorFormat,on,"invalid color format for renderbuffer"))),("depthTexture"in ra||"depthStencilTexture"in ra)&&(Go=!!(ra.depthTexture||ra.depthStencilTexture),$(!Go||ze.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in ra&&(typeof ra.depth=="boolean"?Bo=ra.depth:(Vo=ra.depth,So=!1)),"stencil"in ra&&(typeof ra.stencil=="boolean"?So=ra.stencil:(ts=ra.stencil,Bo=!1)),"depthStencil"in ra&&(typeof ra.depthStencil=="boolean"?Bo=So=ra.depthStencil:(Hs=ra.depthStencil,Bo=!1,So=!1))}var hi=null,En=null,xa=null,Va=null;if(Array.isArray(Ba))hi=Ba.map(Kr);else if(Ba)hi=[Kr(Ba)];else for(hi=new Array(es),Ea=0;Ea<es;++Ea)hi[Ea]=br(Da,bi,qo,ji,_s);$(ze.webgl_draw_buffers||hi.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),$(hi.length<=Pt.maxColorAttachments,"too many color attachments, not supported"),Da=Da||hi[0].width,bi=bi||hi[0].height,Vo?En=Kr(Vo):Bo&&!So&&(En=br(Da,bi,Go,"depth","uint32")),ts?xa=Kr(ts):So&&!Bo&&(xa=br(Da,bi,!1,"stencil","uint8")),Hs?Va=Kr(Hs):!Vo&&!ts&&So&&Bo&&(Va=br(Da,bi,Go,"depth stencil","depth stencil")),$(!!Vo+!!ts+!!Hs<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var Ao=null;for(Ea=0;Ea<hi.length;++Ea)if(Sn(hi[Ea],Da,bi),$(!hi[Ea]||hi[Ea].texture&&Ru.indexOf(hi[Ea].texture._texture.format)>=0||hi[Ea].renderbuffer&&R.indexOf(hi[Ea].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Ea+" is invalid"),hi[Ea]&&hi[Ea].texture){var su=fl[hi[Ea].texture._texture.format]*hl[hi[Ea].texture._texture.type];Ao===null?Ao=su:$(Ao===su,"all color attachments much have the same number of bits per pixel.")}return Sn(En,Da,bi),$(!En||En.texture&&En.texture._texture.format===cc||En.renderbuffer&&En.renderbuffer._renderbuffer.format===Vl,"invalid depth attachment for framebuffer object"),Sn(xa,Da,bi),$(!xa||xa.renderbuffer&&xa.renderbuffer._renderbuffer.format===s,"invalid stencil attachment for framebuffer object"),Sn(Va,Da,bi),$(!Va||Va.texture&&Va.texture._texture.format===a||Va.renderbuffer&&Va.renderbuffer._renderbuffer.format===a,"invalid depth-stencil attachment for framebuffer object"),$r(Rr),Rr.width=Da,Rr.height=bi,Rr.colorAttachments=hi,Rr.depthAttachment=En,Rr.stencilAttachment=xa,Rr.depthStencilAttachment=Va,ba.color=hi.map(mr),ba.depth=mr(En),ba.stencil=mr(xa),ba.depthStencil=mr(Va),ba.width=Rr.width,ba.height=Rr.height,Ur(Rr),ba}function La(Fn,Ua){$(xr.next!==Rr,"can not resize a framebuffer which is currently in use");var Ea=Math.max(Fn|0,1),Da=Math.max(Ua|0||Ea,1);if(Ea===Rr.width&&Da===Rr.height)return ba;for(var bi=Rr.colorAttachments,Bo=0;Bo<bi.length;++Bo)Jr(bi[Bo],Ea,Da);return Jr(Rr.depthAttachment,Ea,Da),Jr(Rr.stencilAttachment,Ea,Da),Jr(Rr.depthStencilAttachment,Ea,Da),Rr.width=ba.width=Ea,Rr.height=ba.height=Da,Ur(Rr),ba}return ba(sn,nn),m(ba,{resize:La,_reglType:"framebuffer",_framebuffer:Rr,destroy:function(){zr(Rr),$r(Rr)},use:function(Ua){xr.setFBO({framebuffer:ba},Ua)}})}function Wn(sn){var nn=Array(6);function Rr(La){var Fn;$(nn.indexOf(xr.next)<0,"can not update framebuffer which is currently in use");var Ua={color:null},Ea=0,Da=null,bi="rgba",Bo="uint8",So=1;if(typeof La=="number")Ea=La|0;else if(!La)Ea=1;else{$.type(La,"object","invalid arguments for framebuffer");var Ba=La;if("shape"in Ba){var qo=Ba.shape;$(Array.isArray(qo)&&qo.length>=2,"invalid shape for framebuffer"),$(qo[0]===qo[1],"cube framebuffer must be square"),Ea=qo[0]}else"radius"in Ba&&(Ea=Ba.radius|0),"width"in Ba?(Ea=Ba.width|0,"height"in Ba&&$(Ba.height===Ea,"must be square")):"height"in Ba&&(Ea=Ba.height|0);("color"in Ba||"colors"in Ba)&&(Da=Ba.color||Ba.colors,Array.isArray(Da)&&$(Da.length===1||ze.webgl_draw_buffers,"multiple render targets not supported")),Da||("colorCount"in Ba&&(So=Ba.colorCount|0,$(So>0,"invalid color buffer count")),"colorType"in Ba&&($.oneOf(Ba.colorType,rn,"invalid color type"),Bo=Ba.colorType),"colorFormat"in Ba&&(bi=Ba.colorFormat,$.oneOf(Ba.colorFormat,Wr,"invalid color format for texture"))),"depth"in Ba&&(Ua.depth=Ba.depth),"stencil"in Ba&&(Ua.stencil=Ba.stencil),"depthStencil"in Ba&&(Ua.depthStencil=Ba.depthStencil)}var ji;if(Da)if(Array.isArray(Da))for(ji=[],Fn=0;Fn<Da.length;++Fn)ji[Fn]=Da[Fn];else ji=[Da];else{ji=Array(So);var _s={radius:Ea,format:bi,type:Bo};for(Fn=0;Fn<So;++Fn)ji[Fn]=gr.createCube(_s)}for(Ua.color=Array(ji.length),Fn=0;Fn<ji.length;++Fn){var es=ji[Fn];$(typeof es=="function"&&es._reglType==="textureCube","invalid cube map"),Ea=Ea||es.width,$(es.width===Ea&&es.height===Ea,"invalid cube map shape"),Ua.color[Fn]={target:Xu,data:ji[Fn]}}for(Fn=0;Fn<6;++Fn){for(var Vo=0;Vo<ji.length;++Vo)Ua.color[Vo].target=Xu+Fn;Fn>0&&(Ua.depth=nn[0].depth,Ua.stencil=nn[0].stencil,Ua.depthStencil=nn[0].depthStencil),nn[Fn]?nn[Fn](Ua):nn[Fn]=Gr(Ua)}return m(Rr,{width:Ea,height:Ea,color:ji})}function ba(La){var Fn,Ua=La|0;if($(Ua>0&&Ua<=Pt.maxCubeMapSize,"invalid radius for cube fbo"),Ua===Rr.width)return Rr;var Ea=Rr.color;for(Fn=0;Fn<Ea.length;++Fn)Ea[Fn].resize(Ua);for(Fn=0;Fn<6;++Fn)nn[Fn].resize(Ua);return Rr.width=Rr.height=Ua,Rr}return Rr(sn),m(Rr,{faces:nn,resize:ba,_reglType:"framebufferCube",destroy:function(){nn.forEach(function(Fn){Fn.destroy()})}})}function $n(){xr.cur=null,xr.next=null,xr.dirty=!0,Ie(Lr).forEach(function(sn){sn.framebuffer=fe.createFramebuffer(),Ur(sn)})}return m(xr,{getFramebuffer:function(nn){if(typeof nn=="function"&&nn._reglType==="framebuffer"){var Rr=nn._framebuffer;if(Rr instanceof Xn)return Rr}return null},create:Gr,createCube:Wn,clear:function(){Ie(Lr).forEach(zr)},restore:$n})}var Te=5126,Ye=34962;function qe(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Te,this.offset=0,this.stride=0,this.divisor=0}function tt(fe,ze,Pt,gr,kr){for(var Or=Pt.maxAttributes,xr=new Array(Or),Wr=0;Wr<Or;++Wr)xr[Wr]=new qe;var on=0,rn={},Qr={Record:qe,scope:{},state:xr,currentVAO:null,targetVAO:null,restore:Sn()?Lr:function(){},createVAO:Xn,getVAO:Kr,destroyBuffer:cn,setVAO:Sn()?br:mr,clear:Sn()?Jr:function(){}};function cn($r){for(var zr=0;zr<xr.length;++zr){var Ur=xr[zr];Ur.buffer===$r&&(fe.disableVertexAttribArray(zr),Ur.buffer=null)}}function Sn(){return ze.oes_vertex_array_object}function fn(){return ze.angle_instanced_arrays}function Kr($r){return typeof $r=="function"&&$r._vao?$r._vao:null}function br($r){if($r===Qr.currentVAO)return;var zr=Sn();$r?zr.bindVertexArrayOES($r.vao):zr.bindVertexArrayOES(null),Qr.currentVAO=$r}function mr($r){if($r===Qr.currentVAO)return;if($r)$r.bindAttrs();else for(var zr=fn(),Ur=0;Ur<xr.length;++Ur){var Gr=xr[Ur];Gr.buffer?(fe.enableVertexAttribArray(Ur),fe.vertexAttribPointer(Ur,Gr.size,Gr.type,Gr.normalized,Gr.stride,Gr.offfset),zr&&Gr.divisor&&zr.vertexAttribDivisorANGLE(Ur,Gr.divisor)):(fe.disableVertexAttribArray(Ur),fe.vertexAttrib4f(Ur,Gr.x,Gr.y,Gr.z,Gr.w))}Qr.currentVAO=$r}function Jr(){Ie(rn).forEach(function($r){$r.destroy()})}function wn(){this.id=++on,this.attributes=[];var $r=Sn();$r?this.vao=$r.createVertexArrayOES():this.vao=null,rn[this.id]=this,this.buffers=[]}wn.prototype.bindAttrs=function(){for(var $r=fn(),zr=this.attributes,Ur=0;Ur<zr.length;++Ur){var Gr=zr[Ur];Gr.buffer?(fe.enableVertexAttribArray(Ur),fe.bindBuffer(Ye,Gr.buffer.buffer),fe.vertexAttribPointer(Ur,Gr.size,Gr.type,Gr.normalized,Gr.stride,Gr.offset),$r&&Gr.divisor&&$r.vertexAttribDivisorANGLE(Ur,Gr.divisor)):(fe.disableVertexAttribArray(Ur),fe.vertexAttrib4f(Ur,Gr.x,Gr.y,Gr.z,Gr.w))}for(var Wn=zr.length;Wn<Or;++Wn)fe.disableVertexAttribArray(Wn)},wn.prototype.refresh=function(){var $r=Sn();$r&&($r.bindVertexArrayOES(this.vao),this.bindAttrs(),Qr.currentVAO=this)},wn.prototype.destroy=function(){if(this.vao){var $r=Sn();this===Qr.currentVAO&&(Qr.currentVAO=null,$r.bindVertexArrayOES(null)),$r.deleteVertexArrayOES(this.vao),this.vao=null}rn[this.id]&&(delete rn[this.id],gr.vaoCount-=1)};function Lr(){var $r=Sn();$r&&Ie(rn).forEach(function(zr){zr.refresh()})}function Xn($r){var zr=new wn;gr.vaoCount+=1;function Ur(Gr){$(Array.isArray(Gr),"arguments to vertex array constructor must be an array"),$(Gr.length<Or,"too many attributes"),$(Gr.length>0,"must specify at least one attribute");var Wn={},$n=zr.attributes;$n.length=Gr.length;for(var sn=0;sn<Gr.length;++sn){var nn=Gr[sn],Rr=$n[sn]=new qe,ba=nn.data||nn;if(Array.isArray(ba)||T(ba)||Ut(ba)){var La;zr.buffers[sn]&&(La=zr.buffers[sn],T(ba)&&La._buffer.byteLength>=ba.byteLength?La.subdata(ba):(La.destroy(),zr.buffers[sn]=null)),zr.buffers[sn]||(La=zr.buffers[sn]=kr.create(nn,Ye,!1,!0)),Rr.buffer=kr.getBuffer(La),Rr.size=Rr.buffer.dimension|0,Rr.normalized=!1,Rr.type=Rr.buffer.dtype,Rr.offset=0,Rr.stride=0,Rr.divisor=0,Rr.state=1,Wn[sn]=1}else kr.getBuffer(nn)?(Rr.buffer=kr.getBuffer(nn),Rr.size=Rr.buffer.dimension|0,Rr.normalized=!1,Rr.type=Rr.buffer.dtype,Rr.offset=0,Rr.stride=0,Rr.divisor=0,Rr.state=1):kr.getBuffer(nn.buffer)?(Rr.buffer=kr.getBuffer(nn.buffer),Rr.size=(+nn.size||Rr.buffer.dimension)|0,Rr.normalized=!!nn.normalized||!1,"type"in nn?($.parameter(nn.type,_o,"invalid buffer type"),Rr.type=_o[nn.type]):Rr.type=Rr.buffer.dtype,Rr.offset=(nn.offset||0)|0,Rr.stride=(nn.stride||0)|0,Rr.divisor=(nn.divisor||0)|0,Rr.state=1,$(Rr.size>=1&&Rr.size<=4,"size must be between 1 and 4"),$(Rr.offset>=0,"invalid offset"),$(Rr.stride>=0&&Rr.stride<=255,"stride must be between 0 and 255"),$(Rr.divisor>=0,"divisor must be positive"),$(!Rr.divisor||!!ze.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in nn?($(sn>0,"first attribute must not be a constant"),Rr.x=+nn.x||0,Rr.y=+nn.y||0,Rr.z=+nn.z||0,Rr.w=+nn.w||0,Rr.state=2):$(!1,"invalid attribute spec for location "+sn)}for(var Fn=0;Fn<zr.buffers.length;++Fn)!Wn[Fn]&&zr.buffers[Fn]&&(zr.buffers[Fn].destroy(),zr.buffers[Fn]=null);return zr.refresh(),Ur}return Ur.destroy=function(){for(var Gr=0;Gr<zr.buffers.length;++Gr)zr.buffers[Gr]&&zr.buffers[Gr].destroy();zr.buffers.length=0,zr.destroy()},Ur._vao=zr,Ur._reglType="vao",Ur($r)}return Qr}var Dt=35632,Rt=35633,Wt=35718,kt=35721;function zt(fe,ze,Pt,gr){var kr={},Or={};function xr(br,mr,Jr,wn){this.name=br,this.id=mr,this.location=Jr,this.info=wn}function Wr(br,mr){for(var Jr=0;Jr<br.length;++Jr)if(br[Jr].id===mr.id){br[Jr].location=mr.location;return}br.push(mr)}function on(br,mr,Jr){var wn=br===Dt?kr:Or,Lr=wn[mr];if(!Lr){var Xn=ze.str(mr);Lr=fe.createShader(br),fe.shaderSource(Lr,Xn),fe.compileShader(Lr),$.shaderError(fe,Lr,Xn,br,Jr),wn[mr]=Lr}return Lr}var rn={},Qr=[],cn=0;function Sn(br,mr){this.id=cn++,this.fragId=br,this.vertId=mr,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,gr.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function fn(br,mr,Jr){var wn,Lr,Xn=on(Dt,br.fragId),$r=on(Rt,br.vertId),zr=br.program=fe.createProgram();if(fe.attachShader(zr,Xn),fe.attachShader(zr,$r),Jr)for(wn=0;wn<Jr.length;++wn){var Ur=Jr[wn];fe.bindAttribLocation(zr,Ur[0],Ur[1])}fe.linkProgram(zr),$.linkError(fe,zr,ze.str(br.fragId),ze.str(br.vertId),mr);var Gr=fe.getProgramParameter(zr,Wt);gr.profile&&(br.stats.uniformsCount=Gr);var Wn=br.uniforms;for(wn=0;wn<Gr;++wn)if(Lr=fe.getActiveUniform(zr,wn),Lr)if(Lr.size>1)for(var $n=0;$n<Lr.size;++$n){var sn=Lr.name.replace("[0]","["+$n+"]");Wr(Wn,new xr(sn,ze.id(sn),fe.getUniformLocation(zr,sn),Lr))}else Wr(Wn,new xr(Lr.name,ze.id(Lr.name),fe.getUniformLocation(zr,Lr.name),Lr));var nn=fe.getProgramParameter(zr,kt);gr.profile&&(br.stats.attributesCount=nn);var Rr=br.attributes;for(wn=0;wn<nn;++wn)Lr=fe.getActiveAttrib(zr,wn),Lr&&Wr(Rr,new xr(Lr.name,ze.id(Lr.name),fe.getAttribLocation(zr,Lr.name),Lr))}gr.profile&&(Pt.getMaxUniformsCount=function(){var br=0;return Qr.forEach(function(mr){mr.stats.uniformsCount>br&&(br=mr.stats.uniformsCount)}),br},Pt.getMaxAttributesCount=function(){var br=0;return Qr.forEach(function(mr){mr.stats.attributesCount>br&&(br=mr.stats.attributesCount)}),br});function Kr(){kr={},Or={};for(var br=0;br<Qr.length;++br)fn(Qr[br],null,Qr[br].attributes.map(function(mr){return[mr.location,mr.name]}))}return{clear:function(){var mr=fe.deleteShader.bind(fe);Ie(kr).forEach(mr),kr={},Ie(Or).forEach(mr),Or={},Qr.forEach(function(Jr){fe.deleteProgram(Jr.program)}),Qr.length=0,rn={},Pt.shaderCount=0},program:function(mr,Jr,wn,Lr){$.command(mr>=0,"missing vertex shader",wn),$.command(Jr>=0,"missing fragment shader",wn);var Xn=rn[Jr];Xn||(Xn=rn[Jr]={});var $r=Xn[mr];if($r&&($r.refCount++,!Lr))return $r;var zr=new Sn(Jr,mr);return Pt.shaderCount++,fn(zr,wn,Lr),$r||(Xn[mr]=zr),Qr.push(zr),m(zr,{destroy:function(){if(zr.refCount--,zr.refCount<=0){fe.deleteProgram(zr.program);var Gr=Qr.indexOf(zr);Qr.splice(Gr,1),Pt.shaderCount--}Xn[zr.vertId].refCount<=0&&(fe.deleteShader(Or[zr.vertId]),delete Or[zr.vertId],delete rn[zr.fragId][zr.vertId]),Object.keys(rn[zr.fragId]).length||(fe.deleteShader(kr[zr.fragId]),delete kr[zr.fragId],delete rn[zr.fragId])}})},restore:Kr,shader:on,frag:-1,vert:-1}}var nr=6408,Jt=5121,Cr=3333,pr=5126;function _r(fe,ze,Pt,gr,kr,Or,xr){function Wr(Qr){var cn;ze.next===null?($(kr.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),cn=Jt):($(ze.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),cn=ze.next.colorAttachments[0].texture._texture.type,Or.oes_texture_float?($(cn===Jt||cn===pr,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),cn===pr&&$(xr.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):$(cn===Jt,"Reading from a framebuffer is only allowed for the type 'uint8'"));var Sn=0,fn=0,Kr=gr.framebufferWidth,br=gr.framebufferHeight,mr=null;T(Qr)?mr=Qr:Qr&&($.type(Qr,"object","invalid arguments to regl.read()"),Sn=Qr.x|0,fn=Qr.y|0,$(Sn>=0&&Sn<gr.framebufferWidth,"invalid x offset for regl.read"),$(fn>=0&&fn<gr.framebufferHeight,"invalid y offset for regl.read"),Kr=(Qr.width||gr.framebufferWidth-Sn)|0,br=(Qr.height||gr.framebufferHeight-fn)|0,mr=Qr.data||null),mr&&(cn===Jt?$(mr instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):cn===pr&&$(mr instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),$(Kr>0&&Kr+Sn<=gr.framebufferWidth,"invalid width for read pixels"),$(br>0&&br+fn<=gr.framebufferHeight,"invalid height for read pixels"),Pt();var Jr=Kr*br*4;return mr||(cn===Jt?mr=new Uint8Array(Jr):cn===pr&&(mr=mr||new Float32Array(Jr))),$.isTypedArray(mr,"data buffer for regl.read() must be a typedarray"),$(mr.byteLength>=Jr,"data buffer for regl.read() too small"),fe.pixelStorei(Cr,4),fe.readPixels(Sn,fn,Kr,br,nr,cn,mr),mr}function on(Qr){var cn;return ze.setFBO({framebuffer:Qr.framebuffer},function(){cn=Wr(Qr)}),cn}function rn(Qr){return!Qr||!("framebuffer"in Qr)?Wr(Qr):on(Qr)}return rn}function wr(fe){return Array.prototype.slice.call(fe)}function Hr(fe){return wr(fe).join("")}function Yr(){var fe=0,ze=[],Pt=[];function gr(cn){for(var Sn=0;Sn<Pt.length;++Sn)if(Pt[Sn]===cn)return ze[Sn];var fn="g"+fe++;return ze.push(fn),Pt.push(cn),fn}function kr(){var cn=[];function Sn(){cn.push.apply(cn,wr(arguments))}var fn=[];function Kr(){var br="v"+fe++;return fn.push(br),arguments.length>0&&(cn.push(br,"="),cn.push.apply(cn,wr(arguments)),cn.push(";")),br}return m(Sn,{def:Kr,toString:function(){return Hr([fn.length>0?"var "+fn.join(",")+";":"",Hr(cn)])}})}function Or(){var cn=kr(),Sn=kr(),fn=cn.toString,Kr=Sn.toString;function br(mr,Jr){Sn(mr,Jr,"=",cn.def(mr,Jr),";")}return m(function(){cn.apply(cn,wr(arguments))},{def:cn.def,entry:cn,exit:Sn,save:br,set:function(Jr,wn,Lr){br(Jr,wn),cn(Jr,wn,"=",Lr,";")},toString:function(){return fn()+Kr()}})}function xr(){var cn=Hr(arguments),Sn=Or(),fn=Or(),Kr=Sn.toString,br=fn.toString;return m(Sn,{then:function(){return Sn.apply(Sn,wr(arguments)),this},else:function(){return fn.apply(fn,wr(arguments)),this},toString:function(){var Jr=br();return Jr&&(Jr="else{"+Jr+"}"),Hr(["if(",cn,"){",Kr(),"}",Jr])}})}var Wr=kr(),on={};function rn(cn,Sn){var fn=[];function Kr(){var Lr="a"+fn.length;return fn.push(Lr),Lr}Sn=Sn||0;for(var br=0;br<Sn;++br)Kr();var mr=Or(),Jr=mr.toString,wn=on[cn]=m(mr,{arg:Kr,toString:function(){return Hr(["function(",fn.join(),"){",Jr(),"}"])}});return wn}function Qr(){var cn=['"use strict";',Wr,"return {"];Object.keys(on).forEach(function(Kr){cn.push('"',Kr,'":',on[Kr].toString(),",")}),cn.push("}");var Sn=Hr(cn).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),fn=Function.apply(null,ze.concat(Sn));return fn.apply(null,Pt)}return{global:Wr,link:gr,block:kr,proc:rn,scope:Or,cond:xr,compile:Qr}}var un="xyzw".split(""),_n=5121,ia=1,pa=2,ya=0,Pa=1,Pn=2,ga=3,aa=4,zn=5,Ca=6,qn="dither",wa="blend.enable",Ja="blend.color",co="blend.equation",$i="blend.func",Vi="depth.enable",fi="depth.func",Ji="depth.range",Lo="depth.mask",Iu="colorMask",Us="cull.enable",Bs="cull.face",Jo="frontFace",ss="lineWidth",Al="polygonOffset.enable",Eu="polygonOffset.offset",dl="sample.alpha",Gl="sample.enable",Du="sample.coverage",Kc="stencil.enable",Ku="stencil.mask",eo="stencil.func",Rs="stencil.opFront",Hl="stencil.opBack",fc="scissor.enable",Xi="scissor.box",jo="viewport",xs="profile",to="framebuffer",Vs="vert",ro="frag",$u="elements",pl="primitive",ml="count",Ac="offset",Ju="instances",Wl="vao",Uo="Width",vo="Height",$c=to+Uo,Zl=to+vo,Jc=jo+Uo,Es=jo+vo,cf="drawingBuffer",Nf=cf+Uo,ff=cf+vo,Zf=[$i,co,eo,Rs,Hl,Du,jo,Xi,Eu],Nu=34962,hf=34963,Xl=35632,vl=35633,Qc=3553,Af=34067,Xf=2884,Cc=3042,wc=3024,Yf=2960,Kf=2929,kf=3089,$f=32823,qc=32926,fh=32928,go=5126,hc=35664,df=35665,Yl=35666,Oc=5124,Mc=35667,ku=35668,Pc=35669,Lc=35670,pf=35671,Cf=35672,jf=35673,dc=35674,Kl=35675,ne=35676,se=35678,k=35680,G=4,_e=1028,ot=1029,Xt=2304,rr=2305,tr=32775,Dr=32776,tn=519,Vn=7680,ta=0,oa=1,Ya=32774,za=513,Ni=36160,Fa=36064,Gi={"0":0,"1":1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Qo=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Qi={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},oi={"0":0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Ts={frag:Xl,vert:vl},ki={cw:Xt,ccw:rr};function yo(fe){return Array.isArray(fe)||T(fe)||Ut(fe)}function us(fe){return fe.sort(function(ze,Pt){return ze===jo?-1:Pt===jo?1:ze<Pt?-1:1})}function yi(fe,ze,Pt,gr){this.thisDep=fe,this.contextDep=ze,this.propDep=Pt,this.append=gr}function fo(fe){return fe&&!(fe.thisDep||fe.contextDep||fe.propDep)}function Ta(fe){return new yi(!1,!1,!1,fe)}function Ro(fe,ze){var Pt=fe.type;if(Pt===ya){var gr=fe.data.length;return new yi(!0,gr>=1,gr>=2,ze)}else if(Pt===aa){var kr=fe.data;return new yi(kr.thisDep,kr.contextDep,kr.propDep,ze)}else{if(Pt===zn)return new yi(!1,!1,!1,ze);if(Pt===Ca){for(var Or=!1,xr=!1,Wr=!1,on=0;on<fe.data.length;++on){var rn=fe.data[on];if(rn.type===Pa)Wr=!0;else if(rn.type===Pn)xr=!0;else if(rn.type===ga)Or=!0;else if(rn.type===ya){Or=!0;var Qr=rn.data;Qr>=1&&(xr=!0),Qr>=2&&(Wr=!0)}else rn.type===aa&&(Or=Or||rn.data.thisDep,xr=xr||rn.data.contextDep,Wr=Wr||rn.data.propDep)}return new yi(Or,xr,Wr,ze)}else return new yi(Pt===ga,Pt===Pn,Pt===Pa,ze)}}var pc=new yi(!1,!1,!1,function(){});function zf(fe,ze,Pt,gr,kr,Or,xr,Wr,on,rn,Qr,cn,Sn,fn,Kr){var br=rn.Record,mr={add:32774,subtract:32778,"reverse subtract":32779};Pt.ext_blend_minmax&&(mr.min=tr,mr.max=Dr);var Jr=Pt.angle_instanced_arrays,wn=Pt.webgl_draw_buffers,Lr={dirty:!0,profile:Kr.profile},Xn={},$r=[],zr={},Ur={};function Gr(v){return v.replace(".","_")}function Wn(v,f,c){var p=Gr(v);$r.push(v),Xn[p]=Lr[p]=!!c,zr[p]=f}function $n(v,f,c){var p=Gr(v);$r.push(v),Array.isArray(c)?(Lr[p]=c.slice(),Xn[p]=c.slice()):Lr[p]=Xn[p]=c,Ur[p]=f}Wn(qn,wc),Wn(wa,Cc),$n(Ja,"blendColor",[0,0,0,0]),$n(co,"blendEquationSeparate",[Ya,Ya]),$n($i,"blendFuncSeparate",[oa,ta,oa,ta]),Wn(Vi,Kf,!0),$n(fi,"depthFunc",za),$n(Ji,"depthRange",[0,1]),$n(Lo,"depthMask",!0),$n(Iu,Iu,[!0,!0,!0,!0]),Wn(Us,Xf),$n(Bs,"cullFace",ot),$n(Jo,Jo,rr),$n(ss,ss,1),Wn(Al,$f),$n(Eu,"polygonOffset",[0,0]),Wn(dl,qc),Wn(Gl,fh),$n(Du,"sampleCoverage",[1,!1]),Wn(Kc,Yf),$n(Ku,"stencilMask",-1),$n(eo,"stencilFunc",[tn,0,-1]),$n(Rs,"stencilOpSeparate",[_e,Vn,Vn,Vn]),$n(Hl,"stencilOpSeparate",[ot,Vn,Vn,Vn]),Wn(fc,kf),$n(Xi,"scissor",[0,0,fe.drawingBufferWidth,fe.drawingBufferHeight]),$n(jo,jo,[0,0,fe.drawingBufferWidth,fe.drawingBufferHeight]);var sn={gl:fe,context:Sn,strings:ze,next:Xn,current:Lr,draw:cn,elements:Or,buffer:kr,shader:Qr,attributes:rn.state,vao:rn,uniforms:on,framebuffer:Wr,extensions:Pt,timer:fn,isBufferArgs:yo},nn={primTypes:Xo,compareFuncs:Qi,blendFuncs:Gi,blendEquations:mr,stencilOps:oi,glTypes:_o,orientationType:ki};$.optional(function(){sn.isArrayLike=Ti}),wn&&(nn.backBuffer=[ot],nn.drawBuffer=W(gr.maxDrawbuffers,function(v){return v===0?[0]:W(v,function(f){return Fa+f})}));var Rr=0;function ba(){var v=Yr(),f=v.link,c=v.global;v.id=Rr++,v.batchId="0";var p=f(sn),y=v.shared={props:"a0"};Object.keys(sn).forEach(function(J){y[J]=c.def(p,".",J)}),$.optional(function(){v.CHECK=f($),v.commandStr=$.guessCommand(),v.command=f(v.commandStr),v.assert=function(J,he,We){J("if(!(",he,"))",this.CHECK,".commandRaise(",f(We),",",this.command,");")},nn.invalidBlendCombinations=Qo});var P=v.next={},N=v.current={};Object.keys(Ur).forEach(function(J){Array.isArray(Lr[J])&&(P[J]=c.def(y.next,".",J),N[J]=c.def(y.current,".",J))});var ee=v.constants={};Object.keys(nn).forEach(function(J){ee[J]=c.def(JSON.stringify(nn[J]))}),v.invoke=function(J,he){switch(he.type){case ya:var We=["this",y.context,y.props,v.batchId];return J.def(f(he.data),".call(",We.slice(0,Math.max(he.data.length+1,4)),")");case Pa:return J.def(y.props,he.data);case Pn:return J.def(y.context,he.data);case ga:return J.def("this",he.data);case aa:return he.data.append(v,J),he.data.ref;case zn:return he.data.toString();case Ca:return he.data.map(function(De){return v.invoke(J,De)})}},v.attribCache={};var V={};return v.scopeAttrib=function(J){var he=ze.id(J);if(he in V)return V[he];var We=rn.scope[he];We||(We=rn.scope[he]=new br);var De=V[he]=f(We);return De},v}function La(v){var f=v.static,c=v.dynamic,p;if(xs in f){var y=!!f[xs];p=Ta(function(N,ee){return y}),p.enable=y}else if(xs in c){var P=c[xs];p=Ro(P,function(N,ee){return N.invoke(ee,P)})}return p}function Fn(v,f){var c=v.static,p=v.dynamic;if(to in c){var y=c[to];return y?(y=Wr.getFramebuffer(y),$.command(y,"invalid framebuffer object"),Ta(function(N,ee){var V=N.link(y),J=N.shared;ee.set(J.framebuffer,".next",V);var he=J.context;return ee.set(he,"."+$c,V+".width"),ee.set(he,"."+Zl,V+".height"),V})):Ta(function(N,ee){var V=N.shared;ee.set(V.framebuffer,".next","null");var J=V.context;return ee.set(J,"."+$c,J+"."+Nf),ee.set(J,"."+Zl,J+"."+ff),"null"})}else if(to in p){var P=p[to];return Ro(P,function(N,ee){var V=N.invoke(ee,P),J=N.shared,he=J.framebuffer,We=ee.def(he,".getFramebuffer(",V,")");$.optional(function(){N.assert(ee,"!"+V+"||"+We,"invalid framebuffer object")}),ee.set(he,".next",We);var De=J.context;return ee.set(De,"."+$c,We+"?"+We+".width:"+De+"."+Nf),ee.set(De,"."+Zl,We+"?"+We+".height:"+De+"."+ff),We})}else return null}function Ua(v,f,c){var p=v.static,y=v.dynamic;function P(V){if(V in p){var J=p[V];$.commandType(J,"object","invalid "+V,c.commandStr);var he=!0,We=J.x|0,De=J.y|0,It,Kt;return"width"in J?(It=J.width|0,$.command(It>=0,"invalid "+V,c.commandStr)):he=!1,"height"in J?(Kt=J.height|0,$.command(Kt>=0,"invalid "+V,c.commandStr)):he=!1,new yi(!he&&f&&f.thisDep,!he&&f&&f.contextDep,!he&&f&&f.propDep,function(Sr,ln){var jr=Sr.shared.context,an=It;"width"in J||(an=ln.def(jr,".",$c,"-",We));var pn=Kt;return"height"in J||(pn=ln.def(jr,".",Zl,"-",De)),[We,De,an,pn]})}else if(V in y){var Ht=y[V],fr=Ro(Ht,function(Sr,ln){var jr=Sr.invoke(ln,Ht);$.optional(function(){Sr.assert(ln,jr+"&&typeof "+jr+'==="object"',"invalid "+V)});var an=Sr.shared.context,pn=ln.def(jr,".x|0"),Gn=ln.def(jr,".y|0"),la=ln.def('"width" in ',jr,"?",jr,".width|0:","(",an,".",$c,"-",pn,")"),ma=ln.def('"height" in ',jr,"?",jr,".height|0:","(",an,".",Zl,"-",Gn,")");return $.optional(function(){Sr.assert(ln,la+">=0&&"+ma+">=0","invalid "+V)}),[pn,Gn,la,ma]});return f&&(fr.thisDep=fr.thisDep||f.thisDep,fr.contextDep=fr.contextDep||f.contextDep,fr.propDep=fr.propDep||f.propDep),fr}else return f?new yi(f.thisDep,f.contextDep,f.propDep,function(Sr,ln){var jr=Sr.shared.context;return[0,0,ln.def(jr,".",$c),ln.def(jr,".",Zl)]}):null}var N=P(jo);if(N){var ee=N;N=new yi(N.thisDep,N.contextDep,N.propDep,function(V,J){var he=ee.append(V,J),We=V.shared.context;return J.set(We,"."+Jc,he[2]),J.set(We,"."+Es,he[3]),he})}return{viewport:N,scissor_box:P(Xi)}}function Ea(v,f){var c=v.static,p=typeof c[ro]=="string"&&typeof c[Vs]=="string";if(p){if(Object.keys(f.dynamic).length>0)return null;var y=f.static,P=Object.keys(y);if(P.length>0&&typeof y[P[0]]=="number"){for(var N=[],ee=0;ee<P.length;++ee)$(typeof y[P[ee]]=="number","must specify all vertex attribute locations when using vaos"),N.push([y[P[ee]]|0,P[ee]]);return N}}return null}function Da(v,f,c){var p=v.static,y=v.dynamic;function P(he){if(he in p){var We=ze.id(p[he]);$.optional(function(){Qr.shader(Ts[he],We,$.guessCommand())});var De=Ta(function(){return We});return De.id=We,De}else if(he in y){var It=y[he];return Ro(It,function(Kt,Ht){var fr=Kt.invoke(Ht,It),Sr=Ht.def(Kt.shared.strings,".id(",fr,")");return $.optional(function(){Ht(Kt.shared.shader,".shader(",Ts[he],",",Sr,",",Kt.command,");")}),Sr})}return null}var N=P(ro),ee=P(Vs),V=null,J;return fo(N)&&fo(ee)?(V=Qr.program(ee.id,N.id,null,c),J=Ta(function(he,We){return he.link(V)})):J=new yi(N&&N.thisDep||ee&&ee.thisDep,N&&N.contextDep||ee&&ee.contextDep,N&&N.propDep||ee&&ee.propDep,function(he,We){var De=he.shared.shader,It;N?It=N.append(he,We):It=We.def(De,".",ro);var Kt;ee?Kt=ee.append(he,We):Kt=We.def(De,".",Vs);var Ht=De+".program("+Kt+","+It;return $.optional(function(){Ht+=","+he.command}),We.def(Ht+")")}),{frag:N,vert:ee,progVar:J,program:V}}function bi(v,f){var c=v.static,p=v.dynamic;function y(){if($u in c){var he=c[$u];yo(he)?he=Or.getElements(Or.create(he,!0)):he&&(he=Or.getElements(he),$.command(he,"invalid elements",f.commandStr));var We=Ta(function(It,Kt){if(he){var Ht=It.link(he);return It.ELEMENTS=Ht,Ht}return It.ELEMENTS=null,null});return We.value=he,We}else if($u in p){var De=p[$u];return Ro(De,function(It,Kt){var Ht=It.shared,fr=Ht.isBufferArgs,Sr=Ht.elements,ln=It.invoke(Kt,De),jr=Kt.def("null"),an=Kt.def(fr,"(",ln,")"),pn=It.cond(an).then(jr,"=",Sr,".createStream(",ln,");").else(jr,"=",Sr,".getElements(",ln,");");return $.optional(function(){It.assert(pn.else,"!"+ln+"||"+jr,"invalid elements")}),Kt.entry(pn),Kt.exit(It.cond(an).then(Sr,".destroyStream(",jr,");")),It.ELEMENTS=jr,jr})}return null}var P=y();function N(){if(pl in c){var he=c[pl];return $.commandParameter(he,Xo,"invalid primitve",f.commandStr),Ta(function(De,It){return Xo[he]})}else if(pl in p){var We=p[pl];return Ro(We,function(De,It){var Kt=De.constants.primTypes,Ht=De.invoke(It,We);return $.optional(function(){De.assert(It,Ht+" in "+Kt,"invalid primitive, must be one of "+Object.keys(Xo))}),It.def(Kt,"[",Ht,"]")})}else if(P)return fo(P)?P.value?Ta(function(De,It){return It.def(De.ELEMENTS,".primType")}):Ta(function(){return G}):new yi(P.thisDep,P.contextDep,P.propDep,function(De,It){var Kt=De.ELEMENTS;return It.def(Kt,"?",Kt,".primType:",G)});return null}function ee(he,We){if(he in c){var De=c[he]|0;return $.command(!We||De>=0,"invalid "+he,f.commandStr),Ta(function(Kt,Ht){return We&&(Kt.OFFSET=De),De})}else if(he in p){var It=p[he];return Ro(It,function(Kt,Ht){var fr=Kt.invoke(Ht,It);return We&&(Kt.OFFSET=fr,$.optional(function(){Kt.assert(Ht,fr+">=0","invalid "+he)})),fr})}else if(We&&P)return Ta(function(Kt,Ht){return Kt.OFFSET="0",0});return null}var V=ee(Ac,!0);function J(){if(ml in c){var he=c[ml]|0;return $.command(typeof he=="number"&&he>=0,"invalid vertex count",f.commandStr),Ta(function(){return he})}else if(ml in p){var We=p[ml];return Ro(We,function(Kt,Ht){var fr=Kt.invoke(Ht,We);return $.optional(function(){Kt.assert(Ht,"typeof "+fr+'==="number"&&'+fr+">=0&&"+fr+"===("+fr+"|0)","invalid vertex count")}),fr})}else if(P)if(fo(P)){if(P)return V?new yi(V.thisDep,V.contextDep,V.propDep,function(Kt,Ht){var fr=Ht.def(Kt.ELEMENTS,".vertCount-",Kt.OFFSET);return $.optional(function(){Kt.assert(Ht,fr+">=0","invalid vertex offset/element buffer too small")}),fr}):Ta(function(Kt,Ht){return Ht.def(Kt.ELEMENTS,".vertCount")});var De=Ta(function(){return-1});return $.optional(function(){De.MISSING=!0}),De}else{var It=new yi(P.thisDep||V.thisDep,P.contextDep||V.contextDep,P.propDep||V.propDep,function(Kt,Ht){var fr=Kt.ELEMENTS;return Kt.OFFSET?Ht.def(fr,"?",fr,".vertCount-",Kt.OFFSET,":-1"):Ht.def(fr,"?",fr,".vertCount:-1")});return $.optional(function(){It.DYNAMIC=!0}),It}return null}return{elements:P,primitive:N(),count:J(),instances:ee(Ju,!1),offset:V}}function Bo(v,f){var c=v.static,p=v.dynamic,y={};return $r.forEach(function(P){var N=Gr(P);function ee(V,J){if(P in c){var he=V(c[P]);y[N]=Ta(function(){return he})}else if(P in p){var We=p[P];y[N]=Ro(We,function(De,It){return J(De,It,De.invoke(It,We))})}}switch(P){case Us:case wa:case qn:case Kc:case Vi:case fc:case Al:case dl:case Gl:case Lo:return ee(function(V){return $.commandType(V,"boolean",P,f.commandStr),V},function(V,J,he){return $.optional(function(){V.assert(J,"typeof "+he+'==="boolean"',"invalid flag "+P,V.commandStr)}),he});case fi:return ee(function(V){return $.commandParameter(V,Qi,"invalid "+P,f.commandStr),Qi[V]},function(V,J,he){var We=V.constants.compareFuncs;return $.optional(function(){V.assert(J,he+" in "+We,"invalid "+P+", must be one of "+Object.keys(Qi))}),J.def(We,"[",he,"]")});case Ji:return ee(function(V){return $.command(Ti(V)&&V.length===2&&typeof V[0]=="number"&&typeof V[1]=="number"&&V[0]<=V[1],"depth range is 2d array",f.commandStr),V},function(V,J,he){$.optional(function(){V.assert(J,V.shared.isArrayLike+"("+he+")&&"+he+".length===2&&typeof "+he+'[0]==="number"&&typeof '+he+'[1]==="number"&&'+he+"[0]<="+he+"[1]","depth range must be a 2d array")});var We=J.def("+",he,"[0]"),De=J.def("+",he,"[1]");return[We,De]});case $i:return ee(function(V){$.commandType(V,"object","blend.func",f.commandStr);var J="srcRGB"in V?V.srcRGB:V.src,he="srcAlpha"in V?V.srcAlpha:V.src,We="dstRGB"in V?V.dstRGB:V.dst,De="dstAlpha"in V?V.dstAlpha:V.dst;return $.commandParameter(J,Gi,N+".srcRGB",f.commandStr),$.commandParameter(he,Gi,N+".srcAlpha",f.commandStr),$.commandParameter(We,Gi,N+".dstRGB",f.commandStr),$.commandParameter(De,Gi,N+".dstAlpha",f.commandStr),$.command(Qo.indexOf(J+", "+We)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+J+", "+We+")",f.commandStr),[Gi[J],Gi[We],Gi[he],Gi[De]]},function(V,J,he){var We=V.constants.blendFuncs;$.optional(function(){V.assert(J,he+"&&typeof "+he+'==="object"',"invalid blend func, must be an object")});function De(jr,an){var pn=J.def('"',jr,an,'" in ',he,"?",he,".",jr,an,":",he,".",jr);return $.optional(function(){V.assert(J,pn+" in "+We,"invalid "+P+"."+jr+an+", must be one of "+Object.keys(Gi))}),pn}var It=De("src","RGB"),Kt=De("dst","RGB");$.optional(function(){var jr=V.constants.invalidBlendCombinations;V.assert(J,jr+".indexOf("+It+'+", "+'+Kt+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var Ht=J.def(We,"[",It,"]"),fr=J.def(We,"[",De("src","Alpha"),"]"),Sr=J.def(We,"[",Kt,"]"),ln=J.def(We,"[",De("dst","Alpha"),"]");return[Ht,Sr,fr,ln]});case co:return ee(function(V){if(typeof V=="string")return $.commandParameter(V,mr,"invalid "+P,f.commandStr),[mr[V],mr[V]];if(typeof V=="object")return $.commandParameter(V.rgb,mr,P+".rgb",f.commandStr),$.commandParameter(V.alpha,mr,P+".alpha",f.commandStr),[mr[V.rgb],mr[V.alpha]];$.commandRaise("invalid blend.equation",f.commandStr)},function(V,J,he){var We=V.constants.blendEquations,De=J.def(),It=J.def(),Kt=V.cond("typeof ",he,'==="string"');return $.optional(function(){function Ht(fr,Sr,ln){V.assert(fr,ln+" in "+We,"invalid "+Sr+", must be one of "+Object.keys(mr))}Ht(Kt.then,P,he),V.assert(Kt.else,he+"&&typeof "+he+'==="object"',"invalid "+P),Ht(Kt.else,P+".rgb",he+".rgb"),Ht(Kt.else,P+".alpha",he+".alpha")}),Kt.then(De,"=",It,"=",We,"[",he,"];"),Kt.else(De,"=",We,"[",he,".rgb];",It,"=",We,"[",he,".alpha];"),J(Kt),[De,It]});case Ja:return ee(function(V){return $.command(Ti(V)&&V.length===4,"blend.color must be a 4d array",f.commandStr),W(4,function(J){return+V[J]})},function(V,J,he){return $.optional(function(){V.assert(J,V.shared.isArrayLike+"("+he+")&&"+he+".length===4","blend.color must be a 4d array")}),W(4,function(We){return J.def("+",he,"[",We,"]")})});case Ku:return ee(function(V){return $.commandType(V,"number",N,f.commandStr),V|0},function(V,J,he){return $.optional(function(){V.assert(J,"typeof "+he+'==="number"',"invalid stencil.mask")}),J.def(he,"|0")});case eo:return ee(function(V){$.commandType(V,"object",N,f.commandStr);var J=V.cmp||"keep",he=V.ref||0,We="mask"in V?V.mask:-1;return $.commandParameter(J,Qi,P+".cmp",f.commandStr),$.commandType(he,"number",P+".ref",f.commandStr),$.commandType(We,"number",P+".mask",f.commandStr),[Qi[J],he,We]},function(V,J,he){var We=V.constants.compareFuncs;$.optional(function(){function Ht(){V.assert(J,Array.prototype.join.call(arguments,""),"invalid stencil.func")}Ht(he+"&&typeof ",he,'==="object"'),Ht('!("cmp" in ',he,")||(",he,".cmp in ",We,")")});var De=J.def('"cmp" in ',he,"?",We,"[",he,".cmp]",":",Vn),It=J.def(he,".ref|0"),Kt=J.def('"mask" in ',he,"?",he,".mask|0:-1");return[De,It,Kt]});case Rs:case Hl:return ee(function(V){$.commandType(V,"object",N,f.commandStr);var J=V.fail||"keep",he=V.zfail||"keep",We=V.zpass||"keep";return $.commandParameter(J,oi,P+".fail",f.commandStr),$.commandParameter(he,oi,P+".zfail",f.commandStr),$.commandParameter(We,oi,P+".zpass",f.commandStr),[P===Hl?ot:_e,oi[J],oi[he],oi[We]]},function(V,J,he){var We=V.constants.stencilOps;$.optional(function(){V.assert(J,he+"&&typeof "+he+'==="object"',"invalid "+P)});function De(It){return $.optional(function(){V.assert(J,'!("'+It+'" in '+he+")||("+he+"."+It+" in "+We+")","invalid "+P+"."+It+", must be one of "+Object.keys(oi))}),J.def('"',It,'" in ',he,"?",We,"[",he,".",It,"]:",Vn)}return[P===Hl?ot:_e,De("fail"),De("zfail"),De("zpass")]});case Eu:return ee(function(V){$.commandType(V,"object",N,f.commandStr);var J=V.factor|0,he=V.units|0;return $.commandType(J,"number",N+".factor",f.commandStr),$.commandType(he,"number",N+".units",f.commandStr),[J,he]},function(V,J,he){$.optional(function(){V.assert(J,he+"&&typeof "+he+'==="object"',"invalid "+P)});var We=J.def(he,".factor|0"),De=J.def(he,".units|0");return[We,De]});case Bs:return ee(function(V){var J=0;return V==="front"?J=_e:V==="back"&&(J=ot),$.command(!!J,N,f.commandStr),J},function(V,J,he){return $.optional(function(){V.assert(J,he+'==="front"||'+he+'==="back"',"invalid cull.face")}),J.def(he,'==="front"?',_e,":",ot)});case ss:return ee(function(V){return $.command(typeof V=="number"&&V>=gr.lineWidthDims[0]&&V<=gr.lineWidthDims[1],"invalid line width, must be a positive number between "+gr.lineWidthDims[0]+" and "+gr.lineWidthDims[1],f.commandStr),V},function(V,J,he){return $.optional(function(){V.assert(J,"typeof "+he+'==="number"&&'+he+">="+gr.lineWidthDims[0]+"&&"+he+"<="+gr.lineWidthDims[1],"invalid line width")}),he});case Jo:return ee(function(V){return $.commandParameter(V,ki,N,f.commandStr),ki[V]},function(V,J,he){return $.optional(function(){V.assert(J,he+'==="cw"||'+he+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),J.def(he+'==="cw"?'+Xt+":"+rr)});case Iu:return ee(function(V){return $.command(Ti(V)&&V.length===4,"color.mask must be length 4 array",f.commandStr),V.map(function(J){return!!J})},function(V,J,he){return $.optional(function(){V.assert(J,V.shared.isArrayLike+"("+he+")&&"+he+".length===4","invalid color.mask")}),W(4,function(We){return"!!"+he+"["+We+"]"})});case Du:return ee(function(V){$.command(typeof V=="object"&&V,N,f.commandStr);var J="value"in V?V.value:1,he=!!V.invert;return $.command(typeof J=="number"&&J>=0&&J<=1,"sample.coverage.value must be a number between 0 and 1",f.commandStr),[J,he]},function(V,J,he){$.optional(function(){V.assert(J,he+"&&typeof "+he+'==="object"',"invalid sample.coverage")});var We=J.def('"value" in ',he,"?+",he,".value:1"),De=J.def("!!",he,".invert");return[We,De]})}}),y}function So(v,f){var c=v.static,p=v.dynamic,y={};return Object.keys(c).forEach(function(P){var N=c[P],ee;if(typeof N=="number"||typeof N=="boolean")ee=Ta(function(){return N});else if(typeof N=="function"){var V=N._reglType;V==="texture2d"||V==="textureCube"?ee=Ta(function(J){return J.link(N)}):V==="framebuffer"||V==="framebufferCube"?($.command(N.color.length>0,'missing color attachment for framebuffer sent to uniform "'+P+'"',f.commandStr),ee=Ta(function(J){return J.link(N.color[0])})):$.commandRaise('invalid data for uniform "'+P+'"',f.commandStr)}else Ti(N)?ee=Ta(function(J){var he=J.global.def("[",W(N.length,function(We){return $.command(typeof N[We]=="number"||typeof N[We]=="boolean","invalid uniform "+P,J.commandStr),N[We]}),"]");return he}):$.commandRaise('invalid or missing data for uniform "'+P+'"',f.commandStr);ee.value=N,y[P]=ee}),Object.keys(p).forEach(function(P){var N=p[P];y[P]=Ro(N,function(ee,V){return ee.invoke(V,N)})}),y}function Ba(v,f){var c=v.static,p=v.dynamic,y={};return Object.keys(c).forEach(function(P){var N=c[P],ee=ze.id(P),V=new br;if(yo(N))V.state=ia,V.buffer=kr.getBuffer(kr.create(N,Nu,!1,!0)),V.type=0;else{var J=kr.getBuffer(N);if(J)V.state=ia,V.buffer=J,V.type=0;else if($.command(typeof N=="object"&&N,"invalid data for attribute "+P,f.commandStr),"constant"in N){var he=N.constant;V.buffer="null",V.state=pa,typeof he=="number"?V.x=he:($.command(Ti(he)&&he.length>0&&he.length<=4,"invalid constant for attribute "+P,f.commandStr),un.forEach(function(Sr,ln){ln<he.length&&(V[Sr]=he[ln])}))}else{yo(N.buffer)?J=kr.getBuffer(kr.create(N.buffer,Nu,!1,!0)):J=kr.getBuffer(N.buffer),$.command(!!J,'missing buffer for attribute "'+P+'"',f.commandStr);var We=N.offset|0;$.command(We>=0,'invalid offset for attribute "'+P+'"',f.commandStr);var De=N.stride|0;$.command(De>=0&&De<256,'invalid stride for attribute "'+P+'", must be integer betweeen [0, 255]',f.commandStr);var It=N.size|0;$.command(!("size"in N)||It>0&&It<=4,'invalid size for attribute "'+P+'", must be 1,2,3,4',f.commandStr);var Kt=!!N.normalized,Ht=0;"type"in N&&($.commandParameter(N.type,_o,"invalid type for attribute "+P,f.commandStr),Ht=_o[N.type]);var fr=N.divisor|0;"divisor"in N&&($.command(fr===0||Jr,'cannot specify divisor for attribute "'+P+'", instancing not supported',f.commandStr),$.command(fr>=0,'invalid divisor for attribute "'+P+'"',f.commandStr)),$.optional(function(){var Sr=f.commandStr,ln=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(N).forEach(function(jr){$.command(ln.indexOf(jr)>=0,'unknown parameter "'+jr+'" for attribute pointer "'+P+'" (valid parameters are '+ln+")",Sr)})}),V.buffer=J,V.state=ia,V.size=It,V.normalized=Kt,V.type=Ht||J.dtype,V.offset=We,V.stride=De,V.divisor=fr}}y[P]=Ta(function(Sr,ln){var jr=Sr.attribCache;if(ee in jr)return jr[ee];var an={isStream:!1};return Object.keys(V).forEach(function(pn){an[pn]=V[pn]}),V.buffer&&(an.buffer=Sr.link(V.buffer),an.type=an.type||an.buffer+".dtype"),jr[ee]=an,an})}),Object.keys(p).forEach(function(P){var N=p[P];function ee(V,J){var he=V.invoke(J,N),We=V.shared,De=V.constants,It=We.isBufferArgs,Kt=We.buffer;$.optional(function(){V.assert(J,he+"&&(typeof "+he+'==="object"||typeof '+he+'==="function")&&('+It+"("+he+")||"+Kt+".getBuffer("+he+")||"+Kt+".getBuffer("+he+".buffer)||"+It+"("+he+'.buffer)||("constant" in '+he+"&&(typeof "+he+'.constant==="number"||'+We.isArrayLike+"("+he+".constant))))",'invalid dynamic attribute "'+P+'"')});var Ht={isStream:J.def(!1)},fr=new br;fr.state=ia,Object.keys(fr).forEach(function(an){Ht[an]=J.def(""+fr[an])});var Sr=Ht.buffer,ln=Ht.type;J("if(",It,"(",he,")){",Ht.isStream,"=true;",Sr,"=",Kt,".createStream(",Nu,",",he,");",ln,"=",Sr,".dtype;","}else{",Sr,"=",Kt,".getBuffer(",he,");","if(",Sr,"){",ln,"=",Sr,".dtype;",'}else if("constant" in ',he,"){",Ht.state,"=",pa,";","if(typeof "+he+'.constant === "number"){',Ht[un[0]],"=",he,".constant;",un.slice(1).map(function(an){return Ht[an]}).join("="),"=0;","}else{",un.map(function(an,pn){return Ht[an]+"="+he+".constant.length>"+pn+"?"+he+".constant["+pn+"]:0;"}).join(""),"}}else{","if(",It,"(",he,".buffer)){",Sr,"=",Kt,".createStream(",Nu,",",he,".buffer);","}else{",Sr,"=",Kt,".getBuffer(",he,".buffer);","}",ln,'="type" in ',he,"?",De.glTypes,"[",he,".type]:",Sr,".dtype;",Ht.normalized,"=!!",he,".normalized;");function jr(an){J(Ht[an],"=",he,".",an,"|0;")}return jr("size"),jr("offset"),jr("stride"),jr("divisor"),J("}}"),J.exit("if(",Ht.isStream,"){",Kt,".destroyStream(",Sr,");","}"),Ht}y[P]=Ro(N,ee)}),y}function qo(v,f){var c=v.static,p=v.dynamic;if(Wl in c){var y=c[Wl];return y!==null&&rn.getVAO(y)===null&&(y=rn.createVAO(y)),Ta(function(N){return N.link(rn.getVAO(y))})}else if(Wl in p){var P=p[Wl];return Ro(P,function(N,ee){var V=N.invoke(ee,P);return ee.def(N.shared.vao+".getVAO("+V+")")})}return null}function ji(v){var f=v.static,c=v.dynamic,p={};return Object.keys(f).forEach(function(y){var P=f[y];p[y]=Ta(function(N,ee){return typeof P=="number"||typeof P=="boolean"?""+P:N.link(P)})}),Object.keys(c).forEach(function(y){var P=c[y];p[y]=Ro(P,function(N,ee){return N.invoke(ee,P)})}),p}function _s(v,f,c,p,y){var P=v.static,N=v.dynamic;$.optional(function(){var jr=[to,Vs,ro,$u,pl,Ac,ml,Ju,xs,Wl].concat($r);function an(pn){Object.keys(pn).forEach(function(Gn){$.command(jr.indexOf(Gn)>=0,'unknown parameter "'+Gn+'"',y.commandStr)})}an(P),an(N)});var ee=Ea(v,f),V=Fn(v,y),J=Ua(v,V,y),he=bi(v,y),We=Bo(v,y),De=Da(v,y,ee);function It(jr){var an=J[jr];an&&(We[jr]=an)}It(jo),It(Gr(Xi));var Kt=Object.keys(We).length>0,Ht={framebuffer:V,draw:he,shader:De,state:We,dirty:Kt,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(Ht.profile=La(v,y),Ht.uniforms=So(c,y),Ht.drawVAO=Ht.scopeVAO=qo(v,y),!Ht.drawVAO&&De.program&&!ee&&Pt.angle_instanced_arrays){var fr=!0,Sr=De.program.attributes.map(function(jr){var an=f.static[jr];return fr=fr&&!!an,an});if(fr&&Sr.length>0){var ln=rn.getVAO(rn.createVAO(Sr));Ht.drawVAO=new yi(null,null,null,function(jr,an){return jr.link(ln)}),Ht.useVAO=!0}}return ee?Ht.useVAO=!0:Ht.attributes=Ba(f,y),Ht.context=ji(p,y),Ht}function es(v,f,c){var p=v.shared,y=p.context,P=v.scope();Object.keys(c).forEach(function(N){f.save(y,"."+N);var ee=c[N],V=ee.append(v,f);Array.isArray(V)?P(y,".",N,"=[",V.join(),"];"):P(y,".",N,"=",V,";")}),f(P)}function Vo(v,f,c,p){var y=v.shared,P=y.gl,N=y.framebuffer,ee;wn&&(ee=f.def(y.extensions,".webgl_draw_buffers"));var V=v.constants,J=V.drawBuffer,he=V.backBuffer,We;c?We=c.append(v,f):We=f.def(N,".next"),p||f("if(",We,"!==",N,".cur){"),f("if(",We,"){",P,".bindFramebuffer(",Ni,",",We,".framebuffer);"),wn&&f(ee,".drawBuffersWEBGL(",J,"[",We,".colorAttachments.length]);"),f("}else{",P,".bindFramebuffer(",Ni,",null);"),wn&&f(ee,".drawBuffersWEBGL(",he,");"),f("}",N,".cur=",We,";"),p||f("}")}function ts(v,f,c){var p=v.shared,y=p.gl,P=v.current,N=v.next,ee=p.current,V=p.next,J=v.cond(ee,".dirty");$r.forEach(function(he){var We=Gr(he);if(We in c.state)return;var De,It;if(We in N){De=N[We],It=P[We];var Kt=W(Lr[We].length,function(fr){return J.def(De,"[",fr,"]")});J(v.cond(Kt.map(function(fr,Sr){return fr+"!=="+It+"["+Sr+"]"}).join("||")).then(y,".",Ur[We],"(",Kt,");",Kt.map(function(fr,Sr){return It+"["+Sr+"]="+fr}).join(";"),";"))}else{De=J.def(V,".",We);var Ht=v.cond(De,"!==",ee,".",We);J(Ht),We in zr?Ht(v.cond(De).then(y,".enable(",zr[We],");").else(y,".disable(",zr[We],");"),ee,".",We,"=",De,";"):Ht(y,".",Ur[We],"(",De,");",ee,".",We,"=",De,";")}}),Object.keys(c.state).length===0&&J(ee,".dirty=false;"),f(J)}function Hs(v,f,c,p){var y=v.shared,P=v.current,N=y.current,ee=y.gl;us(Object.keys(c)).forEach(function(V){var J=c[V];if(p&&!p(J))return;var he=J.append(v,f);if(zr[V]){var We=zr[V];fo(J)?he?f(ee,".enable(",We,");"):f(ee,".disable(",We,");"):f(v.cond(he).then(ee,".enable(",We,");").else(ee,".disable(",We,");")),f(N,".",V,"=",he,";")}else if(Ti(he)){var De=P[V];f(ee,".",Ur[V],"(",he,");",he.map(function(It,Kt){return De+"["+Kt+"]="+It}).join(";"),";")}else f(ee,".",Ur[V],"(",he,");",N,".",V,"=",he,";")})}function Go(v,f){Jr&&(v.instancing=f.def(v.shared.extensions,".angle_instanced_arrays"))}function ra(v,f,c,p,y){var P=v.shared,N=v.stats,ee=P.current,V=P.timer,J=c.profile;function he(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}var We,De;function It(jr){We=f.def(),jr(We,"=",he(),";"),typeof y=="string"?jr(N,".count+=",y,";"):jr(N,".count++;"),fn&&(p?(De=f.def(),jr(De,"=",V,".getNumPendingQueries();")):jr(V,".beginQuery(",N,");"))}function Kt(jr){jr(N,".cpuTime+=",he(),"-",We,";"),fn&&(p?jr(V,".pushScopeStats(",De,",",V,".getNumPendingQueries(),",N,");"):jr(V,".endQuery();"))}function Ht(jr){var an=f.def(ee,".profile");f(ee,".profile=",jr,";"),f.exit(ee,".profile=",an,";")}var fr;if(J){if(fo(J)){J.enable?(It(f),Kt(f.exit),Ht("true")):Ht("false");return}fr=J.append(v,f),Ht(fr)}else fr=f.def(ee,".profile");var Sr=v.block();It(Sr),f("if(",fr,"){",Sr,"}");var ln=v.block();Kt(ln),f.exit("if(",fr,"){",ln,"}")}function ou(v,f,c,p,y){var P=v.shared;function N(V){switch(V){case hc:case Mc:case pf:return 2;case df:case ku:case Cf:return 3;case Yl:case Pc:case jf:return 4;default:return 1}}function ee(V,J,he){var We=P.gl,De=f.def(V,".location"),It=f.def(P.attributes,"[",De,"]"),Kt=he.state,Ht=he.buffer,fr=[he.x,he.y,he.z,he.w],Sr=["buffer","normalized","offset","stride"];function ln(){f("if(!",It,".buffer){",We,".enableVertexAttribArray(",De,");}");var an=he.type,pn;if(he.size?pn=f.def(he.size,"||",J):pn=J,f("if(",It,".type!==",an,"||",It,".size!==",pn,"||",Sr.map(function(la){return It+"."+la+"!=="+he[la]}).join("||"),"){",We,".bindBuffer(",Nu,",",Ht,".buffer);",We,".vertexAttribPointer(",[De,pn,an,he.normalized,he.stride,he.offset],");",It,".type=",an,";",It,".size=",pn,";",Sr.map(function(la){return It+"."+la+"="+he[la]+";"}).join(""),"}"),Jr){var Gn=he.divisor;f("if(",It,".divisor!==",Gn,"){",v.instancing,".vertexAttribDivisorANGLE(",[De,Gn],");",It,".divisor=",Gn,";}")}}function jr(){f("if(",It,".buffer){",We,".disableVertexAttribArray(",De,");",It,".buffer=null;","}if(",un.map(function(an,pn){return It+"."+an+"!=="+fr[pn]}).join("||"),"){",We,".vertexAttrib4f(",De,",",fr,");",un.map(function(an,pn){return It+"."+an+"="+fr[pn]+";"}).join(""),"}")}Kt===ia?ln():Kt===pa?jr():(f("if(",Kt,"===",ia,"){"),ln(),f("}else{"),jr(),f("}"))}p.forEach(function(V){var J=V.name,he=c.attributes[J],We;if(he){if(!y(he))return;We=he.append(v,f)}else{if(!y(pc))return;var De=v.scopeAttrib(J);$.optional(function(){v.assert(f,De+".state","missing attribute "+J)}),We={},Object.keys(new br).forEach(function(It){We[It]=f.def(De,".",It)})}ee(v.link(V),N(V.info.type),We)})}function hi(v,f,c,p,y){for(var P=v.shared,N=P.gl,ee,V=0;V<p.length;++V){var J=p[V],he=J.name,We=J.info.type,De=c.uniforms[he],It=v.link(J),Kt=It+".location",Ht;if(De){if(!y(De))continue;if(fo(De)){var fr=De.value;if($.command(fr!==null&&typeof fr!="undefined",'missing uniform "'+he+'"',v.commandStr),We===se||We===k){$.command(typeof fr=="function"&&(We===se&&(fr._reglType==="texture2d"||fr._reglType==="framebuffer")||We===k&&(fr._reglType==="textureCube"||fr._reglType==="framebufferCube")),"invalid texture for uniform "+he,v.commandStr);var Sr=v.link(fr._texture||fr.color[0]._texture);f(N,".uniform1i(",Kt,",",Sr+".bind());"),f.exit(Sr,".unbind();")}else if(We===dc||We===Kl||We===ne){$.optional(function(){$.command(Ti(fr),"invalid matrix for uniform "+he,v.commandStr),$.command(We===dc&&fr.length===4||We===Kl&&fr.length===9||We===ne&&fr.length===16,"invalid length for matrix uniform "+he,v.commandStr)});var ln=v.global.def("new Float32Array(["+Array.prototype.slice.call(fr)+"])"),jr=2;We===Kl?jr=3:We===ne&&(jr=4),f(N,".uniformMatrix",jr,"fv(",Kt,",false,",ln,");")}else{switch(We){case go:$.commandType(fr,"number","uniform "+he,v.commandStr),ee="1f";break;case hc:$.command(Ti(fr)&&fr.length===2,"uniform "+he,v.commandStr),ee="2f";break;case df:$.command(Ti(fr)&&fr.length===3,"uniform "+he,v.commandStr),ee="3f";break;case Yl:$.command(Ti(fr)&&fr.length===4,"uniform "+he,v.commandStr),ee="4f";break;case Lc:$.commandType(fr,"boolean","uniform "+he,v.commandStr),ee="1i";break;case Oc:$.commandType(fr,"number","uniform "+he,v.commandStr),ee="1i";break;case pf:$.command(Ti(fr)&&fr.length===2,"uniform "+he,v.commandStr),ee="2i";break;case Mc:$.command(Ti(fr)&&fr.length===2,"uniform "+he,v.commandStr),ee="2i";break;case Cf:$.command(Ti(fr)&&fr.length===3,"uniform "+he,v.commandStr),ee="3i";break;case ku:$.command(Ti(fr)&&fr.length===3,"uniform "+he,v.commandStr),ee="3i";break;case jf:$.command(Ti(fr)&&fr.length===4,"uniform "+he,v.commandStr),ee="4i";break;case Pc:$.command(Ti(fr)&&fr.length===4,"uniform "+he,v.commandStr),ee="4i";break}f(N,".uniform",ee,"(",Kt,",",Ti(fr)?Array.prototype.slice.call(fr):fr,");")}continue}else Ht=De.append(v,f)}else{if(!y(pc))continue;Ht=f.def(P.uniforms,"[",ze.id(he),"]")}We===se?($(!Array.isArray(Ht),"must specify a scalar prop for textures"),f("if(",Ht,"&&",Ht,'._reglType==="framebuffer"){',Ht,"=",Ht,".color[0];","}")):We===k&&($(!Array.isArray(Ht),"must specify a scalar prop for cube maps"),f("if(",Ht,"&&",Ht,'._reglType==="framebufferCube"){',Ht,"=",Ht,".color[0];","}")),$.optional(function(){function ma(ho,ju){v.assert(f,ho,'bad data or missing for uniform "'+he+'".  '+ju)}function Oi(ho){$(!Array.isArray(Ht),"must not specify an array type for uniform"),ma("typeof "+Ht+'==="'+ho+'"',"invalid type, expected "+ho)}function Ga(ho,ju){Array.isArray(Ht)?$(Ht.length===ho,"must have length "+ho):ma(P.isArrayLike+"("+Ht+")&&"+Ht+".length==="+ho,"invalid vector, should have length "+ho,v.commandStr)}function Co(ho){$(!Array.isArray(Ht),"must not specify a value type"),ma("typeof "+Ht+'==="function"&&'+Ht+'._reglType==="texture'+(ho===Qc?"2d":"Cube")+'"',"invalid texture type",v.commandStr)}switch(We){case Oc:Oi("number");break;case Mc:Ga(2,"number");break;case ku:Ga(3,"number");break;case Pc:Ga(4,"number");break;case go:Oi("number");break;case hc:Ga(2,"number");break;case df:Ga(3,"number");break;case Yl:Ga(4,"number");break;case Lc:Oi("boolean");break;case pf:Ga(2,"boolean");break;case Cf:Ga(3,"boolean");break;case jf:Ga(4,"boolean");break;case dc:Ga(4,"number");break;case Kl:Ga(9,"number");break;case ne:Ga(16,"number");break;case se:Co(Qc);break;case k:Co(Af);break}});var an=1;switch(We){case se:case k:var pn=f.def(Ht,"._texture");f(N,".uniform1i(",Kt,",",pn,".bind());"),f.exit(pn,".unbind();");continue;case Oc:case Lc:ee="1i";break;case Mc:case pf:ee="2i",an=2;break;case ku:case Cf:ee="3i",an=3;break;case Pc:case jf:ee="4i",an=4;break;case go:ee="1f";break;case hc:ee="2f",an=2;break;case df:ee="3f",an=3;break;case Yl:ee="4f",an=4;break;case dc:ee="Matrix2fv";break;case Kl:ee="Matrix3fv";break;case ne:ee="Matrix4fv";break}if(f(N,".uniform",ee,"(",Kt,","),ee.charAt(0)==="M"){var Gn=Math.pow(We-dc+2,2),la=v.global.def("new Float32Array(",Gn,")");Array.isArray(Ht)?f("false,(",W(Gn,function(ma){return la+"["+ma+"]="+Ht[ma]}),",",la,")"):f("false,(Array.isArray(",Ht,")||",Ht," instanceof Float32Array)?",Ht,":(",W(Gn,function(ma){return la+"["+ma+"]="+Ht+"["+ma+"]"}),",",la,")")}else an>1?f(W(an,function(ma){return Array.isArray(Ht)?Ht[ma]:Ht+"["+ma+"]"})):($(!Array.isArray(Ht),"uniform value must not be an array"),f(Ht));f(");")}}function En(v,f,c,p){var y=v.shared,P=y.gl,N=y.draw,ee=p.draw;function V(){var pn=ee.elements,Gn,la=f;return pn?((pn.contextDep&&p.contextDynamic||pn.propDep)&&(la=c),Gn=pn.append(v,la)):Gn=la.def(N,".",$u),Gn&&la("if("+Gn+")"+P+".bindBuffer("+hf+","+Gn+".buffer.buffer);"),Gn}function J(){var pn=ee.count,Gn,la=f;return pn?((pn.contextDep&&p.contextDynamic||pn.propDep)&&(la=c),Gn=pn.append(v,la),$.optional(function(){pn.MISSING&&v.assert(f,"false","missing vertex count"),pn.DYNAMIC&&v.assert(la,Gn+">=0","missing vertex count")})):(Gn=la.def(N,".",ml),$.optional(function(){v.assert(la,Gn+">=0","missing vertex count")})),Gn}var he=V();function We(pn){var Gn=ee[pn];return Gn?Gn.contextDep&&p.contextDynamic||Gn.propDep?Gn.append(v,c):Gn.append(v,f):f.def(N,".",pn)}var De=We(pl),It=We(Ac),Kt=J();if(typeof Kt=="number"){if(Kt===0)return}else c("if(",Kt,"){"),c.exit("}");var Ht,fr;Jr&&(Ht=We(Ju),fr=v.instancing);var Sr=he+".type",ln=ee.elements&&fo(ee.elements);function jr(){function pn(){c(fr,".drawElementsInstancedANGLE(",[De,Kt,Sr,It+"<<(("+Sr+"-"+_n+")>>1)",Ht],");")}function Gn(){c(fr,".drawArraysInstancedANGLE(",[De,It,Kt,Ht],");")}he?ln?pn():(c("if(",he,"){"),pn(),c("}else{"),Gn(),c("}")):Gn()}function an(){function pn(){c(P+".drawElements("+[De,Kt,Sr,It+"<<(("+Sr+"-"+_n+")>>1)"]+");")}function Gn(){c(P+".drawArrays("+[De,It,Kt]+");")}he?ln?pn():(c("if(",he,"){"),pn(),c("}else{"),Gn(),c("}")):Gn()}Jr&&(typeof Ht!="number"||Ht>=0)?typeof Ht=="string"?(c("if(",Ht,">0){"),jr(),c("}else if(",Ht,"<0){"),an(),c("}")):jr():an()}function xa(v,f,c,p,y){var P=ba(),N=P.proc("body",y);return $.optional(function(){P.commandStr=f.commandStr,P.command=P.link(f.commandStr)}),Jr&&(P.instancing=N.def(P.shared.extensions,".angle_instanced_arrays")),v(P,N,c,p),P.compile().body}function Va(v,f,c,p){Go(v,f),c.useVAO?c.drawVAO?f(v.shared.vao,".setVAO(",c.drawVAO.append(v,f),");"):f(v.shared.vao,".setVAO(",v.shared.vao,".targetVAO);"):(f(v.shared.vao,".setVAO(null);"),ou(v,f,c,p.attributes,function(){return!0})),hi(v,f,c,p.uniforms,function(){return!0}),En(v,f,f,c)}function Ao(v,f){var c=v.proc("draw",1);Go(v,c),es(v,c,f.context),Vo(v,c,f.framebuffer),ts(v,c,f),Hs(v,c,f.state),ra(v,c,f,!1,!0);var p=f.shader.progVar.append(v,c);if(c(v.shared.gl,".useProgram(",p,".program);"),f.shader.program)Va(v,c,f,f.shader.program);else{c(v.shared.vao,".setVAO(null);");var y=v.global.def("{}"),P=c.def(p,".id"),N=c.def(y,"[",P,"]");c(v.cond(N).then(N,".call(this,a0);").else(N,"=",y,"[",P,"]=",v.link(function(ee){return xa(Va,v,f,ee,1)}),"(",p,");",N,".call(this,a0);"))}Object.keys(f.state).length>0&&c(v.shared.current,".dirty=true;")}function su(v,f,c,p){v.batchId="a1",Go(v,f);function y(){return!0}ou(v,f,c,p.attributes,y),hi(v,f,c,p.uniforms,y),En(v,f,f,c)}function $l(v,f,c,p){Go(v,f);var y=c.contextDep,P=f.def(),N="a0",ee="a1",V=f.def();v.shared.props=V,v.batchId=P;var J=v.scope(),he=v.scope();f(J.entry,"for(",P,"=0;",P,"<",ee,";++",P,"){",V,"=",N,"[",P,"];",he,"}",J.exit);function We(Sr){return Sr.contextDep&&y||Sr.propDep}function De(Sr){return!We(Sr)}if(c.needsContext&&es(v,he,c.context),c.needsFramebuffer&&Vo(v,he,c.framebuffer),Hs(v,he,c.state,We),c.profile&&We(c.profile)&&ra(v,he,c,!1,!0),p)c.useVAO?c.drawVAO?We(c.drawVAO)?he(v.shared.vao,".setVAO(",c.drawVAO.append(v,he),");"):J(v.shared.vao,".setVAO(",c.drawVAO.append(v,J),");"):J(v.shared.vao,".setVAO(",v.shared.vao,".targetVAO);"):(J(v.shared.vao,".setVAO(null);"),ou(v,J,c,p.attributes,De),ou(v,he,c,p.attributes,We)),hi(v,J,c,p.uniforms,De),hi(v,he,c,p.uniforms,We),En(v,J,he,c);else{var It=v.global.def("{}"),Kt=c.shader.progVar.append(v,he),Ht=he.def(Kt,".id"),fr=he.def(It,"[",Ht,"]");he(v.shared.gl,".useProgram(",Kt,".program);","if(!",fr,"){",fr,"=",It,"[",Ht,"]=",v.link(function(Sr){return xa(su,v,c,Sr,2)}),"(",Kt,");}",fr,".call(this,a0[",P,"],",P,");")}}function Ot(v,f){var c=v.proc("batch",2);v.batchId="0",Go(v,c);var p=!1,y=!0;Object.keys(f.context).forEach(function(It){p=p||f.context[It].propDep}),p||(es(v,c,f.context),y=!1);var P=f.framebuffer,N=!1;P?(P.propDep?p=N=!0:P.contextDep&&p&&(N=!0),N||Vo(v,c,P)):Vo(v,c,null),f.state.viewport&&f.state.viewport.propDep&&(p=!0);function ee(It){return It.contextDep&&p||It.propDep}ts(v,c,f),Hs(v,c,f.state,function(It){return!ee(It)}),(!f.profile||!ee(f.profile))&&ra(v,c,f,!1,"a1"),f.contextDep=p,f.needsContext=y,f.needsFramebuffer=N;var V=f.shader.progVar;if(V.contextDep&&p||V.propDep)$l(v,c,f,null);else{var J=V.append(v,c);if(c(v.shared.gl,".useProgram(",J,".program);"),f.shader.program)$l(v,c,f,f.shader.program);else{c(v.shared.vao,".setVAO(null);");var he=v.global.def("{}"),We=c.def(J,".id"),De=c.def(he,"[",We,"]");c(v.cond(De).then(De,".call(this,a0,a1);").else(De,"=",he,"[",We,"]=",v.link(function(It){return xa($l,v,f,It,2)}),"(",J,");",De,".call(this,a0,a1);"))}}Object.keys(f.state).length>0&&c(v.shared.current,".dirty=true;")}function Er(v,f){var c=v.proc("scope",3);v.batchId="a2";var p=v.shared,y=p.current;es(v,c,f.context),f.framebuffer&&f.framebuffer.append(v,c),us(Object.keys(f.state)).forEach(function(N){var ee=f.state[N],V=ee.append(v,c);Ti(V)?V.forEach(function(J,he){c.set(v.next[N],"["+he+"]",J)}):c.set(p.next,"."+N,V)}),ra(v,c,f,!0,!0),[$u,Ac,ml,Ju,pl].forEach(function(N){var ee=f.draw[N];if(!ee)return;c.set(p.draw,"."+N,""+ee.append(v,c))}),Object.keys(f.uniforms).forEach(function(N){var ee=f.uniforms[N].append(v,c);Array.isArray(ee)&&(ee="["+ee.join()+"]"),c.set(p.uniforms,"["+ze.id(N)+"]",ee)}),Object.keys(f.attributes).forEach(function(N){var ee=f.attributes[N].append(v,c),V=v.scopeAttrib(N);Object.keys(new br).forEach(function(J){c.set(V,"."+J,ee[J])})}),f.scopeVAO&&c.set(p.vao,".targetVAO",f.scopeVAO.append(v,c));function P(N){var ee=f.shader[N];ee&&c.set(p.shader,"."+N,ee.append(v,c))}P(Vs),P(ro),Object.keys(f.state).length>0&&(c(y,".dirty=true;"),c.exit(y,".dirty=true;")),c("a1(",v.shared.context,",a0,",v.batchId,");")}function yr(v){if(typeof v!="object"||Ti(v))return;for(var f=Object.keys(v),c=0;c<f.length;++c)if(Qe.isDynamic(v[f[c]]))return!0;return!1}function Cn(v,f,c){var p=f.static[c];if(!p||!yr(p))return;var y=v.global,P=Object.keys(p),N=!1,ee=!1,V=!1,J=v.global.def("{}");P.forEach(function(We){var De=p[We];if(Qe.isDynamic(De)){typeof De=="function"&&(De=p[We]=Qe.unbox(De));var It=Ro(De,null);N=N||It.thisDep,V=V||It.propDep,ee=ee||It.contextDep}else{y(J,".",We,"=");switch(typeof De){case"number":y(De);break;case"string":y('"',De,'"');break;case"object":Array.isArray(De)&&y("[",De.join(),"]");break;default:y(v.link(De));break}y(";")}});function he(We,De){P.forEach(function(It){var Kt=p[It];if(!Qe.isDynamic(Kt))return;var Ht=We.invoke(De,Kt);De(J,".",It,"=",Ht,";")})}f.dynamic[c]=new Qe.DynamicVariable(aa,{thisDep:N,contextDep:ee,propDep:V,ref:J,append:he}),delete f.static[c]}function Oa(v,f,c,p,y){var P=ba();P.stats=P.link(y),Object.keys(f.static).forEach(function(ee){Cn(P,f,ee)}),Zf.forEach(function(ee){Cn(P,v,ee)});var N=_s(v,f,c,p,P);return Ao(P,N),Er(P,N),Ot(P,N),m(P.compile(),{destroy:function(){N.shader.program.destroy()}})}return{next:Xn,current:Lr,procs:function(){var v=ba(),f=v.proc("poll"),c=v.proc("refresh"),p=v.block();f(p),c(p);var y=v.shared,P=y.gl,N=y.next,ee=y.current;p(ee,".dirty=false;"),Vo(v,f),Vo(v,c,null,!0);var V;Jr&&(V=v.link(Jr)),Pt.oes_vertex_array_object&&c(v.link(Pt.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var J=0;J<gr.maxAttributes;++J){var he=c.def(y.attributes,"[",J,"]"),We=v.cond(he,".buffer");We.then(P,".enableVertexAttribArray(",J,");",P,".bindBuffer(",Nu,",",he,".buffer.buffer);",P,".vertexAttribPointer(",J,",",he,".size,",he,".type,",he,".normalized,",he,".stride,",he,".offset);").else(P,".disableVertexAttribArray(",J,");",P,".vertexAttrib4f(",J,",",he,".x,",he,".y,",he,".z,",he,".w);",he,".buffer=null;"),c(We),Jr&&c(V,".vertexAttribDivisorANGLE(",J,",",he,".divisor);")}return c(v.shared.vao,".currentVAO=null;",v.shared.vao,".setVAO(",v.shared.vao,".targetVAO);"),Object.keys(zr).forEach(function(De){var It=zr[De],Kt=p.def(N,".",De),Ht=v.block();Ht("if(",Kt,"){",P,".enable(",It,")}else{",P,".disable(",It,")}",ee,".",De,"=",Kt,";"),c(Ht),f("if(",Kt,"!==",ee,".",De,"){",Ht,"}")}),Object.keys(Ur).forEach(function(De){var It=Ur[De],Kt=Lr[De],Ht,fr,Sr=v.block();if(Sr(P,".",It,"("),Ti(Kt)){var ln=Kt.length;Ht=v.global.def(N,".",De),fr=v.global.def(ee,".",De),Sr(W(ln,function(jr){return Ht+"["+jr+"]"}),");",W(ln,function(jr){return fr+"["+jr+"]="+Ht+"["+jr+"];"}).join("")),f("if(",W(ln,function(jr){return Ht+"["+jr+"]!=="+fr+"["+jr+"]"}).join("||"),"){",Sr,"}")}else Ht=p.def(N,".",De),fr=p.def(ee,".",De),Sr(Ht,");",ee,".",De,"=",Ht,";"),f("if(",Ht,"!==",fr,"){",Sr,"}");c(Sr)}),v.compile()}(),compile:Oa}}function Gs(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var ah=34918,Fh=34919,Ff=35007,wf=function(ze,Pt){if(!Pt.ext_disjoint_timer_query)return null;var gr=[];function kr(){return gr.pop()||Pt.ext_disjoint_timer_query.createQueryEXT()}function Or(wn){gr.push(wn)}var xr=[];function Wr(wn){var Lr=kr();Pt.ext_disjoint_timer_query.beginQueryEXT(Ff,Lr),xr.push(Lr),Kr(xr.length-1,xr.length,wn)}function on(){Pt.ext_disjoint_timer_query.endQueryEXT(Ff)}function rn(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Qr=[];function cn(){return Qr.pop()||new rn}function Sn(wn){Qr.push(wn)}var fn=[];function Kr(wn,Lr,Xn){var $r=cn();$r.startQueryIndex=wn,$r.endQueryIndex=Lr,$r.sum=0,$r.stats=Xn,fn.push($r)}var br=[],mr=[];function Jr(){var wn,Lr,Xn=xr.length;if(Xn===0)return;mr.length=Math.max(mr.length,Xn+1),br.length=Math.max(br.length,Xn+1),br[0]=0,mr[0]=0;var $r=0;for(wn=0,Lr=0;Lr<xr.length;++Lr){var zr=xr[Lr];Pt.ext_disjoint_timer_query.getQueryObjectEXT(zr,Fh)?($r+=Pt.ext_disjoint_timer_query.getQueryObjectEXT(zr,ah),Or(zr)):xr[wn++]=zr,br[Lr+1]=$r,mr[Lr+1]=wn}for(xr.length=wn,wn=0,Lr=0;Lr<fn.length;++Lr){var Ur=fn[Lr],Gr=Ur.startQueryIndex,Wn=Ur.endQueryIndex;Ur.sum+=br[Wn]-br[Gr];var $n=mr[Gr],sn=mr[Wn];sn===$n?(Ur.stats.gpuTime+=Ur.sum/1e6,Sn(Ur)):(Ur.startQueryIndex=$n,Ur.endQueryIndex=sn,fn[wn++]=Ur)}fn.length=wn}return{beginQuery:Wr,endQuery:on,pushScopeStats:Kr,update:Jr,getNumPendingQueries:function(){return xr.length},clear:function(){gr.push.apply(gr,xr);for(var Lr=0;Lr<gr.length;Lr++)Pt.ext_disjoint_timer_query.deleteQueryEXT(gr[Lr]);xr.length=0,gr.length=0},restore:function(){xr.length=0,gr.length=0}}},Jf=16384,Th=256,_h=1024,Of=34962,Qf="webglcontextlost",qf="webglcontextrestored",Sh=1,eh=2,mf=3;function hh(fe,ze){for(var Pt=0;Pt<fe.length;++Pt)if(fe[Pt]===ze)return Pt;return-1}function ih(fe){var ze=Hn(fe);if(!ze)return null;var Pt=ze.gl,gr=Pt.getContextAttributes(),kr=Pt.isContextLost(),Or=F(Pt,ze);if(!Or)return null;var xr=Vr(),Wr=Gs(),on=Or.extensions,rn=wf(Pt,on),Qr=vr(),cn=Pt.drawingBufferWidth,Sn=Pt.drawingBufferHeight,fn={tick:0,time:0,viewportWidth:cn,viewportHeight:Sn,framebufferWidth:cn,framebufferHeight:Sn,drawingBufferWidth:cn,drawingBufferHeight:Sn,pixelRatio:ze.pixelRatio},Kr={},br={elements:null,primitive:4,count:-1,offset:0,instances:-1},mr=fu(Pt,on),Jr=Qa(Pt,Wr,ze,Lr),wn=tt(Pt,on,mr,Wr,Jr);function Lr(En){return wn.destroyBuffer(En)}var Xn=zc(Pt,on,Jr,Wr),$r=zt(Pt,xr,Wr,ze),zr=ll(Pt,on,mr,function(){Wn.procs.poll()},fn,Wr,ze),Ur=Zc(Pt,on,mr,Wr,ze),Gr=ue(Pt,on,mr,zr,Ur,Wr),Wn=zf(Pt,xr,on,mr,Jr,Xn,zr,Gr,Kr,wn,$r,br,fn,rn,ze),$n=_r(Pt,Gr,Wn.procs.poll,fn,gr,on,mr),sn=Wn.next,nn=Pt.canvas,Rr=[],ba=[],La=[],Fn=[ze.onDestroy],Ua=null;function Ea(){if(Rr.length===0){rn&&rn.update(),Ua=null;return}Ua=Ft.next(Ea),Hs();for(var En=Rr.length-1;En>=0;--En){var xa=Rr[En];xa&&xa(fn,null,0)}Pt.flush(),rn&&rn.update()}function Da(){!Ua&&Rr.length>0&&(Ua=Ft.next(Ea))}function bi(){Ua&&(Ft.cancel(Ea),Ua=null)}function Bo(En){En.preventDefault(),kr=!0,bi(),ba.forEach(function(xa){xa()})}function So(En){Pt.getError(),kr=!1,Or.restore(),$r.restore(),Jr.restore(),zr.restore(),Ur.restore(),Gr.restore(),wn.restore(),rn&&rn.restore(),Wn.procs.refresh(),Da(),La.forEach(function(xa){xa()})}nn&&(nn.addEventListener(Qf,Bo,!1),nn.addEventListener(qf,So,!1));function Ba(){Rr.length=0,bi(),nn&&(nn.removeEventListener(Qf,Bo),nn.removeEventListener(qf,So)),$r.clear(),Gr.clear(),Ur.clear(),zr.clear(),Xn.clear(),Jr.clear(),wn.clear(),rn&&rn.clear(),Fn.forEach(function(En){En()})}function qo(En){$(!!En,"invalid args to regl({...})"),$.type(En,"object","invalid args to regl({...})");function xa(y){var P=m({},y);delete P.uniforms,delete P.attributes,delete P.context,delete P.vao,"stencil"in P&&P.stencil.op&&(P.stencil.opBack=P.stencil.opFront=P.stencil.op,delete P.stencil.op);function N(ee){if(ee in P){var V=P[ee];delete P[ee],Object.keys(V).forEach(function(J){P[ee+"."+J]=V[J]})}}return N("blend"),N("depth"),N("cull"),N("stencil"),N("polygonOffset"),N("scissor"),N("sample"),"vao"in y&&(P.vao=y.vao),P}function Va(y,P){var N={},ee={};return Object.keys(y).forEach(function(V){var J=y[V];if(Qe.isDynamic(J)){ee[V]=Qe.unbox(J,V);return}else if(P&&Array.isArray(J)){for(var he=0;he<J.length;++he)if(Qe.isDynamic(J[he])){ee[V]=Qe.unbox(J,V);return}}N[V]=J}),{dynamic:ee,static:N}}var Ao=Va(En.context||{},!0),su=Va(En.uniforms||{},!0),$l=Va(En.attributes||{},!1),Ot=Va(xa(En),!1),Er={gpuTime:0,cpuTime:0,count:0},yr=Wn.compile(Ot,$l,su,Ao,Er),Cn=yr.draw,Oa=yr.batch,v=yr.scope,f=[];function c(y){for(;f.length<y;)f.push(null);return f}function p(y,P){var N;if(kr&&$.raise("context lost"),typeof y=="function")return v.call(this,null,y,0);if(typeof P=="function")if(typeof y=="number")for(N=0;N<y;++N)v.call(this,null,P,N);else if(Array.isArray(y))for(N=0;N<y.length;++N)v.call(this,y[N],P,N);else return v.call(this,y,P,0);else if(typeof y=="number"){if(y>0)return Oa.call(this,c(y|0),y|0)}else if(Array.isArray(y)){if(y.length)return Oa.call(this,y,y.length)}else return Cn.call(this,y)}return m(p,{stats:Er,destroy:function(){yr.destroy()}})}var ji=Gr.setFBO=qo({framebuffer:Qe.define.call(null,Sh,"framebuffer")});function _s(En,xa){var Va=0;Wn.procs.poll();var Ao=xa.color;Ao&&(Pt.clearColor(+Ao[0]||0,+Ao[1]||0,+Ao[2]||0,+Ao[3]||0),Va|=Jf),"depth"in xa&&(Pt.clearDepth(+xa.depth),Va|=Th),"stencil"in xa&&(Pt.clearStencil(xa.stencil|0),Va|=_h),$(!!Va,"called regl.clear with no buffer specified"),Pt.clear(Va)}function es(En){if($(typeof En=="object"&&En,"regl.clear() takes an object as input"),"framebuffer"in En)if(En.framebuffer&&En.framebuffer_reglType==="framebufferCube")for(var xa=0;xa<6;++xa)ji(m({framebuffer:En.framebuffer.faces[xa]},En),_s);else ji(En,_s);else _s(null,En)}function Vo(En){$.type(En,"function","regl.frame() callback must be a function"),Rr.push(En);function xa(){var Va=hh(Rr,En);$(Va>=0,"cannot cancel a frame twice");function Ao(){var su=hh(Rr,Ao);Rr[su]=Rr[Rr.length-1],Rr.length-=1,Rr.length<=0&&bi()}Rr[Va]=Ao}return Da(),{cancel:xa}}function ts(){var En=sn.viewport,xa=sn.scissor_box;En[0]=En[1]=xa[0]=xa[1]=0,fn.viewportWidth=fn.framebufferWidth=fn.drawingBufferWidth=En[2]=xa[2]=Pt.drawingBufferWidth,fn.viewportHeight=fn.framebufferHeight=fn.drawingBufferHeight=En[3]=xa[3]=Pt.drawingBufferHeight}function Hs(){fn.tick+=1,fn.time=ra(),ts(),Wn.procs.poll()}function Go(){zr.refresh(),ts(),Wn.procs.refresh(),rn&&rn.update()}function ra(){return(vr()-Qr)/1e3}Go();function ou(En,xa){$.type(xa,"function","listener callback must be a function");var Va;switch(En){case"frame":return Vo(xa);case"lost":Va=ba;break;case"restore":Va=La;break;case"destroy":Va=Fn;break;default:$.raise("invalid event, must be one of frame,lost,restore,destroy")}return Va.push(xa),{cancel:function(){for(var su=0;su<Va.length;++su)if(Va[su]===xa){Va[su]=Va[Va.length-1],Va.pop();return}}}}var hi=m(qo,{clear:es,prop:Qe.define.bind(null,Sh),context:Qe.define.bind(null,eh),this:Qe.define.bind(null,mf),draw:qo({}),buffer:function(xa){return Jr.create(xa,Of,!1,!1)},elements:function(xa){return Xn.create(xa,!1)},texture:zr.create2D,cube:zr.createCube,renderbuffer:Ur.create,framebuffer:Gr.create,framebufferCube:Gr.createCube,vao:wn.createVAO,attributes:gr,frame:Vo,on:ou,limits:mr,hasExtension:function(xa){return mr.extensions.indexOf(xa.toLowerCase())>=0},read:$n,destroy:Ba,_gl:Pt,_refresh:Go,poll:function(){Hs(),rn&&rn.update()},now:ra,stats:Wr});return ze.onDone(null,hi),hi}return ih})},fdMe:function(Re,E,i){"use strict";i.d(E,"a",function(){return T});function T(m,X){var z=X.callback;return z&&(m.dataArray=m.dataArray.map(z)),m}},fo6e:function(Re,E){var i=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function T(m){return i.test(m)}Re.exports=T},g4R6:function(Re,E){function i(T,m,X){return T===T&&(X!==void 0&&(T=T<=X?T:X),m!==void 0&&(T=T>=m?T:m)),T}Re.exports=i},gFfm:function(Re,E){function i(T,m){for(var X=-1,z=T==null?0:T.length;++X<z&&!(m(T[X],X,T)===!1););return T}Re.exports=i},gMG2:function(Re,E,i){"use strict";i.d(E,"a",function(){return Et});var T={},m={},X=34,z=10,o=13;function Z(_t){return new Function("d","return {"+_t.map(function(Ne,ke){return JSON.stringify(Ne)+": d["+ke+'] || ""'}).join(",")+"}")}function D(_t,Ne){var ke=Z(_t);return function(Ue,st){return Ne(ke(Ue),st,_t)}}function K(_t){var Ne=Object.create(null),ke=[];return _t.forEach(function(Ue){for(var st in Ue)st in Ne||ke.push(Ne[st]=st)}),ke}function re(_t,Ne){var ke=_t+"",Ue=ke.length;return Ue<Ne?new Array(Ne-Ue+1).join(0)+ke:ke}function de(_t){return _t<0?"-"+re(-_t,6):_t>9999?"+"+re(_t,6):re(_t,4)}function Y(_t){var Ne=_t.getUTCHours(),ke=_t.getUTCMinutes(),Ue=_t.getUTCSeconds(),st=_t.getUTCMilliseconds();return isNaN(_t)?"Invalid Date":de(_t.getUTCFullYear(),4)+"-"+re(_t.getUTCMonth()+1,2)+"-"+re(_t.getUTCDate(),2)+(st?"T"+re(Ne,2)+":"+re(ke,2)+":"+re(Ue,2)+"."+re(st,3)+"Z":Ue?"T"+re(Ne,2)+":"+re(ke,2)+":"+re(Ue,2)+"Z":ke||Ne?"T"+re(Ne,2)+":"+re(ke,2)+"Z":"")}var Fe=function(_t){var Ne=new RegExp('["'+_t+`
\r]`),ke=_t.charCodeAt(0);function Ue(Q,H){var Ce,Ee,Ae=st(Q,function(ge,rt){if(Ce)return Ce(ge,rt-1);Ee=ge,Ce=H?D(ge,H):Z(ge)});return Ae.columns=Ee||[],Ae}function st(Q,H){var Ce=[],Ee=Q.length,Ae=0,ge=0,rt,Yt=Ee<=0,At=!1;Q.charCodeAt(Ee-1)===z&&--Ee,Q.charCodeAt(Ee-1)===o&&--Ee;function be(){if(Yt)return m;if(At)return At=!1,T;var Ve,lt=Ae,Pe;if(Q.charCodeAt(lt)===X){for(;Ae++<Ee&&Q.charCodeAt(Ae)!==X||Q.charCodeAt(++Ae)===X;);return(Ve=Ae)>=Ee?Yt=!0:(Pe=Q.charCodeAt(Ae++))===z?At=!0:Pe===o&&(At=!0,Q.charCodeAt(Ae)===z&&++Ae),Q.slice(lt+1,Ve-1).replace(/""/g,'"')}for(;Ae<Ee;){if((Pe=Q.charCodeAt(Ve=Ae++))===z)At=!0;else if(Pe===o)At=!0,Q.charCodeAt(Ae)===z&&++Ae;else if(Pe!==ke)continue;return Q.slice(lt,Ve)}return Yt=!0,Q.slice(lt,Ee)}for(;(rt=be())!==m;){for(var xe=[];rt!==T&&rt!==m;)xe.push(rt),rt=be();if(H&&(xe=H(xe,ge++))==null)continue;Ce.push(xe)}return Ce}function Le(Q,H){return Q.map(function(Ce){return H.map(function(Ee){return oe(Ce[Ee])}).join(_t)})}function ut(Q,H){return H==null&&(H=K(Q)),[H.map(oe).join(_t)].concat(Le(Q,H)).join(`
`)}function Vt(Q,H){return H==null&&(H=K(Q)),Le(Q,H).join(`
`)}function Zt(Q){return Q.map(ir).join(`
`)}function ir(Q){return Q.map(oe).join(_t)}function oe(Q){return Q==null?"":Q instanceof Date?Y(Q):Ne.test(Q+="")?'"'+Q.replace(/"/g,'""')+'"':Q}return{parse:Ue,parseRows:st,format:ut,formatBody:Vt,formatRows:Zt,formatRow:ir,formatValue:oe}},Ze=Fe(","),ye=Ze.parse,we=Ze.parseRows,pt=Ze.format,je=Ze.formatBody,Tt=Ze.formatRows,Xe=Ze.formatRow,gt=Ze.formatValue,Je=i("5zYK");function Et(_t,Ne){var ke=ye(_t);return Object(Je.a)(ke,Ne)}},gQMU:function(Re,E,i){var T=i("0ZTe"),m=T("toUpperCase");Re.exports=m},gzZq:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("MON2"),m=i("FV85"),X=i("D9lx"),z=i("LKzl"),o=function(){function Z(D){this._binding=D}return Z.prototype.to=function(D){return this._binding.type=m.BindingTypeEnum.Instance,this._binding.implementationType=D,new X.BindingInWhenOnSyntax(this._binding)},Z.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+T.INVALID_TO_SELF_VALUE);var D=this._binding.serviceIdentifier;return this.to(D)},Z.prototype.toConstantValue=function(D){return this._binding.type=m.BindingTypeEnum.ConstantValue,this._binding.cache=D,this._binding.dynamicValue=null,this._binding.implementationType=null,new z.BindingWhenOnSyntax(this._binding)},Z.prototype.toDynamicValue=function(D){return this._binding.type=m.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=D,this._binding.implementationType=null,new X.BindingInWhenOnSyntax(this._binding)},Z.prototype.toConstructor=function(D){return this._binding.type=m.BindingTypeEnum.Constructor,this._binding.implementationType=D,new z.BindingWhenOnSyntax(this._binding)},Z.prototype.toFactory=function(D){return this._binding.type=m.BindingTypeEnum.Factory,this._binding.factory=D,new z.BindingWhenOnSyntax(this._binding)},Z.prototype.toFunction=function(D){if(typeof D!="function")throw new Error(T.INVALID_FUNCTION_BINDING);var K=this.toConstantValue(D);return this._binding.type=m.BindingTypeEnum.Function,K},Z.prototype.toAutoFactory=function(D){return this._binding.type=m.BindingTypeEnum.Factory,this._binding.factory=function(K){var re=function(){return K.container.get(D)};return re},new z.BindingWhenOnSyntax(this._binding)},Z.prototype.toProvider=function(D){return this._binding.type=m.BindingTypeEnum.Provider,this._binding.provider=D,new z.BindingWhenOnSyntax(this._binding)},Z.prototype.toService=function(D){this.toDynamicValue(function(K){return K.container.get(D)})},Z}();E.BindingToSyntax=o},h1nZ:function(Re,E,i){"use strict";var T=i("fX6N");i.d(E,"container",function(){return T.c}),i.d(E,"createSceneContainer",function(){return T.b}),i.d(E,"createLayerContainer",function(){return T.a}),i.d(E,"lazyInject",function(){return T.d});var m=i("+em5"),X=i("bB6j");i.d(E,"TYPES",function(){return X.a});var z=i("8/Fi"),o=i("PUg6");i.d(E,"BlendType",function(){return o.a});var Z=i("cZlC");i.d(E,"AttributeType",function(){return Z.a}),i.d(E,"ScaleTypes",function(){return Z.b}),i.d(E,"StyleScaleType",function(){return Z.c});var D=i("O1je"),K=i.n(D);i.o(D,"CameraUniform")&&i.d(E,"CameraUniform",function(){return D.CameraUniform}),i.o(D,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return D.CityBuildingLayer}),i.o(D,"Control")&&i.d(E,"Control",function(){return D.Control}),i.o(D,"CoordinateSystem")&&i.d(E,"CoordinateSystem",function(){return D.CoordinateSystem}),i.o(D,"CoordinateUniform")&&i.d(E,"CoordinateUniform",function(){return D.CoordinateUniform}),i.o(D,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return D.HeatmapLayer}),i.o(D,"ImageLayer")&&i.d(E,"ImageLayer",function(){return D.ImageLayer}),i.o(D,"LineLayer")&&i.d(E,"LineLayer",function(){return D.LineLayer}),i.o(D,"Logo")&&i.d(E,"Logo",function(){return D.Logo}),i.o(D,"MapServiceEvent")&&i.d(E,"MapServiceEvent",function(){return D.MapServiceEvent}),i.o(D,"Marker")&&i.d(E,"Marker",function(){return D.Marker}),i.o(D,"PointLayer")&&i.d(E,"PointLayer",function(){return D.PointLayer}),i.o(D,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return D.PolygonLayer}),i.o(D,"Popup")&&i.d(E,"Popup",function(){return D.Popup}),i.o(D,"PositionType")&&i.d(E,"PositionType",function(){return D.PositionType}),i.o(D,"RasterLayer")&&i.d(E,"RasterLayer",function(){return D.RasterLayer}),i.o(D,"Scale")&&i.d(E,"Scale",function(){return D.Scale}),i.o(D,"Scene")&&i.d(E,"Scene",function(){return D.Scene}),i.o(D,"SceneEventList")&&i.d(E,"SceneEventList",function(){return D.SceneEventList}),i.o(D,"Zoom")&&i.d(E,"Zoom",function(){return D.Zoom}),i.o(D,"gl")&&i.d(E,"gl",function(){return D.gl});var re=i("L56e");i.d(E,"MapServiceEvent",function(){return re.a});var de=i("HthE");i.d(E,"CoordinateSystem",function(){return de.a}),i.d(E,"CoordinateUniform",function(){return de.b});var Y=i("/33/"),Fe=i.n(Y);i.o(Y,"CameraUniform")&&i.d(E,"CameraUniform",function(){return Y.CameraUniform}),i.o(Y,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return Y.CityBuildingLayer}),i.o(Y,"Control")&&i.d(E,"Control",function(){return Y.Control}),i.o(Y,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return Y.HeatmapLayer}),i.o(Y,"ImageLayer")&&i.d(E,"ImageLayer",function(){return Y.ImageLayer}),i.o(Y,"LineLayer")&&i.d(E,"LineLayer",function(){return Y.LineLayer}),i.o(Y,"Logo")&&i.d(E,"Logo",function(){return Y.Logo}),i.o(Y,"Marker")&&i.d(E,"Marker",function(){return Y.Marker}),i.o(Y,"PointLayer")&&i.d(E,"PointLayer",function(){return Y.PointLayer}),i.o(Y,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return Y.PolygonLayer}),i.o(Y,"Popup")&&i.d(E,"Popup",function(){return Y.Popup}),i.o(Y,"PositionType")&&i.d(E,"PositionType",function(){return Y.PositionType}),i.o(Y,"RasterLayer")&&i.d(E,"RasterLayer",function(){return Y.RasterLayer}),i.o(Y,"Scale")&&i.d(E,"Scale",function(){return Y.Scale}),i.o(Y,"Scene")&&i.d(E,"Scene",function(){return Y.Scene}),i.o(Y,"SceneEventList")&&i.d(E,"SceneEventList",function(){return Y.SceneEventList}),i.o(Y,"Zoom")&&i.d(E,"Zoom",function(){return Y.Zoom}),i.o(Y,"gl")&&i.d(E,"gl",function(){return Y.gl});var Ze=i("EfZ0");i.d(E,"CameraUniform",function(){return Ze.a});var ye=i("riiI"),we=i.n(ye);i.o(ye,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return ye.CityBuildingLayer}),i.o(ye,"Control")&&i.d(E,"Control",function(){return ye.Control}),i.o(ye,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return ye.HeatmapLayer}),i.o(ye,"ImageLayer")&&i.d(E,"ImageLayer",function(){return ye.ImageLayer}),i.o(ye,"LineLayer")&&i.d(E,"LineLayer",function(){return ye.LineLayer}),i.o(ye,"Logo")&&i.d(E,"Logo",function(){return ye.Logo}),i.o(ye,"Marker")&&i.d(E,"Marker",function(){return ye.Marker}),i.o(ye,"PointLayer")&&i.d(E,"PointLayer",function(){return ye.PointLayer}),i.o(ye,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return ye.PolygonLayer}),i.o(ye,"Popup")&&i.d(E,"Popup",function(){return ye.Popup}),i.o(ye,"PositionType")&&i.d(E,"PositionType",function(){return ye.PositionType}),i.o(ye,"RasterLayer")&&i.d(E,"RasterLayer",function(){return ye.RasterLayer}),i.o(ye,"Scale")&&i.d(E,"Scale",function(){return ye.Scale}),i.o(ye,"Scene")&&i.d(E,"Scene",function(){return ye.Scene}),i.o(ye,"SceneEventList")&&i.d(E,"SceneEventList",function(){return ye.SceneEventList}),i.o(ye,"Zoom")&&i.d(E,"Zoom",function(){return ye.Zoom}),i.o(ye,"gl")&&i.d(E,"gl",function(){return ye.gl});var pt=i("eg+a");i.d(E,"SceneEventList",function(){return pt.a});var je=i("bYl4"),Tt=i.n(je);i.o(je,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return je.CityBuildingLayer}),i.o(je,"Control")&&i.d(E,"Control",function(){return je.Control}),i.o(je,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return je.HeatmapLayer}),i.o(je,"ImageLayer")&&i.d(E,"ImageLayer",function(){return je.ImageLayer}),i.o(je,"LineLayer")&&i.d(E,"LineLayer",function(){return je.LineLayer}),i.o(je,"Logo")&&i.d(E,"Logo",function(){return je.Logo}),i.o(je,"Marker")&&i.d(E,"Marker",function(){return je.Marker}),i.o(je,"PointLayer")&&i.d(E,"PointLayer",function(){return je.PointLayer}),i.o(je,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return je.PolygonLayer}),i.o(je,"Popup")&&i.d(E,"Popup",function(){return je.Popup}),i.o(je,"PositionType")&&i.d(E,"PositionType",function(){return je.PositionType}),i.o(je,"RasterLayer")&&i.d(E,"RasterLayer",function(){return je.RasterLayer}),i.o(je,"Scale")&&i.d(E,"Scale",function(){return je.Scale}),i.o(je,"Scene")&&i.d(E,"Scene",function(){return je.Scene}),i.o(je,"Zoom")&&i.d(E,"Zoom",function(){return je.Zoom}),i.o(je,"gl")&&i.d(E,"gl",function(){return je.gl});var Xe=i("FI6e"),gt=i.n(Xe);i.o(Xe,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return Xe.CityBuildingLayer}),i.o(Xe,"Control")&&i.d(E,"Control",function(){return Xe.Control}),i.o(Xe,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return Xe.HeatmapLayer}),i.o(Xe,"ImageLayer")&&i.d(E,"ImageLayer",function(){return Xe.ImageLayer}),i.o(Xe,"LineLayer")&&i.d(E,"LineLayer",function(){return Xe.LineLayer}),i.o(Xe,"Logo")&&i.d(E,"Logo",function(){return Xe.Logo}),i.o(Xe,"Marker")&&i.d(E,"Marker",function(){return Xe.Marker}),i.o(Xe,"PointLayer")&&i.d(E,"PointLayer",function(){return Xe.PointLayer}),i.o(Xe,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return Xe.PolygonLayer}),i.o(Xe,"Popup")&&i.d(E,"Popup",function(){return Xe.Popup}),i.o(Xe,"PositionType")&&i.d(E,"PositionType",function(){return Xe.PositionType}),i.o(Xe,"RasterLayer")&&i.d(E,"RasterLayer",function(){return Xe.RasterLayer}),i.o(Xe,"Scale")&&i.d(E,"Scale",function(){return Xe.Scale}),i.o(Xe,"Scene")&&i.d(E,"Scene",function(){return Xe.Scene}),i.o(Xe,"Zoom")&&i.d(E,"Zoom",function(){return Xe.Zoom}),i.o(Xe,"gl")&&i.d(E,"gl",function(){return Xe.gl});var Je=i("D+ow"),Et=i.n(Je);i.o(Je,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return Je.CityBuildingLayer}),i.o(Je,"Control")&&i.d(E,"Control",function(){return Je.Control}),i.o(Je,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return Je.HeatmapLayer}),i.o(Je,"ImageLayer")&&i.d(E,"ImageLayer",function(){return Je.ImageLayer}),i.o(Je,"LineLayer")&&i.d(E,"LineLayer",function(){return Je.LineLayer}),i.o(Je,"Logo")&&i.d(E,"Logo",function(){return Je.Logo}),i.o(Je,"Marker")&&i.d(E,"Marker",function(){return Je.Marker}),i.o(Je,"PointLayer")&&i.d(E,"PointLayer",function(){return Je.PointLayer}),i.o(Je,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return Je.PolygonLayer}),i.o(Je,"Popup")&&i.d(E,"Popup",function(){return Je.Popup}),i.o(Je,"PositionType")&&i.d(E,"PositionType",function(){return Je.PositionType}),i.o(Je,"RasterLayer")&&i.d(E,"RasterLayer",function(){return Je.RasterLayer}),i.o(Je,"Scale")&&i.d(E,"Scale",function(){return Je.Scale}),i.o(Je,"Scene")&&i.d(E,"Scene",function(){return Je.Scene}),i.o(Je,"Zoom")&&i.d(E,"Zoom",function(){return Je.Zoom}),i.o(Je,"gl")&&i.d(E,"gl",function(){return Je.gl});var _t=i("AFH1");i.d(E,"PositionType",function(){return _t.a});var Ne=i("8uyu"),ke=i.n(Ne);i.o(Ne,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return Ne.CityBuildingLayer}),i.o(Ne,"Control")&&i.d(E,"Control",function(){return Ne.Control}),i.o(Ne,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return Ne.HeatmapLayer}),i.o(Ne,"ImageLayer")&&i.d(E,"ImageLayer",function(){return Ne.ImageLayer}),i.o(Ne,"LineLayer")&&i.d(E,"LineLayer",function(){return Ne.LineLayer}),i.o(Ne,"Logo")&&i.d(E,"Logo",function(){return Ne.Logo}),i.o(Ne,"Marker")&&i.d(E,"Marker",function(){return Ne.Marker}),i.o(Ne,"PointLayer")&&i.d(E,"PointLayer",function(){return Ne.PointLayer}),i.o(Ne,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return Ne.PolygonLayer}),i.o(Ne,"Popup")&&i.d(E,"Popup",function(){return Ne.Popup}),i.o(Ne,"RasterLayer")&&i.d(E,"RasterLayer",function(){return Ne.RasterLayer}),i.o(Ne,"Scale")&&i.d(E,"Scale",function(){return Ne.Scale}),i.o(Ne,"Scene")&&i.d(E,"Scene",function(){return Ne.Scene}),i.o(Ne,"Zoom")&&i.d(E,"Zoom",function(){return Ne.Zoom}),i.o(Ne,"gl")&&i.d(E,"gl",function(){return Ne.gl});var Ue=i("J7lC"),st=i.n(Ue);i.o(Ue,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return Ue.CityBuildingLayer}),i.o(Ue,"Control")&&i.d(E,"Control",function(){return Ue.Control}),i.o(Ue,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return Ue.HeatmapLayer}),i.o(Ue,"ImageLayer")&&i.d(E,"ImageLayer",function(){return Ue.ImageLayer}),i.o(Ue,"LineLayer")&&i.d(E,"LineLayer",function(){return Ue.LineLayer}),i.o(Ue,"Logo")&&i.d(E,"Logo",function(){return Ue.Logo}),i.o(Ue,"Marker")&&i.d(E,"Marker",function(){return Ue.Marker}),i.o(Ue,"PointLayer")&&i.d(E,"PointLayer",function(){return Ue.PointLayer}),i.o(Ue,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return Ue.PolygonLayer}),i.o(Ue,"Popup")&&i.d(E,"Popup",function(){return Ue.Popup}),i.o(Ue,"RasterLayer")&&i.d(E,"RasterLayer",function(){return Ue.RasterLayer}),i.o(Ue,"Scale")&&i.d(E,"Scale",function(){return Ue.Scale}),i.o(Ue,"Scene")&&i.d(E,"Scene",function(){return Ue.Scene}),i.o(Ue,"Zoom")&&i.d(E,"Zoom",function(){return Ue.Zoom}),i.o(Ue,"gl")&&i.d(E,"gl",function(){return Ue.gl});var Le=i("QGbF"),ut=i.n(Le);i.o(Le,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return Le.CityBuildingLayer}),i.o(Le,"Control")&&i.d(E,"Control",function(){return Le.Control}),i.o(Le,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return Le.HeatmapLayer}),i.o(Le,"ImageLayer")&&i.d(E,"ImageLayer",function(){return Le.ImageLayer}),i.o(Le,"LineLayer")&&i.d(E,"LineLayer",function(){return Le.LineLayer}),i.o(Le,"Logo")&&i.d(E,"Logo",function(){return Le.Logo}),i.o(Le,"Marker")&&i.d(E,"Marker",function(){return Le.Marker}),i.o(Le,"PointLayer")&&i.d(E,"PointLayer",function(){return Le.PointLayer}),i.o(Le,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return Le.PolygonLayer}),i.o(Le,"Popup")&&i.d(E,"Popup",function(){return Le.Popup}),i.o(Le,"RasterLayer")&&i.d(E,"RasterLayer",function(){return Le.RasterLayer}),i.o(Le,"Scale")&&i.d(E,"Scale",function(){return Le.Scale}),i.o(Le,"Scene")&&i.d(E,"Scene",function(){return Le.Scene}),i.o(Le,"Zoom")&&i.d(E,"Zoom",function(){return Le.Zoom}),i.o(Le,"gl")&&i.d(E,"gl",function(){return Le.gl});var Vt=i("V1cb"),Zt=i("bzyH"),ir=i.n(Zt);i.o(Zt,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return Zt.CityBuildingLayer}),i.o(Zt,"Control")&&i.d(E,"Control",function(){return Zt.Control}),i.o(Zt,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return Zt.HeatmapLayer}),i.o(Zt,"ImageLayer")&&i.d(E,"ImageLayer",function(){return Zt.ImageLayer}),i.o(Zt,"LineLayer")&&i.d(E,"LineLayer",function(){return Zt.LineLayer}),i.o(Zt,"Logo")&&i.d(E,"Logo",function(){return Zt.Logo}),i.o(Zt,"Marker")&&i.d(E,"Marker",function(){return Zt.Marker}),i.o(Zt,"PointLayer")&&i.d(E,"PointLayer",function(){return Zt.PointLayer}),i.o(Zt,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return Zt.PolygonLayer}),i.o(Zt,"Popup")&&i.d(E,"Popup",function(){return Zt.Popup}),i.o(Zt,"RasterLayer")&&i.d(E,"RasterLayer",function(){return Zt.RasterLayer}),i.o(Zt,"Scale")&&i.d(E,"Scale",function(){return Zt.Scale}),i.o(Zt,"Scene")&&i.d(E,"Scene",function(){return Zt.Scene}),i.o(Zt,"Zoom")&&i.d(E,"Zoom",function(){return Zt.Zoom}),i.o(Zt,"gl")&&i.d(E,"gl",function(){return Zt.gl});var oe=i("0eqD"),Q=i.n(oe);i.o(oe,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return oe.CityBuildingLayer}),i.o(oe,"Control")&&i.d(E,"Control",function(){return oe.Control}),i.o(oe,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return oe.HeatmapLayer}),i.o(oe,"ImageLayer")&&i.d(E,"ImageLayer",function(){return oe.ImageLayer}),i.o(oe,"LineLayer")&&i.d(E,"LineLayer",function(){return oe.LineLayer}),i.o(oe,"Logo")&&i.d(E,"Logo",function(){return oe.Logo}),i.o(oe,"Marker")&&i.d(E,"Marker",function(){return oe.Marker}),i.o(oe,"PointLayer")&&i.d(E,"PointLayer",function(){return oe.PointLayer}),i.o(oe,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return oe.PolygonLayer}),i.o(oe,"Popup")&&i.d(E,"Popup",function(){return oe.Popup}),i.o(oe,"RasterLayer")&&i.d(E,"RasterLayer",function(){return oe.RasterLayer}),i.o(oe,"Scale")&&i.d(E,"Scale",function(){return oe.Scale}),i.o(oe,"Scene")&&i.d(E,"Scene",function(){return oe.Scene}),i.o(oe,"Zoom")&&i.d(E,"Zoom",function(){return oe.Zoom}),i.o(oe,"gl")&&i.d(E,"gl",function(){return oe.gl});var H=i("/Uc5"),Ce=i.n(H);i.o(H,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return H.CityBuildingLayer}),i.o(H,"Control")&&i.d(E,"Control",function(){return H.Control}),i.o(H,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return H.HeatmapLayer}),i.o(H,"ImageLayer")&&i.d(E,"ImageLayer",function(){return H.ImageLayer}),i.o(H,"LineLayer")&&i.d(E,"LineLayer",function(){return H.LineLayer}),i.o(H,"Logo")&&i.d(E,"Logo",function(){return H.Logo}),i.o(H,"Marker")&&i.d(E,"Marker",function(){return H.Marker}),i.o(H,"PointLayer")&&i.d(E,"PointLayer",function(){return H.PointLayer}),i.o(H,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return H.PolygonLayer}),i.o(H,"Popup")&&i.d(E,"Popup",function(){return H.Popup}),i.o(H,"RasterLayer")&&i.d(E,"RasterLayer",function(){return H.RasterLayer}),i.o(H,"Scale")&&i.d(E,"Scale",function(){return H.Scale}),i.o(H,"Scene")&&i.d(E,"Scene",function(){return H.Scene}),i.o(H,"Zoom")&&i.d(E,"Zoom",function(){return H.Zoom}),i.o(H,"gl")&&i.d(E,"gl",function(){return H.gl});var Ee=i("RMtq"),Ae=i.n(Ee);i.o(Ee,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return Ee.CityBuildingLayer}),i.o(Ee,"Control")&&i.d(E,"Control",function(){return Ee.Control}),i.o(Ee,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return Ee.HeatmapLayer}),i.o(Ee,"ImageLayer")&&i.d(E,"ImageLayer",function(){return Ee.ImageLayer}),i.o(Ee,"LineLayer")&&i.d(E,"LineLayer",function(){return Ee.LineLayer}),i.o(Ee,"Logo")&&i.d(E,"Logo",function(){return Ee.Logo}),i.o(Ee,"Marker")&&i.d(E,"Marker",function(){return Ee.Marker}),i.o(Ee,"PointLayer")&&i.d(E,"PointLayer",function(){return Ee.PointLayer}),i.o(Ee,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return Ee.PolygonLayer}),i.o(Ee,"Popup")&&i.d(E,"Popup",function(){return Ee.Popup}),i.o(Ee,"RasterLayer")&&i.d(E,"RasterLayer",function(){return Ee.RasterLayer}),i.o(Ee,"Scale")&&i.d(E,"Scale",function(){return Ee.Scale}),i.o(Ee,"Scene")&&i.d(E,"Scene",function(){return Ee.Scene}),i.o(Ee,"Zoom")&&i.d(E,"Zoom",function(){return Ee.Zoom}),i.o(Ee,"gl")&&i.d(E,"gl",function(){return Ee.gl});var ge=i("1jvM"),rt=i.n(ge);i.o(ge,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return ge.CityBuildingLayer}),i.o(ge,"Control")&&i.d(E,"Control",function(){return ge.Control}),i.o(ge,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return ge.HeatmapLayer}),i.o(ge,"ImageLayer")&&i.d(E,"ImageLayer",function(){return ge.ImageLayer}),i.o(ge,"LineLayer")&&i.d(E,"LineLayer",function(){return ge.LineLayer}),i.o(ge,"Logo")&&i.d(E,"Logo",function(){return ge.Logo}),i.o(ge,"Marker")&&i.d(E,"Marker",function(){return ge.Marker}),i.o(ge,"PointLayer")&&i.d(E,"PointLayer",function(){return ge.PointLayer}),i.o(ge,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return ge.PolygonLayer}),i.o(ge,"Popup")&&i.d(E,"Popup",function(){return ge.Popup}),i.o(ge,"RasterLayer")&&i.d(E,"RasterLayer",function(){return ge.RasterLayer}),i.o(ge,"Scale")&&i.d(E,"Scale",function(){return ge.Scale}),i.o(ge,"Scene")&&i.d(E,"Scene",function(){return ge.Scene}),i.o(ge,"Zoom")&&i.d(E,"Zoom",function(){return ge.Zoom}),i.o(ge,"gl")&&i.d(E,"gl",function(){return ge.gl});var Yt=i("bPkA"),At=i("PSsN"),be=i.n(At);i.o(At,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return At.CityBuildingLayer}),i.o(At,"Control")&&i.d(E,"Control",function(){return At.Control}),i.o(At,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return At.HeatmapLayer}),i.o(At,"ImageLayer")&&i.d(E,"ImageLayer",function(){return At.ImageLayer}),i.o(At,"LineLayer")&&i.d(E,"LineLayer",function(){return At.LineLayer}),i.o(At,"Logo")&&i.d(E,"Logo",function(){return At.Logo}),i.o(At,"Marker")&&i.d(E,"Marker",function(){return At.Marker}),i.o(At,"PointLayer")&&i.d(E,"PointLayer",function(){return At.PointLayer}),i.o(At,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return At.PolygonLayer}),i.o(At,"Popup")&&i.d(E,"Popup",function(){return At.Popup}),i.o(At,"RasterLayer")&&i.d(E,"RasterLayer",function(){return At.RasterLayer}),i.o(At,"Scale")&&i.d(E,"Scale",function(){return At.Scale}),i.o(At,"Scene")&&i.d(E,"Scene",function(){return At.Scene}),i.o(At,"Zoom")&&i.d(E,"Zoom",function(){return At.Zoom}),i.o(At,"gl")&&i.d(E,"gl",function(){return At.gl});var xe=i("6NqC"),Ve=i.n(xe);i.o(xe,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return xe.CityBuildingLayer}),i.o(xe,"Control")&&i.d(E,"Control",function(){return xe.Control}),i.o(xe,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return xe.HeatmapLayer}),i.o(xe,"ImageLayer")&&i.d(E,"ImageLayer",function(){return xe.ImageLayer}),i.o(xe,"LineLayer")&&i.d(E,"LineLayer",function(){return xe.LineLayer}),i.o(xe,"Logo")&&i.d(E,"Logo",function(){return xe.Logo}),i.o(xe,"Marker")&&i.d(E,"Marker",function(){return xe.Marker}),i.o(xe,"PointLayer")&&i.d(E,"PointLayer",function(){return xe.PointLayer}),i.o(xe,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return xe.PolygonLayer}),i.o(xe,"Popup")&&i.d(E,"Popup",function(){return xe.Popup}),i.o(xe,"RasterLayer")&&i.d(E,"RasterLayer",function(){return xe.RasterLayer}),i.o(xe,"Scale")&&i.d(E,"Scale",function(){return xe.Scale}),i.o(xe,"Scene")&&i.d(E,"Scene",function(){return xe.Scene}),i.o(xe,"Zoom")&&i.d(E,"Zoom",function(){return xe.Zoom}),i.o(xe,"gl")&&i.d(E,"gl",function(){return xe.gl});var lt=i("bTtR"),Pe=i.n(lt);i.o(lt,"CityBuildingLayer")&&i.d(E,"CityBuildingLayer",function(){return lt.CityBuildingLayer}),i.o(lt,"Control")&&i.d(E,"Control",function(){return lt.Control}),i.o(lt,"HeatmapLayer")&&i.d(E,"HeatmapLayer",function(){return lt.HeatmapLayer}),i.o(lt,"ImageLayer")&&i.d(E,"ImageLayer",function(){return lt.ImageLayer}),i.o(lt,"LineLayer")&&i.d(E,"LineLayer",function(){return lt.LineLayer}),i.o(lt,"Logo")&&i.d(E,"Logo",function(){return lt.Logo}),i.o(lt,"Marker")&&i.d(E,"Marker",function(){return lt.Marker}),i.o(lt,"PointLayer")&&i.d(E,"PointLayer",function(){return lt.PointLayer}),i.o(lt,"PolygonLayer")&&i.d(E,"PolygonLayer",function(){return lt.PolygonLayer}),i.o(lt,"Popup")&&i.d(E,"Popup",function(){return lt.Popup}),i.o(lt,"RasterLayer")&&i.d(E,"RasterLayer",function(){return lt.RasterLayer}),i.o(lt,"Scale")&&i.d(E,"Scale",function(){return lt.Scale}),i.o(lt,"Scene")&&i.d(E,"Scene",function(){return lt.Scene}),i.o(lt,"Zoom")&&i.d(E,"Zoom",function(){return lt.Zoom}),i.o(lt,"gl")&&i.d(E,"gl",function(){return lt.gl});var dt=i("o+pz");i.d(E,"gl",function(){return dt.a})},h7MG:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("doU7"),m=i("MON2"),X=i("FV85"),z=i("xfSm"),o=i("qK8v"),Z=i("ujMp"),D=i("oy+k"),K=i("GXnB"),re=i("yMAV"),de=i("fbrv"),Y=i("xiII"),Fe=i("dX1H");function Ze(Je){return Je._bindingDictionary}E.getBindingDictionary=Ze;function ye(Je,Et,_t,Ne,ke,Ue){var st=Je?z.MULTI_INJECT_TAG:z.INJECT_TAG,Le=new K.Metadata(st,_t),ut=new Fe.Target(Et,Ne,_t,Le);if(ke!==void 0){var Vt=new K.Metadata(ke,Ue);ut.metadata.push(Vt)}return ut}function we(Je,Et,_t,Ne,ke){var Ue=Tt(_t.container,ke.serviceIdentifier),st=[];return Ue.length===T.BindingCount.NoBindingsAvailable&&_t.container.options.autoBindInjectable&&typeof ke.serviceIdentifier=="function"&&Je.getConstructorMetadata(ke.serviceIdentifier).compilerGeneratedMetadata&&(_t.container.bind(ke.serviceIdentifier).toSelf(),Ue=Tt(_t.container,ke.serviceIdentifier)),Et?st=Ue:st=Ue.filter(function(Le){var ut=new Y.Request(Le.serviceIdentifier,_t,Ne,Le,ke);return Le.constraint(ut)}),pt(ke.serviceIdentifier,st,ke,_t.container),st}function pt(Je,Et,_t,Ne){switch(Et.length){case T.BindingCount.NoBindingsAvailable:if(_t.isOptional())return Et;var ke=Z.getServiceIdentifierAsString(Je),Ue=m.NOT_REGISTERED;throw Ue+=Z.listMetadataForTarget(ke,_t),Ue+=Z.listRegisteredBindingsForServiceIdentifier(Ne,ke,Tt),new Error(Ue);case T.BindingCount.OnlyOneBindingAvailable:if(!_t.isArray())return Et;case T.BindingCount.MultipleBindingsAvailable:default:if(_t.isArray())return Et;var ke=Z.getServiceIdentifierAsString(Je),Ue=m.AMBIGUOUS_MATCH+" "+ke;throw Ue+=Z.listRegisteredBindingsForServiceIdentifier(Ne,ke,Tt),new Error(Ue)}}function je(Je,Et,_t,Ne,ke,Ue){var st,Le;if(ke===null){st=we(Je,Et,Ne,null,Ue),Le=new Y.Request(_t,Ne,null,st,Ue);var ut=new re.Plan(Ne,Le);Ne.addPlan(ut)}else st=we(Je,Et,Ne,ke,Ue),Le=ke.addChildRequest(Ue.serviceIdentifier,st,Ue);st.forEach(function(Vt){var Zt=null;if(Ue.isArray())Zt=Le.addChildRequest(Vt.serviceIdentifier,Vt,Ue);else{if(Vt.cache)return;Zt=Le}if(Vt.type===X.BindingTypeEnum.Instance&&Vt.implementationType!==null){var ir=de.getDependencies(Je,Vt.implementationType);if(!Ne.container.options.skipBaseClassChecks){var oe=de.getBaseClassDependencyCount(Je,Vt.implementationType);if(ir.length<oe){var Q=m.ARGUMENTS_LENGTH_MISMATCH(de.getFunctionName(Vt.implementationType));throw new Error(Q)}}ir.forEach(function(H){je(Je,!1,H.serviceIdentifier,Ne,Zt,H)})}})}function Tt(Je,Et){var _t=[],Ne=Ze(Je);return Ne.hasKey(Et)?_t=Ne.get(Et):Je.parent!==null&&(_t=Tt(Je.parent,Et)),_t}function Xe(Je,Et,_t,Ne,ke,Ue,st,Le){Le===void 0&&(Le=!1);var ut=new D.Context(Et),Vt=ye(_t,Ne,ke,"",Ue,st);try{return je(Je,Le,ke,ut,null,Vt),ut}catch(Zt){throw o.isStackOverflowExeption(Zt)&&(ut.plan&&Z.circularDependencyToException(ut.plan.rootRequest)),Zt}}E.plan=Xe;function gt(Je,Et,_t,Ne){var ke=new Fe.Target(X.TargetTypeEnum.Variable,"",Et,new K.Metadata(_t,Ne)),Ue=new D.Context(Je),st=new Y.Request(Et,Ue,null,[],ke);return st}E.createMockRequest=gt},heNW:function(Re,E){function i(T,m,X){switch(X.length){case 0:return T.call(m);case 1:return T.call(m,X[0]);case 2:return T.call(m,X[0],X[1]);case 3:return T.call(m,X[0],X[1],X[2])}return T.apply(m,X)}Re.exports=i},hi0z:function(Re,E,i){"use strict";(function(T,m){Re.exports=m()})(this,function(){function T(de){var Y=[];return de.AMapUI&&Y.push(m(de.AMapUI)),de.Loca&&Y.push(X(de.Loca)),Promise.all(Y)}function m(de){return new Promise(function(Y,Fe){var Ze=[];if(de.plugins)for(var ye=0;ye<de.plugins.length;ye+=1)o.AMapUI.plugins.indexOf(de.plugins[ye])==-1&&Ze.push(de.plugins[ye]);if(Z.AMapUI===z.failed)Fe("\u524D\u6B21\u8BF7\u6C42 AMapUI \u5931\u8D25");else if(Z.AMapUI===z.notload){Z.AMapUI=z.loading,o.AMapUI.version=de.version||o.AMapUI.version,ye=o.AMapUI.version;var we=document.body||document.head,pt=document.createElement("script");pt.type="text/javascript",pt.src="https://webapi.amap.com/ui/"+ye+"/main.js",pt.onerror=function(je){Z.AMapUI=z.failed,Fe("\u8BF7\u6C42 AMapUI \u5931\u8D25")},pt.onload=function(){if(Z.AMapUI=z.loaded,Ze.length)window.AMapUI.loadUI(Ze,function(){for(var je=0,Tt=Ze.length;je<Tt;je++){var Xe=Ze[je].split("/").slice(-1)[0];window.AMapUI[Xe]=arguments[je]}for(Y();D.AMapUI.length;)D.AMapUI.splice(0,1)[0]()});else for(Y();D.AMapUI.length;)D.AMapUI.splice(0,1)[0]()},we.appendChild(pt)}else Z.AMapUI===z.loaded?de.version&&de.version!==o.AMapUI.version?Fe("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):Ze.length?window.AMapUI.loadUI(Ze,function(){for(var je=0,Tt=Ze.length;je<Tt;je++){var Xe=Ze[je].split("/").slice(-1)[0];window.AMapUI[Xe]=arguments[je]}Y()}):Y():de.version&&de.version!==o.AMapUI.version?Fe("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):D.AMapUI.push(function(je){je?Fe(je):Ze.length?window.AMapUI.loadUI(Ze,function(){for(var Tt=0,Xe=Ze.length;Tt<Xe;Tt++){var gt=Ze[Tt].split("/").slice(-1)[0];window.AMapUI[gt]=arguments[Tt]}Y()}):Y()})})}function X(de){return new Promise(function(Y,Fe){if(o.AMap.version.startsWith("2.0"))Fe("Loca \u6682\u4E0D\u9002\u914D JSAPI 2.0,\u8BF7\u4F7F\u7528 1.4.15");else if(Z.Loca===z.failed)Fe("\u524D\u6B21\u8BF7\u6C42 Loca \u5931\u8D25");else if(Z.Loca===z.notload){Z.Loca=z.loading,o.Loca.version=de.version||o.Loca.version;var Ze=o.Loca.version,ye=o.key,we=document.body||document.head,pt=document.createElement("script");pt.type="text/javascript",pt.src="https://webapi.amap.com/loca?v="+Ze+"&key="+ye,pt.onerror=function(je){Z.Loca=z.failed,Fe("\u8BF7\u6C42 AMapUI \u5931\u8D25")},pt.onload=function(){for(Z.Loca=z.loaded,Y();D.Loca.length;)D.Loca.splice(0,1)[0]()},we.appendChild(pt)}else Z.Loca===z.loaded?de.version&&de.version!==o.Loca.version?Fe("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):Y():de.version&&de.version!==o.Loca.version?Fe("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):D.Loca.push(function(je){je?Fe(je):Fe()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var z;(function(de){de.notload="notload",de.loading="loading",de.loaded="loaded",de.failed="failed"})(z||(z={}));var o={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},Z={AMap:z.notload,AMapUI:z.notload,Loca:z.notload},D={AMap:[],AMapUI:[],Loca:[]},K=[],re=function(Y){typeof Y=="function"&&(Z.AMap===z.loaded?Y(window.AMap):K.push(Y))};return{load:function(Y){return new Promise(function(Fe,Ze){if(Z.AMap==z.failed)Ze("");else if(Z.AMap==z.notload){var ye=Y.key,we=Y.version,pt=Y.plugins;ye?(window.AMap&&location.host!=="lbs.amap.com"&&Ze("\u7981\u6B62\u591A\u79CDAPI\u52A0\u8F7D\u65B9\u5F0F\u6DF7\u7528"),o.key=ye,o.AMap.version=we||o.AMap.version,o.AMap.plugins=pt||o.AMap.plugins,Z.AMap=z.loading,we=document.body||document.head,window.___onAPILoaded=function(Tt){if(delete window.___onAPILoaded,Tt)Z.AMap=z.failed,Ze(Tt);else for(Z.AMap=z.loaded,T(Y).then(function(){Fe(window.AMap)}).catch(Ze);K.length;)K.splice(0,1)[0]()},pt=document.createElement("script"),pt.type="text/javascript",pt.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+o.AMap.version+"&key="+ye+"&plugin="+o.AMap.plugins.join(","),pt.onerror=function(Tt){Z.AMap=z.failed,Ze(Tt)},we.appendChild(pt)):Ze("\u8BF7\u586B\u5199key")}else if(Z.AMap==z.loaded)if(Y.key&&Y.key!==o.key)Ze("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(Y.version&&Y.version!==o.AMap.version)Ze("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{if(ye=[],Y.plugins)for(we=0;we<Y.plugins.length;we+=1)o.AMap.plugins.indexOf(Y.plugins[we])==-1&&ye.push(Y.plugins[we]);ye.length?window.AMap.plugin(ye,function(){T(Y).then(function(){Fe(window.AMap)}).catch(Ze)}):T(Y).then(function(){Fe(window.AMap)}).catch(Ze)}else if(Y.key&&Y.key!==o.key)Ze("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(Y.version&&Y.version!==o.AMap.version)Ze("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{var je=[];if(Y.plugins)for(we=0;we<Y.plugins.length;we+=1)o.AMap.plugins.indexOf(Y.plugins[we])==-1&&je.push(Y.plugins[we]);re(function(){je.length?window.AMap.plugin(je,function(){T(Y).then(function(){Fe(window.AMap)}).catch(Ze)}):T(Y).then(function(){Fe(window.AMap)}).catch(Ze)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,o={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},Z={AMap:z.notload,AMapUI:z.notload,Loca:z.notload},D={AMap:[],AMapUI:[],Loca:[]}}}})},hypo:function(Re,E,i){var T=i("O0oS");function m(X,z,o){z=="__proto__"&&T?T(X,z,{configurable:!0,enumerable:!0,value:o,writable:!0}):X[z]=o}Re.exports=m},iWIM:function(Re,E,i){var T=i("n3AX");function m(X,z,o){return typeof Reflect!="undefined"&&Reflect.get?Re.exports=m=Reflect.get:Re.exports=m=function(D,K,re){var de=T(D,K);if(!de)return;var Y=Object.getOwnPropertyDescriptor(de,K);return Y.get?Y.get.call(re):Y.value},m(X,z,o||X)}Re.exports=m},iegG:function(Re,E){function i(T){var m=T.target||T.srcElement;m.__resizeRAF__&&cancelAnimationFrame(m.__resizeRAF__),m.__resizeRAF__=requestAnimationFrame(function(){var X=m.__resizeTrigger__,z=X&&X.__resizeListeners__;z&&z.forEach(function(o){o.call(X,T)})})}var E=function(m,X){var z=this,o=z.document,Z,D=o.attachEvent;typeof navigator!="undefined"&&(Z=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/));function K(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",i)}if(!m.__resizeListeners__)if(m.__resizeListeners__=[],D)m.__resizeTrigger__=m,m.attachEvent("onresize",i);else{getComputedStyle(m).position==="static"&&(m.style.position="relative");var re=m.__resizeTrigger__=o.createElement("object");re.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),re.setAttribute("class","resize-sensor"),re.setAttribute("tabindex","-1"),re.__resizeElement__=m,re.onload=K,re.type="text/html",Z&&m.appendChild(re),re.data="about:blank",Z||m.appendChild(re)}m.__resizeListeners__.push(X)};Re.exports=typeof window=="undefined"?E:E.bind(window),Re.exports.unbind=function(T,m){var X=document.attachEvent,z=T.__resizeListeners__||[];if(m){var o=z.indexOf(m);o!==-1&&z.splice(o,1)}else z=T.__resizeListeners__=[];if(!z.length){if(X)T.detachEvent("onresize",i);else if(T.__resizeTrigger__){var Z=T.__resizeTrigger__.contentDocument,D=Z&&Z.defaultView;D&&(D.removeEventListener("resize",i),delete D.__resizeTrigger__),T.__resizeTrigger__=!T.removeChild(T.__resizeTrigger__)}delete T.__resizeListeners__}}},itsj:function(Re,E){function i(T,m){return m==="constructor"&&typeof T[m]=="function"||m=="__proto__"?void 0:T[m]}Re.exports=i},"iz+Y":function(Re,E,i){Re.exports={miniChart:"antd-pro-pages-dashboard-monitor-components-charts-index-miniChart",chartContent:"antd-pro-pages-dashboard-monitor-components-charts-index-chartContent",chartLoading:"antd-pro-pages-dashboard-monitor-components-charts-index-chartLoading"}},jCWc:function(Re,E,i){"use strict";var T=i("cIOH"),m=i.n(T),X=i("1GLa")},"jIg/":function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("xfSm"),m=i("GXnB"),X=i("Ztfv");function z(o){return function(Z,D,K){var re=new m.Metadata(T.MULTI_INJECT_TAG,o);typeof K=="number"?X.tagParameter(Z,D,K,re):X.tagProperty(Z,D,re)}}E.multiInject=z},jYQm:function(Re,E,i){"use strict";var T=i("q1tI"),m=i.n(T),X=Object(T.createContext)({});E.a=X},jYx5:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("xfSm"),m=i("GXnB"),X=i("Ztfv");function z(){return function(o,Z,D){var K=new m.Metadata(T.OPTIONAL_TAG,!0);typeof D=="number"?X.tagParameter(o,Z,D,K):X.tagProperty(o,Z,K)}}E.optional=z},"jbM+":function(Re,E,i){var T=i("R/W3");function m(X,z){var o=X==null?0:X.length;return!!o&&T(X,z,0)>-1}Re.exports=m},jeLo:function(Re,E,i){var T=i("juv8"),m=i("mTTR");function X(z){return T(z,m(z))}Re.exports=X},juv8:function(Re,E,i){var T=i("MrPd"),m=i("hypo");function X(z,o,Z,D){var K=!Z;Z||(Z={});for(var re=-1,de=o.length;++re<de;){var Y=o[re],Fe=D?D(Z[Y],z[Y],Y,Z,z):void 0;Fe===void 0&&(Fe=z[Y]),K?m(Z,Y,Fe):T(Z,Y,Fe)}return Z}Re.exports=X},"k5/I":function(Re,E,i){"use strict";i.d(E,"a",function(){return Et}),i.d(E,"b",function(){return Vt}),i.d(E,"e",function(){return oe}),i.d(E,"f",function(){return Ce}),i.d(E,"c",function(){return Yt}),i.d(E,"d",function(){return yt});var T=i("lSNA"),m=i.n(T),X=i("lwsE"),z=i.n(X),o=i("W8MJ"),Z=i.n(o),D=i("7W2i"),K=i.n(D),re=i("a1gu"),de=i.n(re),Y=i("Nsbk"),Fe=i.n(Y),Ze=i("h1nZ"),ye=i("Hel2"),we=i("uhBA");function pt(nt,Nt){var $=Object.keys(nt);if(Object.getOwnPropertySymbols){var Ke=Object.getOwnPropertySymbols(nt);Nt&&(Ke=Ke.filter(function(ae){return Object.getOwnPropertyDescriptor(nt,ae).enumerable})),$.push.apply($,Ke)}return $}function je(nt){for(var Nt=1;Nt<arguments.length;Nt++){var $=arguments[Nt]!=null?arguments[Nt]:{};Nt%2?pt(Object($),!0).forEach(function(Ke){m()(nt,Ke,$[Ke])}):Object.getOwnPropertyDescriptors?Object.defineProperties(nt,Object.getOwnPropertyDescriptors($)):pt(Object($)).forEach(function(Ke){Object.defineProperty(nt,Ke,Object.getOwnPropertyDescriptor($,Ke))})}return nt}function Tt(nt){var Nt=Xe();return function(){var Ke=Fe()(nt),ae;if(Nt){var et=Fe()(this).constructor;ae=Reflect.construct(Ke,arguments,et)}else ae=Ke.apply(this,arguments);return de()(this,ae)}}function Xe(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var gt;(function(nt){nt.TOPRIGHT="topright",nt.TOPLEFT="topleft",nt.BOTTOMRIGHT="bottomright",nt.BOTTOMLEFT="bottomleft"})(gt||(gt={}));var Je=0,Et=function(nt){K()($,nt);var Nt=Tt($);function $(Ke){var ae;return z()(this,$),ae=Nt.call(this),ae.controlOption=void 0,ae.container=void 0,ae.sceneContainer=void 0,ae.mapsService=void 0,ae.renderService=void 0,ae.layerService=void 0,ae.controlService=void 0,ae.isShow=void 0,ae.controlOption=je(je({},ae.getDefault()),Ke||{}),ae}return Z()($,[{key:"getDefault",value:function(){return{position:gt.TOPRIGHT,name:"".concat(Je++)}}},{key:"setPosition",value:function(ae){var et=this.controlService;return et&&et.removeControl(this),this.controlOption.position=ae,et&&et.addControl(this,this.sceneContainer),this}},{key:"addTo",value:function(ae){this.mapsService=ae.get(Ze.TYPES.IMapService),this.renderService=ae.get(Ze.TYPES.IRendererService),this.layerService=ae.get(Ze.TYPES.ILayerService),this.controlService=ae.get(Ze.TYPES.IControlService),this.sceneContainer=ae,this.isShow=!0,this.container=this.onAdd();var et=this.container,jt=this.controlOption.position,sr=this.controlService.controlCorners[jt];return ye.a.addClass(et,"l7-control"),jt.indexOf("bottom")!==-1?sr.insertBefore(et,sr.firstChild):sr.appendChild(et),this}},{key:"onAdd",value:function(){throw new Error("Method not implemented.")}},{key:"onRemove",value:function(){throw new Error("Method not implemented.")}},{key:"hide",value:function(){var ae=this.container;ye.a.addClass(ae,"l7-control-hide"),this.isShow=!1}},{key:"show",value:function(){var ae=this.container;ye.a.removeClass(ae,"l7-control-hide"),this.isShow=!0}},{key:"remove",value:function(){if(!this.mapsService)return this;ye.a.remove(this.container),this.onRemove()}},{key:"_refocusOnMap",value:function(ae){if(this.mapsService&&ae&&ae.screenX>0&&ae.screenY>0){var et=this.mapsService.getContainer();et!==null&&et.focus()}}}]),$}(we.EventEmitter),_t=i("PJYZ"),Ne=i.n(_t);function ke(nt){var Nt=Ue();return function(){var Ke=Fe()(nt),ae;if(Nt){var et=Fe()(this).constructor;ae=Reflect.construct(Ke,arguments,et)}else ae=Ke.apply(this,arguments);return de()(this,ae)}}function Ue(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var st=function(nt){K()($,nt);var Nt=ke($);function $(Ke){var ae;return z()(this,$),ae=Nt.call(this,Ke),ae.layerControlInputs=void 0,ae.layers=void 0,ae.lastZIndex=void 0,ae.handlingClick=void 0,ae.layersLink=void 0,ae.baseLayersList=void 0,ae.separator=void 0,ae.overlaysList=void 0,ae.form=void 0,ae.layerControlInputs=[],ae.layers=[],ae.lastZIndex=0,ae.handlingClick=!1,ae.initLayers(),Object(ye.i)(["checkDisabledLayers","onLayerChange","collapse","extend","expand","onInputClick"],Ne()(ae)),ae}return Z()($,[{key:"getDefault",value:function(){return{collapsed:!0,position:Ze.PositionType.TOPRIGHT,autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,name:"layers"}}},{key:"onAdd",value:function(){var ae=this;return this.initLayout(),this.update(),this.mapsService.on("zoomend",this.checkDisabledLayers),this.layers.forEach(function(et){et.layer.on("remove",ae.onLayerChange),et.layer.on("add",ae.onLayerChange)}),this.container}},{key:"addVisualLayer",value:function(ae,et){return this.addLayer(ae,et,!0),this.mapsService?this.update():this}},{key:"expand",value:function(){var ae=this.renderService.getViewportSize(),et=ae.height;ye.a.addClass(this.container,"l7-control-layers-expanded"),this.form.style.height="null";var jt=et-(this.container.offsetTop+50);return jt<this.form.clientHeight?(ye.a.addClass(this.form,"l7-control-layers-scrollbar"),this.form.style.height=jt+"px"):ye.a.removeClass(this.form,"l7-control-layers-scrollbar"),this.checkDisabledLayers(),this}},{key:"collapse",value:function(){return ye.a.removeClass(this.container,"l7-control-layers-expanded"),this}},{key:"onRemove",value:function(){var ae=this;if(!this.mapsService)return;this.mapsService.off("click",this.collapse),this.layers.forEach(function(et){et.layer.off("remove",ae.onLayerChange),et.layer.off("add",ae.onLayerChange)})}},{key:"initLayout",value:function(){var ae="l7-control-layers",et=this.container=ye.a.create("div",ae),jt=this.controlOption.collapsed;et.setAttribute("aria-haspopup","true");var sr=this.form=ye.a.create("form",ae+"-list");jt&&(this.mapsService.on("click",this.collapse),et.addEventListener("mouseenter",this.expand),et.addEventListener("mouseleave",this.collapse)),this.layersLink=ye.a.create("a",ae+"-toggle",et);var ft=this.layersLink;ft.title="Layers",jt||this.expand(),this.baseLayersList=ye.a.create("div",ae+"-base",sr),this.separator=ye.a.create("div",ae+"-separator",sr),this.overlaysList=ye.a.create("div",ae+"-overlays",sr),et.appendChild(sr)}},{key:"initLayers",value:function(){var ae=this,et=this.controlOption,jt=et.baseLayers,sr=jt===void 0?{}:jt,ft=et.overlayers,mt=ft===void 0?{}:ft;Object.keys(sr).forEach(function(Ct,vt){ae.addLayer(sr[Ct],Ct,!1)}),Object.keys(mt).forEach(function(Ct,vt){ae.addLayer(mt[Ct],Ct,!0)})}},{key:"update",value:function(){if(!this.container)return this;ye.a.empty(this.baseLayersList),ye.a.empty(this.overlaysList),this.layerControlInputs=[];var ae,et,jt,sr,ft=0;for(jt=0;jt<this.layers.length;jt++)sr=this.layers[jt],this.addItem(sr),et=et||sr.overlay,ae=ae||!sr.overlay,ft+=sr.overlay?0:1;return this.controlOption.hideSingleBase&&(ae=ae&&ft>1,this.baseLayersList.style.display=ae?"":"none"),this.separator.style.display=et&&ae?"":"none",this}},{key:"checkDisabledLayers",value:function(){for(var ae=this.layerControlInputs,et,jt,sr=this.mapsService.getZoom(),ft=ae.length-1;ft>=0;ft--)if(et=ae[ft],jt=this.layerService.getLayer(et.layerId),jt&&jt.inited){var mt=jt.getMinZoom(),Ct=jt.getMaxZoom();et.disabled=sr<mt||sr>Ct}}},{key:"addLayer",value:function(ae,et,jt){this.mapsService&&(ae.on("add",this.onLayerChange),ae.on("remove",this.onLayerChange)),this.layers.push({layer:ae,name:et,overlay:jt});var sr=this.controlOption,ft=sr.sortLayers,mt=sr.sortFunction,Ct=sr.autoZIndex;ft&&this.layers.sort(function(vt,Oe){return mt(vt.layer,Oe.layer,vt.name,Oe.name)}),Ct&&ae.setZIndex&&(this.lastZIndex++,ae.setZIndex(this.lastZIndex)),this.expandIfNotCollapsed()}},{key:"expandIfNotCollapsed",value:function(){return this.mapsService&&!this.controlOption.collapsed&&this.expand(),this}},{key:"onLayerChange",value:function(ae){this.handlingClick||this.update();var et=this.layerService.getLayer(ae.target.layerId),jt=(et==null?void 0:et.overlay)?ae.type==="add"?"overlayadd":"overlayremove":ae.type==="add"?"baselayerchange":null;jt&&this.emit(jt,et)}},{key:"createRadioElement",value:function(ae,et){var jt='<input type="radio" class="l7-control-layers-selector" name="'+ae+'"'+(et?' checked="checked"':"")+"/>",sr=document.createElement("div");return sr.innerHTML=jt,sr.firstChild}},{key:"addItem",value:function(ae){var et=document.createElement("label"),jt=this.layerService.getLayer(ae.layer.id),sr=jt&&jt.inited&&ae.layer.isVisible(),ft;ae.overlay?(ft=document.createElement("input"),ft.type="checkbox",ft.className="l7-control-layers-selector",ft.defaultChecked=sr):ft=this.createRadioElement("l7-base-layers",sr),this.layerControlInputs.push(ft),ft.layerId=ae.layer.id,ft.addEventListener("click",this.onInputClick);var mt=document.createElement("span");mt.innerHTML=" "+ae.name;var Ct=document.createElement("div");et.appendChild(Ct),Ct.appendChild(ft),Ct.appendChild(mt);var vt=ae.overlay?this.overlaysList:this.baseLayersList;return vt.appendChild(et),this.checkDisabledLayers(),et}},{key:"onInputClick",value:function(){var ae=this.layerControlInputs,et,jt,sr=[],ft=[];this.handlingClick=!0;for(var mt=ae.length-1;mt>=0;mt--)et=ae[mt],jt=this.layerService.getLayer(et.layerId),et.checked?sr.push(jt):et.checked||ft.push(jt);ft.forEach(function(Ct){Ct.hide()}),sr.forEach(function(Ct){Ct.show()}),this.handlingClick=!1}}]),$}(Et);function Le(nt){var Nt=ut();return function(){var Ke=Fe()(nt),ae;if(Nt){var et=Fe()(this).constructor;ae=Reflect.construct(Ke,arguments,et)}else ae=Ke.apply(this,arguments);return de()(this,ae)}}function ut(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var Vt=function(nt){K()($,nt);var Nt=Le($);function $(){return z()(this,$),Nt.apply(this,arguments)}return Z()($,[{key:"getDefault",value:function(){return{position:gt.BOTTOMLEFT,name:"logo"}}},{key:"onAdd",value:function(){var ae="l7-control-logo",et=ye.a.create("div",ae),jt=ye.a.create("a","l7-ctrl-logo");return jt.target="_blank",jt.rel="noopener nofollow",jt.href="https://antv.alipay.com/l7",jt.setAttribute("aria-label","AntV logo"),jt.setAttribute("rel","noopener nofollow"),et.appendChild(jt),et}},{key:"onRemove",value:function(){return null}}]),$}(Et);function Zt(nt){var Nt=ir();return function(){var Ke=Fe()(nt),ae;if(Nt){var et=Fe()(this).constructor;ae=Reflect.construct(Ke,arguments,et)}else ae=Ke.apply(this,arguments);return de()(this,ae)}}function ir(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var oe=function(nt){K()($,nt);var Nt=Zt($);function $(Ke){var ae;return z()(this,$),ae=Nt.call(this,Ke),ae.mScale=void 0,ae.iScale=void 0,Object(ye.i)(["update"],Ne()(ae)),ae}return Z()($,[{key:"getDefault",value:function(){return{position:gt.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,name:"scale"}}},{key:"onAdd",value:function(){var ae="l7-control-scale",et=ye.a.create("div",ae);this.addScales(ae+"-line",et);var jt=this.controlOption.updateWhenIdle;return this.mapsService.on(jt?"moveend":"mapmove",this.update),this.mapsService.on(jt?"zoomend":"zoomchange",this.update),this.update(),et}},{key:"onRemove",value:function(){var ae=this.controlOption.updateWhenIdle;this.mapsService.off(ae?"zoomend":"zoomchange",this.update),this.mapsService.off(ae?"moveend":"mapmove",this.update)}},{key:"update",value:function(){var ae=this.mapsService,et=this.controlOption.maxWidth,jt=ae.getSize()[1]/2,sr=ae.containerToLngLat([0,jt]),ft=ae.containerToLngLat([et,jt]),mt=Object(ye.q)([sr.lng,sr.lat],[ft.lng,ft.lat]);this.updateScales(mt)}},{key:"updateScales",value:function(ae){var et=this.controlOption,jt=et.metric,sr=et.imperial;jt&&ae&&this.updateMetric(ae),sr&&ae&&this.updateImperial(ae)}},{key:"updateMetric",value:function(ae){var et=this.getRoundNum(ae),jt=et<1e3?et+" m":et/1e3+" km";this.updateScale(this.mScale,jt,et/ae)}},{key:"updateImperial",value:function(ae){var et=ae*3.2808399,jt,sr,ft;et>5280?(jt=et/5280,sr=this.getRoundNum(jt),this.updateScale(this.iScale,sr+" mi",sr/jt)):(ft=this.getRoundNum(et),this.updateScale(this.iScale,ft+" ft",ft/et))}},{key:"updateScale",value:function(ae,et,jt){var sr=this.controlOption.maxWidth;ae.style.width=Math.round(sr*jt)+"px",ae.innerHTML=et}},{key:"getRoundNum",value:function(ae){var et=Math.pow(10,(Math.floor(ae)+"").length-1),jt=ae/et;return jt=jt>=10?10:jt>=5?5:jt>=3?3:jt>=2?2:1,et*jt}},{key:"addScales",value:function(ae,et){var jt=this.controlOption,sr=jt.metric,ft=jt.imperial;sr&&(this.mScale=ye.a.create("div",ae,et)),ft&&(this.iScale=ye.a.create("div",ae,et))}}]),$}(Et);function Q(nt){var Nt=H();return function(){var Ke=Fe()(nt),ae;if(Nt){var et=Fe()(this).constructor;ae=Reflect.construct(Ke,arguments,et)}else ae=Ke.apply(this,arguments);return de()(this,ae)}}function H(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var Ce=function(nt){K()($,nt);var Nt=Q($);function $(Ke){var ae;return z()(this,$),ae=Nt.call(this,Ke),ae.disabled=void 0,ae.zoomInButton=void 0,ae.zoomOutButton=void 0,Object(ye.i)(["updateDisabled","zoomIn","zoomOut"],Ne()(ae)),ae}return Z()($,[{key:"getDefault",value:function(){return{position:gt.TOPLEFT,zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out",name:"zoom"}}},{key:"onAdd",value:function(){var ae="l7-control-zoom",et=ye.a.create("div",ae+" l7-bar");return this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,ae+"-in",et,this.zoomIn),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,ae+"-out",et,this.zoomOut),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),this.updateDisabled(),et}},{key:"onRemove",value:function(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}},{key:"disable",value:function(){return this.disabled=!0,this.updateDisabled(),this}},{key:"enable",value:function(){return this.disabled=!1,this.updateDisabled(),this}},{key:"zoomIn",value:function(){!this.disabled&&this.mapsService.getZoom()<this.mapsService.getMaxZoom()&&this.mapsService.zoomIn()}},{key:"zoomOut",value:function(){!this.disabled&&this.mapsService.getZoom()>this.mapsService.getMinZoom()&&this.mapsService.zoomOut()}},{key:"createButton",value:function(ae,et,jt,sr,ft){var mt=ye.a.create("a",jt,sr);return mt.innerHTML=ae,mt.title=et,mt.href="javascript:void(0)",mt.addEventListener("click",ft),mt}},{key:"updateDisabled",value:function(){var ae=this.mapsService,et="l7-disabled";ye.a.removeClass(this.zoomInButton,et),ye.a.removeClass(this.zoomOutButton,et),(this.disabled||ae.getZoom()<=ae.getMinZoom())&&ye.a.addClass(this.zoomOutButton,et),(this.disabled||ae.getZoom()>=ae.getMaxZoom())&&ye.a.addClass(this.zoomInButton,et)}}]),$}(Et);function Ee(nt,Nt){var $=Object.keys(nt);if(Object.getOwnPropertySymbols){var Ke=Object.getOwnPropertySymbols(nt);Nt&&(Ke=Ke.filter(function(ae){return Object.getOwnPropertyDescriptor(nt,ae).enumerable})),$.push.apply($,Ke)}return $}function Ae(nt){for(var Nt=1;Nt<arguments.length;Nt++){var $=arguments[Nt]!=null?arguments[Nt]:{};Nt%2?Ee(Object($),!0).forEach(function(Ke){m()(nt,Ke,$[Ke])}):Object.getOwnPropertyDescriptors?Object.defineProperties(nt,Object.getOwnPropertyDescriptors($)):Ee(Object($)).forEach(function(Ke){Object.defineProperty(nt,Ke,Object.getOwnPropertyDescriptor($,Ke))})}return nt}function ge(nt){var Nt=rt();return function(){var Ke=Fe()(nt),ae;if(Nt){var et=Fe()(this).constructor;ae=Reflect.construct(Ke,arguments,et)}else ae=Ke.apply(this,arguments);return de()(this,ae)}}function rt(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var Yt=function(nt){K()($,nt);var Nt=ge($);function $(Ke){var ae;return z()(this,$),ae=Nt.call(this),ae.markerOption=void 0,ae.defaultMarker=void 0,ae.popup=void 0,ae.mapsService=void 0,ae.sceneSerive=void 0,ae.lngLat=void 0,ae.scene=void 0,ae.added=!1,ae.eventHandle=function(et){ae.emit(et.type,{target:et,data:ae.markerOption.extData,lngLat:ae.lngLat})},ae.markerOption=Ae(Ae({},ae.getDefault()),Ke),Object(ye.i)(["update","onMove","onUp","addDragHandler","onMapClick"],Ne()(ae)),ae.init(),ae}return Z()($,[{key:"getDefault",value:function(){return{element:void 0,anchor:ye.f.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1}}},{key:"addTo",value:function(ae){this.scene=ae,this.mapsService=ae.get(Ze.TYPES.IMapService),this.sceneSerive=ae.get(Ze.TYPES.ISceneService);var et=this.markerOption,jt=et.element,sr=et.draggable;return this.mapsService.getMarkerContainer().appendChild(jt),this.registerMarkerEvent(jt),this.mapsService.on("camerachange",this.update),this.update(),this.added=!0,this.emit("added"),this}},{key:"remove",value:function(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("mousedown",this.addDragHandler),this.mapsService.off("touchstart",this.addDragHandler),this.mapsService.off("mouseup",this.onUp),this.mapsService.off("touchend",this.onUp)),this.unRegisterMarkerEvent(),this.removeAllListeners();var ae=this.markerOption.element;return ae&&ye.a.remove(ae),this.popup&&this.popup.remove(),this}},{key:"setLnglat",value:function(ae){return this.lngLat=ae,Array.isArray(ae)&&(this.lngLat={lng:ae[0],lat:ae[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"getElement",value:function(){return this.markerOption.element}},{key:"setElement",value:function(ae){var et=this;if(!this.added)return this.once("added",function(){et.setElement(ae)}),this;var jt=this.markerOption.element;return jt&&ye.a.remove(jt),this.markerOption.element=ae,this.init(),this.mapsService.getMarkerContainer().appendChild(ae),this.registerMarkerEvent(ae),this.update(),this}},{key:"openPopup",value:function(){var ae=this;if(!this.added)return this.once("added",function(){ae.openPopup()}),this;var et=this.popup;return et?(et.isOpen()||et.addTo(this.scene),this):this}},{key:"closePopup",value:function(){var ae=this;this.added||this.once("added",function(){ae.closePopup()});var et=this.popup;return et&&et.remove(),this}},{key:"setPopup",value:function(ae){return this.popup=ae,this.lngLat&&this.popup.setLnglat(this.lngLat),this}},{key:"togglePopup",value:function(){var ae=this.popup;if(ae)ae.isOpen()?ae.remove():ae.addTo(this.scene);else return this;return this}},{key:"getPopup",value:function(){return this.popup}},{key:"getOffset",value:function(){return this.markerOption.offsets}},{key:"setDraggable",value:function(ae){throw new Error("Method not implemented.")}},{key:"isDraggable",value:function(){return this.markerOption.draggable}},{key:"getExtData",value:function(){return this.markerOption.extData}},{key:"setExtData",value:function(ae){this.markerOption.extData=ae}},{key:"update",value:function(){if(!this.mapsService)return;var ae=this.markerOption,et=ae.element,jt=ae.anchor;this.updatePosition(),ye.a.setTransform(et,"".concat(ye.e[jt]))}},{key:"onMapClick",value:function(ae){var et=this.markerOption.element;this.popup&&et&&this.togglePopup()}},{key:"updatePosition",value:function(){if(!this.mapsService)return;var ae=this.markerOption,et=ae.element,jt=ae.offsets,sr=this.lngLat,ft=sr.lng,mt=sr.lat,Ct=this.mapsService.getBounds(),vt=this.mapsService.getZoom();if((ft<Ct[0][0]||ft>Ct[1][0]||mt<Ct[0][1]||mt>Ct[1][1])&&vt>3){et&&(et.style.display="none");return}var Oe=this.mapsService.lngLatToContainer([ft,mt]);et&&(et.style.display="block",et.style.left=Oe.x+jt[0]+"px",et.style.top=Oe.y-jt[1]+"px")}},{key:"init",value:function(){var ae=this,et=this.markerOption.element,jt=this.markerOption,sr=jt.color,ft=jt.anchor;if(!et){this.defaultMarker=!0,et=ye.a.create("div"),this.markerOption.element=et;var mt=document.createElementNS("http://www.w3.org/2000/svg","svg");mt.setAttributeNS(null,"display","block"),mt.setAttributeNS(null,"height","48px"),mt.setAttributeNS(null,"width","48px"),mt.setAttributeNS(null,"viewBox","0 0 1024 1024");var Ct=document.createElementNS("http://www.w3.org/2000/svg","path");Ct.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),Ct.setAttributeNS(null,"fill",sr),mt.appendChild(Ct),et.appendChild(mt)}ye.a.addClass(et,"l7-marker"),et.addEventListener("click",function(vt){ae.onMapClick(vt)}),et.addEventListener("click",this.eventHandle),Object(ye.g)(et,ft,"marker")}},{key:"registerMarkerEvent",value:function(ae){ae.addEventListener("mousemove",this.eventHandle),ae.addEventListener("click",this.eventHandle),ae.addEventListener("mousedown",this.eventHandle),ae.addEventListener("mouseup",this.eventHandle),ae.addEventListener("dblclick",this.eventHandle),ae.addEventListener("contextmenu",this.eventHandle),ae.addEventListener("mouseover",this.eventHandle),ae.addEventListener("mouseout",this.eventHandle)}},{key:"unRegisterMarkerEvent",value:function(){var ae=this.getElement();ae.removeEventListener("mousemove",this.eventHandle),ae.removeEventListener("click",this.eventHandle),ae.removeEventListener("mousedown",this.eventHandle),ae.removeEventListener("mouseup",this.eventHandle),ae.removeEventListener("dblclick",this.eventHandle),ae.removeEventListener("contextmenu",this.eventHandle),ae.removeEventListener("mouseover",this.eventHandle),ae.removeEventListener("mouseout",this.eventHandle)}},{key:"addDragHandler",value:function(ae){throw new Error("Method not implemented.")}},{key:"onUp",value:function(ae){throw new Error("Method not implemented.")}}]),$}(we.EventEmitter),At=i("QkVN"),be=i.n(At),xe=i("mpbz"),Ve=i.n(xe);function lt(nt,Nt){var $=Object.keys(nt);if(Object.getOwnPropertySymbols){var Ke=Object.getOwnPropertySymbols(nt);Nt&&(Ke=Ke.filter(function(ae){return Object.getOwnPropertyDescriptor(nt,ae).enumerable})),$.push.apply($,Ke)}return $}function Pe(nt){for(var Nt=1;Nt<arguments.length;Nt++){var $=arguments[Nt]!=null?arguments[Nt]:{};Nt%2?lt(Object($),!0).forEach(function(Ke){m()(nt,Ke,$[Ke])}):Object.getOwnPropertyDescriptors?Object.defineProperties(nt,Object.getOwnPropertyDescriptors($)):lt(Object($)).forEach(function(Ke){Object.defineProperty(nt,Ke,Object.getOwnPropertyDescriptor($,Ke))})}return nt}function dt(nt){var Nt=w();return function(){var Ke=Fe()(nt),ae;if(Nt){var et=Fe()(this).constructor;ae=Reflect.construct(Ke,arguments,et)}else ae=Ke.apply(this,arguments);return de()(this,ae)}}function w(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var I=function(nt){K()($,nt);var Nt=dt($);function $(Ke){var ae,et;return z()(this,$),et=Nt.call(this),et.markers=[],et.markerLayerOption=void 0,et.clusterIndex=void 0,et.points=[],et.clusterMarkers=[],et.mapsService=void 0,et.scene=void 0,et.zoom=void 0,et.bbox=void 0,et.markerLayerOption=be()(et.getDefault(),Ke),Object(ye.i)(["update"],Ne()(et)),et.zoom=((ae=et.markerLayerOption.clusterOption)===null||ae===void 0?void 0:ae.zoom)||-99,et}return Z()($,[{key:"getDefault",value:function(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}},{key:"addTo",value:function(ae){return this.scene=ae,this.mapsService=ae.get(Ze.TYPES.IMapService),this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update)),this.addMarkers(),this}},{key:"addMarker",value:function(ae){var et=this.markerLayerOption.cluster;et&&this.addPoint(ae,this.markers.length),this.markers.push(ae)}},{key:"removeMarker",value:function(ae){this.markers.indexOf(ae);var et=this.markers.indexOf(ae);et>-1&&this.markers.splice(et,1)}},{key:"getMarkers",value:function(){var ae=this.markerLayerOption.cluster;return ae?this.clusterMarkers:this.markers}},{key:"addMarkers",value:function(){var ae=this;this.getMarkers().forEach(function(et){et.addTo(ae.scene)})}},{key:"clear",value:function(){this.markers.forEach(function(ae){ae.remove()}),this.clusterMarkers.forEach(function(ae){ae.remove()}),this.mapsService.off("camerachange",this.update),this.markers=[],this.clusterMarkers=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners()}},{key:"addPoint",value:function(ae,et){var jt=ae.getLnglat(),sr=jt.lng,ft=jt.lat,mt={geometry:{type:"Point",coordinates:[sr,ft]},properties:Pe(Pe({},ae.getExtData()),{},{marker_id:et})};this.points.push(mt)}},{key:"initCluster",value:function(){if(!this.markerLayerOption.cluster)return;var ae=this.markerLayerOption.clusterOption,et=ae.radius,jt=ae.minZoom,sr=jt===void 0?0:jt,ft=ae.maxZoom;this.clusterIndex=new Ve.a({radius:et,minZoom:sr,maxZoom:ft}),this.clusterIndex.load(this.points)}},{key:"getClusterMarker",value:function(ae,et){var jt=this,sr=ae[0].concat(ae[1]),ft=this.clusterIndex.getClusters(sr,et);this.clusterMarkers.forEach(function(mt){mt.remove()}),this.clusterMarkers=[],ft.forEach(function(mt){var Ct,vt=jt.markerLayerOption.clusterOption,Oe=vt.field,ct=vt.method;if(mt.properties&&((Ct=mt.properties)===null||Ct===void 0?void 0:Ct.cluster_id)){var Qe,Ft=jt.getLeaves((Qe=mt.properties)===null||Qe===void 0?void 0:Qe.cluster_id);if(mt.properties.clusterData=Ft,Oe&&ct){var vr=Ft==null?void 0:Ft.map(function(na){var ha=m()({},Oe,na.properties[Oe]);return ha}),Vr=ye.c.getColumn(vr,Oe),lr=ye.c.getSatByColumn(ct,Vr),Nn="point_"+ct;mt.properties[Nn]=lr.toFixed(2)}}var vn=jt.clusterMarker(mt);jt.clusterMarkers.push(vn),vn.addTo(jt.scene)})}},{key:"getLeaves",value:function(ae){var et=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Infinity,jt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return ae?this.clusterIndex.getLeaves(ae,et,jt):null}},{key:"clusterMarker",value:function(ae){var et=this.markerLayerOption.clusterOption,jt=et,sr=jt.element,ft=sr===void 0?this.generateElement.bind(this):sr,mt=new Yt({element:ft(ae)}).setLnglat({lng:ae.geometry.coordinates[0],lat:ae.geometry.coordinates[1]});return mt}},{key:"normalMarker",value:function(ae){var et=ae.properties.marker_id;return this.markers[et]}},{key:"update",value:function(){var ae=this.mapsService.getZoom(),et=this.mapsService.getBounds();(!this.bbox||Math.abs(ae-this.zoom)>=1||!Object(ye.j)(this.bbox,et))&&(this.bbox=Object(ye.r)(et,.5),this.zoom=Math.floor(ae),this.getClusterMarker(this.bbox,this.zoom))}},{key:"generateElement",value:function(ae){var et=ye.a.create("div","l7-marker-cluster"),jt=ye.a.create("div","",et),sr=ye.a.create("span","",jt),ft=this.markerLayerOption.clusterOption,mt=ft.field,Ct=ft.method;ae.properties.point_count=ae.properties.point_count||1;var vt=mt&&Ct?ae.properties["point_"+Ct]||ae.properties[mt]:ae.properties.point_count;return sr.textContent=vt,et}}]),$}(we.EventEmitter);function q(nt,Nt){var $=Object.keys(nt);if(Object.getOwnPropertySymbols){var Ke=Object.getOwnPropertySymbols(nt);Nt&&(Ke=Ke.filter(function(ae){return Object.getOwnPropertyDescriptor(nt,ae).enumerable})),$.push.apply($,Ke)}return $}function ce(nt){for(var Nt=1;Nt<arguments.length;Nt++){var $=arguments[Nt]!=null?arguments[Nt]:{};Nt%2?q(Object($),!0).forEach(function(Ke){m()(nt,Ke,$[Ke])}):Object.getOwnPropertyDescriptors?Object.defineProperties(nt,Object.getOwnPropertyDescriptors($)):q(Object($)).forEach(function(Ke){Object.defineProperty(nt,Ke,Object.getOwnPropertyDescriptor($,Ke))})}return nt}function Ge(nt){var Nt=$e();return function(){var Ke=Fe()(nt),ae;if(Nt){var et=Fe()(this).constructor;ae=Reflect.construct(Ke,arguments,et)}else ae=Ke.apply(this,arguments);return de()(this,ae)}}function $e(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var yt=function(nt){K()($,nt);var Nt=Ge($);function $(Ke){var ae;return z()(this,$),ae=Nt.call(this),ae.popupOption=void 0,ae.mapsService=void 0,ae.sceneSerive=void 0,ae.lngLat=void 0,ae.content=void 0,ae.closeButton=void 0,ae.timeoutInstance=void 0,ae.container=void 0,ae.tip=void 0,ae.scene=void 0,ae.popupOption=ce(ce({},ae.getdefault()),Ke),Object(ye.i)(["update","onClickClose","remove"],Ne()(ae)),ae}return Z()($,[{key:"addTo",value:function(ae){var et=this;return this.mapsService=ae.get(Ze.TYPES.IMapService),this.sceneSerive=ae.get(Ze.TYPES.ISceneService),this.mapsService.on("camerachange",this.update),this.scene=ae,this.update(),this.popupOption.closeOnClick&&(this.timeoutInstance=setTimeout(function(){et.mapsService.on("click",et.onClickClose)},30)),this.emit("open"),this}},{key:"close",value:function(){this.remove()}},{key:"open",value:function(){this.addTo(this.scene)}},{key:"setHTML",value:function(ae){var et=window.document.createDocumentFragment(),jt=window.document.createElement("body"),sr;for(jt.innerHTML=ae;!(sr=jt.firstChild,!sr);)et.appendChild(sr);return this.setDOMContent(et)}},{key:"setLnglat",value:function(ae){return this.lngLat=ae,Array.isArray(ae)&&(this.lngLat={lng:ae[0],lat:ae[1]}),this.mapsService&&this.mapsService.on("camerachange",this.update),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"setText",value:function(ae){return this.setDOMContent(window.document.createTextNode(ae))}},{key:"setMaxWidth",value:function(ae){return this.popupOption.maxWidth=ae,this.update(),this}},{key:"setDOMContent",value:function(ae){return this.createContent(),this.content.appendChild(ae),this.update(),this}},{key:"remove",value:function(){return this.content&&this.removeDom(this.content),this.container&&(this.removeDom(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("click",this.onClickClose),delete this.mapsService),clearTimeout(this.timeoutInstance),this.emit("close"),this}},{key:"isOpen",value:function(){return!!this.mapsService}},{key:"createContent",value:function(){this.content&&ye.a.remove(this.content),this.content=ye.a.create("div","l7-popup-content",this.container),this.popupOption.closeButton&&(this.closeButton=ye.a.create("button","l7-popup-close-button",this.content),this.closeButton.setAttribute("aria-label","Close popup"),this.closeButton.innerHTML="&#215;",this.closeButton.addEventListener("click",this.onClickClose))}},{key:"creatDom",value:function(ae,et,jt){var sr=window.document.createElement(ae);return et!==void 0&&(sr.className=et),jt&&jt.appendChild(sr),sr}},{key:"removeDom",value:function(ae){ae.parentNode&&ae.parentNode.removeChild(ae)}},{key:"getdefault",value:function(){return{closeButton:!0,closeOnClick:!0,maxWidth:"240px",offsets:[0,0],anchor:ye.f.BOTTOM,className:"",stopPropagation:!0}}},{key:"onClickClose",value:function(ae){ae.stopPropagation&&ae.stopPropagation(),this.remove()}},{key:"update",value:function(){var ae=this,et=this.lngLat,jt=this.popupOption,sr=jt.className,ft=jt.maxWidth,mt=jt.anchor;if(!this.mapsService||!et||!this.content)return;var Ct=this.mapsService.getMarkerContainer();if(!this.container&&Ct){this.container=this.creatDom("div","l7-popup",Ct),this.tip=this.creatDom("div","l7-popup-tip",this.container),this.container.appendChild(this.content),sr&&sr.split(" ").forEach(function(Oe){return ae.container.classList.add(Oe)});var vt=this.popupOption.stopPropagation;vt&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(function(Oe){ae.container.addEventListener(Oe,function(ct){ct.stopPropagation()})})}ft&&this.container.style.maxWidth!==ft&&(this.container.style.maxWidth=ft),this.updatePosition(),ye.a.setTransform(this.container,"".concat(ye.e[mt])),Object(ye.g)(this.container,mt,"popup")}},{key:"updatePosition",value:function(){if(!this.mapsService)return;var ae=this.lngLat,et=ae.lng,jt=ae.lat,sr=this.popupOption.offsets,ft=this.mapsService.lngLatToContainer([et,jt]);this.container.style.left=ft.x+sr[0]+"px",this.container.style.top=ft.y-sr[1]+"px"}}]),$}(we.EventEmitter);i("BGjm")(`/* @antv/l7-component */
.l7-marker-container {
  width: 100%;
  height: 100%;
  overflow: hidden;
  position: absolute;
 }

.l7-marker {
	position: absolute !important;
	top: 0;
	left: 0;
  z-index: 5;
  cursor: pointer;
}

.l7-marker-cluster {
  background-clip: padding-box;
  border-radius: 20px;
  background-color: rgba(181, 226, 140, 0.6);
  width: 40px;
  height: 40px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-left: 5px;
  margin-top: 5px;
  text-align: center;
  border-radius: 15px;
  font: 12px "Helvetica Neue", Arial, Helvetica, sans-serif;
  background-color: rgba(110, 204, 57, 0.6);
}
.l7-marker-cluster span {
  line-height: 30px;
}

.l7-popup-anchor-bottom,
.l7-popup-anchor-bottom-left,
.l7-popup-anchor-bottom-right {
    -webkit-flex-direction: column-reverse;
    -webkit-box-orient: vertical;
    -webkit-box-direction: reverse;
        -ms-flex-direction: column-reverse;
            flex-direction: column-reverse;
}

.l7-popup-close-button {
  position: absolute;
  right: 0;
  top: 0;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
  background-color: transparent;
}

.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

	/* layers control */

.l7-control-layers {
	-webkit-box-shadow: 0 1px 5px rgba(0,0,0,0.4);
	        box-shadow: 0 1px 5px rgba(0,0,0,0.4);
	background: #fff;
	border-radius: 5px;
	}
.l7-popup-anchor-top,
.l7-popup-anchor-top-left,
.l7-popup-anchor-top-right {
    -webkit-flex-direction: column;
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
        -ms-flex-direction: column;
            flex-direction: column;
}


.l7-popup-anchor-left {
    -webkit-flex-direction: row;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: normal;
        -ms-flex-direction: row;
            flex-direction: row;
}

.l7-popup-anchor-right {
    -webkit-flex-direction: row-reverse;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: reverse;
        -ms-flex-direction: row-reverse;
            flex-direction: row-reverse;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  display: -webkit-flex;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  will-change: transform;
  pointer-events: none;
  z-index: 5;
}
.l7-popup-tip {
  width: 0;
  height: 0;
  border: 10px solid transparent;
  z-index: 1;
}
.l7-popup-anchor-top .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-top: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-top-left .l7-popup-tip {
	-webkit-align-self: flex-start;
	-ms-flex-item-align: start;
	    align-self: flex-start;
	border-top: none;
	border-left: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-top-right .l7-popup-tip {
	-webkit-align-self: flex-end;
	-ms-flex-item-align: end;
	    align-self: flex-end;
	border-top: none;
	border-right: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-bottom .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-bottom: none;
	border-top-color: #fff;
}

.l7-popup-anchor-bottom-left .l7-popup-tip {
	-webkit-align-self: flex-start;
	-ms-flex-item-align: start;
	    align-self: flex-start;
	border-bottom: none;
	border-left: none;
	border-top-color: #fff;
}

.l7-popup-anchor-bottom-right .l7-popup-tip {
	-webkit-align-self: flex-end;
	-ms-flex-item-align: end;
	    align-self: flex-end;
	border-bottom: none;
	border-right: none;
	border-top-color: #fff;
}

.l7-popup-anchor-left .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-left: none;
	border-right-color: #fff;
}

.l7-popup-anchor-right .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-right: none;
	border-left-color: #fff;
}

.l7-popup-close-button {
	position: absolute;
	right: 0;
	top: 0;
	border: 0;
	padding: 0;
	font-size: 25px;
	line-height: 20px;
	border-radius: 0 3px 0 0;
	cursor: pointer;
	background-color: transparent;
}

.l7-popup-close-button:hover {
	background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
	position: relative;
	background: #fff;
	border-radius: 3px;
	-webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
	        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
	padding: 10px 10px 15px;
	pointer-events: auto;
}

.l7-popup-anchor-top-left .l7-popup-content {
	border-top-left-radius: 0;
}

.l7-popup-anchor-top-right .l7-popup-content {
	border-top-right-radius: 0;
}

.l7-popup-anchor-bottom-left .l7-popup-content {
	border-bottom-left-radius: 0;
}

.l7-popup-anchor-bottom-right .l7-popup-content {
	border-bottom-right-radius: 0;
}

.l7-popup-track-pointer {
	display: none;
}

.l7-popup-track-pointer * {
	pointer-events: none;
	-webkit-user-select: none;
	   -moz-user-select: none;
	    -ms-user-select: none;
	        user-select: none;
}

.l7-map:hover .l7-popup-track-pointer {
	display: -webkit-box;
	display: -webkit-flex;
	display: -ms-flexbox;
	display: flex;
}

.l7-map:active .l7-popup-track-pointer {
	display: none;
}


.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

/* general toolbar styles */

.l7-bar {
	-webkit-box-shadow: 0 1px 5px rgba(0,0,0,0.65);
	        box-shadow: 0 1px 5px rgba(0,0,0,0.65);
	border-radius: 4px;
	}
.l7-bar a,
.l7-bar a:hover {
	background-color: #fff;
	width: 30px;
	height: 30px;
  font-size: 20px;
	display: block;
	text-align: center;
	text-decoration: none;
	color: #8E9DAB;
	}
.l7-bar a,
.l7-control-layers-toggle {
	background-position: 50% 50%;
	background-repeat: no-repeat;
	display: block;
	}
.l7-bar a:hover {
	background-color: #f4f4f4;
	}
.l7-bar a:first-child {
	border-top-left-radius: 2px;
	border-top-right-radius: 2px;
	}
.l7-bar a:last-child {
	border-bottom-left-radius: 2px;
	border-bottom-right-radius: 2px;
	border-bottom: none;
	}
.l7-bar a.l7-disabled {
	cursor: default;
	background-color: #f4f4f4;
	color: #bbb;
	}


/* control positioning */

.l7-control-container {
	font: 12px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif;
}
.l7-control-hide {
	display: none;
}
.l7-control {
	position: relative;
	z-index: 800;
	pointer-events: visiblePainted; /* IE 9-10 doesn't have auto */
	pointer-events: auto;
	}
.l7-control {
	float: left;
	clear: both;
	}.l7-top,
  .l7-bottom {
    position: absolute;
    z-index: 1000;
    pointer-events: none;
    }
  .l7-top {
    top: 0;
    }
  .l7-right {
    right: 0;
    }
  .l7-bottom {
    bottom: 0;
    }
  .l7-left {
    left: 0;
    }

  .l7-control {
    float: left;
    clear: both;
    }
  .l7-right .l7-control {
    float: right;
    }
  .l7-top .l7-control {
    margin-top: 10px;
    }
  .l7-bottom .l7-control {
    margin-bottom: 10px;
    }
  .l7-left .l7-control {
    margin-left: 10px;
    }
  .l7-right .l7-control {
    margin-right: 10px;
    }

  /* attribution and scale controls */

.l7-control-container .l7-control-attribution {
	background: #fff;
	background: rgba(255, 255, 255, 0.7);
	margin: 0;
	}
.l7-control-attribution,
.l7-control-scale-line {
	padding: 0 5px;
  color: #333;
	}
.l7-control-attribution a {
	text-decoration: none;
	}
.l7-control-attribution a:hover {
	text-decoration: underline;
	}
.l7-container .l7-control-attribution,
.l7-container .l7-control-scale {
  font-size: 11px;
  padding: 5px 5px 2px 5px;
  background: rgba(255, 255, 255, 0.7);
	}
.l7-left .l7-control-scale {
	margin-left: 5px;
	}
.l7-bottom .l7-control-scale {
	margin-bottom: 5px;
	}
.l7-control-scale-line {
	border: 2px solid #000;
  border-top: none;
  color: #000;
	line-height: 1.1;
	padding: 2px 5px 1px;
	font-size: 11px;
	white-space: nowrap;
	overflow: hidden;
	-webkit-box-sizing: border-box;
	        box-sizing: border-box;

	background: #fff;
	}
.l7-control-scale-line:not(:first-child) {
	border-top: 2px solid #777;
	border-bottom: none;
	margin-top: -2px;
	}
.l7-control-scale-line:not(:first-child):not(:last-child) {
	border-bottom: 2px solid #777;
	}

.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
	-webkit-box-shadow: none;
	        box-shadow: none;
	}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
	border: 2px solid rgba(0,0,0,0.2);
	background-clip: padding-box;
  }
  /*logo */

  .l7-ctrl-logo {
    background-size: 100% 100%;
    width: 89px;
    height: 16px;
    margin: 0 0 -3px -3px;
    display: -webkit-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;
    background-repeat: no-repeat;
    cursor: pointer;
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALIAAAAgCAYAAAHBIxK2AAAABGdBTUEAALGPC/xhBQAAIJZJREFUeAHtfAl8Tkf3/9z7PNmDRFbZSawhQcRSaqva1xCqpataqrT2UkuUUiqlaKtafe1VS1pUiypB0dIgIkpKRPZIELI/2/zO98akN48nltL3838//84nNzNzzpkzc+eee+bMOXMfxijNaMJ7LOrGO/HdYfZ8fb12gD2JJINJdR8WNHVQnRtSn7hilpz0u2DMKaEcFhZmhdzLNbiPyNVlwPxcm4Qh93Fr0gO4Ol5hfqiz6Q14G+QzGpYzQ9nXrUl7X/fgbrXdG3skX7m26+bNW2fQqJ5XmCs6RQKd6EQwB0zgtKgsvCidGF+N8wV/SBLqSKnXzx2WKIHw1xNxq2xtrKsBXqgrbePt1rivJFmloa5OoD129NcVQwa9Phxwaflw3ifvHCus1YIVjW7fwEF66dIhdYO/XV7Qk+9HY/5F7RA+w0G5TdRxq7gw10FBPWwA+3r9jpkYGcoJ5/7YiFxMiYCjLspsekOeCiJ1AhJJNER+8rfTX/j4BNcUMNCLMmhF+wC3cE9RZmMd/0IQjeTtGdwJjURD5EajsRQN1EwEHjAkUVce2LLhnKf8xGId3ZhkX4uxmj7MMKqJz0ZmMr3MJNZBmphV8WDBOCCgo+2QiE7DF3005wvU75e8vMLs4+P3HwwN7do5MzOu2NcjpPHRX/csCqjt2wvtxEAy8xJ3o+7j3jjkcurpn2xtrT0EPiS0oQPKSOfi/ygqL9H/qNbls8EXuer4+65xUa149QnBvGYFgapAN21EZ+pnuH3rrrnKdNA/zCRmjoqGzu36RoL21q38BLAAjRgo6iir63g1QAOcOoU27DAgwKtpPzVMKU+qBWIuve3Jx0zw4j/eQ0CASeNnjUi5mrYH72ZxUfFV0emJ479/BvrM9KxDAgZZEjziTp1d8+pL415sEdJloIAhF7QCZmnQoCkuLkkXNPfkozU8b4wVb30P4i4ADNQ41P08mtSBogHc27Vx70CPEHeUgRNwgUOuTqBR8wwODraGSIkrKipKxqVuI300mntri1jz9OOs0IHeHUdvms2t0iG+vn5nxmnan5QeUff6GGWttpidSjvGbCSZJdAAGTMwtjWSH2G5XrOp3oEv9wuWxqdeUPchZkW8OGqcedmcdujgUcMOH/zltmgL2YW2Fu22fbMz6q2xM+IEvmvHiCGyRq7AK3QLe959+T6v46co0uVBisLk0/9SqIIhcnQiVBPqULJ4dPVd2ypLg6Dx8wxuhAGDHrCOHTtqUfZ2b6KsYYIOuUiXL1/dKW4SMJRxkbbpG9nv5ecVutlt+PSoNvw7VPg8V4X5wqf4YQVp9g+NDQZDITr2cm/8lNIGlbvp+edGD/946eqJqOKmoBJRhjyjrclk0qlZAqeumw8YOEwE6ILdgh0raN9pcHeWx9n3mViPh9IKnlmBVBWI4bfoePDAEcOGPz9WWUDBzMe1cUdft5CnUfb2DvFR8rsz2avrkOdmT18wJisz5zDaqthVWjwAtzRgtBF9VbSdVofXIPWmB2CCouYqUBUFH59QbwwEqg0XykAi96/VuCEetRrm59msEfA+nqEtAUeqNEt324JGJEsDxpMi26gnaCpUxqJk6bahkGFp3akrZO8IBurcVGponpGW+VOdQP++uIAznzE1/cBBvRRZTc+OP0miUBJ78OiyxNxE6uX+KSP3vDIZuEE/z9BgWZZtHHj1oxZbkS6uJFNqIn+SWSy1AubjFtLd171xoHrQooyFQJRB7+0eHBrk2cxNtBW5mgYwoYNFXg5r7CvoFXWxajQ3mjiTc84wVkB2kTWt5NYk3lZ02SCvzphDDVrNZOY2p3mdA0wrhQoGSm5ig6SRyTsqwSxUaMKk+t4tXJIy4/IsoP82yNu7pYusKwk2WdslZmScvGHOyNs1tJ5GNrjVaeT2W2xsLCnuv5J6woQq/QtbXoLCMJqYtbWj208pKbGK4aamgWJR19XlCvpFEdxn6SDOl0byAjXB/cp8rlM/PteZ83k1T92PTuAw0Ly8GychmosWLB/v7xFSW+AeJQ/0auyLiYFEBgQ0dYKdDRsJfFOvpe0V76fgCVrgkNQTao63hAONr2vjFtAFltoTTFLzB415Al7RFdNipHRviWlLbzCHhZ05HxfEy9e7T/zX8FV+XLk+96e8Tl0xOJZfOpjdKp4kzboZXgGrouDj1rTunHnTQl1caoZ/unLNlKnTx32sNxobR0ZGakQTDCY8tEtEkG+LfihDg+NC2ccjpBXoyMTqVaLjTaFLduxe219XqH+67HYGKU5D0pbN30X5+vl0a9m6mZOPTxvFUIayPRAbM1RpS1uztp0a/SD6e9hcYlKVqgi7QEg/DAyRsAUsKSlNLyvT56Bs8e2Ias4LZzfnfEowJyOOVocZDs9jt8YnMDvUZzblZ+jis1rwtqg/KMHgwEThCUOCUS64U/An6iiL9oIGcFjwqMOQQB0JdTyEXd/tfR/1rMzsWCrPBxwPCxJMfJMELVYq0KO+fNkXk6CHRV/qXPSLXA0XZejpqiRZ0IgcY7hzu+AS2TB3quInaNnU2vzSlNqcT/fhHSqAVJgawAunEXxCPU4W9MMlcRN0ryZMAl2XcOHm6YlnYgMAToIOuxks+YBBErGrAa0YtKDDDkeYAaBFErjSUl2uKOfm5v1GE9y1nOLe/4IO+b3YchfKw0wy3lZ6m2arxyr4KV4RURH54qtS/fGufEMZZ7Hja/Ko0ptsgYML0+kKGM+4wbTbmGQUtPfLMfBrWWc3gIZenX4aJmUp9OQdqunk4nv2QmzMus0rO730wtj0qu2DqnuQjCYbrOjYrINq5JuRe/CKQp3QtRMweivm0yur+FBQf9xk6WFQX99Tvw2GDO0390jssWXW1vKf6n4q7Dc1EOXledJwQxF7RV/EomQbptMXssJlNyT5YSe4dq1m/s907eik1WprNKjdur9sW/1AWt7535Ur6/zvN2/lpcds/37eM892mEgTXGHuHD1y4qLRYK0YvrJsMly5knKu0tg0csmObbvfC2/ZbETK9bOnW4TU7xtGEw0a2geZbKysz/Xu9txQvV6fX6VOrMTw/hVsdF8b/tbGgX1feqF1m7Bq5hda+/o+pVgXm9Ztmzk0ctTBlMyEi/fnaoZ9g3HH1xmv5GgwI/m3+oAZUOzkj4fx7rQBt7qdxnhJDiuj/YlBe9dG1pLNbF9D8c2dem2xVMA3NQhjBk6WMyVaelmZVaL0+vmcB/Tz/zVa+8lIPlWW2SLMQh559ZSNCE2sbCq/FBuLyrrbLJVHsYZMr/sdfpiKJOv1pOxtyISp0tQRtHXqhNWQZffSy5d/LBOwJ5H71mrcAnzSSA2Z84ObJPlCbiujSZubkRefZI5X61hL5pavbzMvY4kuTCuzm6nXE4+Ztwf/lBRmcW1zcSkwxsXF6bWmEnbQSPJsoqWMZumwUqYC7QCVi3Y6tMmnCZdYDItiJezj0v3MaLJmRmXX58w0zKJ3w3ww2IwE+fk7JSUll9b2Crl4NfPcJXOav1OH7fyfdSs6cS7zl18Y65GRd36Pmk/S+dwex0/tHTN54pxNJ0/I2tTsM5WccqDFQgn9rW4nyphg4J95ut9gZis7p6Ym3BI4L9eQ+sS/ntrbLXDIE8/fLKaHVP7goyN5whKyKKMHcsWboSasqsznORfSRYEaz3v29uZt4JiDxMC8QVJLjzntg+ow+dBe7BhRJ1MwQ/AVkRbwQbBj7OtTXgVu49qt79LDrW/OX4yrqjEJ/OIPVrwlfM2CB/rW6XQ3wd9SgjsM41SsC9pLt+H0AptK2fdRjFdYHHwdhY0QOsL1VZDimkIHfLLD8xThcmCF+p3SjOxc0WlV+Zervm2x68dN/QQ+MLC2DVSHqOOVw6ZFXDRgCXjUBQ1y7Py+3bO+HyQLO0bArGV2auRrkxRv1orPPgjXF6XVARxJz0vCPvz4vbkoT50899yTenvAD0ljLx0L8Gr2Et4C9XXnTkEiecNKv/xiU/q1nHNXlQmN2iYVlpWwL0qLmSR3ZNFgQCpCogXuLDMa45WrTH8AcCVpTL8Q7ChbVDhAgO6XmwwGj7AWoa9lZ+UcBt3ufZvn6Ar0bUSbP/+42cJQ7NhbNjj3ybpW2p0G3LtP966DUIYk0TbZDr4Kk9Ho7lXLw1+0g6qo6Wtz8+f9sfmARQzqPZNWiCCBJ/NLtrOz9SkoKPxDlmT1SiJIHiuH6oAeF5e1o9XRGjWqa6pXrxbcqlm3YY7Wtifu6WDeU1xHF59an1cDki9wm8nnU7h3AV0fergDNrsln0+BtKUoP0yizYJr/57DhuJ1wnY5/mziepTVr6e3R0hrsbPLyck7BrxIZO/eAi2uuwE4I3Aok5rIAtzPPbjtxQuXtgCOOtQTwkqrPvlqMmBd2vcfDGeSpfGCXrS7H96SujCnBy+oj6LComSoEoGvUA0A6EvZ8DLaO9nYsUOoSzNy57Oi4mJyBu2SpuRcj2rGvZievUsRgleBf5gk6cpabd62egFoaYtr6NFl8DaUoz96LzTAq0kDlNWppLhE2UTg9Tuf8MdG2sw4DRjQU9H7e3b/FE2vomLoU3nJjm92rYSEwoXZuX3EJvDZsWtdz/+sjGlqMJqCXx/90jzALlz4syQl5awi7aj/EwnxPfC1srJy7ti232Sb6jZHRT+VJvm909I3pjKWayxjYdODeLkO1hnC2OLC/mhQWsJO6UvInCtjHQWDB+XKK2tvF3Dq5JkvVR4t/tzwiHk6namuefunwruvEq9ft86RW4Ef9sqQcK2WXRkzYtKBgtsFGYCNHjHpt3enzd+cnpvwo8pHbKQd2Wg9M3qDhjz9tqd+O7tao2XZqP+TKf8Ga3vyzP630EdGRpY+OTnutuiv0iQDqDOxVgaaSDLpjqMuResukoXHpwTw7jT5XnQlfHBBOgPcgxIiEqu+jG4NuoYN63a4mHzio0vJvy7Blhcwa2srWW0NAFZVgh0uaTSKj0LQYFERZVmy+WP1Z2uno25vZyd/tX5FO5T79x72faoF+xm4J5m4geLOPl7PHPvl1CeyLF1T875nkpdckq7qdOwIqY4aEz35i+XEXCYJ30MXs7dnSghSzaSqMunN2n36dZsBfG7uzYt3r0vpaVm/AHbkxJ4xJYWpD80PbapK6bmnL8+dvURRJXsPbXu5W49OU6n/ItA/zEapKr4PA8fC7OVVS1EXgwe8sq9Nh4aJ6nYWdyrFmayLvQsrIwleF8n4Jk9ntlCvo00gZ6ujE6UHBujQAZw2ZY52Cv8fvj/wwahXJu6VGFdu2sh4rdTs+M6+fl7dSAI+kTS0yfkbCWEndbhJIzPdjRu3TgcGBijqbcHc6Km21iz+b7C22KTEaGxFi1slHDyLsrGgKHr5kvYCsW3btkpeynskGYSrmaQnvTufLubhyL6WDGwK0zH9ypvSKMHoQXmuoaztz0diJoHu9VfePp6el3BYeOGstVYJ0Ys/VSR81OjhPmQqKAvbg3hqZNOd9PTsZNAt/3Rhi+5dW/cmy6SzaGfv7HS817NDlUUWsFWfrU9LzkxMFfjHyadMe3MZ7HPzCwJjMnK/8JbNI6rib1GSQfxpoTT7TRs+mYzLSJJoWkTYsKqYWIIbTNzWuaZTA0iWOT4l+2zKxx99fpXCUKxXv+5hn6/akP7n5eRztbw9O5rToi7cnx5+0rWIvi/uSU4/M2BgZJ/ZAwb2KiO9HynaXLp0rIAkTZeff/tc7MFju2Qm0T7r8RPcnJa43MjL1+PtocUif8SrE2ZkpWWX0Tmbex4q5q/KNFLLO8mcHSTXRc7nRsmzSkILCOzWsJkAypLjBXE4U+mdtmSCGclC+AEbC8US0Wh+u5Jz7jraIWREYfRGuJG064n7AAvxCHHIMxorpLcac4q9lHesYjLRb06qrgtZMoVpuecqzCi0tZRg2wq4pXEiKCDwlnIRMMD9WFvrjGqrwhK9RRj5kp+bwLgS37NI8C/wgTOgSPLyV7ibxoa9Rp7kV8nrVo1E3qSjJSr/CuNlBUxHTswSZmLFkhWTtLSGUqSEjO7yXEN1DZW1FBuQrQllxzK5FVuTc5HtnnOIwlRf1X6Waa1GM24KoNGQT69SkpiGFtIyYwwrMK1jb1+9/U9bApV6/7fyxGYAwewzZ1IdiosNBvF2PzHmD8FIWfcoKPIV7ZZ7Q8rImmJGPWPpR0jqdMxEAs5IgEkWCUm6mf6YRITIOXIFUC6heCvIyguhPIR5s1PE9TYrMixlWkM9ZqRwC2jLkywKSm4tPc005KKeOxe+qb+oKhE9fAUOvLLi0ubYH6AVNpoaLU++lnWezs8/OLbw8D09GUp8HkB7wHCEEwVHjBkOxqvX7x906kgOzMvn89qZWLm7SbSXmXwnqLHLMdVmWKAq5eolSY2wtDyp8aIcFNSqekl+Uftjhy5IbduGV0tKulrCdMEGrcRupeYm/iLoLOXkMpJqe4fUN+hZHRM3keQ9Wip3IGiSEIupmLjooXwByeoUA2daCrSw4nx2Kucye86qhJUq7MUKSznt+SqSHcq0KAqY1okZxqySrlcQUIEvJ7e+RDocW2JdmR3T8K0UT2lOwk1viKQnh2oUuaIqrFt120ct4ySGwaALHDPuVb8ZM9+OxjlFOh95oGXzrsvpxk2e/jb7ERB6VL6PQw9hS79427lUqzOOGBGZj5i64IcPYUp1paHDXxzs+UH07NUCvnrVumlzZ334h0ajuZqWc+68gKtz+Bq//CSmq4kbrRL/PDbPyalGKPDJySm7n27V+wtJywozshMPqduYl4Ugw/oHDm455A8ryDjEhp3CkV+/HxEYGKC0/XDRyreXLVmVbKeyE8HTPOE0DNmONhS3Gu0f4NPTHP+gOj7JGRwx4icYzRU7kUlfSzMW9+PJJMTLS03MztqahXs1YuuK8tmAqFgp70FM74eXxpeHTvhkR3eKY2wic6K5YmRoWBE51UdI825tuV/7h8Uh1qQzFAf26vusy8zZE1eKdt6+Xl1ooovbt+795fVUXRuC03rzzyecisZBYwoCsvETRgbcupFfunrl1mwSHtIW7EpqduKF5My4VBIG9w3rt7L+g3qtggsRI3t91IvzNq7d/sKVK1drk8bOtaSZ16zc3pw0sdV332/sLYSYzofd7tdj+H/Aw1O2/S0DhX8wlWvFv7eI0jpJqs1gs33brv09ej6TT7wqFKulIbt7utalw5RKxJwO4+yCEGMDFdjILbFCkNFw6k7py0XP8qu0Fm8nl4UTcW1nY81ORHXjPaL2SZcFcxq2xNbUXsSstB0oiCbA5TkWCCMvYQbda9KotCuVkCbTQGYyNCFb3ESh72wmayOlRbePV6L5m5UAOh+sK8wNh4tzxaeLF99lY6KjunGuri7h0BZf/GfZBfhQfDyaNEnPSUgw70o5bm8yuZrDUcdSTXftYL4EaiT5tobZJqXknsq+p52e+wB28vT+cfQyPYtyxOA+nw/oPXwPyiKl5ibE+Xs06UJb9x/OJB4OdXd3aUMmkPX2XWsnNAvu8EGZJDWhZfi62izyouPDRh2v9cabr/iGt2o6UvCa9c7CqfQFo0Gy0ZyJyyg/uiZw/0SuNocelX9qbvwv8F5+suxzv6VLPo211J6EvRZWnCXL5jUb+sKAoaDBh5SYKzyT1JxzRzAvlQQZRNN+kn6Oepq3JXn8gar+JKZBRPQbffnSJ+qEpAgdCTjnt/UbGCt7jkq+lbZwVmQqGPlcaVJWhRBHPcXd6ciG29xDbOecNtIGCm3VkKJLnqiy0JfcbIvxxx7fOc7Gxkpx6G3ZEDNn1rsLEy5cOb6GIkIuPXt3eef5FwaO3LxpByNteTM9Pb7yGO7az7+fPTBR+Km2bIyZPWPa/Pi1m1b0b0FONnt7Oz/0g0Su6oLLSVd+GP/G9G9154uLtZL2lsnGPo6XFjyDB0wx33JCC/8NBoavKQKBogB8noskH89jxs5dOw78MC7h5/VkUjiSQD+1fvPKDi8+/+ZhX0/lawzl5bv70jZ1dHTQTJ0xfr5gv+/HQ4vXr/smC/GC9Ixz6QL+T+aPo5ExrvT0E/BwX7I0RoR9TSajFebgmWc7TgINjk6OG/POKVnLctKzE06SECtNK2+67nKLOipdIEEOp7jI73QKg+lKWE3aDB56N5wPuUvCpInpCazEEM7yS86wQloh7tBVXFLEbpa8REL8fjkdl2Y158NItDOp/XnZimXM/ZW3lJY+WSH2dwttRt5o+6+3r+6C4A/6Tkq6EjNp4uz44pIS05wZi94V4164ZNYSN1cXKyz54hyowFnK+0X0GJGccXpneKuwQRcvJB3YvXPfAgSX6CPVeBK2avUb1huy79COLecuHp1Dx5fgU+wCId70zapnhNdZaGPwb9mq2SgBRx45uK87p1Xgjh3NjrV0FmHm92YtnirGggfYp09XV5PRFIBNIeDGohstke/9edtrCNmifC0l/YdXXxz3Cxy76dfPVz4DC4L/sYQvkhFh+HT1h62EEP+45+dFEGJ8xp6enXhSfUsWBRkEM45KubIDe5qE+DsE9XSlNM2lbMv0YP4OxaJIzsm+ePd6DivMb8vu6GKYviyJFRq7Se/d+hq4KMa104PZLBLgDXRiRkPhbU5h7s03PNgx4J9UCvBsGqDnBh/YoO07PDUefEtLyzK7tI9Yh80dQtTr1m7JPHL4+HLg6GxB9f2Hy0M1CNtg5wx4VUnWaO1bNn12YJBfizf69hr+5Zujpqx5PnLUp43rtZvVtFHHCBFAdHFxDlu28v1w8JEljf6FIaN/FseJ8DGe4I9wvYAj37Z113XZVnsaZxUyM8+nkYJJw5Gjn386/JFos3Tl+3NQ1nMpDB/aGbmpxkfL329Wu46fcqiD7je7U9u+n0M72jr5nhDt/ldzH7fgIJOJ+0+aNjaw34AeihI6ezph7YiX3zpGk3sjI/fsWfN7q1KQQUibvNIF51kECfMysmuNlFPUjy2sHchWvhzAyXNM9aWshDTsQOmD0vrShwWKkI704vZFddkXRDuXhJgsELKYS9n7CxKkF1b8KNFr8WQS3Gw6g74JztRNeefNDwXXyeNnzSIBI88gl40GpkRyhg4aeeD69RvKQ8aSHbNrfS+Exvy8yn9OQ7Q1z2kCd+D8BDZnGdcTTqTmJCTjRKgky3nQntezc0+JNl7etRT7WqM1XcOuX9ZoKnlvBB1yrdb6CmhwqU2cjNzEs/A2vPj82Nj0tMz9oLWzt/Pfd3DbYNjntJmr06x5Ywf6ZEIRbuBHvz5lWplOp7jrnvRxZPD/byZ8IE0u3IZ16wbaTpw8Zgn6pjBiQq9uQ2Po6/SyjJwEiy/qfQW5/AYkvviyNIEEcgIFqstweou07GgXA4sZ6cxrlNP89X9MDe7sILM9JK4v60CrYyUlejZy0Z/SrL+oHr8EB7w4q7hr78ZZcLMJritXL16jXr5FGZsoQdOqTfNRM2ZNrGvU81pVfXUGWnoZlN2seqOl8PgH/dFWtm4noF07te33KX0GmIv+GjdpOIzs4SCUN2xZ9Q5lyrPbuuW7uT/tPXjLykq6bMmzAfr/pVQs3WmG8W785rMRlCkr//w50eWrKWPx9zyHuzenvZs/MItOl1a85cGvajjbpJNYdYpd97C3YkfH2fGeK0qkdDCg3x4JoI3fXknH6hMNRnFLx9igZTnSwQd28IgExw9fpO9PTVbQVOR6CkFzslvP0pI/+36scLwRp+9A88a4Vxbt2bV3WHz8hUb0uzm3yn9i4H6tVbgHmCQqykcuptBX2/6uYXFk37d4+413pn62Jvo/YPLm+Nfmt+/QZouzs5PiL066dHnrhHEz4xB8QLDnkTv6hxuQtyWAPESKXV9VV5JReyM193QWBNTXlT4Y4boaeGF9fL26og3cbF9vjsmRtdqcq9nxVX6R9NCCDKYf50jfv+3EO5gYHYbjzItATZg1OzVG5t3IFrWmjeGPpL9cCQ8HXYpGw3rQB38XUX2SCd8ilOmMrouXzAmBpgJvsnUNg/u/shBlnMC2dD7Wzy24HTaAzVuFxtSrFxhBk6fd+u1X8+rXaT2Jlcmt6ZzVHQMYPKEk0SecYEVnd/WCpZNzjZoKjII28FrgvK9tDftjly//dkfQIL+WF5dF9nDyrl37WLeYZ+b3j+g5kzaX9s2aN3kV+OLC4iud2vXfiMMqdYJdfk2NBfT/jfTc0P49unXrVKXQiVEWFhUXvT12xgHaK+jpxf3doNH7IUjWf0DPZwXNvh8OHkFZMsiKshRw8/yRBBmNl+VLZ0fb8ZayzH4krdyEnpQnudbiKRxMAbry9Y5gJwnfOzpfUpZF804fp46dOwlxvY5dnnZ64aVIRbOC39ovN8/GAW9ZsrpoSYhBU82dnczPkbpiI5iUcrK1ra2Nl2M1x7oHf/lueOd2/TeYmEnxAID2iSSDdQbZVp6ff7J214IPZ3YnnnLdunUiyNSJuMvfSC/fi8eOnepAp6EOnss5Rydc/kp0EDORfuXOZeyoqSeDmzSIQVtg8Q3K4IGvzkSZW9vd87sdgP+3Ejw05n3hFxroMgffU6f7KBs4uM8fy5euTjFKRkf6ks4FRJ61PJojL7hTePH99z5Kwsuael3R2gBbTPcMwiKVBeBkxh0KtGw7mQ/dhbeUynihvrU2sKEr2JPb1Km7h238a+ylp4zc6IRNXsdObV3JTswqKCw0kUeCNmLxiWp68zLOBpTeLm5LGydt377dXJycnazhewUd/K/YLZPmk8aOf80/LSW96Ntvf8jFRGodXA5iyRf88Es5xQZda0GbkZZVtGP77ntocaKXlRW3wQOv5ugot+vUyqluUGB18CGT5hZ+jwuOfRx0FbzVOcLQaz7Z0Q6eCsDRHzayiodCI58URwXVbR6l/Lghavw6hYGZsDr/rYSNLSKQcfS7AwiOSGWF4eJewRAmRVAD59MPOjPytwUZncAN5yyzhVacDSFlbDJIbO1qkzQXuP9Gql+/bTXj7WLbUq1t4V3H+kN3q5zWOnq5Jn05Jdm6GvMTExPJnC9PCDgYC2/X1Mp6o38j1xv3m0Q1LT5wu985DghlzGcxdqUaKzvSRpLJXtaFhdUpND8mLsZhKQcPuhSTxRL+UWFCkM3bPexZC/N2/9b/nYF/Z+AxZuD/AA8zEhkTLyOGAAAAAElFTkSuQmCC');
}


	/* layers control */

.l7-control-layers {
	-webkit-box-shadow: 0 1px 8px rgba(0,0,0,0.4);
	        box-shadow: 0 1px 8px rgba(0,0,0,0.4);
	background: #fff;
	border-radius: 2px;
	}
.l7-control-layers-toggle {
	background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAkCAYAAAGf7Ah0AAAABGdBTUEAALGPC/xhBQAABzdJREFUWAnVV3lslEUUn/l2F0tpwdAih1HEqCReDcphNCo1EkgFkXa5PNpuC0Fo2e7Wgko8KiaKWrvbK5672xYFpNtiRRuNiY0aURA14BGviBcVlaKltVa6+42/N9v5Mrtt05rwj/PHzjt+8743b+a9N8vYwKgMNlUQyemnMtAkaJajvb3dToQSGp8e6boopkr4VYgEMYwO0vhCTfMVzBcMf8bx086YyODcuM80zTqp9IWat+7evW8sMdIxIqqCLa6oiAaJpuEtcBqcc2HEWMZ0JclgZR/Nchf++ubrzKjJSguXS4tVjXvPjfb3/UAAacGTn/MOMb7QnjNpNqP/bKZ50Ai0tqYmCi0n4zbM+W+lBc7JBOa+QPhDwcTsxJXE2+32edKCL9h8hRDmRzpIOWydAylhrcMfDN+ugBRKSdP3KwPhsFJIPth02FISIYQwYsDYcVfWhy/Bon4JgumffMGmiGTwQ0B/sHml4q2ZFAD3WQIQVhx0IdFw8B189lolN+w8w5PnjPmlhJgtA8/vfn3iye7u3yGzDljDxZEG4097Cp3rSSjBtMHunp6vFR+HHoIxmbgTe1xHKssDHecLNFUjMzbqMs5ZlHF7ute17M84+TMHDzr+OvR9JwKdCms9yRkzJq6bPTsWXh05QOPUN+PUHyPWMPhm6UHd7vaUohWZPSRE8OqxpTyibQa/qcTlbEP0vwF7AWUAT3JM9dy69FfSNza+MU4awNE8iQtXSkJuGLleV852ov2h5jkwVof0mUs8aO4LhTuYYFOAjExId0wcFIPahpaLTkWiX9ECfHG/sLNi1i8+HODfgLFFRI96+INNi0cNTgTS1obKQh03aAuk9DeELzcj4pACYivvwvXrFK/PcQZiQWo+hmidpYMUjQC7EOB6xdNsGfAHwk/RDdOVw9Dm+NTUSWtWLDohDVQ37JkbiUT2DwMeVswZP+gtdM4x3HnLDhjcGM2XLWOISaenIGee9MCSgqgMht/H/q/SZYk0qviV3oKcj5XcioESyOoqIseFYDYloxnAGm/hcrcuk3JV2XBMl+pKqn6mENux11+w12m6jpqMMFn7rPPTHdwfCm8yTfG4tMaNu+GepPUFiqbM7T105ARSPQU+dY/LOC/N2gI65WEkyWUEtjmSppfkLvlRLaQ5VnZFDtGGzbheNRROKZmbu/AvUvh3tE4Wff2/0IUC+y2q+4VVoXBW1BSvkR7Rb8BW84lWJQBdlGozcs7GLy3Nd35OSqTxBqtfgkc1+sPjcqbDgEl6xK0dH5lv545LOCVL1/F+3CoY4eyY1+WcBiC2KYEHQBd5XDkyndE17xCm2Ug6BLcSwb3LigE1AlOYu6TS4HUwVEw0Df1osfBnLDwnpiFDCQPuvQ73Fkqxg8/hEVYLXt66MXbbzOK8bKre1hhkgDT0RDja3fEHytwZxCMLH0YWPkD0fxqjqUZDejDSV3z1LbexqPkEPJxKWLqtKOGbvPnZL460NlE/KgfkIZiRrfjShsQcG2QQDUwwXjcuZcID61Ys6ErUJ/LDOiCfLUzUjVQdEg0O4jn/ABEq0iuIjrEcwE0x/KGWNbjPj4BO00Gni0ZOoIPzLR5X9vMqqaQDqDzzENra4V5zp8sBZQcROYjsLvYUOPdbEVBKeiZ193QjCmwtZCM+ldS6EWYTH3wuNSV1i+pFCj/IAaWgGUfBq0N78qPM3DZcp9TxcTQeyzZm3ON2LatXpSlOP8BIB6qDLddHmHnFrBlpNZmZmdZbNXEB9XsRlZXFennqGHzoXW5DaId4iSoc/Q365EjnRjszPnYXZL9NDWUtGsqzCjAw7xprTypbn7fkaILcYqkInzzeX06C8emO8sKlS7stZQLxVMPes/+O9FVAvEpXob+utY6gZmfrtMjf/RUI+2odhF7wJbq+Gzf3zTj5CAwyaoEwozVoCzN1KKK00z7WUbZx9dIOklsO6CAZpu87i5gpHoJ8gtLh9vZixSO2KckV7qysf5Sc5uq2tjOix3rL0FW3IJuSNV0XM/iDs85LqxvqeKUD8n3LxUobt5WVuLJlS9IM4O9i09VRwWtxLWfpcix+hXjs8mZdjn19YuOiuKRgufzXqOuqQi2r8O+yAk/tl2Q/RMW7ETe8UdX1GJhHDM5qjDHJ5e7bs07qBp7ZsTe9t6/vUXykkLKEdLFbLgLJSUn3rrt1yXEdX/1C23jzVG+5Keg/B5r2wJD9g/NcaUAJq4MvXxxl/TWoATcoGc0Av4eUKnIXZlsvXpLHO0CS2KgOtGQgdeuwqWuUjGbUgrdszLHRXXDLF0oe54AS0kyPnc5Iz/2CmV7EeIzSwcjvsHQPXkUhld/kCP6Xu+DRNjg/SWHh+SnODF+aPeVh9XCydAPEsA4kAqsCzcuiTPiw7+maTj6SwGsVk/9gY9xbUpizR8MNS47aAd0C7s35CG8VdrxYyjl/FcdUgo73nY77X9D/Au9RDMh+aBoVAAAAAElFTkSuQmCC');
	width: 30px;
  height: 30px;
  background-size: 20px 20px;
	}

.l7-touch .l7-control-layers-toggle {
	width: 44px;
	height: 44px;
	}
.l7-control-layers .l7-control-layers-list,
.l7-control-layers-expanded .l7-control-layers-toggle {
	display: none;
	}
.l7-control-layers-expanded .l7-control-layers-list {
	display: block;
	position: relative;
	}
.l7-control-layers-expanded {
	padding: 6px 10px 6px 6px;
	color: #59626B;
	background: #fff;
	}
.l7-control-layers-scrollbar {
	overflow-y: scroll;
	overflow-x: hidden;
	padding-right: 5px;
	}
.l7-control-layers-selector {
	margin-top: 2px;
	position: relative;
	top: 1px;
	}
.l7-control-layers label {
  display: block;
  padding: 8px;
  }
  .l7-control-layers label input[type="radio"],
  .l7-control-layers label input[type="checkbox"] {
  width: 14px;
  height: 14px;
  margin: 0;
}
.l7-control-layers-separator {
	height: 0;
	border-top: 1px solid #D8D8D8;
	margin: 5px -10px 5px -6px;
}
.mapboxgl-ctrl-logo {
  display: none !important;
 }
 .amap-logo{
  display: none !important;
 }


`)},kPKH:function(Re,E,i){"use strict";var T=i("/kpp");E.a=T.a},"kQ+U":function(Re,E,i){"use strict";i.d(E,"a",function(){return mt});var T=i("lSNA"),m=i.n(T),X=i("lwsE"),z=i.n(X),o=i("W8MJ"),Z=i.n(o),D=i("k5/I"),K=i("h1nZ"),re=i("o0o1"),de=i.n(re),Y=i("yXPU"),Fe=i.n(Y),Ze=i("4cb6"),ye=i("fbvF"),we=i.n(ye),pt=function(){function Ct(vt,Oe){z()(this,Ct),this.attribute=void 0,this.buffer=void 0;var ct=Oe.buffer,Qe=Oe.offset,Ft=Oe.stride,vr=Oe.normalized,Vr=Oe.size,lr=Oe.divisor;this.buffer=ct,this.attribute={buffer:ct.get(),offset:Qe||0,stride:Ft||0,normalized:vr||!1,divisor:lr||0},Vr&&(this.attribute.size=Vr)}return Z()(Ct,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(Oe){this.buffer.subData(Oe)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),Ct}(),je,Tt,Xe,gt,Je,Et,_t,Ne,ke,Ue,st,Le,ut,Vt,Zt=(je={},m()(je,K.gl.POINTS,"points"),m()(je,K.gl.LINES,"lines"),m()(je,K.gl.LINE_LOOP,"line loop"),m()(je,K.gl.LINE_STRIP,"line strip"),m()(je,K.gl.TRIANGLES,"triangles"),m()(je,K.gl.TRIANGLE_FAN,"triangle fan"),m()(je,K.gl.TRIANGLE_STRIP,"triangle strip"),je),ir=(Tt={},m()(Tt,K.gl.STATIC_DRAW,"static"),m()(Tt,K.gl.DYNAMIC_DRAW,"dynamic"),m()(Tt,K.gl.STREAM_DRAW,"stream"),Tt),oe=(Xe={},m()(Xe,K.gl.BYTE,"int8"),m()(Xe,K.gl.UNSIGNED_INT,"int16"),m()(Xe,K.gl.INT,"int32"),m()(Xe,K.gl.UNSIGNED_BYTE,"uint8"),m()(Xe,K.gl.UNSIGNED_SHORT,"uint16"),m()(Xe,K.gl.UNSIGNED_INT,"uint32"),m()(Xe,K.gl.FLOAT,"float"),Xe),Q=(gt={},m()(gt,K.gl.ALPHA,"alpha"),m()(gt,K.gl.LUMINANCE,"luminance"),m()(gt,K.gl.LUMINANCE_ALPHA,"luminance alpha"),m()(gt,K.gl.RGB,"rgb"),m()(gt,K.gl.RGBA,"rgba"),m()(gt,K.gl.RGBA4,"rgba4"),m()(gt,K.gl.RGB5_A1,"rgb5 a1"),m()(gt,K.gl.RGB565,"rgb565"),m()(gt,K.gl.DEPTH_COMPONENT,"depth"),m()(gt,K.gl.DEPTH_STENCIL,"depth stencil"),gt),H=(Je={},m()(Je,K.gl.DONT_CARE,"dont care"),m()(Je,K.gl.NICEST,"nice"),m()(Je,K.gl.FASTEST,"fast"),Je),Ce=(Et={},m()(Et,K.gl.NEAREST,"nearest"),m()(Et,K.gl.LINEAR,"linear"),m()(Et,K.gl.LINEAR_MIPMAP_LINEAR,"mipmap"),m()(Et,K.gl.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),m()(Et,K.gl.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),m()(Et,K.gl.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),Et),Ee=(_t={},m()(_t,K.gl.REPEAT,"repeat"),m()(_t,K.gl.CLAMP_TO_EDGE,"clamp"),m()(_t,K.gl.MIRRORED_REPEAT,"mirror"),_t),Ae=(Ne={},m()(Ne,K.gl.NONE,"none"),m()(Ne,K.gl.BROWSER_DEFAULT_WEBGL,"browser"),Ne),ge=(ke={},m()(ke,K.gl.NEVER,"never"),m()(ke,K.gl.ALWAYS,"always"),m()(ke,K.gl.LESS,"less"),m()(ke,K.gl.LEQUAL,"lequal"),m()(ke,K.gl.GREATER,"greater"),m()(ke,K.gl.GEQUAL,"gequal"),m()(ke,K.gl.EQUAL,"equal"),m()(ke,K.gl.NOTEQUAL,"notequal"),ke),rt=(Ue={},m()(Ue,K.gl.FUNC_ADD,"add"),m()(Ue,K.gl.MIN_EXT,"min"),m()(Ue,K.gl.MAX_EXT,"max"),m()(Ue,K.gl.FUNC_SUBTRACT,"subtract"),m()(Ue,K.gl.FUNC_REVERSE_SUBTRACT,"reverse subtract"),Ue),Yt=(st={},m()(st,K.gl.ZERO,"zero"),m()(st,K.gl.ONE,"one"),m()(st,K.gl.SRC_COLOR,"src color"),m()(st,K.gl.ONE_MINUS_SRC_COLOR,"one minus src color"),m()(st,K.gl.SRC_ALPHA,"src alpha"),m()(st,K.gl.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),m()(st,K.gl.DST_COLOR,"dst color"),m()(st,K.gl.ONE_MINUS_DST_COLOR,"one minus dst color"),m()(st,K.gl.DST_ALPHA,"dst alpha"),m()(st,K.gl.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),m()(st,K.gl.CONSTANT_COLOR,"constant color"),m()(st,K.gl.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),m()(st,K.gl.CONSTANT_ALPHA,"constant alpha"),m()(st,K.gl.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),m()(st,K.gl.SRC_ALPHA_SATURATE,"src alpha saturate"),st),At=(Le={},m()(Le,K.gl.NEVER,"never"),m()(Le,K.gl.ALWAYS,"always"),m()(Le,K.gl.LESS,"less"),m()(Le,K.gl.LEQUAL,"lequal"),m()(Le,K.gl.GREATER,"greater"),m()(Le,K.gl.GEQUAL,"gequal"),m()(Le,K.gl.EQUAL,"equal"),m()(Le,K.gl.NOTEQUAL,"notequal"),Le),be=(ut={},m()(ut,K.gl.ZERO,"zero"),m()(ut,K.gl.KEEP,"keep"),m()(ut,K.gl.REPLACE,"replace"),m()(ut,K.gl.INVERT,"invert"),m()(ut,K.gl.INCR,"increment"),m()(ut,K.gl.DECR,"decrement"),m()(ut,K.gl.INCR_WRAP,"increment wrap"),m()(ut,K.gl.DECR_WRAP,"decrement wrap"),ut),xe=(Vt={},m()(Vt,K.gl.FRONT,"front"),m()(Vt,K.gl.BACK,"back"),Vt),Ve=function(){function Ct(vt,Oe){z()(this,Ct),this.buffer=void 0;var ct=Oe.data,Qe=Oe.usage,Ft=Oe.type;this.buffer=vt.buffer({data:ct,usage:ir[Qe||K.gl.STATIC_DRAW],type:oe[Ft||K.gl.UNSIGNED_BYTE]})}return Z()(Ct,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(Oe){var ct=Oe.data,Qe=Oe.offset;this.buffer.subdata(ct,Qe)}}]),Ct}(),lt=function(){function Ct(vt,Oe){z()(this,Ct),this.elements=void 0;var ct=Oe.data,Qe=Oe.usage,Ft=Oe.type,vr=Oe.count;this.elements=vt.elements({data:ct,usage:ir[Qe||K.gl.STATIC_DRAW],type:oe[Ft||K.gl.UNSIGNED_BYTE],count:vr})}return Z()(Ct,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(Oe){var ct=Oe.data;this.elements.subdata(ct)}},{key:"destroy",value:function(){}}]),Ct}(),Pe=function(){function Ct(vt,Oe){z()(this,Ct),this.framebuffer=void 0;var ct=Oe.width,Qe=Oe.height,Ft=Oe.color,vr=Oe.colors,Vr=Oe.depth,lr=Oe.stencil,Nn={width:ct,height:Qe};Array.isArray(vr)&&(Nn.colors=vr.map(function(vn){return vn.get()})),Ft&&typeof Ft!="boolean"&&(Nn.color=Ft.get()),this.framebuffer=vt.framebuffer(Nn)}return Z()(Ct,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(Oe){var ct=Oe.width,Qe=Oe.height;this.framebuffer.resize(ct,Qe)}}]),Ct}(),dt=i("cDf5"),w=i.n(dt),I=i("c6wG"),q=i.n(I),ce=i("YO3V"),Ge=i.n(ce);function $e(Ct,vt){var Oe=Object.keys(Ct);if(Object.getOwnPropertySymbols){var ct=Object.getOwnPropertySymbols(Ct);vt&&(ct=ct.filter(function(Qe){return Object.getOwnPropertyDescriptor(Ct,Qe).enumerable})),Oe.push.apply(Oe,ct)}return Oe}function yt(Ct){for(var vt=1;vt<arguments.length;vt++){var Oe=arguments[vt]!=null?arguments[vt]:{};vt%2?$e(Object(Oe),!0).forEach(function(ct){m()(Ct,ct,Oe[ct])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ct,Object.getOwnPropertyDescriptors(Oe)):$e(Object(Oe)).forEach(function(ct){Object.defineProperty(Ct,ct,Object.getOwnPropertyDescriptor(Oe,ct))})}return Ct}var nt=function(){function Ct(vt,Oe){z()(this,Ct),this.reGl=void 0,this.destroyed=!1,this.drawCommand=void 0,this.drawParams=void 0,this.options=void 0,this.uniforms={},this.reGl=vt;var ct=Oe.vs,Qe=Oe.fs,Ft=Oe.attributes,vr=Oe.uniforms,Vr=Oe.primitive,lr=Oe.count,Nn=Oe.elements,vn=Oe.depth,na=Oe.blend,ha=Oe.stencil,Zn=Oe.cull,Hn=Oe.instances,F={};this.options=Oe,vr&&(this.uniforms=this.extractUniforms(vr),Object.keys(vr).forEach(function(me){F[me]=vt.prop(me)}));var W={};Object.keys(Ft).forEach(function(me){W[me]=Ft[me].get()});var le={attributes:W,frag:Qe,uniforms:F,vert:ct,primitive:Zt[Vr===void 0?K.gl.TRIANGLES:Vr]};Hn&&(le.instances=Hn),lr&&(le.count=lr),Nn&&(le.elements=Nn.get()),this.initDepthDrawParams({depth:vn},le),this.initBlendDrawParams({blend:na},le),this.initStencilDrawParams({stencil:ha},le),this.initCullDrawParams({cull:Zn},le),this.drawCommand=vt(le),this.drawParams=le}return Z()(Ct,[{key:"addUniforms",value:function(Oe){this.uniforms=yt(yt({},this.uniforms),this.extractUniforms(Oe))}},{key:"draw",value:function(Oe){if(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)return;var ct=yt(yt({},this.uniforms),this.extractUniforms(Oe.uniforms||{})),Qe={};Object.keys(ct).forEach(function(Ft){var vr=w()(ct[Ft]);vr==="boolean"||vr==="number"||Array.isArray(ct[Ft])||ct[Ft].BYTES_PER_ELEMENT?Qe[Ft]=ct[Ft]:Qe[Ft]=ct[Ft].get()}),this.drawCommand(Qe)}},{key:"destroy",value:function(){this.drawParams.elements.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(function(Oe){Oe.destroy()}),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(Oe,ct){var Qe=Oe.depth;Qe&&(ct.depth={enable:Qe.enable===void 0?!0:!!Qe.enable,mask:Qe.mask===void 0?!0:!!Qe.mask,func:ge[Qe.func||K.gl.LESS],range:Qe.range||[0,1]})}},{key:"initBlendDrawParams",value:function(Oe,ct){var Qe=Oe.blend;if(Qe){var Ft=Qe.enable,vr=Qe.func,Vr=Qe.equation,lr=Qe.color,Nn=lr===void 0?[0,0,0,0]:lr;ct.blend={enable:!!Ft,func:{srcRGB:Yt[vr&&vr.srcRGB||K.gl.SRC_ALPHA],srcAlpha:Yt[vr&&vr.srcAlpha||K.gl.SRC_ALPHA],dstRGB:Yt[vr&&vr.dstRGB||K.gl.ONE_MINUS_SRC_ALPHA],dstAlpha:Yt[vr&&vr.dstAlpha||K.gl.ONE_MINUS_SRC_ALPHA]},equation:{rgb:rt[Vr&&Vr.rgb||K.gl.FUNC_ADD],alpha:rt[Vr&&Vr.alpha||K.gl.FUNC_ADD]},color:Nn}}}},{key:"initStencilDrawParams",value:function(Oe,ct){var Qe=Oe.stencil;if(Qe){var Ft=Qe.enable,vr=Qe.mask,Vr=vr===void 0?-1:vr,lr=Qe.func,Nn=lr===void 0?{cmp:K.gl.ALWAYS,ref:0,mask:-1}:lr,vn=Qe.opFront,na=vn===void 0?{fail:K.gl.KEEP,zfail:K.gl.KEEP,zpass:K.gl.KEEP}:vn,ha=Qe.opBack,Zn=ha===void 0?{fail:K.gl.KEEP,zfail:K.gl.KEEP,zpass:K.gl.KEEP}:ha;ct.stencil={enable:!!Ft,mask:Vr,func:yt(yt({},Nn),{},{cmp:At[Nn.cmp]}),opFront:{fail:be[na.fail],zfail:be[na.zfail],zpass:be[na.zpass]},opBack:{fail:be[Zn.fail],zfail:be[Zn.zfail],zpass:be[Zn.zpass]}}}}},{key:"initCullDrawParams",value:function(Oe,ct){var Qe=Oe.cull;if(Qe){var Ft=Qe.enable,vr=Qe.face,Vr=vr===void 0?K.gl.BACK:vr;ct.cull={enable:!!Ft,face:xe[Vr]}}}},{key:"extractUniforms",value:function(Oe){var ct=this,Qe={};return Object.keys(Oe).forEach(function(Ft){ct.extractUniformsRecursively(Ft,Oe[Ft],Qe,"")}),Qe}},{key:"extractUniformsRecursively",value:function(Oe,ct,Qe,Ft){var vr=this;if(ct===null||typeof ct=="number"||typeof ct=="boolean"||Array.isArray(ct)&&typeof ct[0]=="number"||q()(ct)||ct===""||"resize"in ct){Qe["".concat(Ft&&Ft+".").concat(Oe)]=ct;return}Ge()(ct)&&Object.keys(ct).forEach(function(Vr){vr.extractUniformsRecursively(Vr,ct[Vr],Qe,"".concat(Ft&&Ft+".").concat(Oe))}),Array.isArray(ct)&&ct.forEach(function(Vr,lr){Object.keys(Vr).forEach(function(Nn){vr.extractUniformsRecursively(Nn,Vr[Nn],Qe,"".concat(Ft&&Ft+".").concat(Oe,"[").concat(lr,"]"))})})}}]),Ct}(),Nt=function(){function Ct(vt,Oe){z()(this,Ct),this.texture=void 0,this.width=void 0,this.height=void 0;var ct=Oe.data,Qe=Oe.type,Ft=Qe===void 0?K.gl.UNSIGNED_BYTE:Qe,vr=Oe.width,Vr=Oe.height,lr=Oe.flipY,Nn=lr===void 0?!1:lr,vn=Oe.format,na=vn===void 0?K.gl.RGBA:vn,ha=Oe.mipmap,Zn=ha===void 0?!1:ha,Hn=Oe.wrapS,F=Hn===void 0?K.gl.CLAMP_TO_EDGE:Hn,W=Oe.wrapT,le=W===void 0?K.gl.CLAMP_TO_EDGE:W,me=Oe.aniso,at=me===void 0?0:me,bt=Oe.alignment,He=bt===void 0?1:bt,ht=Oe.premultiplyAlpha,Qt=ht===void 0?!1:ht,qt=Oe.mag,Nr=qt===void 0?K.gl.NEAREST:qt,qr=Oe.min,or=qr===void 0?K.gl.NEAREST:qr,Br=Oe.colorSpace,Tn=Br===void 0?K.gl.BROWSER_DEFAULT_WEBGL:Br;this.width=vr,this.height=Vr;var dr={width:vr,height:Vr,type:oe[Ft],format:Q[na],wrapS:Ee[F],wrapT:Ee[le],mag:Ce[Nr],min:Ce[or],alignment:He,flipY:Nn,colorSpace:Ae[Tn],premultiplyAlpha:Qt,aniso:at};ct&&(dr.data=ct),typeof Zn=="number"?dr.mipmap=H[Zn]:typeof Zn=="boolean"&&(dr.mipmap=Zn),this.texture=vt.texture(dr)}return Z()(Ct,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var Oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.texture(Oe)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(Oe){var ct=Oe.width,Qe=Oe.height;this.texture.resize(ct,Qe),this.width=ct,this.height=Qe}},{key:"destroy",value:function(){this.texture.destroy()}}]),Ct}(),$,Ke,ae,et=($=Object(Ze.injectable)(),$(Ke=(ae=function(){function Ct(){var vt=this;z()(this,Ct),this.gl=void 0,this.$container=void 0,this.canvas=void 0,this.width=void 0,this.height=void 0,this.isDirty=void 0,this.createModel=function(Oe){return new nt(vt.gl,Oe)},this.createAttribute=function(Oe){return new pt(vt.gl,Oe)},this.createBuffer=function(Oe){return new Ve(vt.gl,Oe)},this.createElements=function(Oe){return new lt(vt.gl,Oe)},this.createTexture2D=function(Oe){return new Nt(vt.gl,Oe)},this.createFramebuffer=function(Oe){return new Pe(vt.gl,Oe)},this.useFramebuffer=function(Oe,ct){vt.gl({framebuffer:Oe?Oe.get():null})(ct)},this.clear=function(Oe){var ct=Oe.color,Qe=Oe.depth,Ft=Oe.stencil,vr=Oe.framebuffer,Vr=vr===void 0?null:vr,lr={color:ct,depth:Qe,stencil:Ft};lr.framebuffer=Vr===null?Vr:Vr.get(),vt.gl.clear(lr)},this.viewport=function(Oe){var ct=Oe.x,Qe=Oe.y,Ft=Oe.width,vr=Oe.height;vt.gl._gl.viewport(ct,Qe,Ft,vr),vt.width=Ft,vt.height=vr,vt.gl._refresh()},this.readPixels=function(Oe){var ct=Oe.framebuffer,Qe=Oe.x,Ft=Oe.y,vr=Oe.width,Vr=Oe.height,lr={x:Qe,y:Ft,width:vr,height:Vr};return ct&&(lr.framebuffer=ct.get()),vt.gl.read(lr)},this.getViewportSize=function(){return{width:vt.gl._gl.drawingBufferWidth,height:vt.gl._gl.drawingBufferHeight}},this.getContainer=function(){var Oe;return(Oe=vt.canvas)===null||Oe===void 0?void 0:Oe.parentElement},this.getCanvas=function(){return vt.canvas},this.getGLContext=function(){return vt.gl._gl},this.destroy=function(){vt.gl.destroy()}}return Z()(Ct,[{key:"init",value:function(){var vt=Fe()(de.a.mark(function ct(Qe,Ft){var vr=this;return de.a.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:return this.canvas=Qe,lr.next=3,new Promise(function(Nn,vn){we()({canvas:vr.canvas,attributes:{alpha:!0,antialias:Ft.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:Ft.preserveDrawingBuffer},extensions:["OES_element_index_uint","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(ha,Zn){(ha||!Zn)&&vn(ha),Nn(Zn)}})});case 3:this.gl=lr.sent;case 4:case"end":return lr.stop()}},ct,this)}));function Oe(ct,Qe){return vt.apply(this,arguments)}return Oe}()},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var Oe=this.getGLContext();Oe.disable(Oe.CULL_FACE)}},{key:"setDirty",value:function(Oe){this.isDirty=Oe}},{key:"getDirty",value:function(){return this.isDirty}}]),Ct}(),ae))||Ke),jt=i("Hel2");function sr(Ct,vt){var Oe=Object.keys(Ct);if(Object.getOwnPropertySymbols){var ct=Object.getOwnPropertySymbols(Ct);vt&&(ct=ct.filter(function(Qe){return Object.getOwnPropertyDescriptor(Ct,Qe).enumerable})),Oe.push.apply(Oe,ct)}return Oe}function ft(Ct){for(var vt=1;vt<arguments.length;vt++){var Oe=arguments[vt]!=null?arguments[vt]:{};vt%2?sr(Object(Oe),!0).forEach(function(ct){m()(Ct,ct,Oe[ct])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ct,Object.getOwnPropertyDescriptors(Oe)):sr(Object(Oe)).forEach(function(ct){Object.defineProperty(Ct,ct,Object.getOwnPropertyDescriptor(Oe,ct))})}return Ct}var mt=function(){function Ct(vt){z()(this,Ct),this.sceneService=void 0,this.mapService=void 0,this.controlService=void 0,this.layerService=void 0,this.iconService=void 0,this.markerService=void 0,this.popupService=void 0,this.fontService=void 0,this.interactionService=void 0,this.container=void 0;var Oe=vt.id,ct=vt.map,Qe=Object(K.createSceneContainer)();this.container=Qe,ct.setContainer(Qe,Oe),Qe.bind(K.TYPES.IRendererService).to(et).inSingletonScope(),this.sceneService=Qe.get(K.TYPES.ISceneService),this.mapService=Qe.get(K.TYPES.IMapService),this.iconService=Qe.get(K.TYPES.IIconService),this.fontService=Qe.get(K.TYPES.IFontService),this.controlService=Qe.get(K.TYPES.IControlService),this.layerService=Qe.get(K.TYPES.ILayerService),this.markerService=Qe.get(K.TYPES.IMarkerService),this.interactionService=Qe.get(K.TYPES.IInteractionService),this.popupService=Qe.get(K.TYPES.IPopupService),this.initComponent(Oe),this.sceneService.init(vt),this.initControl()}return Z()(Ct,[{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"exportPng",value:function(Oe){return this.sceneService.exportPng(Oe)}},{key:"exportMap",value:function(Oe){return this.sceneService.exportPng(Oe)}},{key:"registerRenderService",value:function(Oe){var ct=this;if(this.sceneService.loaded){var Qe=new Oe(this);Qe.init()}else this.on("loaded",function(){var Ft=new Oe(ct);Ft.init()})}},{key:"addLayer",value:function(Oe){var ct=Object(K.createLayerContainer)(this.container);Oe.setContainer(ct),this.sceneService.addLayer(Oe)}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(Oe){return this.layerService.getLayer(Oe)}},{key:"getLayerByName",value:function(Oe){return this.layerService.getLayerByName(Oe)}},{key:"removeLayer",value:function(Oe){this.layerService.remove(Oe)}},{key:"removeAllLayer",value:function(){this.layerService.removeAllLayers()}},{key:"render",value:function(){this.sceneService.render()}},{key:"addImage",value:function(Oe,ct){this.iconService.addImage(Oe,ct)}},{key:"hasImage",value:function(Oe){return this.iconService.hasImage(Oe)}},{key:"removeImage",value:function(Oe){this.iconService.removeImage(Oe)}},{key:"addIconFontGlyphs",value:function(Oe,ct){this.fontService.addIconGlyphs(ct)}},{key:"addControl",value:function(Oe){this.controlService.addControl(Oe,this.container)}},{key:"removeControl",value:function(Oe){this.controlService.removeControl(Oe)}},{key:"getControlByName",value:function(Oe){return this.controlService.getControlByName(Oe)}},{key:"addMarker",value:function(Oe){this.markerService.addMarker(Oe)}},{key:"addMarkerLayer",value:function(Oe){this.markerService.addMarkerLayer(Oe)}},{key:"removeMarkerLayer",value:function(Oe){this.markerService.removeMarkerLayer(Oe)}},{key:"removeAllMakers",value:function(){this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(Oe){this.popupService.addPopup(Oe)}},{key:"on",value:function(Oe,ct){K.SceneEventList.indexOf(Oe)===-1?this.mapService.on(Oe,ct):this.sceneService.on(Oe,ct)}},{key:"off",value:function(Oe,ct){K.SceneEventList.indexOf(Oe)===-1?this.mapService.off(Oe,ct):this.sceneService.off(Oe,ct)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(){return this.mapService.getCenter()}},{key:"setCenter",value:function(Oe){return this.mapService.setCenter(Oe)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(Oe){return this.mapService.setPitch(Oe)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(Oe){this.mapService.setRotation(Oe)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(Oe){this.mapService.panTo(Oe)}},{key:"panBy",value:function(Oe){this.mapService.panBy(Oe)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(Oe){this.mapService.setZoom(Oe)}},{key:"fitBounds",value:function(Oe,ct){var Qe=this.sceneService.getSceneConfig(),Ft=Qe.fitBoundsOptions,vr=Qe.animate;this.mapService.fitBounds(Oe,ct||ft(ft({},Ft),{},{animate:vr}))}},{key:"setZoomAndCenter",value:function(Oe,ct){this.mapService.setZoomAndCenter(Oe,ct)}},{key:"setMapStyle",value:function(Oe){this.mapService.setMapStyle(Oe)}},{key:"setMapStatus",value:function(Oe){this.mapService.setMapStatus(Oe)}},{key:"pixelToLngLat",value:function(Oe){return this.mapService.pixelToLngLat(Oe)}},{key:"lngLatToPixel",value:function(Oe){return this.mapService.lngLatToPixel(Oe)}},{key:"containerToLngLat",value:function(Oe){return this.mapService.containerToLngLat(Oe)}},{key:"lngLatToContainer",value:function(Oe){return this.mapService.lngLatToContainer(Oe)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(Oe,ct){this.container.bind(K.TYPES.IPostProcessingPass).to(Oe).whenTargetNamed(ct)}},{key:"initComponent",value:function(Oe){this.controlService.init({container:jt.a.getContainer(Oe)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var Oe=this.sceneService.getSceneConfig(),ct=Oe.logoVisible,Qe=Oe.logoPosition;ct&&this.addControl(new D.b({position:Qe}))}},{key:"map",get:function(){return this.mapService.map}}]),Ct}()},kZZr:function(Re,E,i){Re.exports={"ant-pro-grid-content":"ant-pro-grid-content",wide:"wide"}},l94r:function(Re,E,i){"use strict";i.d(E,"a",function(){return Q});var T=i("lSNA"),m=i.n(T),X=i("lwsE"),z=i.n(X),o=i("W8MJ"),Z=i.n(o),D=i("7W2i"),K=i.n(D),re=i("a1gu"),de=i.n(re),Y=i("Nsbk"),Fe=i.n(Y),Ze=i("4qC0"),ye=i.n(Ze),we=i("lSCD"),pt=i.n(we),je=i("BkRI"),Tt=i.n(je),Xe=i("xp6e"),gt=i("Hel2"),Je=i("uhBA"),Et=i("rlAn"),_t=i("qxNg");function Ne(H){if(H.length===0)throw new Error("max requires at least one data point");for(var Ce=H[0],Ee=1;Ee<H.length;Ee++)H[Ee]>Ce&&(Ce=H[Ee]);return Ce}function ke(H){if(H.length===0)throw new Error("min requires at least one data point");for(var Ce=H[0],Ee=1;Ee<H.length;Ee++)H[Ee]<Ce&&(Ce=H[Ee]);return Ce}function Ue(H){if(H.length===0)return 0;for(var Ce=H[0],Ee=0,Ae,ge=1;ge<H.length;ge++)Ae=Ce+H[ge]*1,Math.abs(Ce)>=Math.abs(H[ge])?Ee+=Ce-Ae+H[ge]:Ee+=H[ge]-Ae+Ce,Ce=Ae;return Ce+Ee*1}function st(H){if(H.length===0)throw new Error("mean requires at least one data point");return Ue(H)/H.length}var Le={min:ke,max:Ne,mean:st,sum:Ue};function ut(H,Ce){return H.map(function(Ee){return Ee[Ce]*1})}function Vt(H,Ce){var Ee=Object.keys(H);if(Object.getOwnPropertySymbols){var Ae=Object.getOwnPropertySymbols(H);Ce&&(Ae=Ae.filter(function(ge){return Object.getOwnPropertyDescriptor(H,ge).enumerable})),Ee.push.apply(Ee,Ae)}return Ee}function Zt(H){for(var Ce=1;Ce<arguments.length;Ce++){var Ee=arguments[Ce]!=null?arguments[Ce]:{};Ce%2?Vt(Object(Ee),!0).forEach(function(Ae){m()(H,Ae,Ee[Ae])}):Object.getOwnPropertyDescriptors?Object.defineProperties(H,Object.getOwnPropertyDescriptors(Ee)):Vt(Object(Ee)).forEach(function(Ae){Object.defineProperty(H,Ae,Object.getOwnPropertyDescriptor(Ee,Ae))})}return H}function ir(H){var Ce=oe();return function(){var Ae=Fe()(H),ge;if(Ce){var rt=Fe()(this).constructor;ge=Reflect.construct(Ae,arguments,rt)}else ge=Ae.apply(this,arguments);return de()(this,ge)}}function oe(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(H){return!1}}var Q=function(H){K()(Ee,H);var Ce=ir(Ee);function Ee(Ae,ge){var rt;return z()(this,Ee),rt=Ce.call(this),rt.data=void 0,rt.extent=void 0,rt.hooks={init:new Xe.c},rt.parser={type:"geojson"},rt.transforms=[],rt.cluster=!1,rt.clusterOptions={enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"},rt.originData=void 0,rt.rawData=void 0,rt.clusterIndex=void 0,rt.originData=Ae,rt.initCfg(ge),rt.hooks.init.tap("parser",function(){rt.excuteParser()}),rt.hooks.init.tap("cluster",function(){rt.initCluster()}),rt.hooks.init.tap("transform",function(){rt.executeTrans()}),rt.init(),rt}return Z()(Ee,[{key:"setData",value:function(ge,rt){this.rawData=ge,this.originData=ge,this.initCfg(rt),this.init(),this.emit("update")}},{key:"getClusters",value:function(ge){return this.clusterIndex.getClusters(this.extent,ge)}},{key:"getClustersLeaves",value:function(ge){return this.clusterIndex.getLeaves(ge,Infinity)}},{key:"updateClusterData",value:function(ge){var rt=this,Yt=this.clusterOptions,At=Yt.method,be=At===void 0?"sum":At,xe=Yt.field,Ve=Object(gt.r)(Object(gt.h)(this.extent),2),lt=this.clusterIndex.getClusters(Ve[0].concat(Ve[1]),Math.floor(ge));this.clusterOptions.zoom=ge,lt.forEach(function(Pe){Pe.id||(Pe.properties.point_count=1)}),(xe||pt()(be))&&(lt=lt.map(function(Pe){var dt=Pe.id;if(dt){var w=rt.clusterIndex.getLeaves(dt,Infinity),I=w.map(function(Ge){return Ge.properties}),q;if(ye()(be)&&xe){var ce=ut(I,xe);q=Le[be](ce)}pt()(be)&&(q=be(I)),Pe.properties.stat=q}else Pe.properties.point_count=1;return Pe})),this.data=Object(Et.getParser)("geojson")({type:"FeatureCollection",features:lt}),this.executeTrans()}},{key:"getFeatureById",value:function(ge){var rt=this.parser.type,Yt=rt===void 0?"geojson":rt;if(Yt==="geojson"&&!this.cluster){var At=ge<this.originData.features.length?this.originData.features[ge]:"null",be=Tt()(At);if(this.transforms.length!==0){var xe=this.data.dataArray.find(function(Ve){return Ve._id===ge});be.properties=xe}return be}else return ge<this.data.dataArray.length?this.data.dataArray[ge]:"null"}},{key:"getFeatureId",value:function(ge,rt){var Yt=this.data.dataArray.find(function(At){return At[ge]===name});return Yt==null?void 0:Yt._id}},{key:"destroy",value:function(){this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null}},{key:"initCfg",value:function(ge){ge&&(ge.parser&&(this.parser=ge.parser),ge.transforms&&(this.transforms=ge.transforms),this.cluster=ge.cluster||!1,ge.clusterOptions&&(this.cluster=!0,this.clusterOptions=Zt(Zt({},this.clusterOptions),ge.clusterOptions)))}},{key:"excuteParser",value:function(){var ge=this.parser,rt=ge.type||"geojson",Yt=Object(Et.getParser)(rt);this.data=Yt(this.originData,ge),this.extent=Object(gt.m)(this.data.dataArray)}},{key:"executeTrans",value:function(){var ge=this,rt=this.transforms;rt.forEach(function(Yt){var At=Yt.type,be=Object(Et.getTransform)(At)(ge.data,Yt);Object.assign(ge.data,be)})}},{key:"initCluster",value:function(){if(!this.cluster)return;var ge=this.clusterOptions||{};this.clusterIndex=Object(_t.a)(this.data,ge)}},{key:"init",value:function(){this.hooks.init.call(this)}}]),Ee}(Je.EventEmitter)},lJbI:function(Re,E,i){"use strict";i.d(E,"a",function(){return T});function T(m,X){var z=X.extent,o=X.width,Z=X.height,D=X.min,K=X.max,re={_id:1,dataArray:[{_id:1,data:Array.from(m),width:o,height:Z,min:D,max:K,coordinates:[[z[0],z[1]],[z[2],z[3]]]}]};return re}},mNvP:function(Re,E,i){(function(T,m){/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var X;(function(z){(function(o){var Z=typeof m=="object"?m:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),D=K(z);typeof Z.Reflect=="undefined"?Z.Reflect=z:D=K(Z.Reflect,D),o(D);function K(re,de){return function(Y,Fe){typeof re[Y]!="function"&&Object.defineProperty(re,Y,{configurable:!0,writable:!0,value:Fe}),de&&de(Y,Fe)}}})(function(o){var Z=Object.prototype.hasOwnProperty,D=typeof Symbol=="function",K=D&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",re=D&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",de=typeof Object.create=="function",Y={__proto__:[]}instanceof Array,Fe=!de&&!Y,Ze={create:de?function(){return sr(Object.create(null))}:Y?function(){return sr({__proto__:null})}:function(){return sr({})},has:Fe?function(ft,mt){return Z.call(ft,mt)}:function(ft,mt){return mt in ft},get:Fe?function(ft,mt){return Z.call(ft,mt)?ft[mt]:void 0}:function(ft,mt){return ft[mt]}},ye=Object.getPrototypeOf(Function),we=typeof T=="object"&&Object({NODE_ENV:"production"})&&Object({NODE_ENV:"production"}).REFLECT_METADATA_USE_MAP_POLYFILL==="true",pt=!we&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:ae(),je=!we&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:et(),Tt=!we&&typeof WeakMap=="function"?WeakMap:jt(),Xe=new Tt;function gt(ft,mt,Ct,vt){if(Yt(Ct)){if(!I(ft))throw new TypeError;if(!ce(mt))throw new TypeError;return Vt(ft,mt)}else{if(!I(ft))throw new TypeError;if(!xe(mt))throw new TypeError;if(!xe(vt)&&!Yt(vt)&&!At(vt))throw new TypeError;return At(vt)&&(vt=void 0),Ct=w(Ct),Zt(ft,mt,Ct,vt)}}o("decorate",gt);function Je(ft,mt){function Ct(vt,Oe){if(!xe(vt))throw new TypeError;if(!Yt(Oe)&&!Ge(Oe))throw new TypeError;Ee(ft,mt,vt,Oe)}return Ct}o("metadata",Je);function Et(ft,mt,Ct,vt){if(!xe(Ct))throw new TypeError;return Yt(vt)||(vt=w(vt)),Ee(ft,mt,Ct,vt)}o("defineMetadata",Et);function _t(ft,mt,Ct){if(!xe(mt))throw new TypeError;return Yt(Ct)||(Ct=w(Ct)),oe(ft,mt,Ct)}o("hasMetadata",_t);function Ne(ft,mt,Ct){if(!xe(mt))throw new TypeError;return Yt(Ct)||(Ct=w(Ct)),Q(ft,mt,Ct)}o("hasOwnMetadata",Ne);function ke(ft,mt,Ct){if(!xe(mt))throw new TypeError;return Yt(Ct)||(Ct=w(Ct)),H(ft,mt,Ct)}o("getMetadata",ke);function Ue(ft,mt,Ct){if(!xe(mt))throw new TypeError;return Yt(Ct)||(Ct=w(Ct)),Ce(ft,mt,Ct)}o("getOwnMetadata",Ue);function st(ft,mt){if(!xe(ft))throw new TypeError;return Yt(mt)||(mt=w(mt)),Ae(ft,mt)}o("getMetadataKeys",st);function Le(ft,mt){if(!xe(ft))throw new TypeError;return Yt(mt)||(mt=w(mt)),ge(ft,mt)}o("getOwnMetadataKeys",Le);function ut(ft,mt,Ct){if(!xe(mt))throw new TypeError;Yt(Ct)||(Ct=w(Ct));var vt=ir(mt,Ct,!1);if(Yt(vt))return!1;if(!vt.delete(ft))return!1;if(vt.size>0)return!0;var Oe=Xe.get(mt);return Oe.delete(Ct),Oe.size>0||Xe.delete(mt),!0}o("deleteMetadata",ut);function Vt(ft,mt){for(var Ct=ft.length-1;Ct>=0;--Ct){var vt=ft[Ct],Oe=vt(mt);if(!Yt(Oe)&&!At(Oe)){if(!ce(Oe))throw new TypeError;mt=Oe}}return mt}function Zt(ft,mt,Ct,vt){for(var Oe=ft.length-1;Oe>=0;--Oe){var ct=ft[Oe],Qe=ct(mt,Ct,vt);if(!Yt(Qe)&&!At(Qe)){if(!xe(Qe))throw new TypeError;vt=Qe}}return vt}function ir(ft,mt,Ct){var vt=Xe.get(ft);if(Yt(vt)){if(!Ct)return;vt=new pt,Xe.set(ft,vt)}var Oe=vt.get(mt);if(Yt(Oe)){if(!Ct)return;Oe=new pt,vt.set(mt,Oe)}return Oe}function oe(ft,mt,Ct){var vt=Q(ft,mt,Ct);if(vt)return!0;var Oe=Ke(mt);return At(Oe)?!1:oe(ft,Oe,Ct)}function Q(ft,mt,Ct){var vt=ir(mt,Ct,!1);return Yt(vt)?!1:Pe(vt.has(ft))}function H(ft,mt,Ct){var vt=Q(ft,mt,Ct);if(vt)return Ce(ft,mt,Ct);var Oe=Ke(mt);return At(Oe)?void 0:H(ft,Oe,Ct)}function Ce(ft,mt,Ct){var vt=ir(mt,Ct,!1);return Yt(vt)?void 0:vt.get(ft)}function Ee(ft,mt,Ct,vt){var Oe=ir(Ct,vt,!0);Oe.set(ft,mt)}function Ae(ft,mt){var Ct=ge(ft,mt),vt=Ke(ft);if(vt===null)return Ct;var Oe=Ae(vt,mt);if(Oe.length<=0)return Ct;if(Ct.length<=0)return Oe;for(var ct=new je,Qe=[],Ft=0,vr=Ct;Ft<vr.length;Ft++){var Vr=vr[Ft],lr=ct.has(Vr);lr||(ct.add(Vr),Qe.push(Vr))}for(var Nn=0,vn=Oe;Nn<vn.length;Nn++){var Vr=vn[Nn],lr=ct.has(Vr);lr||(ct.add(Vr),Qe.push(Vr))}return Qe}function ge(ft,mt){var Ct=[],vt=ir(ft,mt,!1);if(Yt(vt))return Ct;for(var Oe=vt.keys(),ct=yt(Oe),Qe=0;;){var Ft=Nt(ct);if(!Ft)return Ct.length=Qe,Ct;var vr=nt(Ft);try{Ct[Qe]=vr}catch(Vr){try{$(ct)}finally{throw Vr}}Qe++}}function rt(ft){if(ft===null)return 1;switch(typeof ft){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return ft===null?1:6;default:return 6}}function Yt(ft){return ft===void 0}function At(ft){return ft===null}function be(ft){return typeof ft=="symbol"}function xe(ft){return typeof ft=="object"?ft!==null:typeof ft=="function"}function Ve(ft,mt){switch(rt(ft)){case 0:return ft;case 1:return ft;case 2:return ft;case 3:return ft;case 4:return ft;case 5:return ft}var Ct=mt===3?"string":mt===5?"number":"default",vt=$e(ft,K);if(vt!==void 0){var Oe=vt.call(ft,Ct);if(xe(Oe))throw new TypeError;return Oe}return lt(ft,Ct==="default"?"number":Ct)}function lt(ft,mt){if(mt==="string"){var Ct=ft.toString;if(q(Ct)){var vt=Ct.call(ft);if(!xe(vt))return vt}var Oe=ft.valueOf;if(q(Oe)){var vt=Oe.call(ft);if(!xe(vt))return vt}}else{var Oe=ft.valueOf;if(q(Oe)){var vt=Oe.call(ft);if(!xe(vt))return vt}var ct=ft.toString;if(q(ct)){var vt=ct.call(ft);if(!xe(vt))return vt}}throw new TypeError}function Pe(ft){return!!ft}function dt(ft){return""+ft}function w(ft){var mt=Ve(ft,3);return be(mt)?mt:dt(mt)}function I(ft){return Array.isArray?Array.isArray(ft):ft instanceof Object?ft instanceof Array:Object.prototype.toString.call(ft)==="[object Array]"}function q(ft){return typeof ft=="function"}function ce(ft){return typeof ft=="function"}function Ge(ft){switch(rt(ft)){case 3:return!0;case 4:return!0;default:return!1}}function $e(ft,mt){var Ct=ft[mt];if(Ct==null)return;if(!q(Ct))throw new TypeError;return Ct}function yt(ft){var mt=$e(ft,re);if(!q(mt))throw new TypeError;var Ct=mt.call(ft);if(!xe(Ct))throw new TypeError;return Ct}function nt(ft){return ft.value}function Nt(ft){var mt=ft.next();return mt.done?!1:mt}function $(ft){var mt=ft.return;mt&&mt.call(ft)}function Ke(ft){var mt=Object.getPrototypeOf(ft);if(typeof ft!="function"||ft===ye)return mt;if(mt!==ye)return mt;var Ct=ft.prototype,vt=Ct&&Object.getPrototypeOf(Ct);if(vt==null||vt===Object.prototype)return mt;var Oe=vt.constructor;return typeof Oe!="function"||Oe===ft?mt:Oe}function ae(){var ft={},mt=[],Ct=function(){function Qe(Ft,vr,Vr){this._index=0,this._keys=Ft,this._values=vr,this._selector=Vr}return Qe.prototype["@@iterator"]=function(){return this},Qe.prototype[re]=function(){return this},Qe.prototype.next=function(){var Ft=this._index;if(Ft>=0&&Ft<this._keys.length){var vr=this._selector(this._keys[Ft],this._values[Ft]);return Ft+1>=this._keys.length?(this._index=-1,this._keys=mt,this._values=mt):this._index++,{value:vr,done:!1}}return{value:void 0,done:!0}},Qe.prototype.throw=function(Ft){throw this._index>=0&&(this._index=-1,this._keys=mt,this._values=mt),Ft},Qe.prototype.return=function(Ft){return this._index>=0&&(this._index=-1,this._keys=mt,this._values=mt),{value:Ft,done:!0}},Qe}();return function(){function Qe(){this._keys=[],this._values=[],this._cacheKey=ft,this._cacheIndex=-2}return Object.defineProperty(Qe.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Qe.prototype.has=function(Ft){return this._find(Ft,!1)>=0},Qe.prototype.get=function(Ft){var vr=this._find(Ft,!1);return vr>=0?this._values[vr]:void 0},Qe.prototype.set=function(Ft,vr){var Vr=this._find(Ft,!0);return this._values[Vr]=vr,this},Qe.prototype.delete=function(Ft){var vr=this._find(Ft,!1);if(vr>=0){for(var Vr=this._keys.length,lr=vr+1;lr<Vr;lr++)this._keys[lr-1]=this._keys[lr],this._values[lr-1]=this._values[lr];return this._keys.length--,this._values.length--,Ft===this._cacheKey&&(this._cacheKey=ft,this._cacheIndex=-2),!0}return!1},Qe.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=ft,this._cacheIndex=-2},Qe.prototype.keys=function(){return new Ct(this._keys,this._values,vt)},Qe.prototype.values=function(){return new Ct(this._keys,this._values,Oe)},Qe.prototype.entries=function(){return new Ct(this._keys,this._values,ct)},Qe.prototype["@@iterator"]=function(){return this.entries()},Qe.prototype[re]=function(){return this.entries()},Qe.prototype._find=function(Ft,vr){return this._cacheKey!==Ft&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=Ft)),this._cacheIndex<0&&vr&&(this._cacheIndex=this._keys.length,this._keys.push(Ft),this._values.push(void 0)),this._cacheIndex},Qe}();function vt(Qe,Ft){return Qe}function Oe(Qe,Ft){return Ft}function ct(Qe,Ft){return[Qe,Ft]}}function et(){return function(){function ft(){this._map=new pt}return Object.defineProperty(ft.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),ft.prototype.has=function(mt){return this._map.has(mt)},ft.prototype.add=function(mt){return this._map.set(mt,mt),this},ft.prototype.delete=function(mt){return this._map.delete(mt)},ft.prototype.clear=function(){this._map.clear()},ft.prototype.keys=function(){return this._map.keys()},ft.prototype.values=function(){return this._map.values()},ft.prototype.entries=function(){return this._map.entries()},ft.prototype["@@iterator"]=function(){return this.keys()},ft.prototype[re]=function(){return this.keys()},ft}()}function jt(){var ft=16,mt=Ze.create(),Ct=vt();return function(){function vr(){this._key=vt()}return vr.prototype.has=function(Vr){var lr=Oe(Vr,!1);return lr!==void 0?Ze.has(lr,this._key):!1},vr.prototype.get=function(Vr){var lr=Oe(Vr,!1);return lr!==void 0?Ze.get(lr,this._key):void 0},vr.prototype.set=function(Vr,lr){var Nn=Oe(Vr,!0);return Nn[this._key]=lr,this},vr.prototype.delete=function(Vr){var lr=Oe(Vr,!1);return lr!==void 0?delete lr[this._key]:!1},vr.prototype.clear=function(){this._key=vt()},vr}();function vt(){var vr;do vr="@@WeakMap@@"+Ft();while(Ze.has(mt,vr));return mt[vr]=!0,vr}function Oe(vr,Vr){if(!Z.call(vr,Ct)){if(!Vr)return;Object.defineProperty(vr,Ct,{value:Ze.create()})}return vr[Ct]}function ct(vr,Vr){for(var lr=0;lr<Vr;++lr)vr[lr]=Math.random()*255|0;return vr}function Qe(vr){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(vr)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(vr)):ct(new Uint8Array(vr),vr):ct(new Array(vr),vr)}function Ft(){var vr=Qe(ft);vr[6]=vr[6]&79|64,vr[8]=vr[8]&191|128;for(var Vr="",lr=0;lr<ft;++lr){var Nn=vr[lr];(lr===4||lr===6||lr===8)&&(Vr+="-"),Nn<16&&(Vr+="0"),Vr+=Nn.toString(16).toLowerCase()}return Vr}}function sr(ft){return ft.__=void 0,delete ft.__,ft}})})(X||(X={}))}).call(this,i("Q2Ig"),i("yLpj"))},mTTR:function(Re,E,i){var T=i("b80T"),m=i("QcOe"),X=i("MMmD");function z(o){return X(o)?T(o,!0):m(o)}Re.exports=z},mc0g:function(Re,E){function i(T){return function(m,X,z){for(var o=-1,Z=Object(m),D=z(m),K=D.length;K--;){var re=D[T?K:++o];if(X(Z[re],re,Z)===!1)break}return m}}Re.exports=i},mhV4:function(Re,E,i){var T=i("ZK94");Re.exports.geometry=m,Re.exports.ring=z;function m(Z){var D=0,K;switch(Z.type){case"Polygon":return X(Z.coordinates);case"MultiPolygon":for(K=0;K<Z.coordinates.length;K++)D+=X(Z.coordinates[K]);return D;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(K=0;K<Z.geometries.length;K++)D+=m(Z.geometries[K]);return D}}function X(Z){var D=0;if(Z&&Z.length>0){D+=Math.abs(z(Z[0]));for(var K=1;K<Z.length;K++)D-=Math.abs(z(Z[K]))}return D}function z(Z){var D,K,re,de,Y,Fe,Ze,ye=0,we=Z.length;if(we>2){for(Ze=0;Ze<we;Ze++)Ze===we-2?(de=we-2,Y=we-1,Fe=0):Ze===we-1?(de=we-1,Y=0,Fe=1):(de=Ze,Y=Ze+1,Fe=Ze+2),D=Z[de],K=Z[Y],re=Z[Fe],ye+=(o(re[0])-o(D[0]))*Math.sin(o(K[1]));ye=ye*T.RADIUS*T.RADIUS/2}return ye}function o(Z){return Z*Math.PI/180}},mpbz:function(Re,E,i){(function(T,m){Re.exports=m()})(this,function(){"use strict";function T(Ne,ke,Ue,st,Le,ut){if(Le-st<=Ue)return;var Vt=st+Le>>1;m(Ne,ke,Vt,st,Le,ut%2),T(Ne,ke,Ue,st,Vt-1,ut+1),T(Ne,ke,Ue,Vt+1,Le,ut+1)}function m(Ne,ke,Ue,st,Le,ut){for(;Le>st;){if(Le-st>600){var Vt=Le-st+1,Zt=Ue-st+1,ir=Math.log(Vt),oe=.5*Math.exp(2*ir/3),Q=.5*Math.sqrt(ir*oe*(Vt-oe)/Vt)*(Zt-Vt/2<0?-1:1),H=Math.max(st,Math.floor(Ue-Zt*oe/Vt+Q)),Ce=Math.min(Le,Math.floor(Ue+(Vt-Zt)*oe/Vt+Q));m(Ne,ke,Ue,H,Ce,ut)}var Ee=ke[2*Ue+ut],Ae=st,ge=Le;for(X(Ne,ke,st,Ue),ke[2*Le+ut]>Ee&&X(Ne,ke,st,Le);Ae<ge;){for(X(Ne,ke,Ae,ge),Ae++,ge--;ke[2*Ae+ut]<Ee;)Ae++;for(;ke[2*ge+ut]>Ee;)ge--}ke[2*st+ut]===Ee?X(Ne,ke,st,ge):(ge++,X(Ne,ke,ge,Le)),ge<=Ue&&(st=ge+1),Ue<=ge&&(Le=ge-1)}}function X(Ne,ke,Ue,st){z(Ne,Ue,st),z(ke,2*Ue,2*st),z(ke,2*Ue+1,2*st+1)}function z(Ne,ke,Ue){var st=Ne[ke];Ne[ke]=Ne[Ue],Ne[Ue]=st}function o(Ne,ke,Ue,st,Le,ut,Vt){for(var Zt=[0,Ne.length-1,0],ir=[],oe,Q;Zt.length;){var H=Zt.pop(),Ce=Zt.pop(),Ee=Zt.pop();if(Ce-Ee<=Vt){for(var Ae=Ee;Ae<=Ce;Ae++)oe=ke[2*Ae],Q=ke[2*Ae+1],oe>=Ue&&oe<=Le&&Q>=st&&Q<=ut&&ir.push(Ne[Ae]);continue}var ge=Math.floor((Ee+Ce)/2);oe=ke[2*ge],Q=ke[2*ge+1],oe>=Ue&&oe<=Le&&Q>=st&&Q<=ut&&ir.push(Ne[ge]);var rt=(H+1)%2;(H===0?Ue<=oe:st<=Q)&&(Zt.push(Ee),Zt.push(ge-1),Zt.push(rt)),(H===0?Le>=oe:ut>=Q)&&(Zt.push(ge+1),Zt.push(Ce),Zt.push(rt))}return ir}function Z(Ne,ke,Ue,st,Le,ut){for(var Vt=[0,Ne.length-1,0],Zt=[],ir=Le*Le;Vt.length;){var oe=Vt.pop(),Q=Vt.pop(),H=Vt.pop();if(Q-H<=ut){for(var Ce=H;Ce<=Q;Ce++)D(ke[2*Ce],ke[2*Ce+1],Ue,st)<=ir&&Zt.push(Ne[Ce]);continue}var Ee=Math.floor((H+Q)/2),Ae=ke[2*Ee],ge=ke[2*Ee+1];D(Ae,ge,Ue,st)<=ir&&Zt.push(Ne[Ee]);var rt=(oe+1)%2;(oe===0?Ue-Le<=Ae:st-Le<=ge)&&(Vt.push(H),Vt.push(Ee-1),Vt.push(rt)),(oe===0?Ue+Le>=Ae:st+Le>=ge)&&(Vt.push(Ee+1),Vt.push(Q),Vt.push(rt))}return Zt}function D(Ne,ke,Ue,st){var Le=Ne-Ue,ut=ke-st;return Le*Le+ut*ut}var K=function(ke){return ke[0]},re=function(ke){return ke[1]},de=function(ke,Ue,st,Le,ut){Ue===void 0&&(Ue=K),st===void 0&&(st=re),Le===void 0&&(Le=64),ut===void 0&&(ut=Float64Array),this.nodeSize=Le,this.points=ke;for(var Vt=ke.length<65536?Uint16Array:Uint32Array,Zt=this.ids=new Vt(ke.length),ir=this.coords=new ut(ke.length*2),oe=0;oe<ke.length;oe++)Zt[oe]=oe,ir[2*oe]=Ue(ke[oe]),ir[2*oe+1]=st(ke[oe]);T(Zt,ir,Le,0,Zt.length-1,0)};de.prototype.range=function(ke,Ue,st,Le){return o(this.ids,this.coords,ke,Ue,st,Le,this.nodeSize)},de.prototype.within=function(ke,Ue,st){return Z(this.ids,this.coords,ke,Ue,st,this.nodeSize)};var Y={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(ke){return ke}},Fe=function(ke){this.options=Je(Object.create(Y),ke),this.trees=new Array(this.options.maxZoom+1)};Fe.prototype.load=function(ke){var Ue=this.options,st=Ue.log,Le=Ue.minZoom,ut=Ue.maxZoom,Vt=Ue.nodeSize;st&&console.time("total time");var Zt="prepare "+ke.length+" points";st&&console.time(Zt),this.points=ke;for(var ir=[],oe=0;oe<ke.length;oe++){if(!ke[oe].geometry)continue;ir.push(ye(ke[oe],oe))}this.trees[ut+1]=new de(ir,Et,_t,Vt,Float32Array),st&&console.timeEnd(Zt);for(var Q=ut;Q>=Le;Q--){var H=+Date.now();ir=this._cluster(ir,Q),this.trees[Q]=new de(ir,Et,_t,Vt,Float32Array),st&&console.log("z%d: %d clusters in %dms",Q,ir.length,+Date.now()-H)}return st&&console.timeEnd("total time"),this},Fe.prototype.getClusters=function(ke,Ue){var st=((ke[0]+180)%360+360)%360-180,Le=Math.max(-90,Math.min(90,ke[1])),ut=ke[2]===180?180:((ke[2]+180)%360+360)%360-180,Vt=Math.max(-90,Math.min(90,ke[3]));if(ke[2]-ke[0]>=360)st=-180,ut=180;else if(st>ut){var Zt=this.getClusters([st,Le,180,Vt],Ue),ir=this.getClusters([-180,Le,ut,Vt],Ue);return Zt.concat(ir)}for(var oe=this.trees[this._limitZoom(Ue)],Q=oe.range(je(st),Tt(Vt),je(ut),Tt(Le)),H=[],Ce=0,Ee=Q;Ce<Ee.length;Ce+=1){var Ae=Ee[Ce],ge=oe.points[Ae];H.push(ge.numPoints?we(ge):this.points[ge.index])}return H},Fe.prototype.getChildren=function(ke){var Ue=this._getOriginId(ke),st=this._getOriginZoom(ke),Le="No cluster with the specified id.",ut=this.trees[st];if(!ut)throw new Error(Le);var Vt=ut.points[Ue];if(!Vt)throw new Error(Le);for(var Zt=this.options.radius/(this.options.extent*Math.pow(2,st-1)),ir=ut.within(Vt.x,Vt.y,Zt),oe=[],Q=0,H=ir;Q<H.length;Q+=1){var Ce=H[Q],Ee=ut.points[Ce];Ee.parentId===ke&&oe.push(Ee.numPoints?we(Ee):this.points[Ee.index])}if(oe.length===0)throw new Error(Le);return oe},Fe.prototype.getLeaves=function(ke,Ue,st){Ue=Ue||10,st=st||0;var Le=[];return this._appendLeaves(Le,ke,Ue,st,0),Le},Fe.prototype.getTile=function(ke,Ue,st){var Le=this.trees[this._limitZoom(ke)],ut=Math.pow(2,ke),Vt=this.options,Zt=Vt.extent,ir=Vt.radius,oe=ir/Zt,Q=(st-oe)/ut,H=(st+1+oe)/ut,Ce={features:[]};return this._addTileFeatures(Le.range((Ue-oe)/ut,Q,(Ue+1+oe)/ut,H),Le.points,Ue,st,ut,Ce),Ue===0&&this._addTileFeatures(Le.range(1-oe/ut,Q,1,H),Le.points,ut,st,ut,Ce),Ue===ut-1&&this._addTileFeatures(Le.range(0,Q,oe/ut,H),Le.points,-1,st,ut,Ce),Ce.features.length?Ce:null},Fe.prototype.getClusterExpansionZoom=function(ke){for(var Ue=this._getOriginZoom(ke)-1;Ue<=this.options.maxZoom;){var st=this.getChildren(ke);if(Ue++,st.length!==1)break;ke=st[0].properties.cluster_id}return Ue},Fe.prototype._appendLeaves=function(ke,Ue,st,Le,ut){for(var Vt=this.getChildren(Ue),Zt=0,ir=Vt;Zt<ir.length;Zt+=1){var oe=ir[Zt],Q=oe.properties;if(Q&&Q.cluster?ut+Q.point_count<=Le?ut+=Q.point_count:ut=this._appendLeaves(ke,Q.cluster_id,st,Le,ut):ut<Le?ut++:ke.push(oe),ke.length===st)break}return ut},Fe.prototype._addTileFeatures=function(ke,Ue,st,Le,ut,Vt){for(var Zt=0,ir=ke;Zt<ir.length;Zt+=1){var oe=ir[Zt],Q=Ue[oe],H=Q.numPoints,Ce={type:1,geometry:[[Math.round(this.options.extent*(Q.x*ut-st)),Math.round(this.options.extent*(Q.y*ut-Le))]],tags:H?pt(Q):this.points[Q.index].properties},Ee=void 0;H?Ee=Q.id:this.options.generateId?Ee=Q.index:this.points[Q.index].id&&(Ee=this.points[Q.index].id),Ee!==void 0&&(Ce.id=Ee),Vt.features.push(Ce)}},Fe.prototype._limitZoom=function(ke){return Math.max(this.options.minZoom,Math.min(+ke,this.options.maxZoom+1))},Fe.prototype._cluster=function(ke,Ue){for(var st=[],Le=this.options,ut=Le.radius,Vt=Le.extent,Zt=Le.reduce,ir=Le.minPoints,oe=ut/(Vt*Math.pow(2,Ue)),Q=0;Q<ke.length;Q++){var H=ke[Q];if(H.zoom<=Ue)continue;H.zoom=Ue;for(var Ce=this.trees[Ue+1],Ee=Ce.within(H.x,H.y,oe),Ae=H.numPoints||1,ge=Ae,rt=0,Yt=Ee;rt<Yt.length;rt+=1){var At=Yt[rt],be=Ce.points[At];be.zoom>Ue&&(ge+=be.numPoints||1)}if(ge>=ir){for(var xe=H.x*Ae,Ve=H.y*Ae,lt=Zt&&Ae>1?this._map(H,!0):null,Pe=(Q<<5)+(Ue+1)+this.points.length,dt=0,w=Ee;dt<w.length;dt+=1){var I=w[dt],q=Ce.points[I];if(q.zoom<=Ue)continue;q.zoom=Ue;var ce=q.numPoints||1;xe+=q.x*ce,Ve+=q.y*ce,q.parentId=Pe,Zt&&(lt||(lt=this._map(H,!0)),Zt(lt,this._map(q)))}H.parentId=Pe,st.push(Ze(xe/ge,Ve/ge,Pe,ge,lt))}else if(st.push(H),ge>1)for(var Ge=0,$e=Ee;Ge<$e.length;Ge+=1){var yt=$e[Ge],nt=Ce.points[yt];if(nt.zoom<=Ue)continue;nt.zoom=Ue,st.push(nt)}}return st},Fe.prototype._getOriginId=function(ke){return ke-this.points.length>>5},Fe.prototype._getOriginZoom=function(ke){return(ke-this.points.length)%32},Fe.prototype._map=function(ke,Ue){if(ke.numPoints)return Ue?Je({},ke.properties):ke.properties;var st=this.points[ke.index].properties,Le=this.options.map(st);return Ue&&Le===st?Je({},Le):Le};function Ze(Ne,ke,Ue,st,Le){return{x:Ne,y:ke,zoom:Infinity,id:Ue,parentId:-1,numPoints:st,properties:Le}}function ye(Ne,ke){var Ue=Ne.geometry.coordinates,st=Ue[0],Le=Ue[1];return{x:je(st),y:Tt(Le),zoom:Infinity,index:ke,parentId:-1}}function we(Ne){return{type:"Feature",id:Ne.id,properties:pt(Ne),geometry:{type:"Point",coordinates:[Xe(Ne.x),gt(Ne.y)]}}}function pt(Ne){var ke=Ne.numPoints,Ue=ke>=1e4?Math.round(ke/1e3)+"k":ke>=1e3?Math.round(ke/100)/10+"k":ke;return Je(Je({},Ne.properties),{cluster:!0,cluster_id:Ne.id,point_count:ke,point_count_abbreviated:Ue})}function je(Ne){return Ne/360+.5}function Tt(Ne){var ke=Math.sin(Ne*Math.PI/180),Ue=.5-.25*Math.log((1+ke)/(1-ke))/Math.PI;return Ue<0?0:Ue>1?1:Ue}function Xe(Ne){return(Ne-.5)*360}function gt(Ne){var ke=(180-Ne*360)*Math.PI/180;return 360*Math.atan(Math.exp(ke))/Math.PI-90}function Je(Ne,ke){for(var Ue in ke)Ne[Ue]=ke[Ue];return Ne}function Et(Ne){return Ne.x}function _t(Ne){return Ne.y}return Fe})},"mv/X":function(Re,E,i){var T=i("ljhN"),m=i("MMmD"),X=i("wJg7"),z=i("GoyQ");function o(Z,D,K){if(!z(K))return!1;var re=typeof D;return(re=="number"?m(K)&&X(D,K.length):re=="string"&&D in K)?T(K[D],Z):!1}Re.exports=o},"n+fv":function(Re,E,i){"use strict";i.r(E),i.d(E,"create",function(){return m}),i.d(E,"clone",function(){return X}),i.d(E,"length",function(){return z}),i.d(E,"fromValues",function(){return o}),i.d(E,"copy",function(){return Z}),i.d(E,"set",function(){return D}),i.d(E,"add",function(){return K}),i.d(E,"subtract",function(){return re}),i.d(E,"multiply",function(){return de}),i.d(E,"divide",function(){return Y}),i.d(E,"ceil",function(){return Fe}),i.d(E,"floor",function(){return Ze}),i.d(E,"min",function(){return ye}),i.d(E,"max",function(){return we}),i.d(E,"round",function(){return pt}),i.d(E,"scale",function(){return je}),i.d(E,"scaleAndAdd",function(){return Tt}),i.d(E,"distance",function(){return Xe}),i.d(E,"squaredDistance",function(){return gt}),i.d(E,"squaredLength",function(){return Je}),i.d(E,"negate",function(){return Et}),i.d(E,"inverse",function(){return _t}),i.d(E,"normalize",function(){return Ne}),i.d(E,"dot",function(){return ke}),i.d(E,"cross",function(){return Ue}),i.d(E,"lerp",function(){return st}),i.d(E,"hermite",function(){return Le}),i.d(E,"bezier",function(){return ut}),i.d(E,"random",function(){return Vt}),i.d(E,"transformMat4",function(){return Zt}),i.d(E,"transformMat3",function(){return ir}),i.d(E,"transformQuat",function(){return oe}),i.d(E,"rotateX",function(){return Q}),i.d(E,"rotateY",function(){return H}),i.d(E,"rotateZ",function(){return Ce}),i.d(E,"angle",function(){return Ee}),i.d(E,"zero",function(){return Ae}),i.d(E,"str",function(){return ge}),i.d(E,"exactEquals",function(){return rt}),i.d(E,"equals",function(){return Yt}),i.d(E,"sub",function(){return At}),i.d(E,"mul",function(){return be}),i.d(E,"div",function(){return xe}),i.d(E,"dist",function(){return Ve}),i.d(E,"sqrDist",function(){return lt}),i.d(E,"len",function(){return Pe}),i.d(E,"sqrLen",function(){return dt}),i.d(E,"forEach",function(){return w});var T=i("yU0y");function m(){var I=new T.a(3);return T.a!=Float32Array&&(I[0]=0,I[1]=0,I[2]=0),I}function X(I){var q=new T.a(3);return q[0]=I[0],q[1]=I[1],q[2]=I[2],q}function z(I){var q=I[0],ce=I[1],Ge=I[2];return Math.hypot(q,ce,Ge)}function o(I,q,ce){var Ge=new T.a(3);return Ge[0]=I,Ge[1]=q,Ge[2]=ce,Ge}function Z(I,q){return I[0]=q[0],I[1]=q[1],I[2]=q[2],I}function D(I,q,ce,Ge){return I[0]=q,I[1]=ce,I[2]=Ge,I}function K(I,q,ce){return I[0]=q[0]+ce[0],I[1]=q[1]+ce[1],I[2]=q[2]+ce[2],I}function re(I,q,ce){return I[0]=q[0]-ce[0],I[1]=q[1]-ce[1],I[2]=q[2]-ce[2],I}function de(I,q,ce){return I[0]=q[0]*ce[0],I[1]=q[1]*ce[1],I[2]=q[2]*ce[2],I}function Y(I,q,ce){return I[0]=q[0]/ce[0],I[1]=q[1]/ce[1],I[2]=q[2]/ce[2],I}function Fe(I,q){return I[0]=Math.ceil(q[0]),I[1]=Math.ceil(q[1]),I[2]=Math.ceil(q[2]),I}function Ze(I,q){return I[0]=Math.floor(q[0]),I[1]=Math.floor(q[1]),I[2]=Math.floor(q[2]),I}function ye(I,q,ce){return I[0]=Math.min(q[0],ce[0]),I[1]=Math.min(q[1],ce[1]),I[2]=Math.min(q[2],ce[2]),I}function we(I,q,ce){return I[0]=Math.max(q[0],ce[0]),I[1]=Math.max(q[1],ce[1]),I[2]=Math.max(q[2],ce[2]),I}function pt(I,q){return I[0]=Math.round(q[0]),I[1]=Math.round(q[1]),I[2]=Math.round(q[2]),I}function je(I,q,ce){return I[0]=q[0]*ce,I[1]=q[1]*ce,I[2]=q[2]*ce,I}function Tt(I,q,ce,Ge){return I[0]=q[0]+ce[0]*Ge,I[1]=q[1]+ce[1]*Ge,I[2]=q[2]+ce[2]*Ge,I}function Xe(I,q){var ce=q[0]-I[0],Ge=q[1]-I[1],$e=q[2]-I[2];return Math.hypot(ce,Ge,$e)}function gt(I,q){var ce=q[0]-I[0],Ge=q[1]-I[1],$e=q[2]-I[2];return ce*ce+Ge*Ge+$e*$e}function Je(I){var q=I[0],ce=I[1],Ge=I[2];return q*q+ce*ce+Ge*Ge}function Et(I,q){return I[0]=-q[0],I[1]=-q[1],I[2]=-q[2],I}function _t(I,q){return I[0]=1/q[0],I[1]=1/q[1],I[2]=1/q[2],I}function Ne(I,q){var ce=q[0],Ge=q[1],$e=q[2],yt=ce*ce+Ge*Ge+$e*$e;return yt>0&&(yt=1/Math.sqrt(yt)),I[0]=q[0]*yt,I[1]=q[1]*yt,I[2]=q[2]*yt,I}function ke(I,q){return I[0]*q[0]+I[1]*q[1]+I[2]*q[2]}function Ue(I,q,ce){var Ge=q[0],$e=q[1],yt=q[2],nt=ce[0],Nt=ce[1],$=ce[2];return I[0]=$e*$-yt*Nt,I[1]=yt*nt-Ge*$,I[2]=Ge*Nt-$e*nt,I}function st(I,q,ce,Ge){var $e=q[0],yt=q[1],nt=q[2];return I[0]=$e+Ge*(ce[0]-$e),I[1]=yt+Ge*(ce[1]-yt),I[2]=nt+Ge*(ce[2]-nt),I}function Le(I,q,ce,Ge,$e,yt){var nt=yt*yt,Nt=nt*(2*yt-3)+1,$=nt*(yt-2)+yt,Ke=nt*(yt-1),ae=nt*(3-2*yt);return I[0]=q[0]*Nt+ce[0]*$+Ge[0]*Ke+$e[0]*ae,I[1]=q[1]*Nt+ce[1]*$+Ge[1]*Ke+$e[1]*ae,I[2]=q[2]*Nt+ce[2]*$+Ge[2]*Ke+$e[2]*ae,I}function ut(I,q,ce,Ge,$e,yt){var nt=1-yt,Nt=nt*nt,$=yt*yt,Ke=Nt*nt,ae=3*yt*Nt,et=3*$*nt,jt=$*yt;return I[0]=q[0]*Ke+ce[0]*ae+Ge[0]*et+$e[0]*jt,I[1]=q[1]*Ke+ce[1]*ae+Ge[1]*et+$e[1]*jt,I[2]=q[2]*Ke+ce[2]*ae+Ge[2]*et+$e[2]*jt,I}function Vt(I,q){q=q||1;var ce=T.c()*2*Math.PI,Ge=T.c()*2-1,$e=Math.sqrt(1-Ge*Ge)*q;return I[0]=Math.cos(ce)*$e,I[1]=Math.sin(ce)*$e,I[2]=Ge*q,I}function Zt(I,q,ce){var Ge=q[0],$e=q[1],yt=q[2],nt=ce[3]*Ge+ce[7]*$e+ce[11]*yt+ce[15];return nt=nt||1,I[0]=(ce[0]*Ge+ce[4]*$e+ce[8]*yt+ce[12])/nt,I[1]=(ce[1]*Ge+ce[5]*$e+ce[9]*yt+ce[13])/nt,I[2]=(ce[2]*Ge+ce[6]*$e+ce[10]*yt+ce[14])/nt,I}function ir(I,q,ce){var Ge=q[0],$e=q[1],yt=q[2];return I[0]=Ge*ce[0]+$e*ce[3]+yt*ce[6],I[1]=Ge*ce[1]+$e*ce[4]+yt*ce[7],I[2]=Ge*ce[2]+$e*ce[5]+yt*ce[8],I}function oe(I,q,ce){var Ge=ce[0],$e=ce[1],yt=ce[2],nt=ce[3],Nt=q[0],$=q[1],Ke=q[2],ae=$e*Ke-yt*$,et=yt*Nt-Ge*Ke,jt=Ge*$-$e*Nt,sr=$e*jt-yt*et,ft=yt*ae-Ge*jt,mt=Ge*et-$e*ae,Ct=nt*2;return ae*=Ct,et*=Ct,jt*=Ct,sr*=2,ft*=2,mt*=2,I[0]=Nt+ae+sr,I[1]=$+et+ft,I[2]=Ke+jt+mt,I}function Q(I,q,ce,Ge){var $e=[],yt=[];return $e[0]=q[0]-ce[0],$e[1]=q[1]-ce[1],$e[2]=q[2]-ce[2],yt[0]=$e[0],yt[1]=$e[1]*Math.cos(Ge)-$e[2]*Math.sin(Ge),yt[2]=$e[1]*Math.sin(Ge)+$e[2]*Math.cos(Ge),I[0]=yt[0]+ce[0],I[1]=yt[1]+ce[1],I[2]=yt[2]+ce[2],I}function H(I,q,ce,Ge){var $e=[],yt=[];return $e[0]=q[0]-ce[0],$e[1]=q[1]-ce[1],$e[2]=q[2]-ce[2],yt[0]=$e[2]*Math.sin(Ge)+$e[0]*Math.cos(Ge),yt[1]=$e[1],yt[2]=$e[2]*Math.cos(Ge)-$e[0]*Math.sin(Ge),I[0]=yt[0]+ce[0],I[1]=yt[1]+ce[1],I[2]=yt[2]+ce[2],I}function Ce(I,q,ce,Ge){var $e=[],yt=[];return $e[0]=q[0]-ce[0],$e[1]=q[1]-ce[1],$e[2]=q[2]-ce[2],yt[0]=$e[0]*Math.cos(Ge)-$e[1]*Math.sin(Ge),yt[1]=$e[0]*Math.sin(Ge)+$e[1]*Math.cos(Ge),yt[2]=$e[2],I[0]=yt[0]+ce[0],I[1]=yt[1]+ce[1],I[2]=yt[2]+ce[2],I}function Ee(I,q){var ce=I[0],Ge=I[1],$e=I[2],yt=q[0],nt=q[1],Nt=q[2],$=Math.sqrt(ce*ce+Ge*Ge+$e*$e),Ke=Math.sqrt(yt*yt+nt*nt+Nt*Nt),ae=$*Ke,et=ae&&ke(I,q)/ae;return Math.acos(Math.min(Math.max(et,-1),1))}function Ae(I){return I[0]=0,I[1]=0,I[2]=0,I}function ge(I){return"vec3("+I[0]+", "+I[1]+", "+I[2]+")"}function rt(I,q){return I[0]===q[0]&&I[1]===q[1]&&I[2]===q[2]}function Yt(I,q){var ce=I[0],Ge=I[1],$e=I[2],yt=q[0],nt=q[1],Nt=q[2];return Math.abs(ce-yt)<=T.b*Math.max(1,Math.abs(ce),Math.abs(yt))&&Math.abs(Ge-nt)<=T.b*Math.max(1,Math.abs(Ge),Math.abs(nt))&&Math.abs($e-Nt)<=T.b*Math.max(1,Math.abs($e),Math.abs(Nt))}var At=re,be=de,xe=Y,Ve=Xe,lt=gt,Pe=z,dt=Je,w=function(){var I=m();return function(q,ce,Ge,$e,yt,nt){var Nt,$;for(ce||(ce=3),Ge||(Ge=0),$e?$=Math.min($e*ce+Ge,q.length):$=q.length,Nt=Ge;Nt<$;Nt+=ce)I[0]=q[Nt],I[1]=q[Nt+1],I[2]=q[Nt+2],yt(I,I,nt),q[Nt]=I[0],q[Nt+1]=I[1],q[Nt+2]=I[2];return q}}()},n2J3:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("xfSm"),m=i("GXnB"),X=i("Ztfv");function z(){return function(o,Z,D){var K=new m.Metadata(T.UNMANAGED_TAG,!0);X.tagParameter(o,Z,D,K)}}E.unmanaged=z},n3AX:function(Re,E,i){var T=i("Nsbk");function m(X,z){for(;!Object.prototype.hasOwnProperty.call(X,z)&&!(X=T(X),X===null););return X}Re.exports=m},"o+pz":function(Re,E,i){"use strict";i.d(E,"a",function(){return T});var T;(function(m){m[m.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",m[m.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",m[m.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",m[m.POINTS=0]="POINTS",m[m.LINES=1]="LINES",m[m.LINE_LOOP=2]="LINE_LOOP",m[m.LINE_STRIP=3]="LINE_STRIP",m[m.TRIANGLES=4]="TRIANGLES",m[m.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",m[m.TRIANGLE_FAN=6]="TRIANGLE_FAN",m[m.ZERO=0]="ZERO",m[m.ONE=1]="ONE",m[m.SRC_COLOR=768]="SRC_COLOR",m[m.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",m[m.SRC_ALPHA=770]="SRC_ALPHA",m[m.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",m[m.DST_ALPHA=772]="DST_ALPHA",m[m.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",m[m.DST_COLOR=774]="DST_COLOR",m[m.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",m[m.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",m[m.FUNC_ADD=32774]="FUNC_ADD",m[m.BLEND_EQUATION=32777]="BLEND_EQUATION",m[m.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",m[m.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",m[m.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",m[m.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",m[m.MAX_EXT=32776]="MAX_EXT",m[m.MIN_EXT=32775]="MIN_EXT",m[m.BLEND_DST_RGB=32968]="BLEND_DST_RGB",m[m.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",m[m.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",m[m.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",m[m.CONSTANT_COLOR=32769]="CONSTANT_COLOR",m[m.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",m[m.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",m[m.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",m[m.BLEND_COLOR=32773]="BLEND_COLOR",m[m.ARRAY_BUFFER=34962]="ARRAY_BUFFER",m[m.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",m[m.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",m[m.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",m[m.STREAM_DRAW=35040]="STREAM_DRAW",m[m.STATIC_DRAW=35044]="STATIC_DRAW",m[m.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",m[m.BUFFER_SIZE=34660]="BUFFER_SIZE",m[m.BUFFER_USAGE=34661]="BUFFER_USAGE",m[m.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",m[m.FRONT=1028]="FRONT",m[m.BACK=1029]="BACK",m[m.FRONT_AND_BACK=1032]="FRONT_AND_BACK",m[m.CULL_FACE=2884]="CULL_FACE",m[m.BLEND=3042]="BLEND",m[m.DITHER=3024]="DITHER",m[m.STENCIL_TEST=2960]="STENCIL_TEST",m[m.DEPTH_TEST=2929]="DEPTH_TEST",m[m.SCISSOR_TEST=3089]="SCISSOR_TEST",m[m.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",m[m.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",m[m.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",m[m.NO_ERROR=0]="NO_ERROR",m[m.INVALID_ENUM=1280]="INVALID_ENUM",m[m.INVALID_VALUE=1281]="INVALID_VALUE",m[m.INVALID_OPERATION=1282]="INVALID_OPERATION",m[m.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",m[m.CW=2304]="CW",m[m.CCW=2305]="CCW",m[m.LINE_WIDTH=2849]="LINE_WIDTH",m[m.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",m[m.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",m[m.CULL_FACE_MODE=2885]="CULL_FACE_MODE",m[m.FRONT_FACE=2886]="FRONT_FACE",m[m.DEPTH_RANGE=2928]="DEPTH_RANGE",m[m.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",m[m.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",m[m.DEPTH_FUNC=2932]="DEPTH_FUNC",m[m.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",m[m.STENCIL_FUNC=2962]="STENCIL_FUNC",m[m.STENCIL_FAIL=2964]="STENCIL_FAIL",m[m.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",m[m.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",m[m.STENCIL_REF=2967]="STENCIL_REF",m[m.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",m[m.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",m[m.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",m[m.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",m[m.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",m[m.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",m[m.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",m[m.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",m[m.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",m[m.VIEWPORT=2978]="VIEWPORT",m[m.SCISSOR_BOX=3088]="SCISSOR_BOX",m[m.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",m[m.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",m[m.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",m[m.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",m[m.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",m[m.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",m[m.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",m[m.RED_BITS=3410]="RED_BITS",m[m.GREEN_BITS=3411]="GREEN_BITS",m[m.BLUE_BITS=3412]="BLUE_BITS",m[m.ALPHA_BITS=3413]="ALPHA_BITS",m[m.DEPTH_BITS=3414]="DEPTH_BITS",m[m.STENCIL_BITS=3415]="STENCIL_BITS",m[m.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",m[m.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",m[m.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",m[m.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",m[m.SAMPLES=32937]="SAMPLES",m[m.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",m[m.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",m[m.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",m[m.DONT_CARE=4352]="DONT_CARE",m[m.FASTEST=4353]="FASTEST",m[m.NICEST=4354]="NICEST",m[m.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",m[m.BYTE=5120]="BYTE",m[m.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",m[m.SHORT=5122]="SHORT",m[m.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",m[m.INT=5124]="INT",m[m.UNSIGNED_INT=5125]="UNSIGNED_INT",m[m.FLOAT=5126]="FLOAT",m[m.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",m[m.ALPHA=6406]="ALPHA",m[m.RGB=6407]="RGB",m[m.RGBA=6408]="RGBA",m[m.LUMINANCE=6409]="LUMINANCE",m[m.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",m[m.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",m[m.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",m[m.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",m[m.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",m[m.VERTEX_SHADER=35633]="VERTEX_SHADER",m[m.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",m[m.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",m[m.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",m[m.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",m[m.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",m[m.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",m[m.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",m[m.SHADER_TYPE=35663]="SHADER_TYPE",m[m.DELETE_STATUS=35712]="DELETE_STATUS",m[m.LINK_STATUS=35714]="LINK_STATUS",m[m.VALIDATE_STATUS=35715]="VALIDATE_STATUS",m[m.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",m[m.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",m[m.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",m[m.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",m[m.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",m[m.NEVER=512]="NEVER",m[m.LESS=513]="LESS",m[m.EQUAL=514]="EQUAL",m[m.LEQUAL=515]="LEQUAL",m[m.GREATER=516]="GREATER",m[m.NOTEQUAL=517]="NOTEQUAL",m[m.GEQUAL=518]="GEQUAL",m[m.ALWAYS=519]="ALWAYS",m[m.KEEP=7680]="KEEP",m[m.REPLACE=7681]="REPLACE",m[m.INCR=7682]="INCR",m[m.DECR=7683]="DECR",m[m.INVERT=5386]="INVERT",m[m.INCR_WRAP=34055]="INCR_WRAP",m[m.DECR_WRAP=34056]="DECR_WRAP",m[m.VENDOR=7936]="VENDOR",m[m.RENDERER=7937]="RENDERER",m[m.VERSION=7938]="VERSION",m[m.NEAREST=9728]="NEAREST",m[m.LINEAR=9729]="LINEAR",m[m.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",m[m.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",m[m.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",m[m.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",m[m.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",m[m.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",m[m.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",m[m.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",m[m.TEXTURE_2D=3553]="TEXTURE_2D",m[m.TEXTURE=5890]="TEXTURE",m[m.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",m[m.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",m[m.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",m[m.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",m[m.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",m[m.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",m[m.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",m[m.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",m[m.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",m[m.TEXTURE0=33984]="TEXTURE0",m[m.TEXTURE1=33985]="TEXTURE1",m[m.TEXTURE2=33986]="TEXTURE2",m[m.TEXTURE3=33987]="TEXTURE3",m[m.TEXTURE4=33988]="TEXTURE4",m[m.TEXTURE5=33989]="TEXTURE5",m[m.TEXTURE6=33990]="TEXTURE6",m[m.TEXTURE7=33991]="TEXTURE7",m[m.TEXTURE8=33992]="TEXTURE8",m[m.TEXTURE9=33993]="TEXTURE9",m[m.TEXTURE10=33994]="TEXTURE10",m[m.TEXTURE11=33995]="TEXTURE11",m[m.TEXTURE12=33996]="TEXTURE12",m[m.TEXTURE13=33997]="TEXTURE13",m[m.TEXTURE14=33998]="TEXTURE14",m[m.TEXTURE15=33999]="TEXTURE15",m[m.TEXTURE16=34e3]="TEXTURE16",m[m.TEXTURE17=34001]="TEXTURE17",m[m.TEXTURE18=34002]="TEXTURE18",m[m.TEXTURE19=34003]="TEXTURE19",m[m.TEXTURE20=34004]="TEXTURE20",m[m.TEXTURE21=34005]="TEXTURE21",m[m.TEXTURE22=34006]="TEXTURE22",m[m.TEXTURE23=34007]="TEXTURE23",m[m.TEXTURE24=34008]="TEXTURE24",m[m.TEXTURE25=34009]="TEXTURE25",m[m.TEXTURE26=34010]="TEXTURE26",m[m.TEXTURE27=34011]="TEXTURE27",m[m.TEXTURE28=34012]="TEXTURE28",m[m.TEXTURE29=34013]="TEXTURE29",m[m.TEXTURE30=34014]="TEXTURE30",m[m.TEXTURE31=34015]="TEXTURE31",m[m.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",m[m.REPEAT=10497]="REPEAT",m[m.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",m[m.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",m[m.FLOAT_VEC2=35664]="FLOAT_VEC2",m[m.FLOAT_VEC3=35665]="FLOAT_VEC3",m[m.FLOAT_VEC4=35666]="FLOAT_VEC4",m[m.INT_VEC2=35667]="INT_VEC2",m[m.INT_VEC3=35668]="INT_VEC3",m[m.INT_VEC4=35669]="INT_VEC4",m[m.BOOL=35670]="BOOL",m[m.BOOL_VEC2=35671]="BOOL_VEC2",m[m.BOOL_VEC3=35672]="BOOL_VEC3",m[m.BOOL_VEC4=35673]="BOOL_VEC4",m[m.FLOAT_MAT2=35674]="FLOAT_MAT2",m[m.FLOAT_MAT3=35675]="FLOAT_MAT3",m[m.FLOAT_MAT4=35676]="FLOAT_MAT4",m[m.SAMPLER_2D=35678]="SAMPLER_2D",m[m.SAMPLER_CUBE=35680]="SAMPLER_CUBE",m[m.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",m[m.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",m[m.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",m[m.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",m[m.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",m[m.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",m[m.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",m[m.COMPILE_STATUS=35713]="COMPILE_STATUS",m[m.LOW_FLOAT=36336]="LOW_FLOAT",m[m.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",m[m.HIGH_FLOAT=36338]="HIGH_FLOAT",m[m.LOW_INT=36339]="LOW_INT",m[m.MEDIUM_INT=36340]="MEDIUM_INT",m[m.HIGH_INT=36341]="HIGH_INT",m[m.FRAMEBUFFER=36160]="FRAMEBUFFER",m[m.RENDERBUFFER=36161]="RENDERBUFFER",m[m.RGBA4=32854]="RGBA4",m[m.RGB5_A1=32855]="RGB5_A1",m[m.RGB565=36194]="RGB565",m[m.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",m[m.STENCIL_INDEX=6401]="STENCIL_INDEX",m[m.STENCIL_INDEX8=36168]="STENCIL_INDEX8",m[m.DEPTH_STENCIL=34041]="DEPTH_STENCIL",m[m.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",m[m.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",m[m.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",m[m.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",m[m.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",m[m.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",m[m.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",m[m.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",m[m.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",m[m.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",m[m.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",m[m.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",m[m.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",m[m.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",m[m.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",m[m.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",m[m.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",m[m.NONE=0]="NONE",m[m.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",m[m.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",m[m.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",m[m.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",m[m.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",m[m.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",m[m.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",m[m.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",m[m.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",m[m.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",m[m.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",m[m.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",m[m.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",m[m.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL"})(T||(T={}))},"oCl/":function(Re,E,i){var T=i("CH3K"),m=i("LcsW"),X=i("MvSz"),z=i("0ycA"),o=Object.getOwnPropertySymbols,Z=o?function(D){for(var K=[];D;)T(K,X(D)),D=m(D);return K}:z;Re.exports=Z},oIFs:function(Re,E,i){Re.exports={"ant-modal":"ant-modal","ant-image-preview":"ant-image-preview","zoom-enter":"zoom-enter","zoom-appear":"zoom-appear","ant-modal-mask":"ant-modal-mask","ant-image-preview-mask":"ant-image-preview-mask","ant-modal-mask-hidden":"ant-modal-mask-hidden","ant-image-preview-mask-hidden":"ant-image-preview-mask-hidden","ant-modal-wrap":"ant-modal-wrap","ant-image-preview-wrap":"ant-image-preview-wrap","ant-skeleton":"ant-skeleton","ant-skeleton-header":"ant-skeleton-header","ant-skeleton-avatar":"ant-skeleton-avatar","ant-skeleton-avatar-circle":"ant-skeleton-avatar-circle","ant-skeleton-avatar-lg":"ant-skeleton-avatar-lg","ant-skeleton-avatar-sm":"ant-skeleton-avatar-sm","ant-skeleton-content":"ant-skeleton-content","ant-skeleton-title":"ant-skeleton-title","ant-skeleton-paragraph":"ant-skeleton-paragraph","ant-skeleton-with-avatar":"ant-skeleton-with-avatar","ant-skeleton-round":"ant-skeleton-round","ant-skeleton-active":"ant-skeleton-active","ant-skeleton-loading":"ant-skeleton-loading","ant-skeleton-button":"ant-skeleton-button","ant-skeleton-input":"ant-skeleton-input","ant-skeleton-image":"ant-skeleton-image","ant-skeleton-element":"ant-skeleton-element","ant-skeleton-button-circle":"ant-skeleton-button-circle","ant-skeleton-button-round":"ant-skeleton-button-round","ant-skeleton-button-lg":"ant-skeleton-button-lg","ant-skeleton-button-sm":"ant-skeleton-button-sm","ant-skeleton-input-lg":"ant-skeleton-input-lg","ant-skeleton-input-sm":"ant-skeleton-input-sm","ant-skeleton-image-circle":"ant-skeleton-image-circle","ant-skeleton-image-path":"ant-skeleton-image-path","ant-skeleton-image-svg":"ant-skeleton-image-svg","ant-skeleton-rtl":"ant-skeleton-rtl","ant-skeleton-loading-rtl":"ant-skeleton-loading-rtl"}},oShl:function(Re,E,i){var T=i("Nsbk"),m=i("SksO"),X=i("xfeJ"),z=i("sXyB");function o(Z){var D=typeof Map=="function"?new Map:void 0;return Re.exports=o=function(re){if(re===null||!X(re))return re;if(typeof re!="function")throw new TypeError("Super expression must either be null or a function");if(typeof D!="undefined"){if(D.has(re))return D.get(re);D.set(re,de)}function de(){return z(re,arguments,T(this).constructor)}return de.prototype=Object.create(re.prototype,{constructor:{value:de,enumerable:!1,writable:!0,configurable:!0}}),m(de,re)},o(Z)}Re.exports=o},oaX6:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("xfSm"),m=i("GXnB"),X=i("Ztfv");function z(o){return function(Z,D,K){var re=new m.Metadata(T.NAME_TAG,o);X.tagParameter(Z,D,K,re)}}E.targetName=z},"otv/":function(Re,E,i){var T=i("nmnc"),m=T?T.prototype:void 0,X=m?m.valueOf:void 0;function z(o){return X?Object(X.call(o)):{}}Re.exports=z},"oy+k":function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("d9O0"),m=function(){function X(z){this.id=T.id(),this.container=z}return X.prototype.addPlan=function(z){this.plan=z},X.prototype.setCurrentRequest=function(z){this.currentRequest=z},X}();E.Context=m},pFRH:function(Re,E,i){var T=i("cvCv"),m=i("O0oS"),X=i("zZ0H"),z=m?function(o,Z){return m(o,"toString",{configurable:!0,enumerable:!1,value:T(Z),writable:!0})}:X;Re.exports=z},q4HE:function(Re,E){var i="\\ud800-\\udfff",T="\\u0300-\\u036f",m="\\ufe20-\\ufe2f",X="\\u20d0-\\u20ff",z=T+m+X,o="\\ufe0e\\ufe0f",Z="["+i+"]",D="["+z+"]",K="\\ud83c[\\udffb-\\udfff]",re="(?:"+D+"|"+K+")",de="[^"+i+"]",Y="(?:\\ud83c[\\udde6-\\uddff]){2}",Fe="[\\ud800-\\udbff][\\udc00-\\udfff]",Ze="\\u200d",ye=re+"?",we="["+o+"]?",pt="(?:"+Ze+"(?:"+[de,Y,Fe].join("|")+")"+we+ye+")*",je=we+ye+pt,Tt="(?:"+[de+D+"?",D,Y,Fe,Z].join("|")+")",Xe=RegExp(K+"(?="+K+")|"+Tt+je,"g");function gt(Je){for(var Et=Xe.lastIndex=0;Xe.test(Je);)++Et;return Et}Re.exports=gt},qK8v:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("MON2");function m(X){return X instanceof RangeError||X.message===T.STACK_OVERFLOW}E.isStackOverflowExeption=m},qRkn:function(Re,E,i){var T=i("3cYt"),m={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},X=T(m);Re.exports=X},qd8s:function(Re,E,i){(function(T,m){var X=200,z="__lodash_hash_undefined__",o=800,Z=16,D=9007199254740991,K="[object Arguments]",re="[object Array]",de="[object AsyncFunction]",Y="[object Boolean]",Fe="[object Date]",Ze="[object Error]",ye="[object Function]",we="[object GeneratorFunction]",pt="[object Map]",je="[object Number]",Tt="[object Null]",Xe="[object Object]",gt="[object Proxy]",Je="[object RegExp]",Et="[object Set]",_t="[object String]",Ne="[object Undefined]",ke="[object WeakMap]",Ue="[object ArrayBuffer]",st="[object DataView]",Le="[object Float32Array]",ut="[object Float64Array]",Vt="[object Int8Array]",Zt="[object Int16Array]",ir="[object Int32Array]",oe="[object Uint8Array]",Q="[object Uint8ClampedArray]",H="[object Uint16Array]",Ce="[object Uint32Array]",Ee=/[\\^$.*+?()[\]{}|]/g,Ae=/^\[object .+?Constructor\]$/,ge=/^(?:0|[1-9]\d*)$/,rt={};rt[Le]=rt[ut]=rt[Vt]=rt[Zt]=rt[ir]=rt[oe]=rt[Q]=rt[H]=rt[Ce]=!0,rt[K]=rt[re]=rt[Ue]=rt[Y]=rt[st]=rt[Fe]=rt[Ze]=rt[ye]=rt[pt]=rt[je]=rt[Xe]=rt[Je]=rt[Et]=rt[_t]=rt[ke]=!1;var Yt=typeof T=="object"&&T&&T.Object===Object&&T,At=typeof self=="object"&&self&&self.Object===Object&&self,be=Yt||At||Function("return this")(),xe=E&&!E.nodeType&&E,Ve=xe&&typeof m=="object"&&m&&!m.nodeType&&m,lt=Ve&&Ve.exports===xe,Pe=lt&&Yt.process,dt=function(){try{var wt=Ve&&Ve.require&&Ve.require("util").types;return wt||Pe&&Pe.binding&&Pe.binding("util")}catch(er){}}(),w=dt&&dt.isTypedArray;function I(wt,er,Ar){switch(Ar.length){case 0:return wt.call(er);case 1:return wt.call(er,Ar[0]);case 2:return wt.call(er,Ar[0],Ar[1]);case 3:return wt.call(er,Ar[0],Ar[1],Ar[2])}return wt.apply(er,Ar)}function q(wt,er){for(var Ar=-1,Bn=Array(wt);++Ar<wt;)Bn[Ar]=er(Ar);return Bn}function ce(wt){return function(er){return wt(er)}}function Ge(wt,er){return wt==null?void 0:wt[er]}function $e(wt,er){return function(Ar){return wt(er(Ar))}}var yt=Array.prototype,nt=Function.prototype,Nt=Object.prototype,$=be["__core-js_shared__"],Ke=nt.toString,ae=Nt.hasOwnProperty,et=function(){var wt=/[^.]+$/.exec($&&$.keys&&$.keys.IE_PROTO||"");return wt?"Symbol(src)_1."+wt:""}(),jt=Nt.toString,sr=Ke.call(Object),ft=RegExp("^"+Ke.call(ae).replace(Ee,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),mt=lt?be.Buffer:void 0,Ct=be.Symbol,vt=be.Uint8Array,Oe=mt?mt.allocUnsafe:void 0,ct=$e(Object.getPrototypeOf,Object),Qe=Object.create,Ft=Nt.propertyIsEnumerable,vr=yt.splice,Vr=Ct?Ct.toStringTag:void 0,lr=function(){try{var wt=so(Object,"defineProperty");return wt({},"",{}),wt}catch(er){}}(),Nn=mt?mt.isBuffer:void 0,vn=Math.max,na=Date.now,ha=so(be,"Map"),Zn=so(Object,"create"),Hn=function(){function wt(){}return function(er){if(!_o(er))return{};if(Qe)return Qe(er);wt.prototype=er;var Ar=new wt;return wt.prototype=void 0,Ar}}();function F(wt){var er=-1,Ar=wt==null?0:wt.length;for(this.clear();++er<Ar;){var Bn=wt[er];this.set(Bn[0],Bn[1])}}function W(){this.__data__=Zn?Zn(null):{},this.size=0}function le(wt){var er=this.has(wt)&&delete this.__data__[wt];return this.size-=er?1:0,er}function me(wt){var er=this.__data__;if(Zn){var Ar=er[wt];return Ar===z?void 0:Ar}return ae.call(er,wt)?er[wt]:void 0}function at(wt){var er=this.__data__;return Zn?er[wt]!==void 0:ae.call(er,wt)}function bt(wt,er){var Ar=this.__data__;return this.size+=this.has(wt)?0:1,Ar[wt]=Zn&&er===void 0?z:er,this}F.prototype.clear=W,F.prototype.delete=le,F.prototype.get=me,F.prototype.has=at,F.prototype.set=bt;function He(wt){var er=-1,Ar=wt==null?0:wt.length;for(this.clear();++er<Ar;){var Bn=wt[er];this.set(Bn[0],Bn[1])}}function ht(){this.__data__=[],this.size=0}function Qt(wt){var er=this.__data__,Ar=Ri(er,wt);if(Ar<0)return!1;var Bn=er.length-1;return Ar==Bn?er.pop():vr.call(er,Ar,1),--this.size,!0}function qt(wt){var er=this.__data__,Ar=Ri(er,wt);return Ar<0?void 0:er[Ar][1]}function Nr(wt){return Ri(this.__data__,wt)>-1}function qr(wt,er){var Ar=this.__data__,Bn=Ri(Ar,wt);return Bn<0?(++this.size,Ar.push([wt,er])):Ar[Bn][1]=er,this}He.prototype.clear=ht,He.prototype.delete=Qt,He.prototype.get=qt,He.prototype.has=Nr,He.prototype.set=qr;function or(wt){var er=-1,Ar=wt==null?0:wt.length;for(this.clear();++er<Ar;){var Bn=wt[er];this.set(Bn[0],Bn[1])}}function Br(){this.size=0,this.__data__={hash:new F,map:new(ha||He),string:new F}}function Tn(wt){var er=ms(this,wt).delete(wt);return this.size-=er?1:0,er}function dr(wt){return ms(this,wt).get(wt)}function Xr(wt){return ms(this,wt).has(wt)}function dn(wt,er){var Ar=ms(this,wt),Bn=Ar.size;return Ar.set(wt,er),this.size+=Ar.size==Bn?0:1,this}or.prototype.clear=Br,or.prototype.delete=Tn,or.prototype.get=dr,or.prototype.has=Xr,or.prototype.set=dn;function Kn(wt){var er=this.__data__=new He(wt);this.size=er.size}function gn(){this.__data__=new He,this.size=0}function ur(wt){var er=this.__data__,Ar=er.delete(wt);return this.size=er.size,Ar}function kn(wt){return this.__data__.get(wt)}function An(wt){return this.__data__.has(wt)}function Za(wt,er){var Ar=this.__data__;if(Ar instanceof He){var Bn=Ar.__data__;if(!ha||Bn.length<X-1)return Bn.push([wt,er]),this.size=++Ar.size,this;Ar=this.__data__=new or(Bn)}return Ar.set(wt,er),this.size=Ar.size,this}Kn.prototype.clear=gn,Kn.prototype.delete=ur,Kn.prototype.get=kn,Kn.prototype.has=An,Kn.prototype.set=Za;function ea(wt,er){var Ar=ql(wt),Bn=!Ar&&tl(wt),Qa=!Ar&&!Bn&&vs(wt),Ii=!Ar&&!Bn&&!Qa&&bl(wt),Ki=Ar||Bn||Qa||Ii,ja=Ki?q(wt.length,String):[],pi=ja.length;for(var Zo in wt)(er||ae.call(wt,Zo))&&!(Ki&&(Zo=="length"||Qa&&(Zo=="offset"||Zo=="parent")||Ii&&(Zo=="buffer"||Zo=="byteLength"||Zo=="byteOffset")||Eo(Zo,pi)))&&ja.push(Zo);return ja}function ca(wt,er,Ar){(Ar!==void 0&&!To(wt[er],Ar)||Ar===void 0&&!(er in wt))&&va(wt,er,Ar)}function bo(wt,er,Ar){var Bn=wt[er];(!(ae.call(wt,er)&&To(Bn,Ar))||Ar===void 0&&!(er in wt))&&va(wt,er,Ar)}function Ri(wt,er){for(var Ar=wt.length;Ar--;)if(To(wt[Ar][0],er))return Ar;return-1}function va(wt,er,Ar){er=="__proto__"&&lr?lr(wt,er,{configurable:!0,enumerable:!0,value:Ar,writable:!0}):wt[er]=Ar}var ii=xo();function Ia(wt){return wt==null?wt===void 0?Ne:Tt:Vr&&Vr in Object(wt)?Uu(wt):en(wt)}function Ln(wt){return Po(wt)&&Ia(wt)==K}function Ei(wt){if(!_o(wt)||Ie(wt))return!1;var er=Bu(wt)?ft:Ae;return er.test(Mo(wt))}function Wi(wt){return Po(wt)&&ws(wt.length)&&!!rt[Ia(wt)]}function qa(wt){if(!_o(wt))return cr(wt);var er=Mt(wt),Ar=[];for(var Bn in wt)Bn=="constructor"&&(er||!ae.call(wt,Bn))||Ar.push(Bn);return Ar}function Oo(wt,er,Ar,Bn,Qa){if(wt===er)return;ii(er,function(Ii,Ki){if(Qa||(Qa=new Kn),_o(Ii))Ml(wt,er,Ki,Ar,Oo,Bn,Qa);else{var ja=Bn?Bn(jn(wt,Ki),Ii,Ki+"",wt,er,Qa):void 0;ja===void 0&&(ja=Ii),ca(wt,Ki,ja)}},ka)}function Ml(wt,er,Ar,Bn,Qa,Ii,Ki){var ja=jn(wt,Ar),pi=jn(er,Ar),Zo=Ki.get(pi);if(Zo){ca(wt,Ar,Zo);return}var Ci=Ii?Ii(ja,pi,Ar+"",wt,er,Ki):void 0,Xo=Ci===void 0;if(Xo){var Au=ql(pi),du=!Au&&vs(pi),Ds=!Au&&!du&&bl(pi);Ci=pi,Au||du||Ds?ql(ja)?Ci=ja:jc(ja)?Ci=Fu(ja):du?(Xo=!1,Ci=Cs(pi,!0)):Ds?(Xo=!1,Ci=Na(pi,!0)):Ci=[]:$s(pi)||tl(pi)?(Ci=ja,tl(ja)?Ci=Su(ja):(!_o(ja)||Bu(ja))&&(Ci=Ys(pi))):Xo=!1}Xo&&(Ki.set(pi,Ci),Qa(Ci,pi,Bn,Ii,Ki),Ki.delete(pi)),ca(wt,Ar,Ci)}function cu(wt,er){return Fi(bn(wt,er,Js),wt+"")}var fa=lr?function(wt,er){return lr(wt,"toString",{configurable:!0,enumerable:!1,value:ec(er),writable:!0})}:Js;function Cs(wt,er){if(er)return wt.slice();var Ar=wt.length,Bn=Oe?Oe(Ar):new wt.constructor(Ar);return wt.copy(Bn),Bn}function oo(wt){var er=new wt.constructor(wt.byteLength);return new vt(er).set(new vt(wt)),er}function Na(wt,er){var Ar=er?oo(wt.buffer):wt.buffer;return new wt.constructor(Ar,wt.byteOffset,wt.length)}function Fu(wt,er){var Ar=-1,Bn=wt.length;for(er||(er=Array(Bn));++Ar<Bn;)er[Ar]=wt[Ar];return er}function Ai(wt,er,Ar,Bn){var Qa=!Ar;Ar||(Ar={});for(var Ii=-1,Ki=er.length;++Ii<Ki;){var ja=er[Ii],pi=Bn?Bn(Ar[ja],wt[ja],ja,Ar,wt):void 0;pi===void 0&&(pi=wt[ja]),Qa?va(Ar,ja,pi):bo(Ar,ja,pi)}return Ar}function li(wt){return cu(function(er,Ar){var Bn=-1,Qa=Ar.length,Ii=Qa>1?Ar[Qa-1]:void 0,Ki=Qa>2?Ar[2]:void 0;for(Ii=wt.length>3&&typeof Ii=="function"?(Qa--,Ii):void 0,Ki&&fu(Ar[0],Ar[1],Ki)&&(Ii=Qa<3?void 0:Ii,Qa=1),er=Object(er);++Bn<Qa;){var ja=Ar[Bn];ja&&wt(er,ja,Bn,Ii)}return er})}function xo(wt){return function(er,Ar,Bn){for(var Qa=-1,Ii=Object(er),Ki=Bn(er),ja=Ki.length;ja--;){var pi=Ki[wt?ja:++Qa];if(Ar(Ii[pi],pi,Ii)===!1)break}return er}}function ms(wt,er){var Ar=wt.__data__;return Ut(er)?Ar[typeof er=="string"?"string":"hash"]:Ar.map}function so(wt,er){var Ar=Ge(wt,er);return Ei(Ar)?Ar:void 0}function Uu(wt){var er=ae.call(wt,Vr),Ar=wt[Vr];try{wt[Vr]=void 0;var Bn=!0}catch(Ii){}var Qa=jt.call(wt);return Bn&&(er?wt[Vr]=Ar:delete wt[Vr]),Qa}function Ys(wt){return typeof wt.constructor=="function"&&!Mt(wt)?Hn(ct(wt)):{}}function Eo(wt,er){var Ar=typeof wt;return er=er==null?D:er,!!er&&(Ar=="number"||Ar!="symbol"&&ge.test(wt))&&wt>-1&&wt%1==0&&wt<er}function fu(wt,er,Ar){if(!_o(Ar))return!1;var Bn=typeof er;return(Bn=="number"?Ks(Ar)&&Eo(er,Ar.length):Bn=="string"&&er in Ar)?To(Ar[er],wt):!1}function Ut(wt){var er=typeof wt;return er=="string"||er=="number"||er=="symbol"||er=="boolean"?wt!=="__proto__":wt===null}function Ie(wt){return!!et&&et in wt}function Mt(wt){var er=wt&&wt.constructor,Ar=typeof er=="function"&&er.prototype||Nt;return wt===Ar}function cr(wt){var er=[];if(wt!=null)for(var Ar in Object(wt))er.push(Ar);return er}function en(wt){return jt.call(wt)}function bn(wt,er,Ar){return er=vn(er===void 0?wt.length-1:er,0),function(){for(var Bn=arguments,Qa=-1,Ii=vn(Bn.length-er,0),Ki=Array(Ii);++Qa<Ii;)Ki[Qa]=Bn[er+Qa];Qa=-1;for(var ja=Array(er+1);++Qa<er;)ja[Qa]=Bn[Qa];return ja[er]=Ar(Ki),I(wt,this,ja)}}function jn(wt,er){return er==="constructor"&&typeof wt[er]=="function"||er=="__proto__"?void 0:wt[er]}var Fi=qi(fa);function qi(wt){var er=0,Ar=0;return function(){var Bn=na(),Qa=Z-(Bn-Ar);if(Ar=Bn,Qa>0){if(++er>=o)return arguments[0]}else er=0;return wt.apply(void 0,arguments)}}function Mo(wt){if(wt!=null){try{return Ke.call(wt)}catch(er){}try{return wt+""}catch(er){}}return""}function To(wt,er){return wt===er||wt!==wt&&er!==er}var tl=Ln(function(){return arguments}())?Ln:function(wt){return Po(wt)&&ae.call(wt,"callee")&&!Ft.call(wt,"callee")},ql=Array.isArray;function Ks(wt){return wt!=null&&ws(wt.length)&&!Bu(wt)}function jc(wt){return Po(wt)&&Ks(wt)}var vs=Nn||ns;function Bu(wt){if(!_o(wt))return!1;var er=Ia(wt);return er==ye||er==we||er==de||er==gt}function ws(wt){return typeof wt=="number"&&wt>-1&&wt%1==0&&wt<=D}function _o(wt){var er=typeof wt;return wt!=null&&(er=="object"||er=="function")}function Po(wt){return wt!=null&&typeof wt=="object"}function $s(wt){if(!Po(wt)||Ia(wt)!=Xe)return!1;var er=ct(wt);if(er===null)return!0;var Ar=ae.call(er,"constructor")&&er.constructor;return typeof Ar=="function"&&Ar instanceof Ar&&Ke.call(Ar)==sr}var bl=w?ce(w):Wi;function Su(wt){return Ai(wt,ka(wt))}function ka(wt){return Ks(wt)?ea(wt,!0):qa(wt)}var hu=li(function(wt,er,Ar,Bn){Oo(wt,er,Ar,Bn)});function ec(wt){return function(){return wt}}function Js(wt){return wt}function ns(){return!1}m.exports=hu}).call(this,i("yLpj"),i("YuTi")(Re))},quyA:function(Re,E){var i="\\ud800-\\udfff",T="\\u0300-\\u036f",m="\\ufe20-\\ufe2f",X="\\u20d0-\\u20ff",z=T+m+X,o="\\ufe0e\\ufe0f",Z="\\u200d",D=RegExp("["+Z+i+z+o+"]");function K(re){return D.test(re)}Re.exports=K},qxNg:function(Re,E,i){"use strict";i.d(E,"a",function(){return D});var T=i("lSNA"),m=i.n(T),X=i("mpbz"),z=i.n(X);function o(re,de){var Y=Object.keys(re);if(Object.getOwnPropertySymbols){var Fe=Object.getOwnPropertySymbols(re);de&&(Fe=Fe.filter(function(Ze){return Object.getOwnPropertyDescriptor(re,Ze).enumerable})),Y.push.apply(Y,Fe)}return Y}function Z(re){for(var de=1;de<arguments.length;de++){var Y=arguments[de]!=null?arguments[de]:{};de%2?o(Object(Y),!0).forEach(function(Fe){m()(re,Fe,Y[Fe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(re,Object.getOwnPropertyDescriptors(Y)):o(Object(Y)).forEach(function(Fe){Object.defineProperty(re,Fe,Object.getOwnPropertyDescriptor(Y,Fe))})}return re}function D(re,de){var Y=de.radius,Fe=Y===void 0?40:Y,Ze=de.maxZoom,ye=Ze===void 0?18:Ze,we=de.minZoom,pt=we===void 0?0:we,je=de.zoom,Tt=je===void 0?2:je;if(re.pointIndex){var Xe=re.pointIndex.getClusters(re.extent,Math.floor(Tt));return re.dataArray=K(Xe),re}var gt=new z.a({radius:Fe,minZoom:pt,maxZoom:ye}),Je={type:"FeatureCollection",features:[]};return Je.features=re.dataArray.map(function(Et){return{type:"Feature",geometry:{type:"Point",coordinates:Et.coordinates},properties:Z({},Et)}}),gt.load(Je.features),gt}function K(re){return re.map(function(de,Y){return Z({coordinates:de.geometry.coordinates,_id:Y+1},de.properties)})}},riiI:function(Re,E){},rlAn:function(Re,E,i){"use strict";var T=i("ISu3"),m=i("gMG2"),X=i("5gLl"),z=i("BpBL"),o=i("5zYK"),Z=i("lJbI"),D=i("l94r"),K=i("qxNg"),re=i("Y8BV"),de=i("VIsB"),Y=i("+VLl"),Fe=i("aF1E"),Ze=i("fdMe");i.d(E,"getTransform",function(){return T.b}),i.d(E,"getParser",function(){return T.a});var ye=i("U1ZX"),we=i.n(ye);E.default=D.a,Object(T.c)("geojson",X.a),Object(T.c)("image",z.a),Object(T.c)("csv",m.a),Object(T.c)("json",o.a),Object(T.c)("raster",Z.a),Object(T.d)("cluster",K.a),Object(T.d)("filter",re.a),Object(T.d)("join",Fe.a),Object(T.d)("map",Ze.a),Object(T.d)("grid",de.a),Object(T.d)("hexagon",Y.a)},rxlC:function(Re,E,i){"use strict";Re.exports=m,Re.exports.default=m;var T=1e20;function m(o,Z,D,K,re,de){this.fontSize=o||24,this.buffer=Z===void 0?3:Z,this.cutoff=K||.25,this.fontFamily=re||"sans-serif",this.fontWeight=de||"normal",this.radius=D||8;var Y=this.size=this.fontSize+this.buffer*2;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=Y,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(Y*Y),this.gridInner=new Float64Array(Y*Y),this.f=new Float64Array(Y),this.d=new Float64Array(Y),this.z=new Float64Array(Y+1),this.v=new Int16Array(Y),this.middle=Math.round(Y/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}m.prototype.draw=function(o){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(o,this.buffer,this.middle);for(var Z=this.ctx.getImageData(0,0,this.size,this.size),D=new Uint8ClampedArray(this.size*this.size),K=0;K<this.size*this.size;K++){var re=Z.data[K*4+3]/255;this.gridOuter[K]=re===1?0:re===0?T:Math.pow(Math.max(0,.5-re),2),this.gridInner[K]=re===1?T:re===0?0:Math.pow(Math.max(0,re-.5),2)}for(X(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),X(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),K=0;K<this.size*this.size;K++){var de=this.gridOuter[K]-this.gridInner[K];D[K]=Math.max(0,Math.min(255,Math.round(255-255*(de/this.radius+this.cutoff))))}return D};function X(o,Z,D,K,re,de,Y){for(var Fe=0;Fe<Z;Fe++){for(var Ze=0;Ze<D;Ze++)K[Ze]=o[Ze*Z+Fe];for(z(K,re,de,Y,D),Ze=0;Ze<D;Ze++)o[Ze*Z+Fe]=re[Ze]}for(Ze=0;Ze<D;Ze++){for(Fe=0;Fe<Z;Fe++)K[Fe]=o[Ze*Z+Fe];for(z(K,re,de,Y,Z),Fe=0;Fe<Z;Fe++)o[Ze*Z+Fe]=Math.sqrt(re[Fe])}}function z(o,Z,D,K,re){D[0]=0,K[0]=-T,K[1]=+T;for(var de=1,Y=0;de<re;de++){for(var Fe=(o[de]+de*de-(o[D[Y]]+D[Y]*D[Y]))/(2*de-2*D[Y]);Fe<=K[Y];)Y--,Fe=(o[de]+de*de-(o[D[Y]]+D[Y]*D[Y]))/(2*de-2*D[Y]);Y++,D[Y]=de,K[Y]=Fe,K[Y+1]=+T}for(de=0,Y=0;de<re;de++){for(;K[Y+1]<de;)Y++;Z[de]=(de-D[Y])*(de-D[Y])+o[D[Y]]}}},sGsY:function(Re,E,i){"use strict";var T=i("lSNA"),m=i.n(T),X=i("pVnL"),z=i.n(X),o=i("q1tI"),Z=i("TSYQ"),D=i.n(Z),K=i("H84U"),re=i("/ezw"),de=i("B6l+"),Y=i.n(de),Fe=function(ge){var rt=ge.value,Yt=ge.formatter,At=ge.precision,be=ge.decimalSeparator,xe=ge.groupSeparator,Ve=xe===void 0?"":xe,lt=ge.prefixCls,Pe;if(typeof Yt=="function")Pe=Yt(rt);else{var dt=String(rt),w=dt.match(/^(-?)(\d*)(\.(\d+))?$/);if(!w||dt==="-")Pe=dt;else{var I=w[1],q=w[2]||"0",ce=w[4]||"";q=q.replace(/\B(?=(\d{3})+(?!\d))/g,Ve),typeof At=="number"&&(ce=Y()(ce,At,"0").slice(0,At)),ce&&(ce="".concat(be).concat(ce)),Pe=[o.createElement("span",{key:"int",className:"".concat(lt,"-content-value-int")},I,q),ce&&o.createElement("span",{key:"decimal",className:"".concat(lt,"-content-value-decimal")},ce)]}}return o.createElement("span",{className:"".concat(lt,"-content-value")},Pe)},Ze=Fe,ye=function(ge){var rt=ge.prefixCls,Yt=ge.className,At=ge.style,be=ge.valueStyle,xe=ge.value,Ve=xe===void 0?0:xe,lt=ge.title,Pe=ge.valueRender,dt=ge.prefix,w=ge.suffix,I=ge.loading,q=ge.direction,ce=ge.onMouseEnter,Ge=ge.onMouseLeave,$e=o.createElement(Ze,z()({},ge,{value:Ve})),yt=D()(rt,m()({},"".concat(rt,"-rtl"),q==="rtl"),Yt);return o.createElement("div",{className:yt,style:At,onMouseEnter:ce,onMouseLeave:Ge},lt&&o.createElement("div",{className:"".concat(rt,"-title")},lt),o.createElement(re.a,{paragraph:!1,loading:I},o.createElement("div",{style:be,className:"".concat(rt,"-content")},dt&&o.createElement("span",{className:"".concat(rt,"-content-prefix")},dt),Pe?Pe($e):$e,w&&o.createElement("span",{className:"".concat(rt,"-content-suffix")},w))))};ye.defaultProps={decimalSeparator:".",groupSeparator:",",loading:!1};var we=Object(K.c)({prefixCls:"statistic"})(ye),pt=we,je=i("lwsE"),Tt=i.n(je),Xe=i("W8MJ"),gt=i.n(Xe),Je=i("7W2i"),Et=i.n(Je),_t=i("LQ03"),Ne=i.n(_t),ke=i("J4zp"),Ue=i.n(ke),st=i("QQZ/"),Le=i.n(st),ut=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]];function Vt(Ae,ge){var rt=Ae,Yt=/\[[^\]]*]/g,At=(ge.match(Yt)||[]).map(function(lt){return lt.slice(1,-1)}),be=ge.replace(Yt,"[]"),xe=ut.reduce(function(lt,Pe){var dt=Ue()(Pe,2),w=dt[0],I=dt[1];if(lt.indexOf(w)!==-1){var q=Math.floor(rt/I);return rt-=q*I,lt.replace(new RegExp("".concat(w,"+"),"g"),function(ce){var Ge=ce.length;return Le()(q.toString(),Ge,"0")})}return lt},be),Ve=0;return xe.replace(Yt,function(){var lt=At[Ve];return Ve+=1,lt})}function Zt(Ae,ge){var rt=ge.format,Yt=rt===void 0?"":rt,At=new Date(Ae).getTime(),be=Date.now(),xe=Math.max(At-be,0);return Vt(xe,Yt)}var ir=i("0n0R"),oe=1e3/30;function Q(Ae){return new Date(Ae).getTime()}var H=function(Ae){Et()(rt,Ae);var ge=Ne()(rt);function rt(){var Yt;return Tt()(this,rt),Yt=ge.apply(this,arguments),Yt.syncTimer=function(){var At=Yt.props.value,be=Q(At);be>=Date.now()?Yt.startTimer():Yt.stopTimer()},Yt.startTimer=function(){if(Yt.countdownId)return;Yt.countdownId=window.setInterval(function(){Yt.forceUpdate()},oe)},Yt.stopTimer=function(){var At=Yt.props,be=At.onFinish,xe=At.value;if(Yt.countdownId){clearInterval(Yt.countdownId),Yt.countdownId=void 0;var Ve=Q(xe);be&&Ve<Date.now()&&be()}},Yt.formatCountdown=function(At,be){var xe=Yt.props.format;return Zt(At,z()(z()({},be),{format:xe}))},Yt.valueRender=function(At){return Object(ir.a)(At,{title:void 0})},Yt}return gt()(rt,[{key:"componentDidMount",value:function(){this.syncTimer()}},{key:"componentDidUpdate",value:function(){this.syncTimer()}},{key:"componentWillUnmount",value:function(){this.stopTimer()}},{key:"render",value:function(){return o.createElement(pt,z()({valueRender:this.valueRender},this.props,{formatter:this.formatCountdown}))}}]),rt}(o.Component);H.defaultProps={format:"HH:mm:ss"};var Ce=H;pt.Countdown=Ce;var Ee=E.a=pt},sKgW:function(Re,E){var i=9007199254740991,T=Math.floor;function m(X,z){var o="";if(!X||z<1||z>i)return o;do z%2&&(o+=X),z=T(z/2),z&&(X+=X);while(z);return o}Re.exports=m},sXyB:function(Re,E,i){var T=i("SksO"),m=i("b48C");function X(z,o,Z){return m()?Re.exports=X=Reflect.construct:Re.exports=X=function(K,re,de){var Y=[null];Y.push.apply(Y,re);var Fe=Function.bind.apply(K,Y),Ze=new Fe;return de&&T(Ze,de.prototype),Ze},X.apply(null,arguments)}Re.exports=X},sgoq:function(Re,E,i){var T=i("asDA"),m=i("TKrE"),X=i("6nK8"),z="['\u2019]",o=RegExp(z,"g");function Z(D){return function(K){return T(X(m(K).replace(o,"")),D,"")}}Re.exports=Z},sxDa:function(Re,E,i){"use strict";i.d(E,"e",function(){return ks}),i.d(E,"f",function(){return sl}),i.d(E,"d",function(){return nl}),i.d(E,"a",function(){return ms}),i.d(E,"c",function(){return pi}),i.d(E,"g",function(){return uc}),i.d(E,"b",function(){return Js});var T=i("h1nZ"),m=i("lwsE"),X=i.n(m),z=i("W8MJ"),o=i.n(z),Z=i("7W2i"),D=i.n(Z),K=i("a1gu"),re=i.n(K),de=i("Nsbk"),Y=i.n(de),Fe=i("QILm"),Ze=i.n(Fe),ye=i("lSNA"),we=i.n(ye),pt=i("yG8O"),je=i.n(pt),Tt=i("PJYZ"),Xe=i.n(Tt),gt=i("U+yc"),Je=i.n(gt),Et=i("1ABj"),_t=i("GoyQ"),Ne=i.n(_t),ke=i("lSCD"),Ue=i.n(ke),st=i("xp6e"),Le=i("Hel2"),ut=i("uhBA"),Vt=i("4U9+"),Zt=i.n(Vt),ir=i("4cb6"),oe,Q,H,Ce,Ee,Ae;function ge(d){return d.map(function(S){return typeof S=="string"&&(S=[S,{}]),S})}var rt=(oe=Object(ir.injectable)(),Q=Object(ir.inject)(T.TYPES.IGlobalConfigService),oe(H=(Ce=(Ae=function(){function d(){X()(this,d),je()(this,"configService",Ee,this),this.enabled=void 0}return o()(d,[{key:"apply",value:function(_,x){var C=this,M=x.rendererService,U=x.postProcessingPassFactory,ie=x.normalPassFactory;_.hooks.init.tap("MultiPassRendererPlugin",function(){var ve=_.getLayerConfig(),Be=ve.enableMultiPassRenderer,Lt=ve.passes,$t=Lt===void 0?[]:Lt;C.enabled=!!Be&&_.getLayerConfig().enableMultiPassRenderer!==!1,C.enabled&&(_.multiPassRenderer=C.createMultiPassRenderer(_,$t,U,ie),_.multiPassRenderer.setRenderFlag(!0))}),_.hooks.beforeRender.tap("MultiPassRendererPlugin",function(){})}},{key:"createMultiPassRenderer",value:function(_,x,C,M){var U=_.multiPassRenderer,ie=_.getLayerConfig(),ve=ie.enablePicking,Be=ie.enableTAA;return ve&&U.add(M("pixelPicking")),U}}]),d}(),Ae),Ee=Je()(Ce.prototype,"configService",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ce))||H),Yt,At=(Yt={},we()(Yt,T.BlendType.additive,{enable:!0,func:{srcRGB:T.gl.ONE,dstRGB:T.gl.ONE,srcAlpha:1,dstAlpha:1}}),we()(Yt,T.BlendType.normal,{enable:!0,func:{srcRGB:T.gl.SRC_ALPHA,dstRGB:T.gl.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),we()(Yt,T.BlendType.subtractive,{enable:!0,func:{srcRGB:T.gl.ONE,dstRGB:T.gl.ONE,srcAlpha:T.gl.ZERO,dstAlpha:T.gl.ONE_MINUS_SRC_COLOR},equation:{rgb:T.gl.FUNC_SUBTRACT,alpha:T.gl.FUNC_SUBTRACT}}),we()(Yt,T.BlendType.max,{enable:!0,func:{srcRGB:T.gl.ONE,dstRGB:T.gl.ONE},equation:{rgb:T.gl.MAX_EXT}}),we()(Yt,T.BlendType.min,{enable:!0,func:{srcRGB:T.gl.ONE,dstRGB:T.gl.ONE},equation:{rgb:T.gl.MIN_EXT}}),Yt),be={properties:{enablePicking:{type:"boolean"},enableHighlight:{type:"boolean"},highlightColor:{oneOf:[{type:"array",items:{type:"number",minimum:0,maximum:1}},{type:"string"}]}}},xe,Ve,lt,Pe,dt,w,I,q;function ce(d,S){var _;if(typeof Symbol=="undefined"||d[Symbol.iterator]==null){if(Array.isArray(d)||(_=Ge(d))||S&&d&&typeof d.length=="number"){_&&(d=_);var x=0,C=function(){};return{s:C,n:function(){return x>=d.length?{done:!0}:{done:!1,value:d[x++]}},e:function(Be){throw Be},f:C}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,U=!1,ie;return{s:function(){_=d[Symbol.iterator]()},n:function(){var Be=_.next();return M=Be.done,Be},e:function(Be){U=!0,ie=Be},f:function(){try{!M&&_.return!=null&&_.return()}finally{if(U)throw ie}}}}function Ge(d,S){if(!d)return;if(typeof d=="string")return $e(d,S);var _=Object.prototype.toString.call(d).slice(8,-1);if(_==="Object"&&d.constructor&&(_=d.constructor.name),_==="Map"||_==="Set")return Array.from(d);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return $e(d,S)}function $e(d,S){(S==null||S>d.length)&&(S=d.length);for(var _=0,x=new Array(S);_<S;_++)x[_]=d[_];return x}function yt(d,S){var _=Object.keys(d);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(d);S&&(x=x.filter(function(C){return Object.getOwnPropertyDescriptor(d,C).enumerable})),_.push.apply(_,x)}return _}function nt(d){for(var S=1;S<arguments.length;S++){var _=arguments[S]!=null?arguments[S]:{};S%2?yt(Object(_),!0).forEach(function(x){we()(d,x,_[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(_)):yt(Object(_)).forEach(function(x){Object.defineProperty(d,x,Object.getOwnPropertyDescriptor(_,x))})}return d}function Nt(d){var S=$();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function $(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Ke=0,ae=(xe=Object(T.lazyInject)(T.TYPES.ILogService),Ve=Object(T.lazyInject)(T.TYPES.IGlobalConfigService),lt=Object(T.lazyInject)(T.TYPES.IShaderModuleService),Pe=(q=function(d){D()(_,d);var S=Nt(_);function _(){var x,C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return X()(this,_),x=S.call(this),x.id="".concat(Ke++),x.name="".concat(Ke),x.type=void 0,x.visible=!0,x.zIndex=0,x.minZoom=void 0,x.maxZoom=void 0,x.inited=!1,x.layerModelNeedUpdate=!1,x.pickedFeatureID=null,x.selectedFeatureID=null,x.styleNeedUpdate=!1,x.dataState={dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1},x.hooks={init:new st.b,afterInit:new st.b,beforeRender:new st.b,beforeRenderData:new st.d,afterRender:new st.c,beforePickingEncode:new st.c,afterPickingEncode:new st.c,beforeHighlight:new st.c(["pickedColor"]),afterHighlight:new st.c,beforeSelect:new st.c(["pickedColor"]),afterSelect:new st.c,beforeDestroy:new st.c,afterDestroy:new st.c},x.models=[],x.multiPassRenderer=void 0,x.plugins=void 0,x.sourceOption=void 0,x.layerModel=void 0,je()(x,"logger",dt,Xe()(x)),je()(x,"configService",w,Xe()(x)),je()(x,"shaderModuleService",I,Xe()(x)),x.cameraService=void 0,x.coordinateService=void 0,x.iconService=void 0,x.fontService=void 0,x.rendererService=void 0,x.layerService=void 0,x.interactionService=void 0,x.mapService=void 0,x.styleAttributeService=void 0,x.layerSource=void 0,x.postProcessingPassFactory=void 0,x.normalPassFactory=void 0,x.animateOptions={enable:!1},x.container=void 0,x.encodedData=void 0,x.configSchema=void 0,x.currentPickId=null,x.rawConfig=void 0,x.needUpdateConfig=void 0,x.pendingStyleAttributes=[],x.scaleOptions={},x.animateStartTime=void 0,x.aniamateStatus=!1,x.sourceEvent=function(){x.dataState.dataSourceNeedUpdate=!0;var M=x.getLayerConfig(),U=M.autoFit,ie=M.fitBoundsOptions;U&&x.fitBounds(ie),x.emit("dataUpdate"),x.reRender()},x.name=C.name||x.id,x.zIndex=C.zIndex||0,x.rawConfig=C,x}return o()(_,[{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(C){if(!this.inited)this.needUpdateConfig=nt(nt({},this.needUpdateConfig),C);else{var M=this.container.get(T.TYPES.SceneID);this.configService.setLayerConfig(M,this.id,nt(nt(nt({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),C)),this.needUpdateConfig={}}}},{key:"setContainer",value:function(C){this.container=C}},{key:"getContainer",value:function(){return this.container}},{key:"addPlugin",value:function(C){return this.plugins.push(C),this}},{key:"init",value:function(){var C=this,M=this.container.get(T.TYPES.SceneID),U=this.rawConfig.enableMultiPassRenderer,ie=U===void 0?!1:U;this.configService.setLayerConfig(M,this.id,{enableMultiPassRenderer:ie}),this.iconService=this.container.get(T.TYPES.IIconService),this.fontService=this.container.get(T.TYPES.IFontService),this.rendererService=this.container.get(T.TYPES.IRendererService),this.layerService=this.container.get(T.TYPES.ILayerService),this.interactionService=this.container.get(T.TYPES.IInteractionService),this.mapService=this.container.get(T.TYPES.IMapService),this.cameraService=this.container.get(T.TYPES.ICameraService),this.coordinateService=this.container.get(T.TYPES.ICoordinateSystemService),this.postProcessingPassFactory=this.container.get(T.TYPES.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(T.TYPES.IFactoryNormalPass),this.styleAttributeService=this.container.get(T.TYPES.IStyleAttributeService),this.multiPassRenderer=this.container.get(T.TYPES.IMultiPassRenderer),this.multiPassRenderer.setLayer(this),this.pendingStyleAttributes.forEach(function($t){var Pr=$t.attributeName,Mr=$t.attributeField,mn=$t.attributeValues,On=$t.updateOptions;C.styleAttributeService.updateStyleAttribute(Pr,{scale:nt({field:Mr},C.splitValuesAndCallbackInAttribute(mn,C.getLayerConfig()[Pr]))},On)}),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(T.TYPES.ILayerPlugin);var ve=ce(this.plugins),Be;try{for(ve.s();!(Be=ve.n()).done;){var Lt=Be.value;Lt.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}}catch($t){ve.e($t)}finally{ve.f()}return this.hooks.init.call(),this.hooks.afterInit.call(),this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this}},{key:"prepareBuildModel",value:function(){this.inited=!0,this.updateLayerConfig(nt(nt({},this.getDefaultConfig()),this.rawConfig));var C=this.getLayerConfig(),M=C.animateOption;(M==null?void 0:M.enable)&&(this.layerService.startAnimate(),this.aniamateStatus=!0)}},{key:"color",value:function(C,M,U){return this.updateStyleAttribute("color",C,M,U),this}},{key:"size",value:function(C,M,U){return this.updateStyleAttribute("size",C,M,U),this}},{key:"filter",value:function(C,M,U){return this.updateStyleAttribute("filter",C,M,U),this}},{key:"shape",value:function(C,M,U){return this.updateStyleAttribute("shape",C,M,U),this}},{key:"label",value:function(C,M,U){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:C,attributeValues:M,updateOptions:U}),this}},{key:"animate",value:function(C){var M={};return Ne()(C)?(M.enable=!0,M=nt(nt({},M),C)):M.enable=C,this.updateLayerConfig({animateOption:M}),this}},{key:"source",value:function(C,M){return this.sourceOption={data:C,options:M},this}},{key:"setData",value:function(C,M){var U=this;return this.inited?this.layerSource.setData(C,M):this.on("inited",function(){U.layerSource.setData(C,M)}),this}},{key:"style",value:function(C){var M=this,U=C.passes,ie=Ze()(C,["passes"]);return U&&ge(U).forEach(function(ve){var Be=M.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(ve[0]);Be&&Be.updateOptions(ve[1])}),this.rawConfig=nt(nt({},this.rawConfig),ie),this.container&&(this.updateLayerConfig(this.rawConfig),this.styleNeedUpdate=!0),this}},{key:"scale",value:function(C,M){return Ne()(C)?this.scaleOptions=nt(nt({},this.scaleOptions),C):this.scaleOptions[C]=M,this}},{key:"render",value:function(){return this.renderModels(),this}},{key:"active",value:function(C){var M={};return M.enableHighlight=Ne()(C)?!0:C,Ne()(C)?(M.enableHighlight=!0,C.color&&(M.highlightColor=C.color)):M.enableHighlight=!!C,this.updateLayerConfig(M),this}},{key:"setActive",value:function(C,M){var U=this;if(Ne()(C)){var ie=C.x,ve=ie===void 0?0:ie,Be=C.y,Lt=Be===void 0?0:Be;this.updateLayerConfig({highlightColor:Ne()(M)?M.color:this.getLayerConfig().highlightColor}),this.pick({x:ve,y:Lt})}else this.updateLayerConfig({pickedFeatureID:C,highlightColor:Ne()(M)?M.color:this.getLayerConfig().highlightColor}),this.hooks.beforeSelect.call(Object(Le.l)(C)).then(function(){setTimeout(function(){U.reRender()},1)})}},{key:"select",value:function(C){var M={};return M.enableSelect=Ne()(C)?!0:C,Ne()(C)?(M.enableSelect=!0,C.color&&(M.selectColor=C.color)):M.enableSelect=!!C,this.updateLayerConfig(M),this}},{key:"setSelect",value:function(C,M){var U=this;if(Ne()(C)){var ie=C.x,ve=ie===void 0?0:ie,Be=C.y,Lt=Be===void 0?0:Be;this.updateLayerConfig({selectColor:Ne()(M)?M.color:this.getLayerConfig().selectColor}),this.pick({x:ve,y:Lt})}else this.updateLayerConfig({pickedFeatureID:C,selectColor:Ne()(M)?M.color:this.getLayerConfig().selectColor}),this.hooks.beforeSelect.call(Object(Le.l)(C)).then(function(){setTimeout(function(){U.reRender()},1)})}},{key:"setBlend",value:function(C){this.updateLayerConfig({blend:C}),this.layerModelNeedUpdate=!0,this.reRender()}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this}},{key:"setIndex",value:function(C){return this.zIndex=C,this.layerService.updateRenderOrder(),this}},{key:"setCurrentPickId",value:function(C){this.currentPickId=C}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(C){this.selectedFeatureID=C}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var C=this.mapService.getZoom(),M=this.getLayerConfig(),U=M.visible,ie=M.minZoom,ve=ie===void 0?-Infinity:ie,Be=M.maxZoom,Lt=Be===void 0?Infinity:Be;return!!U&&C>=ve&&C<=Lt}},{key:"setMinZoom",value:function(C){return this.updateLayerConfig({minZoom:C}),this}},{key:"getMinZoom",value:function(){var C=this.getLayerConfig(),M=C.minZoom;return M}},{key:"getMaxZoom",value:function(){var C=this.getLayerConfig(),M=C.maxZoom;return M}},{key:"get",value:function(C){var M=this.getLayerConfig();return M[C]}},{key:"setMaxZoom",value:function(C){return this.updateLayerConfig({maxZoom:C}),this}},{key:"fitBounds",value:function(C){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var M=this.getSource(),U=M.extent,ie=U.some(function(ve){return Math.abs(ve)===Infinity});return ie?this:(this.mapService.fitBounds([[U[0],U[1]],[U[2],U[3]]],C),this)}},{key:"destroy",value:function(){this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),this.multiPassRenderer.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),this.emit("remove",{target:this,type:"remove"}),this.removeAllListeners()}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){this.models.forEach(function(C){return C.destroy()}),this.layerModel.clearModels()}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(function(C){return C.needRescale||C.needRemapping||C.needRegenerateVertices}).length}},{key:"setSource",value:function(C){this.layerSource=C;var M=this.mapService.getZoom();this.layerSource.cluster&&this.layerSource.updateClusterData(M),this.layerSource.on("update",this.sourceEvent)}},{key:"getSource",value:function(){return this.layerSource}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(C){this.encodedData=C}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getConfigSchemaForValidation",value:function(){return this.configSchema||(this.configSchema=Zt()([be,this.getConfigSchema()])),this.configSchema}},{key:"getLegendItems",value:function(C){var M=this.styleAttributeService.getLayerAttributeScale(C);if(M){if(M.ticks){var U=M.ticks().map(function(ve){return we()({value:ve},C,M(ve))});return U}else if(M.invertExtent){var ie=M.range().map(function(ve){return we()({value:M.invertExtent(ve)},C,ve)});return ie}}else return[]}},{key:"pick",value:function(C){var M=C.x,U=C.y;this.interactionService.triggerHover({x:M,y:U})}},{key:"buildLayerModel",value:function(C){var M=C.moduleName,U=C.vertexShader,ie=C.fragmentShader,ve=C.triangulation,Be=Ze()(C,["moduleName","vertexShader","fragmentShader","triangulation"]);this.shaderModuleService.registerModule(M,{vs:U,fs:ie});var Lt=this.shaderModuleService.getModule(M),$t=Lt.vs,Pr=Lt.fs,Mr=Lt.uniforms,mn=this.rendererService.createModel,On=this.styleAttributeService.createAttributesAndIndices(this.encodedData,ve),Mn=On.attributes,Sa=On.elements;return mn(nt({attributes:Mn,uniforms:Mr,fs:Pr,vs:$t,elements:Sa,blend:At[T.BlendType.normal]},Be))}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.aniamateStatus&&(this.layerService.stopAnimate(),this.aniamateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(C){var M=this.getLayerConfig(),U=M.enableHighlight,ie=U===void 0?!0:U,ve=M.enableSelect,Be=ve===void 0?!0:ve,Lt=this.eventNames().indexOf(C)!==-1||this.eventNames().indexOf("un"+C)!==-1;return(C==="click"||C==="dblclick")&&Be&&(Lt=!0),C==="mousemove"&&(ie||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(Lt=!0),this.isVisible()&&Lt}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"rebuildModels",value:function(){throw new Error("Method not implemented.")}},{key:"renderModels",value:function(){var C=this;return this.layerModelNeedUpdate&&this.layerModel&&(this.models=this.layerModel.buildModels(),this.hooks.beforeRender.call(),this.layerModelNeedUpdate=!1),this.models.forEach(function(M){M.draw({uniforms:C.layerModel.getUninforms()})}),this}},{key:"getConfigSchema",value:function(){throw new Error("Method not implemented.")}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"reRender",value:function(){this.inited&&this.layerService.renderLayers()}},{key:"splitValuesAndCallbackInAttribute",value:function(C,M){return{values:Ue()(C)?void 0:C||M,callback:Ue()(C)?C:void 0}}},{key:"updateStyleAttribute",value:function(C,M,U,ie){this.inited?this.styleAttributeService.updateStyleAttribute(C,{scale:nt({field:M},this.splitValuesAndCallbackInAttribute(U,this.getLayerConfig()[M]))},ie):this.pendingStyleAttributes.push({attributeName:C,attributeField:M,attributeValues:U,updateOptions:ie})}}]),_}(ut.EventEmitter),q),dt=Je()(Pe.prototype,"logger",[xe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=Je()(Pe.prototype,"configService",[Ve],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=Je()(Pe.prototype,"shaderModuleService",[lt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pe),et,jt,sr,ft,mt,Ct,vt=(et=Object(T.lazyInject)(T.TYPES.IGlobalConfigService),jt=Object(T.lazyInject)(T.TYPES.IShaderModuleService),sr=(Ct=function(){function d(S){X()(this,d),this.triangulation=void 0,this.layer=void 0,je()(this,"configService",ft,this),je()(this,"shaderModuleService",mt,this),this.rendererService=void 0,this.iconService=void 0,this.fontService=void 0,this.styleAttributeService=void 0,this.mapService=void 0,this.cameraService=void 0,this.layerService=void 0,this.layer=S,this.rendererService=S.getContainer().get(T.TYPES.IRendererService),this.styleAttributeService=S.getContainer().get(T.TYPES.IStyleAttributeService),this.mapService=S.getContainer().get(T.TYPES.IMapService),this.iconService=S.getContainer().get(T.TYPES.IIconService),this.fontService=S.getContainer().get(T.TYPES.IFontService),this.cameraService=S.getContainer().get(T.TYPES.ICameraService),this.layerService=S.getContainer().get(T.TYPES.ILayerService),this.registerBuiltinAttributes(),this.startModelAnimate()}return o()(d,[{key:"getBlend",value:function(){var _=this.layer.getLayerConfig(),x=_.blend,C=x===void 0?"normal":x;return At[T.BlendType[C]]}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){return!1}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){throw new Error("Method not implemented.")}},{key:"clearModels",value:function(){return}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"render",value:function(){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(_){return[_.enable?0:1,_.duration||4,_.interval||.2,_.trailLength||.1]}},{key:"startModelAnimate",value:function(){var _=this.layer.getLayerConfig(),x=_.animateOption;x.enable&&this.layer.setAnimateStartTime()}}]),d}(),Ct),ft=Je()(sr.prototype,"configService",[et],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mt=Je()(sr.prototype,"shaderModuleService",[jt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sr),Oe=i("J4zp"),ct=i.n(Oe),Qe=i("RIqP"),Ft=i.n(Qe),vr=i("VmRL"),Vr=i.n(vr),lr=i("IOcx"),Nn=lr.c.create(),vn=lr.c.create(),na=lr.c.create(),ha=lr.c.create(),Zn=lr.c.create();function Hn(d,S,_,x,C){lr.c.add(d,_,x),lr.c.normalize(d,d),S=lr.c.fromValues(-d[1],d[0]);var M=lr.c.fromValues(-_[1],_[0]);return[C/lr.c.dot(S,M),S]}function F(d,S){return lr.c.set(d,-S[1],S[0])}function W(d,S,_){return lr.c.sub(d,S,_),lr.c.normalize(d,d),d}function le(d,S){return d[0]===S[0]&&d[1]===S[1]}function me(d){for(var S=new Map,_=0;_<d.length;_++){var x=d[0].toString()+"-"+d[1].toString();S.get(x)?(d.splice(_,1),_++):S.set(x,x)}return d}var at=function(){function d(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};X()(this,d),this.complex=void 0,this.join=void 0,this.cap=void 0,this.miterLimit=void 0,this.thickness=void 0,this.normal=void 0,this.lastFlip=-1,this.miter=lr.c.fromValues(0,0),this.started=!1,this.dash=!1,this.totalDistance=0,this.join=S.join||"miter",this.cap=S.cap||"butt",this.miterLimit=S.miterLimit||10,this.thickness=S.thickness||1,this.dash=S.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0}}return o()(d,[{key:"extrude",value:function(_){var x=this.complex;if(_.length<=1)return x;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var C=_.length,M=x.startIndex,U=1;U<C;U++){var ie=_[U-1],ve=_[U],Be=U<_.length-1?_[U+1]:null,Lt=this.segment(x,M,ie,ve,Be);M+=Lt}if(this.dash)for(var $t=0;$t<x.positions.length/6;$t++)x.positions[$t*6+5]=this.totalDistance;return x.startIndex=x.positions.length/6,x}},{key:"segment",value:function(_,x,C,M,U){var ie=0,ve=_.indices,Be=_.positions,Lt=_.normals,$t=this.cap==="square",Pr=this.join==="bevel",Mr=Object(Le.d)([M[0],M[1]]),mn=Object(Le.d)([C[0],C[1]]);W(na,Mr,mn);var On=0;if(this.dash&&(On=this.lineSegmentDistance(Mr,mn),this.totalDistance+=On),this.normal||(this.normal=lr.c.create(),F(this.normal,na)),!this.started)if(this.started=!0,$t){var Mn=lr.c.create(),Sa=lr.c.create();lr.c.add(Mn,this.normal,na),lr.c.add(Sa,this.normal,na),Lt.push(Sa[0],Sa[1],0),Lt.push(Mn[0],Mn[1],0),Be.push(C[0],C[1],0,this.totalDistance-On,-this.thickness,0),Be.push(C[0],C[1],0,this.totalDistance-On,this.thickness,0)}else this.extrusions(Be,Lt,C,this.normal,this.thickness,this.totalDistance-On);if(ve.push(x+0,x+1,x+2),U){var Ka=Object(Le.d)([U[0],U[1]]);le(Mr,Ka)&&lr.c.add(Ka,Mr,lr.c.normalize(Ka,lr.c.subtract(Ka,Mr,mn))),W(ha,Ka,Mr);var ni=Hn(Zn,lr.c.create(),na,ha,this.thickness),io=ct()(ni,2),Aa=io[0],Do=io[1],rs=lr.c.dot(Zn,this.normal)<0?-1:1,Xs=Pr;if(!Xs&&this.join==="miter"){var Wa=Aa;Wa>this.miterLimit&&(Xs=!0)}Xs?(Lt.push(this.normal[0],this.normal[1],0),Lt.push(Do[0],Do[1],0),Be.push(M[0],M[1],0,this.totalDistance,-this.thickness*rs,0),Be.push(M[0],M[1],0,this.totalDistance,this.thickness*rs,0),ve.push.apply(ve,Ft()(this.lastFlip!==-rs?[x,x+2,x+3]:[x+2,x+1,x+3])),ve.push(x+2,x+3,x+4),F(Nn,ha),lr.c.copy(this.normal,Nn),Lt.push(this.normal[0],this.normal[1],0),Be.push(M[0],M[1],0,this.totalDistance,-this.thickness*rs,0),ie+=3):(this.extrusions(Be,Lt,M,Do,Aa,this.totalDistance),ve.push.apply(ve,Ft()(this.lastFlip===1?[x,x+2,x+3]:[x+2,x+1,x+3])),rs=-1,lr.c.copy(this.normal,Do),ie+=2),this.lastFlip=rs}else{if(F(this.normal,na),$t){var Ha=lr.c.create(),ri=lr.c.create();lr.c.sub(ri,na,this.normal),lr.c.add(Ha,na,this.normal),Lt.push(ri[0],ri[1],0),Lt.push(Ha[0],Ha[1],0),Be.push(M[0],M[1],0,this.totalDistance,this.thickness,0),Be.push(M[0],M[1],0,this.totalDistance,this.thickness,0)}else this.extrusions(Be,Lt,M,this.normal,this.thickness,this.totalDistance);ve.push.apply(ve,Ft()(this.lastFlip===1?[x,x+2,x+3]:[x+2,x+1,x+3])),ie+=2}return ie}},{key:"extrusions",value:function(_,x,C,M,U,ie){x.push(M[0],M[1],0),x.push(M[0],M[1],0),_.push(C[0],C[1],0,ie,-U,0),_.push(C[0],C[1],0,ie,U,0)}},{key:"lineSegmentDistance",value:function(_,x){var C=x[0]-_[0],M=x[1]-_[1];return Math.sqrt(C*C+M*M)}}]),d}(),bt=i("UB5X"),He=i.n(bt);function ht(d){if(He()(d[0]))return d;if(He()(d[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(He()(d[0][0][0])){var S=d,_=0,x=0,C=0;return S.forEach(function(M){M.forEach(function(U){_+=U[0],x+=U[1],C++})}),[_/C,x/C,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function Qt(d){var S=d[0][0],_=d[0][d[0].length-1];S[0]===_[0]&&S[1]===_[1]&&(d[0]=d[0].slice(0,d[0].length-1));for(var x=d[0].length,C=Vr.a.flatten(d),M=C.vertices,U=C.dimensions,ie=[],ve=[],Be=0;Be<M.length/U;Be++)U===2?ie.push(M[Be*2],M[Be*2+1],1):ie.push(M[Be*3],M[Be*3+1],1);var Lt=Vr()(C.vertices,C.holes,C.dimensions);ve.push.apply(ve,Ft()(Lt));for(var $t=function(mn){var On=C.vertices.slice(mn*U,(mn+1)*U),Mn=C.vertices.slice((mn+1)*U,(mn+2)*U);Mn.length===0&&(Mn=C.vertices.slice(0,U));var Sa=ie.length/3;ie.push(On[0],On[1],1,Mn[0],Mn[1],1,On[0],On[1],0,Mn[0],Mn[1],0),ve.push.apply(ve,Ft()([0,2,1,2,3,1].map(function(Ha){return Ha+Sa})))},Pr=0;Pr<x;Pr++)$t(Pr);return{positions:ie,index:ve}}function qt(d){var S=Vr.a.flatten(d),_=Vr()(S.vertices,S.holes,S.dimensions);return{positions:S.vertices,index:_}}function Nr(d){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,_=d[0][0],x=d[0][d[0].length-1];_[0]===x[0]&&_[1]===x[1]&&(d[0]=d[0].slice(0,d[0].length-1));for(var C=d[0].length,M=Vr.a.flatten(d),U=M.vertices,ie=M.dimensions,ve=[],Be=[],Lt=[],$t=0;$t<U.length/ie;$t++)ie===2?ve.push(U[$t*2],U[$t*2+1],1,-1,-1):ve.push(U[$t*3],U[$t*3+1],1,-1,-1),Lt.push(0,0,1);var Pr=Vr()(M.vertices,M.holes,M.dimensions);Be.push.apply(Be,Ft()(Pr));for(var Mr=function(Mn){var Sa=M.vertices.slice(Mn*ie,(Mn+1)*ie),Ha=M.vertices.slice((Mn+1)*ie,(Mn+2)*ie);Ha.length===0&&(Ha=M.vertices.slice(0,ie));var ri=ve.length/5;ve.push(Sa[0],Sa[1],1,0,0,Ha[0],Ha[1],1,.1,0,Sa[0],Sa[1],0,0,.8,Ha[0],Ha[1],0,.1,.8);var Ka=qr([Ha[0],Ha[1],1],[Sa[0],Sa[1],0],[Sa[0],Sa[1],1],S);Lt.push.apply(Lt,Ft()(Ka).concat(Ft()(Ka),Ft()(Ka),Ft()(Ka))),Be.push.apply(Be,Ft()([1,2,0,3,2,1].map(function(ni){return ni+ri})))},mn=0;mn<C;mn++)Mr(mn);return{positions:ve,index:Be,normals:Lt}}function qr(d,S,_){var x=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,C=lr.d.create(),M=lr.d.create(),U=lr.d.create();x&&(d=Object(Le.p)(d),S=Object(Le.p)(S),_=Object(Le.p)(_));var ie=lr.d.fromValues.apply(lr.d,Ft()(d)),ve=lr.d.fromValues.apply(lr.d,Ft()(S)),Be=lr.d.fromValues.apply(lr.d,Ft()(_));lr.d.sub(C,Be,ve),lr.d.sub(M,ie,ve),lr.d.cross(U,C,M);var Lt=lr.d.create();return lr.d.normalize(Lt,U),Lt}var or,Br;(function(d){d.CYLINDER="cylinder",d.SQUARECOLUMN="squareColumn",d.TRIANGLECOLUMN="triangleColumn",d.HEXAGONCOLUMN="hexagonColumn",d.PENTAGONCOLUMN="pentagonColumn"})(Br||(Br={}));var Tn;(function(d){d.CIRCLE="circle",d.SQUARE="square",d.TRIANGLE="triangle",d.HEXAGON="hexagon",d.PENTAGON="pentagon"})(Tn||(Tn={}));function dr(d){for(var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,_=Math.PI*2/d,x=[],C=0;C<d;C++)x.push(_*C+S*Math.PI/12);var M=x.map(function(U){var ie=Math.sin(U+Math.PI/4),ve=Math.cos(U+Math.PI/4);return[ie,ve,0]});return M}function Xr(){return dr(30)}function dn(){return dr(4)}function Kn(){return dr(3)}function gn(){return dr(6,1)}function ur(){return dr(5)}var kn=(or={},we()(or,Tn.CIRCLE,Xr),we()(or,Tn.HEXAGON,gn),we()(or,Tn.TRIANGLE,Kn),we()(or,Tn.SQUARE,dn),we()(or,Tn.PENTAGON,ur),we()(or,Br.CYLINDER,Xr),we()(or,Br.HEXAGONCOLUMN,gn),we()(or,Br.TRIANGLECOLUMN,Kn),we()(or,Br.SQUARECOLUMN,dn),we()(or,Br.PENTAGONCOLUMN,ur),or),An={};function Za(d){var S=ht(d.coordinates);return{vertices:[].concat(Ft()(S),Ft()(S),Ft()(S),Ft()(S)),indices:[0,1,2,2,3,0],size:S.length}}function ea(d){var S=d.shape,_=Wi(S,!1),x=_.positions,C=_.index,M=_.normals;return{vertices:x,indices:C,normals:M,size:5}}function ca(d){var S=ht(d.coordinates);return{vertices:Ft()(S),indices:[0],size:S.length}}function bo(d){var S=d.coordinates,_=S;Array.isArray(_[0][0])||(_=[S]);var x=new at({dash:!0,join:"bevel"});_.forEach(function(M){x.extrude(M)});var C=x.complex;return{vertices:C.positions,indices:C.indices,normals:C.normals,size:6}}function Ri(d){var S=d.coordinates,_=Vr.a.flatten(S),x=_.vertices,C=_.dimensions,M=_.holes;return{indices:Vr()(x,M,C),vertices:x,size:C}}function va(d){var S=d.coordinates,_=Nr(S,!0),x=_.positions,C=_.index,M=_.normals;return{vertices:x,indices:C,normals:M,size:5}}function ii(d){var S=d.shape,_=cu(S),x=_.positions,C=_.index;return{vertices:x,indices:C,size:3}}function Ia(d){var S=d.coordinates,_=[].concat(Ft()(S[0]),[0,0,1,S[1][0],S[0][1],0,1,1],Ft()(S[1]),[0,1,0],Ft()(S[0]),[0,0,1],Ft()(S[1]),[0,1,0,S[0][0],S[1][1],0,0,0]),x=[0,1,2,3,4,5];return{vertices:_,indices:x,size:5}}function Ln(d){for(var S=30,_=d.coordinates,x=[],C=[],M=function(ve){x.push(ve,1,ve,_[0][0],_[0][1],_[1][0],_[1][1],ve,-1,ve,_[0][0],_[0][1],_[1][0],_[1][1]),ve!==S-1&&C.push.apply(C,Ft()([0,1,2,1,3,2].map(function(Be){return ve*2+Be})))},U=0;U<S;U++)M(U);return{vertices:x,indices:C,size:7}}function Ei(d){var S=d.coordinates;S.length===2&&S.push(0);var _=d.size,x=fa(-1,1),C=fa(1,1),M=fa(-1,-1),U=fa(1,-1),ie=[].concat(Ft()(S),Ft()(x),Ft()(S),Ft()(M),Ft()(S),Ft()(U),Ft()(S),Ft()(C)),ve=[0,1,2,3,0,2];return{vertices:ie,indices:ve,size:5}}function Wi(d){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(An&&An[d])return An[d];var _=kn[d]?kn[d]():kn.cylinder(),x=Nr([_],S);return An[d]=x,x}function qa(d,S){for(var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,x=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,C=new Float32Array(d.length/_*3),M,U,ie,ve=lr.d.create(),Be=lr.d.create(),Lt=lr.d.create(),$t=0,Pr=S.length;$t<Pr;$t+=3){M=S[$t+0]*3,U=S[$t+1]*3,ie=S[$t+2]*3;var Mr=[d[M],d[M+1]],mn=[d[U],d[U+1]],On=[d[ie],d[ie+1]];x&&(Mr=Object(Le.p)(Mr),mn=Object(Le.p)(mn),On=Object(Le.p)(On));var Mn=Mr,Sa=ct()(Mn,2),Ha=Sa[0],ri=Sa[1],Ka=lr.d.fromValues(Ha,ri,d[M+2]),ni=mn,io=ct()(ni,2),Aa=io[0],Do=io[1],rs=lr.d.fromValues(Aa,Do,d[U+2]),Xs=On,Wa=ct()(Xs,2),ds=Wa[0],Fo=Wa[1],yl=lr.d.fromValues(ds,Fo,d[ie+2]);lr.d.sub(ve,yl,rs),lr.d.sub(Be,Ka,rs),lr.d.cross(Lt,ve,Be),C[M]+=ve[0],C[M+1]+=ve[1],C[M+2]+=ve[2],C[U]+=ve[0],C[U+1]+=ve[1],C[U+2]+=ve[2],C[ie]+=ve[0],C[ie+1]+=ve[1],C[ie+2]+=ve[2]}return Oo(C),C}function Oo(d){for(var S=0,_=d.length;S<_;S+=3){var x=lr.d.fromValues(d[S],d[S+1],d[S+2]),C=lr.d.create();lr.d.normalize(C,x),d.set(C,S)}}function Ml(d){var S=d[0][0],_=d[0][d[0].length-1];return S[0]===_[0]&&S[1]===_[1]}function cu(d){var S=["cylinder","triangleColumn","hexagonColumn","squareColumn"],_=kn[d]?kn[d]():kn.circle(),x=S.indexOf(d)===-1?qt([_]):Qt([_]);return x}function fa(d,S){var _=(d+1)/2,x=(S+1)/2;return[_,x]}function Cs(d){var S=oo();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function oo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Na=`uniform float u_opacity: 1.0;
uniform vec4 u_baseColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_brightColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_windowColor : [ 1.0, 0, 0, 1.0 ];
uniform float u_near : 0;
uniform float u_far : 1;
varying vec4 v_Color;
varying vec2 v_texCoord;
uniform float u_Zoom : 1;
uniform float u_time;

#pragma include "picking"

vec3 getWindowColor(float n, float hot, vec3 brightColor, vec3 darkColor) {
    float s = step(hot, n);
    vec3 color = mix(brightColor,vec3(0.9,0.9,1.0),n);

    return mix(darkColor, color, s);
}
float random (vec2 st) {
    return fract(sin(dot(st.xy, vec2(12.9898,78.233)))* 43758.5453123);
}

float LinearizeDepth()
{
    float z = gl_FragCoord.z * 2.0 - 1.0;
    return (2.0 * u_near * u_far) / (u_far + u_near - z * (u_far - u_near));
}

vec3 fog(vec3 color, vec3 fogColor, float depth){
    float fogFactor=clamp(depth,0.0,1.0);
    vec3 output_color=mix(fogColor,color,fogFactor);
    return output_color;
}

float sdRect(vec2 p, vec2 sz) {
  vec2 d = abs(p) - sz;
  float outside = length(max(d, 0.));
  float inside = min(max(d.x, d.y), 0.);
  return outside + inside;
}

void main() {
  gl_FragColor = v_Color;
  vec3 baseColor = u_baseColor.xyz;
  vec3 brightColor = u_brightColor.xyz;
  vec3 windowColor = u_windowColor.xyz;
  float targetColId = 5.;
  float depth = 1.0 - LinearizeDepth() / u_far * u_Zoom;
  vec3 fogColor = vec3(23.0/255.0,31.0/255.0,51.0/255.0);
  if(v_texCoord.x < 0.) { //\u9876\u90E8\u989C\u8272
       vec3 foggedColor = fog(baseColor.xyz + vec3(0.12*0.9,0.2*0.9,0.3*0.9),fogColor,depth);
       gl_FragColor = vec4( foggedColor, v_Color.w);
  }else { // \u4FA7\u9762\u989C\u8272
        vec2 st = v_texCoord;
        vec2  UvScale = v_texCoord;
        float tStep = min(0.08,max(0.05* (18.0-u_Zoom),0.02));
        float tStart = 0.25 * tStep;
        float tEnd = 0.75 * tStep;
        float u = mod(UvScale.x, tStep);
        float v = mod(UvScale.y, tStep);
        float ux = floor(UvScale.x/tStep);
        float uy = floor(UvScale.y/tStep);
        float n = random(vec2(ux,uy));
        float lightP = u_time;
        float head = 1.0- step(0.005,st.y);
        /*step3*/
        // \u5C06\u7A97\u6237\u989C\u8272\u548C\u5899\u9762\u989C\u8272\u533A\u522B\u5F00\u6765
        float sU = step(tStart, u) - step(tEnd, u);
        float sV = step(tStart, v) - step(tEnd, v);
        vec2 windowSize = vec2(abs(tEnd-tStart),abs(tEnd-tStart));
        float dist = sdRect(vec2(u,v), windowSize);
        float s = sU * sV;

        float curColId = floor(UvScale.x / tStep);
        float sCol = step(targetColId - 0.2, curColId) - step(targetColId + 0.2, curColId);

        float mLightP = mod(lightP, 2.);
        float sRow = step(mLightP - 0.2, st.y) - step(mLightP, st.y);
        if(ux == targetColId){
            n =0.;
        }
        float timeP = min(0.75, abs ( sin(u_time/3.0) ) );
        float hot = smoothstep(1.0,0.0,timeP);
        vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), s);
        //vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), 1.0);
        float sFinal = s * sCol * sRow;
        color += mix(baseColor, brightColor, sFinal*n);
        if (st.y<0.01){
        color = baseColor;
         }
        if(head ==1.0) { // \u9876\u90E8\u4EAE\u7EBF
            color = brightColor;
        }
        color = color * v_Color.rgb;

        vec3 foggedColor = fog(color,fogColor,depth);

        gl_FragColor = vec4(foggedColor,1.0);
  }
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Fu=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

attribute vec2 a_Uv;
varying vec2 v_texCoord;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);
   v_texCoord = a_Uv;
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,Ai=function(d){D()(_,d);var S=Cs(_);function _(){return X()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=M===void 0?1:M,ie=C.baseColor,ve=ie===void 0?"rgb(16,16,16)":ie,Be=C.brightColor,Lt=Be===void 0?"rgb(255,176,38)":Be,$t=C.windowColor,Pr=$t===void 0?"rgb(30,60,89)":$t,Mr=C.time,mn=Mr===void 0?0:Mr;return{u_opacity:U,u_baseColor:Object(Le.s)(ve),u_brightColor:Object(Le.s)(Lt),u_windowColor:Object(Le.s)(Pr),u_time:this.layer.getLayerAnimateTime()||mn}}},{key:"initModels",value:function(){return this.startModelAnimate(),[this.layer.buildLayerModel({moduleName:"cityBuilding",vertexShader:Fu,fragmentShader:Na,triangulation:va})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:T.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:3,update:function(M,U,ie,ve,Be){return Be}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(M,U,ie,ve){var Be=M.size,Lt=Be===void 0?10:Be;return Array.isArray(Lt)?[Lt[0]]:[Lt]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:T.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:2,update:function(M,U,ie,ve){var Be=M.size;return[ie[3],ie[4]]}}})}}]),_}(vt);function li(d){var S=xo();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function xo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var ms=function(d){D()(_,d);var S=li(_);function _(){var x;X()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.type="PolygonLayer",x}return o()(_,[{key:"buildModels",value:function(){this.layerModel=new Ai(this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"setLight",value:function(C){this.updateLayerConfig({time:C})}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){return"citybuilding"}}]),_}(ae);function so(d){var S=Uu();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function Uu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Ys=`precision highp float;\r
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807\r
attribute vec3 a_Position;\r
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807\r
attribute vec3 a_Pos;\r
attribute float a_Size;\r
attribute vec4 a_Color;\r
uniform vec2 u_radius;\r
uniform float u_coverage: 0.9;\r
uniform float u_angle: 0;\r
uniform mat4 u_ModelMatrix;\r
varying vec4 v_color;\r
\r
#pragma include "projection"\r
#pragma include "project"\r
#pragma include "picking"\r
\r
void main() {\r
  v_color = a_Color;\r
\r
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));\r
  vec2 offset = a_Position.xy * u_radius * rotationMatrix * u_coverage ;\r
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\r
  vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));\r
  gl_Position = project_common_position_to_clipspace(project_pos);\r
\r
  setPickingColor(a_PickingColor);\r
}\r
`,Eo=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,fu=function(d){D()(_,d);var S=so(_);function _(){return X()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=C.coverage,ie=C.angle;return{u_opacity:M||1,u_coverage:U||.9,u_angle:ie||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"gridheatmap",vertexShader:Ys,fragmentShader:Eo,triangulation:ii,depth:{enable:!1},primitive:T.gl.TRIANGLES,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:T.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:3,update:function(M,U){var ie=M.coordinates;return[ie[0],ie[1],0]}}})}}]),_}(vt);function Ut(d){var S=Ie();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function Ie(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Mt=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;

attribute vec3 a_Normal;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
varying vec4 v_color;

#pragma include "projection"
#pragma include "project"
#pragma include "light"
#pragma include "picking"

void main() {
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);
  vec4 project_pos = project_position(vec4(lnglat, a_Position.z * a_Size, 1.0));
  float lightWeight = calc_lighting(project_pos);
  v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);

  gl_Position = project_common_position_to_clipspace(project_pos);
  setPickingColor(a_PickingColor);
}
`,cr=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,en=function(d){D()(_,d);var S=Ut(_);function _(){return X()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=C.coverage,ie=C.angle;return{u_opacity:M||1,u_coverage:U||1,u_angle:ie||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"grid3dheatmap",vertexShader:Mt,fragmentShader:cr,triangulation:ea,depth:{enable:!0},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(M,U,ie,ve){var Be=M.size;return Array.isArray(Be)?[Be[0]]:[Be]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:T.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:3,update:function(M,U,ie,ve,Be){return Be}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:T.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:3,update:function(M,U){var ie=M.coordinates;return[ie[0],ie[1],0]}}})}}]),_}(vt);function bn(d,S){for(var _=[],x=[],C=[],M=d+1,U=S+1,ie=d/2,ve=S/2,Be=0;Be<U;Be++)for(var Lt=Be-ve,$t=0;$t<M;$t++){var Pr=$t-ie;x.push(Pr/ie,-Lt/ve,0),C.push($t/d),C.push(1-Be/S)}for(var Mr=0;Mr<S;Mr++)for(var mn=0;mn<d;mn++){var On=mn+M*Mr,Mn=mn+M*(Mr+1),Sa=mn+1+M*(Mr+1),Ha=mn+1+M*Mr;_.push(On,Mn,Ha),_.push(Mn,Sa,Ha)}return{vertices:x,indices:_,uvs:C}}function jn(d,S){var _=Object.keys(d);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(d);S&&(x=x.filter(function(C){return Object.getOwnPropertyDescriptor(d,C).enumerable})),_.push.apply(_,x)}return _}function Fi(d){for(var S=1;S<arguments.length;S++){var _=arguments[S]!=null?arguments[S]:{};S%2?jn(Object(_),!0).forEach(function(x){we()(d,x,_[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(_)):jn(Object(_)).forEach(function(x){Object.defineProperty(d,x,Object.getOwnPropertyDescriptor(_,x))})}return d}function qi(d){var S=Mo();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function Mo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var To=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_opacity;
varying vec2 v_texCoord;
varying float v_intensity;

void main(){
   
     float intensity = texture2D(u_texture, v_texCoord).r;
    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));
    gl_FragColor = color;
    // gl_FragColor.a = color.a * smoothstep(0.1,0.2,intensity)* u_opacity;
     gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;

}
`,tl=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
uniform mat4 u_ModelMatrix;
uniform mat4 u_InverseViewProjectionMatrix;
uniform mat4 u_ViewProjectionMatrixUncentered;
varying float v_intensity;

vec2 toBezier(float t, vec2 P0, vec2 P1, vec2 P2, vec2 P3) {
    float t2 = t * t;
    float one_minus_t = 1.0 - t;
    float one_minus_t2 = one_minus_t * one_minus_t;
    return (P0 * one_minus_t2 * one_minus_t + P1 * 3.0 * t * one_minus_t2 + P2 * 3.0 * t2 * one_minus_t + P3 * t2 * t);
}
vec2 toBezier(float t, vec4 p){
    return toBezier(t, vec2(0.0, 0.0), vec2(p.x, p.y), vec2(p.z, p.w), vec2(1.0, 1.0));
}
#pragma include "projection"
void main() {
  v_texCoord = a_Uv;

  vec2 pos =(a_Uv * vec2(2.0) - vec2(1.0));


  vec4 p1 = vec4(pos, 0.0, 1.0);
	vec4 p2 = vec4(pos, 1.0, 1.0);

	vec4 inverseP1 = u_InverseViewProjectionMatrix * p1;
	vec4 inverseP2 = u_InverseViewProjectionMatrix * p2;

  inverseP1 = inverseP1 / inverseP1.w;
	inverseP2 = inverseP2 / inverseP2.w;

	float zPos = (0.0 - inverseP1.z) / (inverseP2.z - inverseP1.z);
	vec4 position = inverseP1 + zPos * (inverseP2 - inverseP1);

  vec4 b= vec4(0.5000, 0, 1, 0.5000);
  float fh;

  v_intensity = texture2D(u_texture, v_texCoord).r;
  fh = toBezier(v_intensity, b).y;
  gl_Position = u_ViewProjectionMatrixUncentered * vec4(position.xy, fh * project_pixel(50.), 1.0);

}
`,ql=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_opacity;
varying vec2 v_texCoord;
varying float v_intensity;

void main(){
     float intensity = texture2D(u_texture, v_texCoord).r;
    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));
    gl_FragColor =color;
    gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;

}
`,Ks=`precision highp float;
uniform float u_intensity;
varying float v_weight;
varying vec2 v_extrude;
#define GAUSS_COEF  0.3989422804014327
void main(){
    float d = -0.5 * 3.0 * 3.0 * dot(v_extrude, v_extrude);
    float val = v_weight * u_intensity * GAUSS_COEF * exp(d);
    gl_FragColor = vec4(val, 1., 1., 1.);
}
`,jc=`precision highp float;
attribute vec3 a_Position;
attribute float a_Size;
attribute vec2 a_Dir;
uniform float u_intensity;
uniform float u_radius;
varying vec2 v_extrude;
varying float v_weight;
uniform mat4 u_ModelMatrix;

#define GAUSS_COEF  0.3989422804014327

#pragma include "projection"

void main(){
    v_weight = a_Size;
    float ZERO = 1.0 / 255.0 / 16.0;
    float extrude_x = a_Dir.x * 2.0 -1.0;
    float extrude_y = a_Dir.y * 2.0 -1.0;
    vec2 extrude_dir = normalize(vec2(extrude_x,extrude_y));
    float S = sqrt(-2.0 * log(ZERO / a_Size / u_intensity / GAUSS_COEF)) / 3.0;
    v_extrude = extrude_dir * S;

    vec2 offset = project_pixel(v_extrude * u_radius);
    vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));
}
`,vs=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
varying float v_intensity;
void main() {
  v_texCoord = a_Uv;
  v_intensity = texture2D(u_texture, v_texCoord).r;
  gl_Position = vec4(a_Position.xy, 0, 1.);
}
`,Bu=function(d){D()(_,d);var S=qi(_);function _(){var x;X()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.texture=void 0,x.colorTexture=void 0,x.heatmapFramerBuffer=void 0,x.intensityModel=void 0,x.colorModel=void 0,x.shapeType=void 0,x}return o()(_,[{key:"render",value:function(){var C=this,M=this.rendererService,U=M.clear,ie=M.useFramebuffer;ie(this.heatmapFramerBuffer,function(){U({color:[0,0,0,0],depth:1,stencil:0,framebuffer:C.heatmapFramerBuffer}),C.drawIntensityMode()}),this.layer.styleNeedUpdate&&this.updateColorTexture(),this.shapeType==="heatmap"?this.drawColorMode():this.draw3DHeatMap()}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){var C,M=this.rendererService,U=M.createFramebuffer,ie=M.clear,ve=M.getViewportSize,Be=M.createTexture2D,Lt=M.useFramebuffer,$t=this.styleAttributeService.getLayerStyleAttribute("shape"),Pr=($t==null||((C=$t.scale)===null||C===void 0)?void 0:C.field)||"heatmap";this.shapeType=Pr,this.intensityModel=this.buildHeatMapIntensity(),this.colorModel=Pr==="heatmap"?this.buildHeatmapColor():this.build3dHeatMap();var Mr=this.layer.getLayerConfig(),mn=Mr.rampColors,On=Object(Le.n)(mn),Mn=ve(),Sa=Mn.width,Ha=Mn.height;return this.heatmapFramerBuffer=U({color:Be({width:Math.floor(Sa/4),height:Math.floor(Ha/4),wrapS:T.gl.CLAMP_TO_EDGE,wrapT:T.gl.CLAMP_TO_EDGE,min:T.gl.LINEAR,mag:T.gl.LINEAR}),depth:!1}),this.updateColorTexture(),[this.intensityModel,this.colorModel]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"dir",type:T.AttributeType.Attribute,descriptor:{name:"a_Dir",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:2,update:function(M,U,ie,ve){return[ie[3],ie[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(M,U,ie,ve){var Be=M.size,Lt=Be===void 0?1:Be;return[Lt]}}})}},{key:"buildHeatMapIntensity",value:function(){return this.layer.buildLayerModel({moduleName:"heatmapintensity",vertexShader:jc,fragmentShader:Ks,triangulation:Ei,depth:{enable:!1},blend:{enable:!0,func:{srcRGB:T.gl.ONE,srcAlpha:1,dstRGB:T.gl.ONE,dstAlpha:1}}})}},{key:"buildHeatmapColor",value:function(){this.shaderModuleService.registerModule("heatmapColor",{vs,fs:ql});var C=this.shaderModuleService.getModule("heatmapColor"),M=C.vs,U=C.fs,ie=C.uniforms,ve=this.rendererService,Be=ve.createAttribute,Lt=ve.createElements,$t=ve.createBuffer,Pr=ve.createModel;return Pr({vs:M,fs:U,attributes:{a_Position:Be({buffer:$t({data:[-1,1,0,1,1,0,-1,-1,0,1,-1,0],type:T.gl.FLOAT}),size:3}),a_Uv:Be({buffer:$t({data:[0,1,1,1,0,0,1,0],type:T.gl.FLOAT}),size:2})},uniforms:Fi({},ie),depth:{enable:!1},blend:this.getBlend(),count:6,elements:Lt({data:[0,2,1,2,3,1],type:T.gl.UNSIGNED_INT,count:6})})}},{key:"drawIntensityMode",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=C.intensity,ie=U===void 0?10:U,ve=C.radius,Be=ve===void 0?5:ve;this.intensityModel.draw({uniforms:{u_opacity:M||1,u_radius:Be,u_intensity:ie}})}},{key:"drawColorMode",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity;this.colorModel.draw({uniforms:{u_opacity:M||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer}})}},{key:"draw3DHeatMap",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=lr.b.invert(lr.b.create(),lr.b.fromValues.apply(lr.b,Ft()(this.cameraService.getViewProjectionMatrixUncentered())));this.colorModel.draw({uniforms:{u_opacity:M||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer,u_ViewProjectionMatrixUncentered:this.cameraService.getViewProjectionMatrixUncentered(),u_InverseViewProjectionMatrix:Ft()(U)}})}},{key:"build3dHeatMap",value:function(){var C=this.rendererService.getViewportSize,M=C(),U=M.width,ie=M.height,ve=bn(U/4,ie/4);this.shaderModuleService.registerModule("heatmap3dColor",{vs:tl,fs:To});var Be=this.shaderModuleService.getModule("heatmap3dColor"),Lt=Be.vs,$t=Be.fs,Pr=Be.uniforms,Mr=this.rendererService,mn=Mr.createAttribute,On=Mr.createElements,Mn=Mr.createBuffer,Sa=Mr.createModel;return Sa({vs:Lt,fs:$t,attributes:{a_Position:mn({buffer:Mn({data:ve.vertices,type:T.gl.FLOAT}),size:3}),a_Uv:mn({buffer:Mn({data:ve.uvs,type:T.gl.FLOAT}),size:2})},primitive:T.gl.TRIANGLES,uniforms:Fi({},Pr),depth:{enable:!0},blend:{enable:!0,func:{srcRGB:T.gl.SRC_ALPHA,srcAlpha:1,dstRGB:T.gl.ONE_MINUS_SRC_ALPHA,dstAlpha:1}},elements:On({data:ve.indices,type:T.gl.UNSIGNED_INT,count:ve.indices.length})})}},{key:"updateStyle",value:function(){this.updateColorTexture()}},{key:"updateColorTexture",value:function(){var C=this.rendererService.createTexture2D;this.texture&&this.texture.destroy();var M=this.layer.getLayerConfig(),U=M.rampColors,ie=Object(Le.n)(U);this.colorTexture=C({data:new Uint8Array(ie.data),width:ie.width,height:ie.height,wrapS:T.gl.CLAMP_TO_EDGE,wrapT:T.gl.CLAMP_TO_EDGE,min:T.gl.NEAREST,mag:T.gl.NEAREST,flipY:!1})}}]),_}(vt);function ws(d){var S=_o();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function _o(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Po=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,$s=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
varying vec4 v_color;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

void main() {
  v_color = a_Color;
    
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);
  vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0., 1.0));
  setPickingColor(a_PickingColor);
}
`,bl=function(d){D()(_,d);var S=ws(_);function _(){return X()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=C.coverage,ie=C.angle;return{u_opacity:M||1,u_coverage:U||.9,u_angle:ie||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"hexagonheatmap",vertexShader:$s,fragmentShader:Po,triangulation:ii,depth:{enable:!1},primitive:T.gl.TRIANGLES,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:T.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:3,update:function(M,U){var ie=M.coordinates;return[ie[0],ie[1],0]}}})}}]),_}(vt),Su={heatmap:Bu,heatmap3d:Bu,grid:fu,grid3d:en,hexagon:bl},ka=Su;function hu(d){var S=ec();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function ec(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Js=function(d){D()(_,d);var S=hu(_);function _(){var x;X()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.type="HeatMapLayer",x}return o()(_,[{key:"buildModels",value:function(){var C=this.getModelType();this.layerModel=new ka[C](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"renderModels",value:function(){var C=this,M=this.getModelType();return M==="heatmap"?(this.layerModel&&this.layerModel.render(),this):(this.layerModelNeedUpdate&&(this.models=this.layerModel.buildModels(),this.layerModelNeedUpdate=!1),this.models.forEach(function(U){return U.draw({uniforms:C.layerModel.getUninforms()})}),this)}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var C,M=this.styleAttributeService.getLayerStyleAttribute("shape"),U=this.getLayerConfig(),ie=U.shape3d,ve=this.getSource(),Be=ve.data.type,Lt=(M==null||((C=M.scale)===null||C===void 0)?void 0:C.field)||"heatmap";return Lt==="heatmap"||Lt==="heatmap3d"?"heatmap":Be==="hexagon"?(ie==null?void 0:ie.indexOf(Lt))===-1?"hexagon":"grid3d":Be==="grid"?(ie==null?void 0:ie.indexOf(Lt))===-1?"grid":"grid3d":"heatmap"}}]),_}(ae);function ns(d){var S=wt();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function wt(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var er=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
void main() {
  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));
  gl_FragColor = color;
}
`,Ar=`precision highp float;
uniform mat4 u_ModelMatrix;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
}
`,Bn=function(d){D()(_,d);var S=ns(_);function _(){var x;X()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.texture=void 0,x}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity;return{u_opacity:M||1,u_texture:this.texture}}},{key:"initModels",value:function(){var C=this,M=this.layer.getSource(),U=this.rendererService.createTexture2D;return this.texture=U({height:0,width:0}),M.data.images.then(function(ie){C.texture=U({data:ie[0],width:ie[0].width,height:ie[0].height}),C.layerService.renderLayers()}),[this.layer.buildLayerModel({moduleName:"RasterImage",vertexShader:Ar,fragmentShader:er,triangulation:Ia,primitive:T.gl.TRIANGLES,depth:{enable:!1},blend:this.getBlend()})]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:T.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:2,update:function(M,U,ie,ve){return[ie[3],ie[4]]}}})}}]),_}(vt),Qa={image:Bn},Ii=Qa;function Ki(d){var S=ja();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function ja(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var pi=function(d){D()(_,d);var S=Ki(_);function _(){var x;X()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.type="ImageLayer",x}return o()(_,[{key:"buildModels",value:function(){var C=this.getModelType();this.layerModel=new Ii[C](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var C=this.getModelType(),M={image:{}};return M[C]}},{key:"getModelType",value:function(){return"image"}}]),_}(ae);function Zo(d){var S=Ci();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function Ci(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Xo=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,Au=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;
#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;
  vec2 source = a_Instance.rg;
  vec2 target =  a_Instance.ba;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  if(u_line_type == LineTypeDash) {
      v_distance_ratio = segmentIndex / segmentNumber;
      float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
      v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
    }
  if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio), 0.0, 1.0));
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));

  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  setPickingColor(a_PickingColor);
}
`,du={solid:0,dash:1},Ds=function(d){D()(_,d);var S=Zo(_);function _(){return X()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=C.lineType,ie=U===void 0?"solid":U,ve=C.dashArray,Be=ve===void 0?[10,5]:ve;return Be.length===2&&Be.push(0,0),{u_opacity:M||1,segmentNumber:30,u_line_type:du[ie||"solid"],u_dash_array:Be,u_blur:.9}}},{key:"getAnimateUniforms",value:function(){var C=this.layer.getLayerConfig(),M=C.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc2dline",vertexShader:Au,fragmentShader:Xo,triangulation:Ln,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(M,U,ie,ve){var Be=M.size,Lt=Be===void 0?1:Be;return Array.isArray(Lt)?[Lt[0]]:[Lt]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:T.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:4,update:function(M,U,ie,ve){return[ie[3],ie[4],ie[5],ie[6]]}}})}}]),_}(vt);function xl(d){var S=Qs();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function Qs(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var rl=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform mat4 u_ModelMatrix;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;
varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

   if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);

  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  setPickingColor(a_PickingColor);
}
`,qs=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,Vu={solid:0,dash:1},tc=function(d){D()(_,d);var S=xl(_);function _(){return X()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=C.lineType,ie=U===void 0?"solid":U,ve=C.dashArray,Be=ve===void 0?[10,5]:ve;return Be.length===2&&Be.push(0,0),{u_opacity:M||1,segmentNumber:30,u_line_type:Vu[ie]||0,u_dash_array:Be}}},{key:"getAnimateUniforms",value:function(){var C=this.layer.getLayerConfig(),M=C.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc3Dline",vertexShader:rl,fragmentShader:qs,triangulation:Ln,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(M,U,ie,ve){var Be=M.size,Lt=Be===void 0?1:Be;return Array.isArray(Lt)?[Lt[0]]:[Lt]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:T.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:4,update:function(M,U,ie,ve){return[ie[3],ie[4],ie[5],ie[6]]}}})}}]),_}(vt);function vc(d){var S=gc();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function gc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Ui=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,zc=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
    return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
    vec2 x = mix(source, target, ratio);
    vec2 center = mix(source, target, 0.5);
    float dSourceCenter = distance(source, center);
    float dXCenter = distance(x, center);
    return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
     float vertex_height = paraboloid(source, target, segmentRatio);

    return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
    );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size)/ 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}
float getAngularDist (vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) *
    sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}
vec2 interpolate (vec2 source, vec2 target, float angularDist, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  if(abs(angularDist - PI) < 0.001) {
    return (1.0 - t) * source + t * target;
  }
  float a = sin((1.0 - t) * angularDist) / sin(angularDist);
  float b = sin(t * angularDist) / sin(angularDist);
  vec2 sin_source = sin(source);
  vec2 cos_source = cos(source);
  vec2 sin_target = sin(target);
  vec2 cos_target = cos(target);
  float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
  float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
  float z = a * sin_source.y + b * sin_target.y;
  return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));
}

void main() {
  v_color = a_Color;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba);
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
  if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;
  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0));
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0));
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));
  setPickingColor(a_PickingColor);
}

`,yc={solid:0,dash:1},nf=function(d){D()(_,d);var S=vc(_);function _(){return X()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=C.lineType,ie=U===void 0?"solid":U,ve=C.dashArray,Be=ve===void 0?[10,5]:ve;return Be.length===2&&Be.push(0,0),{u_opacity:M||1,segmentNumber:30,u_line_type:yc[ie]||0,u_dash_array:Be}}},{key:"getAnimateUniforms",value:function(){var C=this.layer.getLayerConfig(),M=C.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc2dline",vertexShader:zc,fragmentShader:Ui,triangulation:Ln,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(M,U,ie,ve){var Be=M.size,Lt=Be===void 0?1:Be;return Array.isArray(Lt)?[Lt[0]]:[Lt]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:T.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:4,update:function(M,U,ie,ve){return[ie[3],ie[4],ie[5],ie[6]]}}})}}]),_}(vt);function af(d){var S=of();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function of(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Ti=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
uniform float u_blur : 0.99;
uniform float u_line_type: 0.0;
uniform float u_opacity : 1.0;
varying vec4 v_color;
varying vec2 v_normal;


// dash
uniform float u_dash_offset : 0.0;
uniform float u_dash_ratio : 0.1;
varying float v_distance_ratio;
varying vec4 v_dash_array;
varying float v_side;


#pragma include "picking"

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
// [animate, duration, interval, trailLength],
void main() {
  gl_FragColor = v_color;
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  // gl_FragColor.a *= u_opacity * blur ;
  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
 // dash line
  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
    // gl_FragColor.a *=(1.0- step(v_dash_array.x, mod(v_distance_ratio, dashLength)));
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,Cu=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

// dash line
attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5.\uFF0C0, 0];
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;
varying vec4 v_dash_array;
varying vec2 v_normal;
varying float v_distance_ratio;
varying float v_side;


void main() {

  if(u_line_type == LineTypeDash) {
    v_distance_ratio = a_Distance / a_Total_Distance;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  }
  if(u_aimate.x == Animate) {
      v_distance_ratio = a_Distance / a_Total_Distance;
  }
  v_normal = vec2(reverse_offset_normal(a_Normal) * sign(a_Miter));
  v_color = a_Color;
  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  vec2 offset = project_pixel(size.xy);
  v_side = a_Miter * a_Size.x;
  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  setPickingColor(a_PickingColor);
}
`,pu={solid:0,dash:1},eu=function(d){D()(_,d);var S=af(_);function _(){return X()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=C.lineType,ie=U===void 0?"solid":U,ve=C.dashArray,Be=ve===void 0?[10,5,0,0]:ve;return Be.length===2&&Be.push(0,0),{u_opacity:M||1,u_line_type:pu[ie],u_dash_array:Be}}},{key:"getAnimateUniforms",value:function(){var C=this.layer.getLayerConfig(),M=C.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"line",vertexShader:Cu,fragmentShader:Ti,triangulation:bo,primitive:T.gl.TRIANGLES,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){var C=this.layer.getLayerConfig(),M=C.lineType,U=M===void 0?"solid":M;this.styleAttributeService.registerStyleAttribute({name:"distance",type:T.AttributeType.Attribute,descriptor:{name:"a_Distance",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(ve,Be,Lt,$t){return[Lt[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:T.AttributeType.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(ve,Be,Lt,$t){return[Lt[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:2,update:function(ve,Be,Lt,$t){var Pr=ve.size,Mr=Pr===void 0?1:Pr;return Array.isArray(Mr)?[Mr[0],Mr[1]]:[Mr,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:T.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:3,update:function(ve,Be,Lt,$t,Pr){return Pr}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:T.AttributeType.Attribute,descriptor:{name:"a_Miter",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(ve,Be,Lt,$t){return[Lt[4]]}}})}}]),_}(vt),Fc={arc:Ds,arc3d:tc,greatcircle:nf,line:eu},rc=Fc;function mu(d){var S=Uc();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function Uc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var nl=function(d){D()(_,d);var S=mu(_);function _(){var x;X()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.type="LineLayer",x}return o()(_,[{key:"buildModels",value:function(){var C=this.getModelType();this.layerModel=new rc[C](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var C=this.getModelType(),M={line:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"}};return M[C]}},{key:"getModelType",value:function(){var C,M=this.styleAttributeService.getLayerStyleAttribute("shape"),U=M==null||((C=M.scale)===null||C===void 0)?void 0:C.field;return U||"line"}}]),_}(ae);function tu(d){var S=nc();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function nc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var bc=`varying vec4 v_color;
uniform float u_opacity: 1.0;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,mi=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform mat4 u_ModelMatrix;
varying vec4 v_color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec3 size = a_Size * a_Position;

  vec2 offset = project_pixel(size.xy);

  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));
  vec4 pos = vec4(project_pos.xy + offset, project_pixel(size.z), 1.0);

  float lightWeight = calc_lighting(pos);
  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);

  gl_Position = project_common_position_to_clipspace(pos);
  setPickingColor(a_PickingColor);
}
`,xc=function(d){D()(_,d);var S=tu(_);function _(){return X()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity;return{u_opacity:M||1}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointExtrude2",vertexShader:mi,fragmentShader:bc,triangulation:ea,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:3,update:function(M,U,ie,ve){var Be=M.size;if(Be){var Lt=[];return Array.isArray(Be)&&(Lt=Be.length===2?[Be[0],Be[0],Be[1]]:Be),Array.isArray(Be)||(Lt=[Be]),Lt}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:T.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:3,update:function(M,U,ie,ve,Be){return Be}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:T.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:3,update:function(M,U){var ie=ht(M.coordinates);return[ie[0],ie[1],0]}}})}}]),_}(vt);function Rf(d){var S=Ec();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function Ec(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var If=`#define Animate 0.0

uniform float u_blur : 0;
uniform float u_opacity : 1;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [0, 0, 0, 0];
uniform float u_stroke_opacity : 1;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "sdf_2d"
#pragma include "picking"

void main() {
  int shape = int(floor(v_data.w + 0.5));

  lowp float antialiasblur = v_data.z;
  float antialiased_blur = -max(u_blur, antialiasblur);
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  float opacity_t = smoothstep(0.0, antialiased_blur, outer_df);
  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiased_blur,
    0.0,
    inner_df
  );
  vec4 strokeColor = u_stroke_color == vec4(0) ? v_color : u_stroke_color;
  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

  // gl_FragColor = v_color * color_t;
  // gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  gl_FragColor.a = gl_FragColor.a * opacity_t;
  if(u_aimate.x == Animate) {
    float d = length(v_data.xy);
    float intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_aimate.z - u_aimate.y * u_time)), 0.0, 1.0);
    gl_FragColor = vec4(gl_FragColor.xyz, intensity);
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,Bc=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec2 a_Extrude;
attribute float a_Size;
attribute float a_Shape;
uniform mat4 u_ModelMatrix;

uniform float u_stroke_width : 2;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "projection"
#pragma include "picking"

void main() {
  // unpack color(vec2)
  v_color = a_Color;
  vec2 extrude = a_Extrude;

  float shape_type = a_Shape;

  float newSize = setPickingSize(a_Size);

  // radius(16-bit)
  v_radius = newSize;

  vec2 offset = project_pixel(extrude * (newSize + u_stroke_width));
  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  // TODO: billboard
  // anti-alias
  float antialiasblur = 1.0 / u_DevicePixelRatio / (newSize + u_stroke_width);

  // construct point coords
  v_data = vec4(extrude, antialiasblur,shape_type);

  setPickingColor(a_PickingColor);
}
`,Pl=function(d){D()(_,d);var S=Rf(_);function _(){return X()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=M===void 0?1:M,ie=C.stroke,ve=ie===void 0?"rgb(0,0,0,0)":ie,Be=C.strokeWidth,Lt=Be===void 0?1:Be,$t=C.strokeOpacity,Pr=$t===void 0?1:$t;return{u_opacity:U,u_stroke_width:Lt,u_stroke_color:Object(Le.s)(ve),u_stroke_opacity:Pr}}},{key:"getAnimateUniforms",value:function(){var C=this.layer.getLayerConfig(),M=C.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Za)}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointfill",vertexShader:Bc,fragmentShader:If,triangulation:Za,depth:{enable:!1},blend:this.getBlend()})]}},{key:"animateOption2Array",value:function(C){return[C.enable?0:1,C.speed||1,C.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var C=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:T.AttributeType.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:2,update:function(U,ie,ve,Be){var Lt=[1,1,-1,1,-1,-1,1,-1],$t=Be%4*2;return[Lt[$t],Lt[$t+1]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(U,ie,ve,Be){var Lt=U.size,$t=Lt===void 0?5:Lt;return Array.isArray($t)?[$t[0]]:[$t]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:T.AttributeType.Attribute,descriptor:{name:"a_Shape",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(U,ie,ve,Be){var Lt=U.shape,$t=Lt===void 0?2:Lt,Pr=C.layer.getLayerConfig().shape2d,Mr=Pr.indexOf($t);return[Mr]}}})}}]),_}(vt);function al(d){var S=Os();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function Os(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var ac=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [1, 1, 1, 1];
uniform float u_stroke_opacity : 1;
uniform float u_opacity : 1;

varying float v_size;
#pragma include "picking"
void main(){
vec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
vec2 fragmentPosition = 2.0*gl_PointCoord - 1.0;
float distance = length(fragmentPosition);
float distanceSqrd = distance * distance;
float radius = 1.;
float r = 1.0 - smoothstep(radius-(radius*0.01),
                         radius+(radius*0.01),
                         distanceSqrd);
  vec4 textureColor=texture2D(u_texture,pos);
  if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
        gl_FragColor= vec4(textureColor.xyz, textureColor.w);
  }else {
        gl_FragColor= step(0.01, textureColor.z) * v_color;
  }
  gl_FragColor.a =gl_FragColor.a * u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,No=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform float u_stroke_width : 1;
varying float v_size;

#pragma include "projection"
#pragma include "picking"

void main() {
   v_color = a_Color;
   v_uv = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   v_size = a_Size;

   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;

  setPickingColor(a_PickingColor);

}
`,Ll=function(d){D()(_,d);var S=al(_);function _(){var x;X()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.texture=void 0,x}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity;return{u_opacity:M||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128]}}},{key:"initModels",value:function(){var C=this;return this.initIconFontGlyphs(),this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",function(){C.updateTexture(),C.layer.render()}),[this.layer.buildLayerModel({moduleName:"pointiconImage",vertexShader:No,fragmentShader:ac,triangulation:ca,primitive:T.gl.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var C=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(U,ie,ve,Be){var Lt=U.size;return Array.isArray(Lt)?[Lt[0]]:[Lt]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:T.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:2,update:function(U,ie,ve,Be){var Lt=C.fontService.mapping,$t=U.shape,Pr=C.fontService.getGlyph($t),Mr=Lt[Pr],mn=Mr.x,On=Mr.y;return[mn,On]}}})}},{key:"updateTexture",value:function(){var C=this.rendererService.createTexture2D,M=this.fontService.canvas;this.texture=C({data:M,mag:T.gl.LINEAR,min:T.gl.LINEAR,width:M.width,height:M.height})}},{key:"initIconFontGlyphs",value:function(){var C=this,M=this.layer.getLayerConfig(),U=M.fontWeight,ie=U===void 0?"normal":U,ve=M.fontFamily,Be=ve===void 0?"sans-serif":ve,Lt=this.layer.getEncodedData(),$t=[];Lt.forEach(function(Pr){var Mr=Pr.shape,mn=Mr===void 0?"":Mr;mn=mn.toString();var On=C.fontService.getGlyph(mn);$t.indexOf(On)===-1&&$t.push(On)}),this.fontService.setFontOptions({characterSet:$t,fontWeight:ie,fontFamily:Be,fontSize:48})}}]),_}(vt);function El(d){var S=Vc();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function Vc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Rl=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [1, 1, 1, 1];
uniform float u_stroke_opacity : 1;
uniform float u_opacity : 1;

varying float v_size;
#pragma include "picking"
void main(){
vec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
vec2 fragmentPosition = 2.0*gl_PointCoord - 1.0;
float distance = length(fragmentPosition);
float distanceSqrd = distance * distance;
float radius = 1.;
float r = 1.0 - smoothstep(radius-(radius*0.01),
                         radius+(radius*0.01),
                         distanceSqrd);
  vec4 textureColor=texture2D(u_texture,pos);
  if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
        gl_FragColor= vec4(textureColor.xyz, textureColor.w);
  }else {
        gl_FragColor= step(0.01, textureColor.z) * v_color;
  }
  gl_FragColor.a =gl_FragColor.a * u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,ru=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform float u_stroke_width : 1;
varying float v_size;

#pragma include "projection"
#pragma include "picking"

void main() {
   v_color = a_Color;
   v_uv = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   v_size = a_Size;

   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;

  setPickingColor(a_PickingColor);

}
`,Gc=function(d){D()(_,d);var S=El(_);function _(){var x;X()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.texture=void 0,x.updateTexture=function(){var ie=x.rendererService.createTexture2D;if(x.texture){x.texture.update({data:x.iconService.getCanvas()}),x.layer.render();return}x.texture=ie({data:x.iconService.getCanvas(),mag:T.gl.LINEAR,min:T.gl.LINEAR,width:1024,height:x.iconService.canvasHeight||128})},x}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity;return this.rendererService.getDirty()&&this.texture.bind(),{u_opacity:M||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128]}}},{key:"initModels",value:function(){return this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){this.texture&&this.texture.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:ru,fragmentShader:Rl,triangulation:ca,primitive:T.gl.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var C=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(U,ie,ve,Be){var Lt=U.size,$t=Lt===void 0?5:Lt;return Array.isArray($t)?[$t[0]]:[$t]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:T.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:2,update:function(U,ie,ve,Be){var Lt=C.iconService.getIconMap(),$t=U.shape,Pr=Lt[$t]||{x:0,y:0},Mr=Pr.x,mn=Pr.y;return[Mr,mn]}}})}}]),_}(vt);function bf(d){var S=xf();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function xf(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Il=`
uniform float u_opacity : 1;
varying vec4 v_color;
#pragma include "picking"
void main() {
  gl_FragColor = v_color;
  gl_FragColor.a =gl_FragColor.a * u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,ic=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
attribute float a_Size;
attribute vec4 a_Color;
varying vec4 v_color;
#pragma include "projection"
#pragma include "picking"
void main() {
  v_color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
  gl_Position = project_common_position_to_clipspace(project_pos);
  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
    setPickingColor(a_PickingColor);
}
`;function Zi(d){var S=d.coordinates;return{vertices:Ft()(S),indices:[0],size:S.length}}var Dl=function(d){D()(_,d);var S=bf(_);function _(){return X()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=M===void 0?1:M,ie=C.stroke,ve=ie===void 0?"rgb(0,0,0,0)":ie,Be=C.strokeWidth,Lt=Be===void 0?1:Be;return{u_opacity:U,u_stroke_width:Lt,u_stroke_color:Object(Le.s)(ve)}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"normalpoint",vertexShader:ic,fragmentShader:Il,triangulation:Zi,depth:{enable:!1},primitive:T.gl.POINTS,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(M,U,ie,ve){var Be=M.size,Lt=Be===void 0?1:Be;return Array.isArray(Lt)?[Lt[0]]:[Lt]}}})}},{key:"defaultStyleOptions",value:function(){return{blend:T.BlendType.additive}}}]),_}(vt);function Gu(d,S){var _;if(typeof Symbol=="undefined"||d[Symbol.iterator]==null){if(Array.isArray(d)||(_=Ef(d))||S&&d&&typeof d.length=="number"){_&&(d=_);var x=0,C=function(){};return{s:C,n:function(){return x>=d.length?{done:!0}:{done:!1,value:d[x++]}},e:function(Be){throw Be},f:C}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,U=!1,ie;return{s:function(){_=d[Symbol.iterator]()},n:function(){var Be=_.next();return M=Be.done,Be},e:function(Be){U=!0,ie=Be},f:function(){try{!M&&_.return!=null&&_.return()}finally{if(U)throw ie}}}}function Ef(d,S){if(!d)return;if(typeof d=="string")return Nl(d,S);var _=Object.prototype.toString.call(d).slice(8,-1);if(_==="Object"&&d.constructor&&(_=d.constructor.name),_==="Map"||_==="Set")return Array.from(d);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return Nl(d,S)}function Nl(d,S){(S==null||S>d.length)&&(S=d.length);for(var _=0,x=new Array(S);_<S;_++)x[_]=d[_];return x}var oc=function(){function d(S,_,x){X()(this,d),this.boxCells=[],this.xCellCount=void 0,this.yCellCount=void 0,this.boxKeys=void 0,this.bboxes=void 0,this.width=void 0,this.height=void 0,this.xScale=void 0,this.yScale=void 0,this.boxUid=void 0;var C=this.boxCells;this.xCellCount=Math.ceil(S/x),this.yCellCount=Math.ceil(_/x);for(var M=0;M<this.xCellCount*this.yCellCount;M++)C.push([]);this.boxKeys=[],this.bboxes=[],this.width=S,this.height=_,this.xScale=this.xCellCount/S,this.yScale=this.yCellCount/_,this.boxUid=0}return o()(d,[{key:"insert",value:function(_,x,C,M,U){this.forEachCell(x,C,M,U,this.insertBoxCell,this.boxUid++),this.boxKeys.push(_),this.bboxes.push(x),this.bboxes.push(C),this.bboxes.push(M),this.bboxes.push(U)}},{key:"query",value:function(_,x,C,M,U){return this.queryHitTest(_,x,C,M,!1,U)}},{key:"hitTest",value:function(_,x,C,M,U){return this.queryHitTest(_,x,C,M,!0,U)}},{key:"insertBoxCell",value:function(_,x,C,M,U,ie){this.boxCells[U].push(ie)}},{key:"queryHitTest",value:function(_,x,C,M,U,ie){if(C<0||_>this.width||M<0||x>this.height)return U?!1:[];var ve=[];if(_<=0&&x<=0&&this.width<=C&&this.height<=M){if(U)return!0;for(var Be=0;Be<this.boxKeys.length;Be++)ve.push({key:this.boxKeys[Be],x1:this.bboxes[Be*4],y1:this.bboxes[Be*4+1],x2:this.bboxes[Be*4+2],y2:this.bboxes[Be*4+3]});return ie?ve.filter(ie):ve}var Lt={hitTest:U,seenUids:{box:{},circle:{}}};return this.forEachCell(_,x,C,M,this.queryCell,ve,Lt,ie),U?ve.length>0:ve}},{key:"queryCell",value:function(_,x,C,M,U,ie,ve,Be){var Lt=ve.seenUids,$t=this.boxCells[U];if($t!==null){var Pr=this.bboxes,Mr=Gu($t),mn;try{for(Mr.s();!(mn=Mr.n()).done;){var On=mn.value;if(!Lt.box[On]){Lt.box[On]=!0;var Mn=On*4;if(_<=Pr[Mn+2]&&x<=Pr[Mn+3]&&C>=Pr[Mn+0]&&M>=Pr[Mn+1]&&(!Be||Be(this.boxKeys[On]))){if(ve.hitTest)return ie.push(!0),!0;ie.push({key:this.boxKeys[On],x1:Pr[Mn],y1:Pr[Mn+1],x2:Pr[Mn+2],y2:Pr[Mn+3]})}}}}catch(Sa){Mr.e(Sa)}finally{Mr.f()}}return!1}},{key:"forEachCell",value:function(_,x,C,M,U,ie,ve,Be){for(var Lt=this.convertToXCellCoord(_),$t=this.convertToYCellCoord(x),Pr=this.convertToXCellCoord(C),Mr=this.convertToYCellCoord(M),mn=Lt;mn<=Pr;mn++)for(var On=$t;On<=Mr;On++){var Mn=this.xCellCount*On+mn;if(U.call(this,_,x,C,M,Mn,ie,ve,Be))return}}},{key:"convertToXCellCoord",value:function(_){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(_*this.xScale)))}},{key:"convertToYCellCoord",value:function(_){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(_*this.yScale)))}}]),d}(),Wf=oc,Df=function(){function d(S,_){X()(this,d),this.width=void 0,this.height=void 0,this.grid=void 0,this.viewportPadding=100,this.screenRightBoundary=void 0,this.screenBottomBoundary=void 0,this.gridRightBoundary=void 0,this.gridBottomBoundary=void 0,this.width=S,this.height=_,this.viewportPadding=Math.max(S,_),this.grid=new Wf(S+this.viewportPadding,_+this.viewportPadding,25),this.screenRightBoundary=S+this.viewportPadding,this.screenBottomBoundary=_+this.viewportPadding,this.gridRightBoundary=S+2*this.viewportPadding,this.gridBottomBoundary=_+2*this.viewportPadding}return o()(d,[{key:"placeCollisionBox",value:function(_){var x=_.x1+_.anchorPointX+this.viewportPadding,C=_.y1+_.anchorPointY+this.viewportPadding,M=_.x2+_.anchorPointX+this.viewportPadding,U=_.y2+_.anchorPointY+this.viewportPadding;return!this.isInsideGrid(x,C,M,U)||this.grid.hitTest(x,C,M,U)?{box:[]}:{box:[x,C,M,U]}}},{key:"insertCollisionBox",value:function(_,x){var C={featureIndex:x};this.grid.insert(C,_[0],_[1],_[2],_[3])}},{key:"project",value:function(_,x,C){var M=lr.e.fromValues(x,C,0,1),U=lr.e.create(),ie=lr.b.fromValues.apply(lr.b,Ft()(_));return lr.e.transformMat4(U,M,ie),{x:(U[0]/U[3]+1)/2*this.width+this.viewportPadding,y:(-U[1]/U[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(_,x,C,M){return C>=0&&_<this.gridRightBoundary&&M>=0&&x<this.gridBottomBoundary}}]),d}();function Tc(d,S){var _;if(typeof Symbol=="undefined"||d[Symbol.iterator]==null){if(Array.isArray(d)||(_=kl(d))||S&&d&&typeof d.length=="number"){_&&(d=_);var x=0,C=function(){};return{s:C,n:function(){return x>=d.length?{done:!0}:{done:!1,value:d[x++]}},e:function(Be){throw Be},f:C}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,U=!1,ie;return{s:function(){_=d[Symbol.iterator]()},n:function(){var Be=_.next();return M=Be.done,Be},e:function(Be){U=!0,ie=Be},f:function(){try{!M&&_.return!=null&&_.return()}finally{if(U)throw ie}}}}function kl(d,S){if(!d)return;if(typeof d=="string")return _c(d,S);var _=Object.prototype.toString.call(d).slice(8,-1);if(_==="Object"&&d.constructor&&(_=d.constructor.name),_==="Map"||_==="Set")return Array.from(d);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return _c(d,S)}function _c(d,S){(S==null||S>d.length)&&(S=d.length);for(var _=0,x=new Array(S);_<S;_++)x[_]=d[_];return x}function wu(d){var S=.5,_=.5;switch(d){case"right":case"top-right":case"bottom-right":S=1;break;case"left":case"top-left":case"bottom-left":S=0;break;default:S=.5}switch(d){case"bottom":case"bottom-right":case"bottom-left":_=1;break;case"top":case"top-right":case"top-left":_=0;break;default:_=.5}return{horizontalAlign:S,verticalAlign:_}}function Ns(d,S,_,x,C){if(!C)return;var M=d[x],U=M.glyph;if(U)for(var ie=S[U].advance*M.scale,ve=(d[x].x+ie)*C,Be=_;Be<=x;Be++)d[Be].x-=ve}function il(d,S,_,x,C,M,U){var ie=(S-_)*C,ve=(-x*U+.5)*M,Be=Tc(d),Lt;try{for(Be.s();!(Lt=Be.n()).done;){var $t=Lt.value;$t.x+=ie,$t.y+=ve}}catch(Pr){Be.e(Pr)}finally{Be.f()}}function Tl(d,S,_,x,C,M,U){var ie=-8,ve=0,Be=ie,Lt=0,$t=d.positionedGlyphs,Pr=M==="right"?1:M==="left"?0:.5,Mr=$t.length;_.forEach(function(Ha){if(Ha.split("").forEach(function(Ka){var ni=S[Ka],io=0;ni&&($t.push({glyph:Ka,x:ve,y:Be+io,vertical:!1,scale:1,metrics:ni}),ve+=ni.advance+U)}),$t.length!==Mr){var ri=ve-U;Lt=Math.max(ri,Lt),Ns($t,S,Mr,$t.length-1,Pr)}ve=0,Be+=x});var mn=wu(C),On=mn.horizontalAlign,Mn=mn.verticalAlign;il($t,Pr,On,Mn,Lt,x,_.length);var Sa=Be-ie;d.top+=-Mn*Sa,d.bottom=d.top+Sa,d.left+=-On*Lt,d.right=d.left+Lt}function sc(d,S,_,x,C,M){var U=arguments.length>6&&arguments[6]!==void 0?arguments[6]:[0,0],ie=d.split(`
`),ve=[],Be={positionedGlyphs:ve,top:U[1],bottom:U[1],left:U[0],right:U[0],lineCount:ie.length,text:d};return Tl(Be,S,ie,_,x,C,M),ve.length?Be:!1}function Bi(d){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0],_=arguments.length>2?arguments[2]:void 0,x=d.positionedGlyphs,C=x===void 0?[]:x,M=[],U=Tc(C),ie;try{for(U.s();!(ie=U.n()).done;){var ve=ie.value,Be=ve.metrics,Lt=4,$t=Be.advance*ve.scale/2,Pr=_?[ve.x+$t,ve.y]:[0,0],Mr=_?[0,0]:[ve.x+$t+S[0],ve.y+S[1]],mn=(0-Lt)*ve.scale-$t+Mr[0],On=(0-Lt)*ve.scale+Mr[1],Mn=mn+Be.width*ve.scale,Sa=On+Be.height*ve.scale,Ha={x:mn,y:On},ri={x:Mn,y:On},Ka={x:mn,y:Sa},ni={x:Mn,y:Sa};M.push({tl:Ha,tr:ri,bl:Ka,br:ni,tex:Be,glyphOffset:Pr})}}catch(io){U.e(io)}finally{U.f()}return M}function vu(d,S){var _;if(typeof Symbol=="undefined"||d[Symbol.iterator]==null){if(Array.isArray(d)||(_=ol(d))||S&&d&&typeof d.length=="number"){_&&(d=_);var x=0,C=function(){};return{s:C,n:function(){return x>=d.length?{done:!0}:{done:!1,value:d[x++]}},e:function(Be){throw Be},f:C}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,U=!1,ie;return{s:function(){_=d[Symbol.iterator]()},n:function(){var Be=_.next();return M=Be.done,Be},e:function(Be){U=!0,ie=Be},f:function(){try{!M&&_.return!=null&&_.return()}finally{if(U)throw ie}}}}function ol(d,S){if(!d)return;if(typeof d=="string")return Yo(d,S);var _=Object.prototype.toString.call(d).slice(8,-1);if(_==="Object"&&d.constructor&&(_=d.constructor.name),_==="Map"||_==="Set")return Array.from(d);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return Yo(d,S)}function Yo(d,S){(S==null||S>d.length)&&(S=d.length);for(var _=0,x=new Array(S);_<S;_++)x[_]=d[_];return x}function ei(d){var S=$a();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function $a(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Hu=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;
// uniform float u_font_size : 24.0;
uniform float u_opacity : 1.0;
uniform float u_stroke_opacity: 1.0;
uniform vec4 u_stroke : [0, 0, 0, 1];
uniform float u_strokeWidth : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec4 v_color;
varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;

#pragma include "picking"
void main() {
  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  // float fontScale = u_font_size / FONT_SIZE;

  lowp float buff = (6.0 - u_strokeWidth / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), vec4(u_stroke.rgb, u_stroke.a * u_opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor.a= gl_FragColor.a * alpha;
  gl_FragColor = filterColor(gl_FragColor);
}
`,ti=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;
attribute vec4 a_Color;
attribute float a_Size;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;

varying vec2 v_uv;
varying float v_gamma_scale;
varying vec4 v_color;
varying float v_fontScale;

#pragma include "projection"
#pragma include "picking"

void main() {
  v_color = a_Color;
  v_uv = a_tex / u_sdf_map_size;

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
   v_fontScale = fontScale;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  gl_Position = vec4(projected_position.xy / projected_position.w
    + a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`;function Xa(d){var S=this,_=d.id,x=[],C=[];if(!S.glyphInfoMap||!S.glyphInfoMap[_])return{vertices:[],indices:[],size:7};var M=S.glyphInfoMap[_].centroid,U=M.length===2?[M[0],M[1],0]:M;return S.glyphInfoMap[_].glyphQuads.forEach(function(ie,ve){x.push.apply(x,Ft()(U).concat([ie.tex.x,ie.tex.y+ie.tex.height,ie.tl.x,ie.tl.y],Ft()(U),[ie.tex.x+ie.tex.width,ie.tex.y+ie.tex.height,ie.tr.x,ie.tr.y],Ft()(U),[ie.tex.x+ie.tex.width,ie.tex.y,ie.br.x,ie.br.y],Ft()(U),[ie.tex.x,ie.tex.y,ie.bl.x,ie.bl.y])),C.push(0+ve*4,1+ve*4,2+ve*4,2+ve*4,3+ve*4,0+ve*4)}),{vertices:x,indices:C,size:7}}var Tf=function(d){D()(_,d);var S=ei(_);function _(){var x;X()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.glyphInfo=void 0,x.glyphInfoMap={},x.texture=void 0,x.currentZoom=-1,x.extent=void 0,x.textureHeight=0,x.textCount=0,x.preTextStyle={},x.buildModels=function(){return x.initGlyph(),x.updateTexture(),x.filterGlyphs(),[x.layer.buildLayerModel({moduleName:"pointText",vertexShader:ti,fragmentShader:Hu,triangulation:Xa.bind(Xe()(x)),depth:{enable:!1},blend:x.getBlend()})]},x}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=M===void 0?1:M,ie=C.stroke,ve=ie===void 0?"#fff":ie,Be=C.strokeWidth,Lt=Be===void 0?0:Be,$t=C.strokeOpacity,Pr=$t===void 0?1:$t,Mr=C.textAnchor,mn=Mr===void 0?"center":Mr,On=C.textAllowOverlap,Mn=On===void 0?!1:On,Sa=C.halo,Ha=Sa===void 0?.5:Sa,ri=C.gamma,Ka=ri===void 0?2:ri,ni=this.fontService,io=ni.canvas,Aa=ni.mapping;return Object.keys(Aa).length!==this.textCount&&(this.updateTexture(),this.textCount=Object.keys(Aa).length),this.preTextStyle={textAnchor:mn,textAllowOverlap:Mn},{u_opacity:U,u_stroke_opacity:Pr,u_sdf_map:this.texture,u_stroke:Object(Le.s)(ve),u_halo_blur:Ha,u_gamma_scale:Ka,u_sdf_map_size:[io.width,io.height],u_strokeWidth:Lt}}},{key:"initModels",value:function(){this.layer.on("remapping",this.buildModels),this.extent=this.textExtent();var C=this.layer.getLayerConfig(),M=C.textAnchor,U=M===void 0?"center":M,ie=C.textAllowOverlap,ve=ie===void 0?!0:ie;return this.preTextStyle={textAnchor:U,textAllowOverlap:ve},this.buildModels()}},{key:"needUpdate",value:function(){var C=this.layer.getLayerConfig(),M=C.textAllowOverlap,U=M===void 0?!1:M,ie=this.mapService.getZoom(),ve=this.mapService.getBounds(),Be=Object(Le.j)(this.extent,ve);return!U&&(Math.abs(this.currentZoom-ie)>1||!Be)||U!==this.preTextStyle.textAllowOverlap?(this.reBuildModel(),!0):!1}},{key:"clearModels",value:function(){this.layer.off("remapping",this.buildModels)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:T.AttributeType.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:2,update:function(M,U,ie,ve){return[ie[5],ie[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(M,U,ie,ve){var Be=M.size,Lt=Be===void 0?12:Be;return Array.isArray(Lt)?[Lt[0]]:[Lt]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:T.AttributeType.Attribute,descriptor:{name:"a_tex",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:2,update:function(M,U,ie,ve){return[ie[3],ie[4]]}}})}},{key:"textExtent",value:function(){var C=this.mapService.getBounds();return Object(Le.r)(C,.5)}},{key:"initTextFont",value:function(){var C=this.layer.getLayerConfig(),M=C.fontWeight,U=M===void 0?"400":M,ie=C.fontFamily,ve=ie===void 0?"sans-serif":ie,Be=this.layer.getEncodedData(),Lt=[];Be.forEach(function($t){var Pr=$t.shape,Mr=Pr===void 0?"":Pr;Mr=Mr.toString();var mn=vu(Mr),On;try{for(mn.s();!(On=mn.n()).done;){var Mn=On.value;Lt.indexOf(Mn)===-1&&Lt.push(Mn)}}catch(Sa){mn.e(Sa)}finally{mn.f()}}),this.fontService.setFontOptions({characterSet:Lt,fontWeight:U,fontFamily:ve})}},{key:"generateGlyphLayout",value:function(){var C=this,M=this.fontService.mapping,U=this.layer.getLayerConfig(),ie=U.spacing,ve=ie===void 0?2:ie,Be=U.textAnchor,Lt=Be===void 0?"center":Be,$t=U.textOffset,Pr=this.layer.getEncodedData();this.glyphInfo=Pr.map(function(Mr){var mn=Mr.shape,On=mn===void 0?"":mn,Mn=Mr.coordinates,Sa=Mr.id,Ha=Mr.size,ri=Ha===void 0?1:Ha,Ka=sc(On.toString(),M,ri,Lt,"center",ve,$t),ni=Bi(Ka,$t,!1);return Mr.shaping=Ka,Mr.glyphQuads=ni,Mr.centroid=ht(Mn),C.glyphInfoMap[Sa]={shaping:Ka,glyphQuads:ni,centroid:ht(Mn)},Mr})}},{key:"filterGlyphs",value:function(){var C=this,M=this.layer.getLayerConfig(),U=M.padding,ie=U===void 0?[4,4]:U,ve=M.textAllowOverlap,Be=ve===void 0?!1:ve;if(Be)return;this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var Lt=this.rendererService.getViewportSize(),$t=Lt.width,Pr=Lt.height,Mr=new Df($t,Pr),mn=this.glyphInfo.filter(function(On){var Mn=On.shaping,Sa=On.id,Ha=Sa===void 0?0:Sa,ri=On.centroid,Ka=On.size,ni=Ka/24,io=C.mapService.lngLatToContainer(ri),Aa=Mr.placeCollisionBox({x1:Mn.left*ni-ie[0],x2:Mn.right*ni+ie[0],y1:Mn.top*ni-ie[1],y2:Mn.bottom*ni+ie[1],anchorPointX:io.x,anchorPointY:io.y}),Do=Aa.box;return Do&&Do.length?(Mr.insertCollisionBox(Do,Ha),!0):!1});mn.forEach(function(On){C.glyphInfoMap[On.id]=On})}},{key:"initGlyph",value:function(){this.initTextFont(),this.generateGlyphLayout()}},{key:"updateTexture",value:function(){var C=this.rendererService.createTexture2D,M=this.fontService.canvas;this.textureHeight=M.height,this.texture&&this.texture.destroy(),this.texture=C({data:M,mag:T.gl.LINEAR,min:T.gl.LINEAR,width:M.width,height:M.height})}},{key:"reBuildModel",value:function(){this.filterGlyphs(),this.layer.models=[this.layer.buildLayerModel({moduleName:"pointText",vertexShader:ti,fragmentShader:Hu,triangulation:Xa.bind(this),depth:{enable:!1},blend:this.getBlend()})]}}]),_}(vt),_f={fill:Pl,image:Gc,normal:Dl,extrude:xc,text:Tf,icon:Ll},Ko=_f;function Wu(d){var S=gs();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function gs(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var ks=function(d){D()(_,d);var S=Wu(_);function _(){var x;X()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.type="PointLayer",x}return o()(_,[{key:"buildModels",value:function(){var C=this.getModelType();this.layerModel=new Ko[C](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var C=this.getModelType(),M={normal:{blend:"additive"},fill:{blend:"normal"},extrude:{},image:{},icon:{},text:{blend:"normal"}};return M[C]}},{key:"getModelType",value:function(){var C=this.getEncodedData(),M=this.getLayerConfig(),U=M.shape2d,ie=M.shape3d,ve=this.iconService.getIconMap(),Be=C.find(function($t){return $t.hasOwnProperty("shape")});if(Be){var Lt=Be.shape;return Lt==="dot"?"normal":(U==null?void 0:U.indexOf(Lt))!==-1?"fill":(ie==null?void 0:ie.indexOf(Lt))!==-1?"extrude":ve.hasOwnProperty(Lt)?"image":this.fontService.getGlyph(Lt)!==""?"icon":"text"}else return"normal"}}]),_}(ae);function ys(d){var S=$o();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function $o(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Zu=`uniform float u_opacity: 1.0;
varying vec4 v_Color;

#pragma include "picking"

void main() {
  gl_FragColor = v_Color;
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,xn=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,bs=function(d){D()(_,d);var S=ys(_);function _(){return X()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=M===void 0?1:M;return{u_opacity:U}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygonExtrude",vertexShader:xn,fragmentShader:Zu,triangulation:va})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:T.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:T.gl.STATIC_DRAW,data:[],type:T.gl.FLOAT},size:3,update:function(M,U,ie,ve,Be){return Be}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:T.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(M,U,ie,ve){var Be=M.size,Lt=Be===void 0?10:Be;return Array.isArray(Lt)?[Lt[0]]:[Lt]}}})}}]),_}(vt);function nu(d){var S=Sc();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function Sc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Ou=`uniform float u_opacity: 1.0;
varying vec4 v_Color;

#pragma include "picking"

void main() {
  gl_FragColor = v_Color;
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Mu=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "picking"

void main() {
  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}

`,gu=function(d){D()(_,d);var S=nu(_);function _(){return X()(this,_),S.apply(this,arguments)}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=M===void 0?1:M;return{u_opacity:U}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygon",vertexShader:Mu,fragmentShader:Ou,triangulation:Ri,depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){}}]),_}(vt),Zr={fill:gu,line:eu,extrude:bs,text:Tf,point_fill:Pl,point_image:Gc,point_normal:Dl,point_extrude:xc},vi=Zr;function Hc(d){var S=Wc();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function Wc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var sl=function(d){D()(_,d);var S=Hc(_);function _(){var x;X()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.type="PolygonLayer",x}return o()(_,[{key:"buildModels",value:function(){var C=this.getModelType();this.layerModel=new vi[C](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var C,M=this.styleAttributeService.getLayerStyleAttribute("shape"),U=M==null||((C=M.scale)===null||C===void 0)?void 0:C.field;return U==="fill"?"fill":U==="extrude"?"extrude":U==="line"?"line":this.getPointModelType()}},{key:"getPointModelType",value:function(){var C=this.getEncodedData(),M=this.getLayerConfig(),U=M.shape2d,ie=M.shape3d,ve=this.iconService.getIconMap(),Be=C.find(function($t){return $t.hasOwnProperty("shape")});if(Be){var Lt=Be.shape;return Lt==="dot"?"point_normal":(U==null?void 0:U.indexOf(Lt))!==-1?"point_fill":(ie==null?void 0:ie.indexOf(Lt))!==-1?"point_extrude":ve.hasOwnProperty(Lt)?"point_image":"text"}else return"fill"}}]),_}(ae);function Pu(d){var S=Ms();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function Ms(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var as=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_min;
uniform float u_max;
uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;
varying vec2 v_texCoord;

void main() {

  float value = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).r;
  if (value == u_noDataValue)
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1]))
    gl_FragColor = vec4(0, 0, 0, 0);
  else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] -u_domain[0]);
    vec4 color = texture2D(u_colorTexture,vec2(normalisedValue, 0));
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
  }


}
`,wi=`precision highp float;
uniform mat4 u_ModelMatrix;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
}
`,js=function(d){D()(_,d);var S=Pu(_);function _(){var x;X()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.texture=void 0,x.colorTexture=void 0,x}return o()(_,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,U=M===void 0?1:M,ie=C.clampLow,ve=ie===void 0?!0:ie,Be=C.clampHigh,Lt=Be===void 0?!0:Be,$t=C.noDataValue,Pr=$t===void 0?-9999999:$t,Mr=C.domain,mn=Mr===void 0?[0,1]:Mr;return this.updateColorTexure(),{u_opacity:U||1,u_texture:this.texture,u_domain:mn,u_clampLow:ve,u_clampHigh:typeof Lt!="undefined"?Lt:ve,u_noDataValue:Pr,u_colorTexture:this.colorTexture}}},{key:"initModels",value:function(){var C=this.layer.getSource(),M=this.rendererService.createTexture2D,U=C.data.dataArray[0];this.texture=M({data:U.data,width:U.width,height:U.height,format:T.gl.LUMINANCE,type:T.gl.FLOAT});var ie=this.layer.getLayerConfig(),ve=ie.rampColors,Be=Object(Le.n)(ve);return this.colorTexture=M({data:Be.data,width:Be.width,height:Be.height,flipY:!1}),[this.layer.buildLayerModel({moduleName:"RasterImageData",vertexShader:wi,fragmentShader:as,triangulation:Ia,primitive:T.gl.TRIANGLES,depth:{enable:!1},blend:this.getBlend()})]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:T.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:2,update:function(M,U,ie,ve){return[ie[3],ie[4]]}}})}},{key:"updateColorTexure",value:function(){var C=this.rendererService.createTexture2D,M=this.layer.getLayerConfig(),U=M.rampColors,ie=Object(Le.n)(U);this.colorTexture=C({data:ie.data,width:ie.width,height:ie.height,flipY:!1})}}]),_}(vt),sf={raster:js,raster3d:js},ul=sf;function jl(d){var S=uf();return function(){var x=Y()(d),C;if(S){var M=Y()(this).constructor;C=Reflect.construct(x,arguments,M)}else C=x.apply(this,arguments);return re()(this,C)}}function uf(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var uc=function(d){D()(_,d);var S=jl(_);function _(){var x;X()(this,_);for(var C=arguments.length,M=new Array(C),U=0;U<C;U++)M[U]=arguments[U];return x=S.call.apply(S,[this].concat(M)),x.type="RasterLayer",x}return o()(_,[{key:"buildModels",value:function(){var C=this.getModelType();this.layerModel=new ul[C](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var C=this.getModelType(),M={raster:{},raster3d:{}};return M[C]}},{key:"getModelType",value:function(){return"raster"}}]),_}(ae),uo,ci,mo,ll,gi,Ps,cl,au;function ko(d,S){var _=Object.keys(d);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(d);S&&(x=x.filter(function(C){return Object.getOwnPropertyDescriptor(d,C).enumerable})),_.push.apply(_,x)}return _}function _l(d){for(var S=1;S<arguments.length;S++){var _=arguments[S]!=null?arguments[S]:{};S%2?ko(Object(_),!0).forEach(function(x){we()(d,x,_[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(_)):ko(Object(_)).forEach(function(x){Object.defineProperty(d,x,Object.getOwnPropertyDescriptor(_,x))})}return d}var Qn=(uo=Object(ir.injectable)(),ci=Object(ir.inject)(T.TYPES.IGlobalConfigService),mo=Object(ir.inject)(T.TYPES.ILogService),uo(ll=(gi=(au=function(){function d(){X()(this,d),je()(this,"configService",Ps,this),je()(this,"logger",cl,this)}return o()(d,[{key:"apply",value:function(_,x){var C=this,M=x.styleAttributeService;_.hooks.init.tap("DataMappingPlugin",function(){C.generateMaping(_,{styleAttributeService:M})}),_.hooks.beforeRenderData.tap("DataMappingPlugin",function(){return _.dataState.dataMappingNeedUpdate=!1,C.generateMaping(_,{styleAttributeService:M}),!0}),_.hooks.beforeRender.tap("DataMappingPlugin",function(){if(_.layerModelNeedUpdate)return;var U=M.getLayerStyleAttributes()||[],ie=M.getLayerStyleAttribute("filter"),ve=_.getSource().data.dataArray,Be=U.filter(function($t){return $t.needRemapping}),Lt=ve;(ie==null?void 0:ie.needRemapping)&&(ie==null?void 0:ie.scale)&&(Lt=ve.filter(function($t){return C.applyAttributeMapping(ie,$t)[0]})),Be.length&&((ie==null?void 0:ie.needRemapping)?(_.setEncodedData(C.mapping(U,Lt)),ie.needRemapping=!1):_.setEncodedData(C.mapping(Be,Lt,_.getEncodedData())),C.logger.debug("remapping finished"),_.emit("remapping",null))})}},{key:"generateMaping",value:function(_,x){var C=this,M=x.styleAttributeService,U=M.getLayerStyleAttributes()||[],ie=M.getLayerStyleAttribute("filter"),ve=_.getSource().data.dataArray,Be=ve;(ie==null?void 0:ie.scale)&&(Be=ve.filter(function(Lt){return C.applyAttributeMapping(ie,Lt)[0]})),_.setEncodedData(this.mapping(U,Be))}},{key:"mapping",value:function(_,x,C){var M=this;return x.map(function(U,ie){var ve=C?C[ie]:{},Be=_l({id:U._id,coordinates:U.coordinates},ve);return _.filter(function(Lt){return Lt.scale!==void 0}).forEach(function(Lt){var $t=M.applyAttributeMapping(Lt,U);Lt.needRemapping=!1,Lt.name==="color"&&($t=$t.map(function(Pr){return Object(Le.s)(Pr)})),Be[Lt.name]=Array.isArray($t)&&$t.length===1?$t[0]:$t}),Be})}},{key:"applyAttributeMapping",value:function(_,x){var C;if(!_.scale)return[];var M=(_==null||((C=_.scale)===null||C===void 0)?void 0:C.scalers)||[],U=[];return M.forEach(function(ie){var ve,Be=ie.field;(x.hasOwnProperty(Be)||((ve=_.scale)===null||ve===void 0?void 0:ve.type)==="variable")&&U.push(x[Be])}),_.mapping?_.mapping(U):[]}}]),d}(),au),Ps=Je()(gi.prototype,"configService",[ci],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cl=Je()(gi.prototype,"logger",[mo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gi))||ll),ua=i("rlAn"),lo,zl,zs,Di=(lo=Object(ir.injectable)(),lo(zl=(zs=function(){function d(){X()(this,d),this.mapService=void 0}return o()(d,[{key:"apply",value:function(_){var x=this;this.mapService=_.getContainer().get(T.TYPES.IMapService),_.hooks.init.tap("DataSourcePlugin",function(){var C=_.sourceOption,M=C.data,U=C.options;_.setSource(new ua.default(M,U)),x.updateClusterData(_)}),_.hooks.beforeRenderData.tap("DataSourcePlugin",function(){var C=x.updateClusterData(_),M=_.dataState.dataSourceNeedUpdate;return _.dataState.dataSourceNeedUpdate=!1,C||M})}},{key:"updateClusterData",value:function(_){var x=_.getSource(),C=x.cluster,M=x.clusterOptions,U=M.zoom,ie=U===void 0?0:U,ve=M.maxZoom,Be=ve===void 0?16:ve,Lt=this.mapService.getZoom()-1;return C&&Math.abs(ie-Lt)>1&&Be>ie?(x.updateClusterData(Math.floor(Lt)),!0):!1}}]),d}(),zs))||zl),is=i("7tbW"),Zc=i.n(is),Fs=i("4qC0"),_i=i.n(Fs),Si=i("J2iB"),Xu=i.n(Si),yu=function(d,S){return d<S?-1:d>S?1:d>=S?0:NaN},Fl=function(d){return d.length===1&&(d=lc(d)),{left:function(_,x,C,M){for(C==null&&(C=0),M==null&&(M=_.length);C<M;){var U=C+M>>>1;d(_[U],x)<0?C=U+1:M=U}return C},right:function(_,x,C,M){for(C==null&&(C=0),M==null&&(M=_.length);C<M;){var U=C+M>>>1;d(_[U],x)>0?M=U:C=U+1}return C}}};function lc(d){return function(S,_){return yu(d(S),_)}}var Lu=Fl(yu),os=Lu.right,Yu=Lu.left,bu=os,Sf=function(d,S){S==null&&(S=Ul);for(var _=0,x=d.length-1,C=d[0],M=new Array(x<0?0:x);_<x;)M[_]=S(C,C=d[++_]);return M};function Ul(d,S){return[d,S]}var Xc=function(d,S,_){var x=d.length,C=S.length,M=new Array(x*C),U,ie,ve,Be;for(_==null&&(_=Ul),U=ve=0;U<x;++U)for(Be=d[U],ie=0;ie<C;++ie,++ve)M[ve]=_(Be,S[ie]);return M},lf=function(d,S){return S<d?-1:S>d?1:S>=d?0:NaN},iu=function(d){return d===null?NaN:+d},Sl=function(d,S){var _=d.length,x=0,C=-1,M=0,U,ie,ve=0;if(S==null)for(;++C<_;)isNaN(U=iu(d[C]))||(ie=U-M,M+=ie/++x,ve+=ie*(U-M));else for(;++C<_;)isNaN(U=iu(S(d[C],C,d)))||(ie=U-M,M+=ie/++x,ve+=ie*(U-M));if(x>1)return ve/(x-1)},xu=function(d,S){var _=Sl(d,S);return _&&Math.sqrt(_)},cc=function(d,S){var _=d.length,x=-1,C,M,U;if(S==null){for(;++x<_;)if((C=d[x])!=null&&C>=C)for(M=U=C;++x<_;)(C=d[x])!=null&&(M>C&&(M=C),U<C&&(U=C))}else for(;++x<_;)if((C=S(d[x],x,d))!=null&&C>=C)for(M=U=C;++x<_;)(C=S(d[x],x,d))!=null&&(M>C&&(M=C),U<C&&(U=C));return[M,U]},Ru=Array.prototype,fl=Ru.slice,hl=Ru.map,Ls=function(d){return function(){return d}},Bl=function(d){return d},Yc=function(d,S,_){d=+d,S=+S,_=(C=arguments.length)<2?(S=d,d=0,1):C<3?1:+_;for(var x=-1,C=Math.max(0,Math.ceil((S-d)/_))|0,M=new Array(C);++x<C;)M[x]=d+x*_;return M},Vl=Math.sqrt(50),s=Math.sqrt(10),a=Math.sqrt(2),n=function(d,S,_){var x,C=-1,M,U,ie;if(S=+S,d=+d,_=+_,d===S&&_>0)return[d];if((x=S<d)&&(M=d,d=S,S=M),(ie=l(d,S,_))===0||!isFinite(ie))return[];if(ie>0)for(d=Math.ceil(d/ie),S=Math.floor(S/ie),U=new Array(M=Math.ceil(S-d+1));++C<M;)U[C]=(d+C)*ie;else for(d=Math.floor(d*ie),S=Math.ceil(S*ie),U=new Array(M=Math.ceil(d-S+1));++C<M;)U[C]=(d-C)/ie;return x&&U.reverse(),U};function l(d,S,_){var x=(S-d)/Math.max(0,_),C=Math.floor(Math.log(x)/Math.LN10),M=x/Math.pow(10,C);return C>=0?(M>=Vl?10:M>=s?5:M>=a?2:1)*Math.pow(10,C):-Math.pow(10,-C)/(M>=Vl?10:M>=s?5:M>=a?2:1)}function b(d,S,_){var x=Math.abs(S-d)/Math.max(0,_),C=Math.pow(10,Math.floor(Math.log(x)/Math.LN10)),M=x/C;return M>=Vl?C*=10:M>=s?C*=5:M>=a&&(C*=2),S<d?-C:C}var O=function(d){return Math.ceil(Math.log(d.length)/Math.LN2)+1},R=function(){var d=Bl,S=cc,_=O;function x(C){var M,U=C.length,ie,ve=new Array(U);for(M=0;M<U;++M)ve[M]=d(C[M],M,C);var Be=S(ve),Lt=Be[0],$t=Be[1],Pr=_(ve,Lt,$t);Array.isArray(Pr)||(Pr=b(Lt,$t,Pr),Pr=Yc(Math.ceil(Lt/Pr)*Pr,$t,Pr));for(var Mr=Pr.length;Pr[0]<=Lt;)Pr.shift(),--Mr;for(;Pr[Mr-1]>$t;)Pr.pop(),--Mr;var mn=new Array(Mr+1),On;for(M=0;M<=Mr;++M)On=mn[M]=[],On.x0=M>0?Pr[M-1]:Lt,On.x1=M<Mr?Pr[M]:$t;for(M=0;M<U;++M)ie=ve[M],Lt<=ie&&ie<=$t&&mn[bu(Pr,ie,0,Mr)].push(C[M]);return mn}return x.value=function(C){return arguments.length?(d=typeof C=="function"?C:Ls(C),x):d},x.domain=function(C){return arguments.length?(S=typeof C=="function"?C:Ls([C[0],C[1]]),x):S},x.thresholds=function(C){return arguments.length?(_=typeof C=="function"?C:Array.isArray(C)?Ls(fl.call(C)):Ls(C),x):_},x},j=function(d,S,_){if(_==null&&(_=iu),!(x=d.length))return;if((S=+S)<=0||x<2)return+_(d[0],0,d);if(S>=1)return+_(d[x-1],x-1,d);var x,C=(x-1)*S,M=Math.floor(C),U=+_(d[M],M,d),ie=+_(d[M+1],M+1,d);return U+(ie-U)*(C-M)},ue=function(d,S,_){return d=hl.call(d,iu).sort(yu),Math.ceil((_-S)/(2*(j(d,.75)-j(d,.25))*Math.pow(d.length,-1/3)))},Te=function(d,S,_){return Math.ceil((_-S)/(3.5*xu(d)*Math.pow(d.length,-1/3)))},Ye=function(d,S){var _=d.length,x=-1,C,M;if(S==null){for(;++x<_;)if((C=d[x])!=null&&C>=C)for(M=C;++x<_;)(C=d[x])!=null&&C>M&&(M=C)}else for(;++x<_;)if((C=S(d[x],x,d))!=null&&C>=C)for(M=C;++x<_;)(C=S(d[x],x,d))!=null&&C>M&&(M=C);return M},qe=function(d,S){var _=d.length,x=_,C=-1,M,U=0;if(S==null)for(;++C<_;)isNaN(M=iu(d[C]))?--x:U+=M;else for(;++C<_;)isNaN(M=iu(S(d[C],C,d)))?--x:U+=M;if(x)return U/x},tt=function(d,S){var _=d.length,x=-1,C,M=[];if(S==null)for(;++x<_;)isNaN(C=iu(d[x]))||M.push(C);else for(;++x<_;)isNaN(C=iu(S(d[x],x,d)))||M.push(C);return j(M.sort(yu),.5)},Dt=function(d){for(var S=d.length,_,x=-1,C=0,M,U;++x<S;)C+=d[x].length;for(M=new Array(C);--S>=0;)for(U=d[S],_=U.length;--_>=0;)M[--C]=U[_];return M},Rt=function(d,S){var _=d.length,x=-1,C,M;if(S==null){for(;++x<_;)if((C=d[x])!=null&&C>=C)for(M=C;++x<_;)(C=d[x])!=null&&M>C&&(M=C)}else for(;++x<_;)if((C=S(d[x],x,d))!=null&&C>=C)for(M=C;++x<_;)(C=S(d[x],x,d))!=null&&M>C&&(M=C);return M},Wt=function(d,S){for(var _=S.length,x=new Array(_);_--;)x[_]=d[S[_]];return x},kt=function(d,S){if(!(_=d.length))return;var _,x=0,C=0,M,U=d[C];for(S==null&&(S=yu);++x<_;)(S(M=d[x],U)<0||S(U,U)!==0)&&(U=M,C=x);if(S(U,U)===0)return C},zt=function(d,S,_){for(var x=(_==null?d.length:_)-(S=S==null?0:+S),C,M;x;)M=Math.random()*x--|0,C=d[x+S],d[x+S]=d[M+S],d[M+S]=C;return d},nr=function(d,S){var _=d.length,x=-1,C,M=0;if(S==null)for(;++x<_;)(C=+d[x])&&(M+=C);else for(;++x<_;)(C=+S(d[x],x,d))&&(M+=C);return M},Jt=function(d){if(!(M=d.length))return[];for(var S=-1,_=Rt(d,Cr),x=new Array(_);++S<_;)for(var C=-1,M,U=x[S]=new Array(M);++C<M;)U[C]=d[C][S];return x};function Cr(d){return d.length}var pr=function(){return Jt(arguments)};function _r(d,S){switch(arguments.length){case 0:break;case 1:this.range(d);break;default:this.range(S).domain(d);break}return this}function wr(d,S){switch(arguments.length){case 0:break;case 1:this.interpolator(d);break;default:this.interpolator(S).domain(d);break}return this}var Hr="$";function Yr(){}Yr.prototype=un.prototype={constructor:Yr,has:function(S){return Hr+S in this},get:function(S){return this[Hr+S]},set:function(S,_){return this[Hr+S]=_,this},remove:function(S){var _=Hr+S;return _ in this&&delete this[_]},clear:function(){for(var S in this)S[0]===Hr&&delete this[S]},keys:function(){var S=[];for(var _ in this)_[0]===Hr&&S.push(_.slice(1));return S},values:function(){var S=[];for(var _ in this)_[0]===Hr&&S.push(this[_]);return S},entries:function(){var S=[];for(var _ in this)_[0]===Hr&&S.push({key:_.slice(1),value:this[_]});return S},size:function(){var S=0;for(var _ in this)_[0]===Hr&&++S;return S},empty:function(){for(var S in this)if(S[0]===Hr)return!1;return!0},each:function(S){for(var _ in this)_[0]===Hr&&S(this[_],_.slice(1),this)}};function un(d,S){var _=new Yr;if(d instanceof Yr)d.each(function(ie,ve){_.set(ve,ie)});else if(Array.isArray(d)){var x=-1,C=d.length,M;if(S==null)for(;++x<C;)_.set(x,d[x]);else for(;++x<C;)_.set(S(M=d[x],x,d),M)}else if(d)for(var U in d)_.set(U,d[U]);return _}var _n=un,ia=function(){var d=[],S=[],_,x,C;function M(ie,ve,Be,Lt){if(ve>=d.length)return _!=null&&ie.sort(_),x!=null?x(ie):ie;for(var $t=-1,Pr=ie.length,Mr=d[ve++],mn,On,Mn=_n(),Sa,Ha=Be();++$t<Pr;)(Sa=Mn.get(mn=Mr(On=ie[$t])+""))?Sa.push(On):Mn.set(mn,[On]);return Mn.each(function(ri,Ka){Lt(Ha,Ka,M(ri,ve,Be,Lt))}),Ha}function U(ie,ve){if(++ve>d.length)return ie;var Be,Lt=S[ve-1];return x!=null&&ve>=d.length?Be=ie.entries():(Be=[],ie.each(function($t,Pr){Be.push({key:Pr,values:U($t,ve)})})),Lt!=null?Be.sort(function($t,Pr){return Lt($t.key,Pr.key)}):Be}return C={object:function(ve){return M(ve,0,pa,ya)},map:function(ve){return M(ve,0,Pa,Pn)},entries:function(ve){return U(M(ve,0,Pa,Pn),0)},key:function(ve){return d.push(ve),C},sortKeys:function(ve){return S[d.length-1]=ve,C},sortValues:function(ve){return _=ve,C},rollup:function(ve){return x=ve,C}}};function pa(){return{}}function ya(d,S,_){d[S]=_}function Pa(){return _n()}function Pn(d,S,_){d.set(S,_)}function ga(){}var aa=_n.prototype;ga.prototype=zn.prototype={constructor:ga,has:aa.has,add:function(S){return S+="",this[Hr+S]=S,this},remove:aa.remove,clear:aa.clear,values:aa.keys,size:aa.size,empty:aa.empty,each:aa.each};function zn(d,S){var _=new ga;if(d instanceof ga)d.each(function(M){_.add(M)});else if(d){var x=-1,C=d.length;if(S==null)for(;++x<C;)_.add(d[x]);else for(;++x<C;)_.add(S(d[x],x,d))}return _}var Ca=zn,qn=function(d){var S=[];for(var _ in d)S.push(_);return S},wa=function(d){var S=[];for(var _ in d)S.push(d[_]);return S},Ja=function(d){var S=[];for(var _ in d)S.push({key:_,value:d[_]});return S},co=Array.prototype,$i=co.map,Vi=co.slice,fi={name:"implicit"};function Ji(){var d=_n(),S=[],_=[],x=fi;function C(M){var U=M+"",ie=d.get(U);if(!ie){if(x!==fi)return x;d.set(U,ie=S.push(M))}return _[(ie-1)%_.length]}return C.domain=function(M){if(!arguments.length)return S.slice();S=[],d=_n();for(var U=-1,ie=M.length,ve,Be;++U<ie;)d.has(Be=(ve=M[U])+"")||d.set(Be,S.push(ve));return C},C.range=function(M){return arguments.length?(_=Vi.call(M),C):_.slice()},C.unknown=function(M){return arguments.length?(x=M,C):x},C.copy=function(){return Ji(S,_).unknown(x)},_r.apply(C,arguments),C}function Lo(){var d=Ji().unknown(void 0),S=d.domain,_=d.range,x=[0,1],C,M,U=!1,ie=0,ve=0,Be=.5;delete d.unknown;function Lt(){var $t=S().length,Pr=x[1]<x[0],Mr=x[Pr-0],mn=x[1-Pr];C=(mn-Mr)/Math.max(1,$t-ie+ve*2),U&&(C=Math.floor(C)),Mr+=(mn-Mr-C*($t-ie))*Be,M=C*(1-ie),U&&(Mr=Math.round(Mr),M=Math.round(M));var On=Yc($t).map(function(Mn){return Mr+C*Mn});return _(Pr?On.reverse():On)}return d.domain=function($t){return arguments.length?(S($t),Lt()):S()},d.range=function($t){return arguments.length?(x=[+$t[0],+$t[1]],Lt()):x.slice()},d.rangeRound=function($t){return x=[+$t[0],+$t[1]],U=!0,Lt()},d.bandwidth=function(){return M},d.step=function(){return C},d.round=function($t){return arguments.length?(U=!!$t,Lt()):U},d.padding=function($t){return arguments.length?(ie=Math.min(1,ve=+$t),Lt()):ie},d.paddingInner=function($t){return arguments.length?(ie=Math.min(1,$t),Lt()):ie},d.paddingOuter=function($t){return arguments.length?(ve=+$t,Lt()):ve},d.align=function($t){return arguments.length?(Be=Math.max(0,Math.min(1,$t)),Lt()):Be},d.copy=function(){return Lo(S(),x).round(U).paddingInner(ie).paddingOuter(ve).align(Be)},_r.apply(Lt(),arguments)}function Iu(d){var S=d.copy;return d.padding=d.paddingOuter,delete d.paddingInner,delete d.paddingOuter,d.copy=function(){return Iu(S())},d}function Us(){return Iu(Lo.apply(null,arguments).paddingInner(1))}var Bs=i("FmoU");function Jo(d,S,_,x,C){var M=d*d,U=M*d;return((1-3*d+3*M-U)*S+(4-6*M+3*U)*_+(1+3*d+3*M-3*U)*x+U*C)/6}var ss=function(d){var S=d.length-1;return function(_){var x=_<=0?_=0:_>=1?(_=1,S-1):Math.floor(_*S),C=d[x],M=d[x+1],U=x>0?d[x-1]:2*C-M,ie=x<S-1?d[x+2]:2*M-C;return Jo((_-x/S)*S,U,C,M,ie)}},Al=function(d){var S=d.length;return function(_){var x=Math.floor(((_%=1)<0?++_:_)*S),C=d[(x+S-1)%S],M=d[x%S],U=d[(x+1)%S],ie=d[(x+2)%S];return Jo((_-x/S)*S,C,M,U,ie)}},Eu=function(d){return function(){return d}};function dl(d,S){return function(_){return d+_*S}}function Gl(d,S,_){return d=Math.pow(d,_),S=Math.pow(S,_)-d,_=1/_,function(x){return Math.pow(d+x*S,_)}}function Du(d,S){var _=S-d;return _?dl(d,_>180||_<-180?_-360*Math.round(_/360):_):Eu(isNaN(d)?S:d)}function Kc(d){return(d=+d)===1?Ku:function(S,_){return _-S?Gl(S,_,d):Eu(isNaN(S)?_:S)}}function Ku(d,S){var _=S-d;return _?dl(d,_):Eu(isNaN(d)?S:d)}var eo=function d(S){var _=Kc(S);function x(C,M){var U=_((C=Object(Bs.b)(C)).r,(M=Object(Bs.b)(M)).r),ie=_(C.g,M.g),ve=_(C.b,M.b),Be=Ku(C.opacity,M.opacity);return function(Lt){return C.r=U(Lt),C.g=ie(Lt),C.b=ve(Lt),C.opacity=Be(Lt),C+""}}return x.gamma=d,x}(1);function Rs(d){return function(S){var _=S.length,x=new Array(_),C=new Array(_),M=new Array(_),U,ie;for(U=0;U<_;++U)ie=Object(Bs.b)(S[U]),x[U]=ie.r||0,C[U]=ie.g||0,M[U]=ie.b||0;return x=d(x),C=d(C),M=d(M),ie.opacity=1,function(ve){return ie.r=x(ve),ie.g=C(ve),ie.b=M(ve),ie+""}}}var Hl=Rs(ss),fc=Rs(Al),Xi=function(d,S){S||(S=[]);var _=d?Math.min(S.length,d.length):0,x=S.slice(),C;return function(M){for(C=0;C<_;++C)x[C]=d[C]*(1-M)+S[C]*M;return x}};function jo(d){return ArrayBuffer.isView(d)&&!(d instanceof DataView)}var xs=function(d,S){return(jo(S)?Xi:to)(d,S)};function to(d,S){var _=S?S.length:0,x=d?Math.min(_,d.length):0,C=new Array(x),M=new Array(_),U;for(U=0;U<x;++U)C[U]=Uo(d[U],S[U]);for(;U<_;++U)M[U]=S[U];return function(ie){for(U=0;U<x;++U)M[U]=C[U](ie);return M}}var Vs=function(d,S){var _=new Date;return d=+d,S=+S,function(x){return _.setTime(d*(1-x)+S*x),_}},ro=function(d,S){return d=+d,S=+S,function(_){return d*(1-_)+S*_}},$u=function(d,S){var _={},x={},C;(d===null||typeof d!="object")&&(d={}),(S===null||typeof S!="object")&&(S={});for(C in S)C in d?_[C]=Uo(d[C],S[C]):x[C]=S[C];return function(M){for(C in _)x[C]=_[C](M);return x}},pl=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ml=new RegExp(pl.source,"g");function Ac(d){return function(){return d}}function Ju(d){return function(S){return d(S)+""}}var Wl=function(d,S){var _=pl.lastIndex=ml.lastIndex=0,x,C,M,U=-1,ie=[],ve=[];for(d=d+"",S=S+"";(x=pl.exec(d))&&(C=ml.exec(S));)(M=C.index)>_&&(M=S.slice(_,M),ie[U]?ie[U]+=M:ie[++U]=M),(x=x[0])===(C=C[0])?ie[U]?ie[U]+=C:ie[++U]=C:(ie[++U]=null,ve.push({i:U,x:ro(x,C)})),_=ml.lastIndex;return _<S.length&&(M=S.slice(_),ie[U]?ie[U]+=M:ie[++U]=M),ie.length<2?ve[0]?Ju(ve[0].x):Ac(S):(S=ve.length,function(Be){for(var Lt=0,$t;Lt<S;++Lt)ie[($t=ve[Lt]).i]=$t.x(Be);return ie.join("")})},Uo=function(d,S){var _=typeof S,x;return S==null||_==="boolean"?Eu(S):(_==="number"?ro:_==="string"?(x=Object(Bs.a)(S))?(S=x,eo):Wl:S instanceof Bs.a?eo:S instanceof Date?Vs:jo(S)?Xi:Array.isArray(S)?to:typeof S.valueOf!="function"&&typeof S.toString!="function"||isNaN(S)?$u:ro)(d,S)},vo=function(d,S){return d=+d,S=+S,function(_){return Math.round(d*(1-_)+S*_)}},$c=function(d){return function(){return d}},Zl=function(d){return+d},Jc=[0,1];function Es(d){return d}function cf(d,S){return(S-=d=+d)?function(_){return(_-d)/S}:$c(isNaN(S)?NaN:.5)}function Nf(d){var S=d[0],_=d[d.length-1],x;return S>_&&(x=S,S=_,_=x),function(C){return Math.max(S,Math.min(_,C))}}function ff(d,S,_){var x=d[0],C=d[1],M=S[0],U=S[1];return C<x?(x=cf(C,x),M=_(U,M)):(x=cf(x,C),M=_(M,U)),function(ie){return M(x(ie))}}function Zf(d,S,_){var x=Math.min(d.length,S.length)-1,C=new Array(x),M=new Array(x),U=-1;for(d[x]<d[0]&&(d=d.slice().reverse(),S=S.slice().reverse());++U<x;)C[U]=cf(d[U],d[U+1]),M[U]=_(S[U],S[U+1]);return function(ie){var ve=bu(d,ie,1,x)-1;return M[ve](C[ve](ie))}}function Nu(d,S){return S.domain(d.domain()).range(d.range()).interpolate(d.interpolate()).clamp(d.clamp()).unknown(d.unknown())}function hf(){var d=Jc,S=Jc,_=Uo,x,C,M,U=Es,ie,ve,Be;function Lt(){return ie=Math.min(d.length,S.length)>2?Zf:ff,ve=Be=null,$t}function $t(Pr){return isNaN(Pr=+Pr)?M:(ve||(ve=ie(d.map(x),S,_)))(x(U(Pr)))}return $t.invert=function(Pr){return U(C((Be||(Be=ie(S,d.map(x),ro)))(Pr)))},$t.domain=function(Pr){return arguments.length?(d=$i.call(Pr,Zl),U===Es||(U=Nf(d)),Lt()):d.slice()},$t.range=function(Pr){return arguments.length?(S=Vi.call(Pr),Lt()):S.slice()},$t.rangeRound=function(Pr){return S=Vi.call(Pr),_=vo,Lt()},$t.clamp=function(Pr){return arguments.length?(U=Pr?Nf(d):Es,$t):U!==Es},$t.interpolate=function(Pr){return arguments.length?(_=Pr,Lt()):_},$t.unknown=function(Pr){return arguments.length?(M=Pr,$t):M},function(Pr,Mr){return x=Pr,C=Mr,Lt()}}function Xl(d,S){return hf()(d,S)}var vl=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Qc(d){if(!(S=vl.exec(d)))throw new Error("invalid format: "+d);var S;return new Af({fill:S[1],align:S[2],sign:S[3],symbol:S[4],zero:S[5],width:S[6],comma:S[7],precision:S[8]&&S[8].slice(1),trim:S[9],type:S[10]})}Qc.prototype=Af.prototype;function Af(d){this.fill=d.fill===void 0?" ":d.fill+"",this.align=d.align===void 0?">":d.align+"",this.sign=d.sign===void 0?"-":d.sign+"",this.symbol=d.symbol===void 0?"":d.symbol+"",this.zero=!!d.zero,this.width=d.width===void 0?void 0:+d.width,this.comma=!!d.comma,this.precision=d.precision===void 0?void 0:+d.precision,this.trim=!!d.trim,this.type=d.type===void 0?"":d.type+""}Af.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};var Xf=function(d){return Math.abs(d=Math.round(d))>=1e21?d.toLocaleString("en").replace(/,/g,""):d.toString(10)};function Cc(d,S){if((_=(d=S?d.toExponential(S-1):d.toExponential()).indexOf("e"))<0)return null;var _,x=d.slice(0,_);return[x.length>1?x[0]+x.slice(2):x,+d.slice(_+1)]}var wc=function(d){return d=Cc(Math.abs(d)),d?d[1]:NaN},Yf=function(d,S){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(wc(S)/3)))*3-wc(Math.abs(d)))},Kf=function(d,S){return function(_,x){for(var C=_.length,M=[],U=0,ie=d[0],ve=0;C>0&&ie>0&&!(ve+ie+1>x&&(ie=Math.max(1,x-ve)),M.push(_.substring(C-=ie,C+ie)),(ve+=ie+1)>x);)ie=d[U=(U+1)%d.length];return M.reverse().join(S)}},kf=function(d){return function(S){return S.replace(/[0-9]/g,function(_){return d[+_]})}},$f=function(d){e:for(var S=d.length,_=1,x=-1,C;_<S;++_)switch(d[_]){case".":x=C=_;break;case"0":x===0&&(x=_),C=_;break;default:if(!+d[_])break e;x>0&&(x=0);break}return x>0?d.slice(0,x)+d.slice(C+1):d},qc,fh=function(d,S){var _=Cc(d,S);if(!_)return d+"";var x=_[0],C=_[1],M=C-(qc=Math.max(-8,Math.min(8,Math.floor(C/3)))*3)+1,U=x.length;return M===U?x:M>U?x+new Array(M-U+1).join("0"):M>0?x.slice(0,M)+"."+x.slice(M):"0."+new Array(1-M).join("0")+Cc(d,Math.max(0,S+M-1))[0]},go=function(d,S){var _=Cc(d,S);if(!_)return d+"";var x=_[0],C=_[1];return C<0?"0."+new Array(-C).join("0")+x:x.length>C+1?x.slice(0,C+1)+"."+x.slice(C+1):x+new Array(C-x.length+2).join("0")},hc={"%":function(S,_){return(S*100).toFixed(_)},b:function(S){return Math.round(S).toString(2)},c:function(S){return S+""},d:Xf,e:function(S,_){return S.toExponential(_)},f:function(S,_){return S.toFixed(_)},g:function(S,_){return S.toPrecision(_)},o:function(S){return Math.round(S).toString(8)},p:function(S,_){return go(S*100,_)},r:go,s:fh,X:function(S){return Math.round(S).toString(16).toUpperCase()},x:function(S){return Math.round(S).toString(16)}},df=function(d){return d},Yl=Array.prototype.map,Oc=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"],Mc=function(d){var S=d.grouping===void 0||d.thousands===void 0?df:Kf(Yl.call(d.grouping,Number),d.thousands+""),_=d.currency===void 0?"":d.currency[0]+"",x=d.currency===void 0?"":d.currency[1]+"",C=d.decimal===void 0?".":d.decimal+"",M=d.numerals===void 0?df:kf(Yl.call(d.numerals,String)),U=d.percent===void 0?"%":d.percent+"",ie=d.minus===void 0?"-":d.minus+"",ve=d.nan===void 0?"NaN":d.nan+"";function Be($t){$t=Qc($t);var Pr=$t.fill,Mr=$t.align,mn=$t.sign,On=$t.symbol,Mn=$t.zero,Sa=$t.width,Ha=$t.comma,ri=$t.precision,Ka=$t.trim,ni=$t.type;ni==="n"?(Ha=!0,ni="g"):hc[ni]||(ri===void 0&&(ri=12),Ka=!0,ni="g"),(Mn||Pr==="0"&&Mr==="=")&&(Mn=!0,Pr="0",Mr="=");var io=On==="$"?_:On==="#"&&/[boxX]/.test(ni)?"0"+ni.toLowerCase():"",Aa=On==="$"?x:/[%p]/.test(ni)?U:"",Do=hc[ni],rs=/[defgprs%]/.test(ni);ri=ri===void 0?6:/[gprs]/.test(ni)?Math.max(1,Math.min(21,ri)):Math.max(0,Math.min(20,ri));function Xs(Wa){var ds=io,Fo=Aa,yl,Wh,lh;if(ni==="c")Fo=Do(Wa)+Fo,Wa="";else{Wa=+Wa;var ch=Wa<0||1/Wa<0;if(Wa=isNaN(Wa)?ve:Do(Math.abs(Wa),ri),Ka&&(Wa=$f(Wa)),ch&&+Wa===0&&mn!=="+"&&(ch=!1),ds=(ch?mn==="("?mn:ie:mn==="-"||mn==="("?"":mn)+ds,Fo=(ni==="s"?Oc[8+qc/3]:"")+Fo+(ch&&mn==="("?")":""),rs){for(yl=-1,Wh=Wa.length;++yl<Wh;)if(lh=Wa.charCodeAt(yl),48>lh||lh>57){Fo=(lh===46?C+Wa.slice(yl+1):Wa.slice(yl))+Fo,Wa=Wa.slice(0,yl);break}}}Ha&&!Mn&&(Wa=S(Wa,Infinity));var Eh=ds.length+Wa.length+Fo.length,ef=Eh<Sa?new Array(Sa-Eh+1).join(Pr):"";Ha&&Mn&&(Wa=S(ef+Wa,ef.length?Sa-Fo.length:Infinity),ef="");switch(Mr){case"<":Wa=ds+Wa+Fo+ef;break;case"=":Wa=ds+ef+Wa+Fo;break;case"^":Wa=ef.slice(0,Eh=ef.length>>1)+ds+Wa+Fo+ef.slice(Eh);break;default:Wa=ef+ds+Wa+Fo;break}return M(Wa)}return Xs.toString=function(){return $t+""},Xs}function Lt($t,Pr){var Mr=Be(($t=Qc($t),$t.type="f",$t)),mn=Math.max(-8,Math.min(8,Math.floor(wc(Pr)/3)))*3,On=Math.pow(10,-mn),Mn=Oc[8+mn/3];return function(Sa){return Mr(On*Sa)+Mn}}return{format:Be,formatPrefix:Lt}},ku,Pc,Lc;pf({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function pf(d){return ku=Mc(d),Pc=ku.format,Lc=ku.formatPrefix,ku}var Cf=function(d,S){return d=Math.abs(d),S=Math.abs(S)-d,Math.max(0,wc(S)-wc(d))+1},jf=function(d){return Math.max(0,-wc(Math.abs(d)))},dc=function(d,S,_,x){var C=b(d,S,_),M;x=Qc(x==null?",f":x);switch(x.type){case"s":{var U=Math.max(Math.abs(d),Math.abs(S));return x.precision==null&&!isNaN(M=Yf(C,U))&&(x.precision=M),Lc(x,U)}case"":case"e":case"g":case"p":case"r":{x.precision==null&&!isNaN(M=Cf(C,Math.max(Math.abs(d),Math.abs(S))))&&(x.precision=M-(x.type==="e"));break}case"f":case"%":{x.precision==null&&!isNaN(M=jf(C))&&(x.precision=M-(x.type==="%")*2);break}}return Pc(x)};function Kl(d){var S=d.domain;return d.ticks=function(_){var x=S();return n(x[0],x[x.length-1],_==null?10:_)},d.tickFormat=function(_,x){var C=S();return dc(C[0],C[C.length-1],_==null?10:_,x)},d.nice=function(_){_==null&&(_=10);var x=S(),C=0,M=x.length-1,U=x[C],ie=x[M],ve;return ie<U&&(ve=U,U=ie,ie=ve,ve=C,C=M,M=ve),ve=l(U,ie,_),ve>0?(U=Math.floor(U/ve)*ve,ie=Math.ceil(ie/ve)*ve,ve=l(U,ie,_)):ve<0&&(U=Math.ceil(U*ve)/ve,ie=Math.floor(ie*ve)/ve,ve=l(U,ie,_)),ve>0?(x[C]=Math.floor(U/ve)*ve,x[M]=Math.ceil(ie/ve)*ve,S(x)):ve<0&&(x[C]=Math.ceil(U*ve)/ve,x[M]=Math.floor(ie*ve)/ve,S(x)),d},d}function ne(){var d=Xl(Es,Es);return d.copy=function(){return Nu(d,ne())},_r.apply(d,arguments),Kl(d)}function se(d){var S;function _(x){return isNaN(x=+x)?S:x}return _.invert=_,_.domain=_.range=function(x){return arguments.length?(d=$i.call(x,Zl),_):d.slice()},_.unknown=function(x){return arguments.length?(S=x,_):S},_.copy=function(){return se(d).unknown(S)},d=arguments.length?$i.call(d,Zl):[0,1],Kl(_)}var k=function(d,S){d=d.slice();var _=0,x=d.length-1,C=d[_],M=d[x],U;return M<C&&(U=_,_=x,x=U,U=C,C=M,M=U),d[_]=S.floor(C),d[x]=S.ceil(M),d};function G(d){return Math.log(d)}function _e(d){return Math.exp(d)}function ot(d){return-Math.log(-d)}function Xt(d){return-Math.exp(-d)}function rr(d){return isFinite(d)?+("1e"+d):d<0?0:d}function tr(d){return d===10?rr:d===Math.E?Math.exp:function(S){return Math.pow(d,S)}}function Dr(d){return d===Math.E?Math.log:d===10&&Math.log10||d===2&&Math.log2||(d=Math.log(d),function(S){return Math.log(S)/d})}function tn(d){return function(S){return-d(-S)}}function Vn(d){var S=d(G,_e),_=S.domain,x=10,C,M;function U(){return C=Dr(x),M=tr(x),_()[0]<0?(C=tn(C),M=tn(M),d(ot,Xt)):d(G,_e),S}return S.base=function(ie){return arguments.length?(x=+ie,U()):x},S.domain=function(ie){return arguments.length?(_(ie),U()):_()},S.ticks=function(ie){var ve=_(),Be=ve[0],Lt=ve[ve.length-1],$t;($t=Lt<Be)&&(Pr=Be,Be=Lt,Lt=Pr);var Pr=C(Be),Mr=C(Lt),mn,On,Mn,Sa=ie==null?10:+ie,Ha=[];if(!(x%1)&&Mr-Pr<Sa)if(Pr=Math.round(Pr)-1,Mr=Math.round(Mr)+1,Be>0)for(;Pr<Mr;++Pr)for(On=1,mn=M(Pr);On<x;++On){if(Mn=mn*On,Mn<Be)continue;if(Mn>Lt)break;Ha.push(Mn)}else for(;Pr<Mr;++Pr)for(On=x-1,mn=M(Pr);On>=1;--On){if(Mn=mn*On,Mn<Be)continue;if(Mn>Lt)break;Ha.push(Mn)}else Ha=n(Pr,Mr,Math.min(Mr-Pr,Sa)).map(M);return $t?Ha.reverse():Ha},S.tickFormat=function(ie,ve){if(ve==null&&(ve=x===10?".0e":","),typeof ve!="function"&&(ve=Pc(ve)),ie===Infinity)return ve;ie==null&&(ie=10);var Be=Math.max(1,x*ie/S.ticks().length);return function(Lt){var $t=Lt/M(Math.round(C(Lt)));return $t*x<x-.5&&($t*=x),$t<=Be?ve(Lt):""}},S.nice=function(){return _(k(_(),{floor:function(ve){return M(Math.floor(C(ve)))},ceil:function(ve){return M(Math.ceil(C(ve)))}}))},S}function ta(){var d=Vn(hf()).domain([1,10]);return d.copy=function(){return Nu(d,ta()).base(d.base())},_r.apply(d,arguments),d}function oa(d){return function(S){return Math.sign(S)*Math.log1p(Math.abs(S/d))}}function Ya(d){return function(S){return Math.sign(S)*Math.expm1(Math.abs(S))*d}}function za(d){var S=1,_=d(oa(S),Ya(S));return _.constant=function(x){return arguments.length?d(oa(S=+x),Ya(S)):S},Kl(_)}function Ni(){var d=za(hf());return d.copy=function(){return Nu(d,Ni()).constant(d.constant())},_r.apply(d,arguments)}function Fa(d){return function(S){return S<0?-Math.pow(-S,d):Math.pow(S,d)}}function Gi(d){return d<0?-Math.sqrt(-d):Math.sqrt(d)}function Qo(d){return d<0?-d*d:d*d}function Qi(d){var S=d(Es,Es),_=1;function x(){return _===1?d(Es,Es):_===.5?d(Gi,Qo):d(Fa(_),Fa(1/_))}return S.exponent=function(C){return arguments.length?(_=+C,x()):_},Kl(S)}function oi(){var d=Qi(hf());return d.copy=function(){return Nu(d,oi()).exponent(d.exponent())},_r.apply(d,arguments),d}function Ts(){return oi.apply(null,arguments).exponent(.5)}function ki(){var d=[],S=[],_=[],x;function C(){var U=0,ie=Math.max(1,S.length);for(_=new Array(ie-1);++U<ie;)_[U-1]=j(d,U/ie);return M}function M(U){return isNaN(U=+U)?x:S[bu(_,U)]}return M.invertExtent=function(U){var ie=S.indexOf(U);return ie<0?[NaN,NaN]:[ie>0?_[ie-1]:d[0],ie<_.length?_[ie]:d[d.length-1]]},M.domain=function(U){if(!arguments.length)return d.slice();d=[];for(var ie=0,ve=U.length,Be;ie<ve;++ie)(Be=U[ie],Be!=null&&!isNaN(Be=+Be))&&d.push(Be);return d.sort(yu),C()},M.range=function(U){return arguments.length?(S=Vi.call(U),C()):S.slice()},M.unknown=function(U){return arguments.length?(x=U,M):x},M.quantiles=function(){return _.slice()},M.copy=function(){return ki().domain(d).range(S).unknown(x)},_r.apply(M,arguments)}function yo(){var d=0,S=1,_=1,x=[.5],C=[0,1],M;function U(ve){return ve<=ve?C[bu(x,ve,0,_)]:M}function ie(){var ve=-1;for(x=new Array(_);++ve<_;)x[ve]=((ve+1)*S-(ve-_)*d)/(_+1);return U}return U.domain=function(ve){return arguments.length?(d=+ve[0],S=+ve[1],ie()):[d,S]},U.range=function(ve){return arguments.length?(_=(C=Vi.call(ve)).length-1,ie()):C.slice()},U.invertExtent=function(ve){var Be=C.indexOf(ve);return Be<0?[NaN,NaN]:Be<1?[d,x[0]]:Be>=_?[x[_-1],S]:[x[Be-1],x[Be]]},U.unknown=function(ve){return arguments.length&&(M=ve),U},U.thresholds=function(){return x.slice()},U.copy=function(){return yo().domain([d,S]).range(C).unknown(M)},_r.apply(Kl(U),arguments)}function us(){var d=[.5],S=[0,1],_,x=1;function C(M){return M<=M?S[bu(d,M,0,x)]:_}return C.domain=function(M){return arguments.length?(d=Vi.call(M),x=Math.min(d.length,S.length-1),C):d.slice()},C.range=function(M){return arguments.length?(S=Vi.call(M),x=Math.min(d.length,S.length-1),C):S.slice()},C.invertExtent=function(M){var U=S.indexOf(M);return[d[U-1],d[U]]},C.unknown=function(M){return arguments.length?(_=M,C):_},C.copy=function(){return us().domain(d).range(S).unknown(_)},_r.apply(C,arguments)}var yi=new Date,fo=new Date;function Ta(d,S,_,x){function C(M){return d(M=arguments.length===0?new Date:new Date(+M)),M}return C.floor=function(M){return d(M=new Date(+M)),M},C.ceil=function(M){return d(M=new Date(M-1)),S(M,1),d(M),M},C.round=function(M){var U=C(M),ie=C.ceil(M);return M-U<ie-M?U:ie},C.offset=function(M,U){return S(M=new Date(+M),U==null?1:Math.floor(U)),M},C.range=function(M,U,ie){var ve=[],Be;if(M=C.ceil(M),ie=ie==null?1:Math.floor(ie),!(M<U)||!(ie>0))return ve;do ve.push(Be=new Date(+M)),S(M,ie),d(M);while(Be<M&&M<U);return ve},C.filter=function(M){return Ta(function(U){if(U>=U)for(;d(U),!M(U);)U.setTime(U-1)},function(U,ie){if(U>=U)if(ie<0)for(;++ie<=0;)for(;S(U,-1),!M(U););else for(;--ie>=0;)for(;S(U,1),!M(U););})},_&&(C.count=function(M,U){return yi.setTime(+M),fo.setTime(+U),d(yi),d(fo),Math.floor(_(yi,fo))},C.every=function(M){return M=Math.floor(M),!isFinite(M)||!(M>0)?null:M>1?C.filter(x?function(U){return x(U)%M===0}:function(U){return C.count(0,U)%M===0}):C}),C}var Ro=Ta(function(d){d.setMonth(0,1),d.setHours(0,0,0,0)},function(d,S){d.setFullYear(d.getFullYear()+S)},function(d,S){return S.getFullYear()-d.getFullYear()},function(d){return d.getFullYear()});Ro.every=function(d){return!isFinite(d=Math.floor(d))||!(d>0)?null:Ta(function(S){S.setFullYear(Math.floor(S.getFullYear()/d)*d),S.setMonth(0,1),S.setHours(0,0,0,0)},function(S,_){S.setFullYear(S.getFullYear()+_*d)})};var pc=Ro,zf=Ro.range,Gs=Ta(function(d){d.setDate(1),d.setHours(0,0,0,0)},function(d,S){d.setMonth(d.getMonth()+S)},function(d,S){return S.getMonth()-d.getMonth()+(S.getFullYear()-d.getFullYear())*12},function(d){return d.getMonth()}),ah=Gs,Fh=Gs.range,Ff=1e3,wf=6e4,Jf=36e5,Th=864e5,_h=6048e5;function Of(d){return Ta(function(S){S.setDate(S.getDate()-(S.getDay()+7-d)%7),S.setHours(0,0,0,0)},function(S,_){S.setDate(S.getDate()+_*7)},function(S,_){return(_-S-(_.getTimezoneOffset()-S.getTimezoneOffset())*wf)/_h})}var Qf=Of(0),qf=Of(1),Sh=Of(2),eh=Of(3),mf=Of(4),hh=Of(5),ih=Of(6),fe=Qf.range,ze=qf.range,Pt=Sh.range,gr=eh.range,kr=mf.range,Or=hh.range,xr=ih.range,Wr=Ta(function(d){d.setHours(0,0,0,0)},function(d,S){d.setDate(d.getDate()+S)},function(d,S){return(S-d-(S.getTimezoneOffset()-d.getTimezoneOffset())*wf)/Th},function(d){return d.getDate()-1}),on=Wr,rn=Wr.range,Qr=Ta(function(d){d.setTime(d-d.getMilliseconds()-d.getSeconds()*Ff-d.getMinutes()*wf)},function(d,S){d.setTime(+d+S*Jf)},function(d,S){return(S-d)/Jf},function(d){return d.getHours()}),cn=Qr,Sn=Qr.range,fn=Ta(function(d){d.setTime(d-d.getMilliseconds()-d.getSeconds()*Ff)},function(d,S){d.setTime(+d+S*wf)},function(d,S){return(S-d)/wf},function(d){return d.getMinutes()}),Kr=fn,br=fn.range,mr=Ta(function(d){d.setTime(d-d.getMilliseconds())},function(d,S){d.setTime(+d+S*Ff)},function(d,S){return(S-d)/Ff},function(d){return d.getUTCSeconds()}),Jr=mr,wn=mr.range,Lr=Ta(function(){},function(d,S){d.setTime(+d+S)},function(d,S){return S-d});Lr.every=function(d){return d=Math.floor(d),!isFinite(d)||!(d>0)?null:d>1?Ta(function(S){S.setTime(Math.floor(S/d)*d)},function(S,_){S.setTime(+S+_*d)},function(S,_){return(_-S)/d}):Lr};var Xn=Lr,$r=Lr.range;function zr(d){return Ta(function(S){S.setUTCDate(S.getUTCDate()-(S.getUTCDay()+7-d)%7),S.setUTCHours(0,0,0,0)},function(S,_){S.setUTCDate(S.getUTCDate()+_*7)},function(S,_){return(_-S)/_h})}var Ur=zr(0),Gr=zr(1),Wn=zr(2),$n=zr(3),sn=zr(4),nn=zr(5),Rr=zr(6),ba=Ur.range,La=Gr.range,Fn=Wn.range,Ua=$n.range,Ea=sn.range,Da=nn.range,bi=Rr.range,Bo=Ta(function(d){d.setUTCHours(0,0,0,0)},function(d,S){d.setUTCDate(d.getUTCDate()+S)},function(d,S){return(S-d)/Th},function(d){return d.getUTCDate()-1}),So=Bo,Ba=Bo.range,qo=Ta(function(d){d.setUTCMonth(0,1),d.setUTCHours(0,0,0,0)},function(d,S){d.setUTCFullYear(d.getUTCFullYear()+S)},function(d,S){return S.getUTCFullYear()-d.getUTCFullYear()},function(d){return d.getUTCFullYear()});qo.every=function(d){return!isFinite(d=Math.floor(d))||!(d>0)?null:Ta(function(S){S.setUTCFullYear(Math.floor(S.getUTCFullYear()/d)*d),S.setUTCMonth(0,1),S.setUTCHours(0,0,0,0)},function(S,_){S.setUTCFullYear(S.getUTCFullYear()+_*d)})};var ji=qo,_s=qo.range;function es(d){if(0<=d.y&&d.y<100){var S=new Date(-1,d.m,d.d,d.H,d.M,d.S,d.L);return S.setFullYear(d.y),S}return new Date(d.y,d.m,d.d,d.H,d.M,d.S,d.L)}function Vo(d){if(0<=d.y&&d.y<100){var S=new Date(Date.UTC(-1,d.m,d.d,d.H,d.M,d.S,d.L));return S.setUTCFullYear(d.y),S}return new Date(Date.UTC(d.y,d.m,d.d,d.H,d.M,d.S,d.L))}function ts(d,S,_){return{y:d,m:S,d:_,H:0,M:0,S:0,L:0}}function Hs(d){var S=d.dateTime,_=d.date,x=d.time,C=d.periods,M=d.days,U=d.shortDays,ie=d.months,ve=d.shortMonths,Be=Va(C),Lt=Ao(C),$t=Va(M),Pr=Ao(M),Mr=Va(U),mn=Ao(U),On=Va(ie),Mn=Ao(ie),Sa=Va(ve),Ha=Ao(ve),ri={a:ch,A:Eh,b:ef,B:hd,c:null,d:It,e:It,f:ln,g:ju,G:Jl,H:Kt,I:Ht,j:fr,L:Sr,m:jr,M:an,p:dd,q:od,Q:uu,s:rh,S:pn,u:Gn,U:la,V:Oi,w:Ga,W:Co,x:null,X:null,y:ho,Y:ls,Z:Io,"%":ld},Ka={a:pd,A:Zh,b:md,B:ed,c:null,d:xi,e:xi,f:Cl,g:Ah,G:sd,H:vf,I:Qu,j:Mf,L:mc,m:Rc,M:Ic,p:yd,q:vd,Q:uu,s:rh,S:Hi,u:wl,U:Ho,V:gf,w:Ol,W:Uf,x:null,X:null,y:Yh,Y:th,Z:ud,"%":ld},ni={a:Xs,A:Wa,b:ds,B:Fo,c:yl,d:p,e:p,f:J,g:Oa,G:Cn,H:P,I:P,j:y,L:V,m:c,M:N,p:rs,q:f,Q:We,s:De,S:ee,u:$l,U:Ot,V:Er,w:su,W:yr,x:Wh,X:lh,y:Oa,Y:Cn,Z:v,"%":he};ri.x=io(_,ri),ri.X=io(x,ri),ri.c=io(S,ri),Ka.x=io(_,Ka),Ka.X=io(x,Ka),Ka.c=io(S,Ka);function io(Ra,Yi){return function(ai){var Rn=[],kc=-1,ps=0,tf=Ra.length,rf,Ql,Xh;for(ai instanceof Date||(ai=new Date(+ai));++kc<tf;)Ra.charCodeAt(kc)===37&&(Rn.push(Ra.slice(ps,kc)),(Ql=Go[rf=Ra.charAt(++kc)])!=null?rf=Ra.charAt(++kc):Ql=rf==="e"?" ":"0",(Xh=Yi[rf])&&(rf=Xh(ai,Ql)),Rn.push(rf),ps=kc+1);return Rn.push(Ra.slice(ps,kc)),Rn.join("")}}function Aa(Ra,Yi){return function(ai){var Rn=ts(1900,void 0,1),kc=Do(Rn,Ra,ai+="",0),ps,tf;if(kc!=ai.length)return null;if("Q"in Rn)return new Date(Rn.Q);if("s"in Rn)return new Date(Rn.s*1e3+("L"in Rn?Rn.L:0));if(Yi&&!("Z"in Rn)&&(Rn.Z=0),"p"in Rn&&(Rn.H=Rn.H%12+Rn.p*12),Rn.m===void 0&&(Rn.m="q"in Rn?Rn.q:0),"V"in Rn){if(Rn.V<1||Rn.V>53)return null;"w"in Rn||(Rn.w=1),"Z"in Rn?(ps=Vo(ts(Rn.y,0,1)),tf=ps.getUTCDay(),ps=tf>4||tf===0?Gr.ceil(ps):Gr(ps),ps=So.offset(ps,(Rn.V-1)*7),Rn.y=ps.getUTCFullYear(),Rn.m=ps.getUTCMonth(),Rn.d=ps.getUTCDate()+(Rn.w+6)%7):(ps=es(ts(Rn.y,0,1)),tf=ps.getDay(),ps=tf>4||tf===0?qf.ceil(ps):qf(ps),ps=on.offset(ps,(Rn.V-1)*7),Rn.y=ps.getFullYear(),Rn.m=ps.getMonth(),Rn.d=ps.getDate()+(Rn.w+6)%7)}else("W"in Rn||"U"in Rn)&&("w"in Rn||(Rn.w="u"in Rn?Rn.u%7:"W"in Rn?1:0),tf="Z"in Rn?Vo(ts(Rn.y,0,1)).getUTCDay():es(ts(Rn.y,0,1)).getDay(),Rn.m=0,Rn.d="W"in Rn?(Rn.w+6)%7+Rn.W*7-(tf+5)%7:Rn.w+Rn.U*7-(tf+6)%7);return"Z"in Rn?(Rn.H+=Rn.Z/100|0,Rn.M+=Rn.Z%100,Vo(Rn)):es(Rn)}}function Do(Ra,Yi,ai,Rn){for(var kc=0,ps=Yi.length,tf=ai.length,rf,Ql;kc<ps;){if(Rn>=tf)return-1;if(rf=Yi.charCodeAt(kc++),rf===37){if(rf=Yi.charAt(kc++),Ql=ni[rf in Go?Yi.charAt(kc++):rf],!Ql||(Rn=Ql(Ra,ai,Rn))<0)return-1}else if(rf!=ai.charCodeAt(Rn++))return-1}return Rn}function rs(Ra,Yi,ai){var Rn=Be.exec(Yi.slice(ai));return Rn?(Ra.p=Lt[Rn[0].toLowerCase()],ai+Rn[0].length):-1}function Xs(Ra,Yi,ai){var Rn=Mr.exec(Yi.slice(ai));return Rn?(Ra.w=mn[Rn[0].toLowerCase()],ai+Rn[0].length):-1}function Wa(Ra,Yi,ai){var Rn=$t.exec(Yi.slice(ai));return Rn?(Ra.w=Pr[Rn[0].toLowerCase()],ai+Rn[0].length):-1}function ds(Ra,Yi,ai){var Rn=Sa.exec(Yi.slice(ai));return Rn?(Ra.m=Ha[Rn[0].toLowerCase()],ai+Rn[0].length):-1}function Fo(Ra,Yi,ai){var Rn=On.exec(Yi.slice(ai));return Rn?(Ra.m=Mn[Rn[0].toLowerCase()],ai+Rn[0].length):-1}function yl(Ra,Yi,ai){return Do(Ra,S,Yi,ai)}function Wh(Ra,Yi,ai){return Do(Ra,_,Yi,ai)}function lh(Ra,Yi,ai){return Do(Ra,x,Yi,ai)}function ch(Ra){return U[Ra.getDay()]}function Eh(Ra){return M[Ra.getDay()]}function ef(Ra){return ve[Ra.getMonth()]}function hd(Ra){return ie[Ra.getMonth()]}function dd(Ra){return C[+(Ra.getHours()>=12)]}function od(Ra){return 1+~~(Ra.getMonth()/3)}function pd(Ra){return U[Ra.getUTCDay()]}function Zh(Ra){return M[Ra.getUTCDay()]}function md(Ra){return ve[Ra.getUTCMonth()]}function ed(Ra){return ie[Ra.getUTCMonth()]}function yd(Ra){return C[+(Ra.getUTCHours()>=12)]}function vd(Ra){return 1+~~(Ra.getUTCMonth()/3)}return{format:function(Yi){var ai=io(Yi+="",ri);return ai.toString=function(){return Yi},ai},parse:function(Yi){var ai=Aa(Yi+="",!1);return ai.toString=function(){return Yi},ai},utcFormat:function(Yi){var ai=io(Yi+="",Ka);return ai.toString=function(){return Yi},ai},utcParse:function(Yi){var ai=Aa(Yi+="",!0);return ai.toString=function(){return Yi},ai}}}var Go={"-":"",_:" ","0":"0"},ra=/^\s*\d+/,ou=/^%/,hi=/[\\^$*+?|[\]().{}]/g;function En(d,S,_){var x=d<0?"-":"",C=(x?-d:d)+"",M=C.length;return x+(M<_?new Array(_-M+1).join(S)+C:C)}function xa(d){return d.replace(hi,"\\$&")}function Va(d){return new RegExp("^(?:"+d.map(xa).join("|")+")","i")}function Ao(d){for(var S={},_=-1,x=d.length;++_<x;)S[d[_].toLowerCase()]=_;return S}function su(d,S,_){var x=ra.exec(S.slice(_,_+1));return x?(d.w=+x[0],_+x[0].length):-1}function $l(d,S,_){var x=ra.exec(S.slice(_,_+1));return x?(d.u=+x[0],_+x[0].length):-1}function Ot(d,S,_){var x=ra.exec(S.slice(_,_+2));return x?(d.U=+x[0],_+x[0].length):-1}function Er(d,S,_){var x=ra.exec(S.slice(_,_+2));return x?(d.V=+x[0],_+x[0].length):-1}function yr(d,S,_){var x=ra.exec(S.slice(_,_+2));return x?(d.W=+x[0],_+x[0].length):-1}function Cn(d,S,_){var x=ra.exec(S.slice(_,_+4));return x?(d.y=+x[0],_+x[0].length):-1}function Oa(d,S,_){var x=ra.exec(S.slice(_,_+2));return x?(d.y=+x[0]+(+x[0]>68?1900:2e3),_+x[0].length):-1}function v(d,S,_){var x=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(S.slice(_,_+6));return x?(d.Z=x[1]?0:-(x[2]+(x[3]||"00")),_+x[0].length):-1}function f(d,S,_){var x=ra.exec(S.slice(_,_+1));return x?(d.q=x[0]*3-3,_+x[0].length):-1}function c(d,S,_){var x=ra.exec(S.slice(_,_+2));return x?(d.m=x[0]-1,_+x[0].length):-1}function p(d,S,_){var x=ra.exec(S.slice(_,_+2));return x?(d.d=+x[0],_+x[0].length):-1}function y(d,S,_){var x=ra.exec(S.slice(_,_+3));return x?(d.m=0,d.d=+x[0],_+x[0].length):-1}function P(d,S,_){var x=ra.exec(S.slice(_,_+2));return x?(d.H=+x[0],_+x[0].length):-1}function N(d,S,_){var x=ra.exec(S.slice(_,_+2));return x?(d.M=+x[0],_+x[0].length):-1}function ee(d,S,_){var x=ra.exec(S.slice(_,_+2));return x?(d.S=+x[0],_+x[0].length):-1}function V(d,S,_){var x=ra.exec(S.slice(_,_+3));return x?(d.L=+x[0],_+x[0].length):-1}function J(d,S,_){var x=ra.exec(S.slice(_,_+6));return x?(d.L=Math.floor(x[0]/1e3),_+x[0].length):-1}function he(d,S,_){var x=ou.exec(S.slice(_,_+1));return x?_+x[0].length:-1}function We(d,S,_){var x=ra.exec(S.slice(_));return x?(d.Q=+x[0],_+x[0].length):-1}function De(d,S,_){var x=ra.exec(S.slice(_));return x?(d.s=+x[0],_+x[0].length):-1}function It(d,S){return En(d.getDate(),S,2)}function Kt(d,S){return En(d.getHours(),S,2)}function Ht(d,S){return En(d.getHours()%12||12,S,2)}function fr(d,S){return En(1+on.count(pc(d),d),S,3)}function Sr(d,S){return En(d.getMilliseconds(),S,3)}function ln(d,S){return Sr(d,S)+"000"}function jr(d,S){return En(d.getMonth()+1,S,2)}function an(d,S){return En(d.getMinutes(),S,2)}function pn(d,S){return En(d.getSeconds(),S,2)}function Gn(d){var S=d.getDay();return S===0?7:S}function la(d,S){return En(Qf.count(pc(d)-1,d),S,2)}function ma(d){var S=d.getDay();return S>=4||S===0?mf(d):mf.ceil(d)}function Oi(d,S){return d=ma(d),En(mf.count(pc(d),d)+(pc(d).getDay()===4),S,2)}function Ga(d){return d.getDay()}function Co(d,S){return En(qf.count(pc(d)-1,d),S,2)}function ho(d,S){return En(d.getFullYear()%100,S,2)}function ju(d,S){return d=ma(d),En(d.getFullYear()%100,S,2)}function ls(d,S){return En(d.getFullYear()%1e4,S,4)}function Jl(d,S){var _=d.getDay();return d=_>=4||_===0?mf(d):mf.ceil(d),En(d.getFullYear()%1e4,S,4)}function Io(d){var S=d.getTimezoneOffset();return(S>0?"-":(S*=-1,"+"))+En(S/60|0,"0",2)+En(S%60,"0",2)}function xi(d,S){return En(d.getUTCDate(),S,2)}function vf(d,S){return En(d.getUTCHours(),S,2)}function Qu(d,S){return En(d.getUTCHours()%12||12,S,2)}function Mf(d,S){return En(1+So.count(ji(d),d),S,3)}function mc(d,S){return En(d.getUTCMilliseconds(),S,3)}function Cl(d,S){return mc(d,S)+"000"}function Rc(d,S){return En(d.getUTCMonth()+1,S,2)}function Ic(d,S){return En(d.getUTCMinutes(),S,2)}function Hi(d,S){return En(d.getUTCSeconds(),S,2)}function wl(d){var S=d.getUTCDay();return S===0?7:S}function Ho(d,S){return En(Ur.count(ji(d)-1,d),S,2)}function Pf(d){var S=d.getUTCDay();return S>=4||S===0?sn(d):sn.ceil(d)}function gf(d,S){return d=Pf(d),En(sn.count(ji(d),d)+(ji(d).getUTCDay()===4),S,2)}function Ol(d){return d.getUTCDay()}function Uf(d,S){return En(Gr.count(ji(d)-1,d),S,2)}function Yh(d,S){return En(d.getUTCFullYear()%100,S,2)}function Ah(d,S){return d=Pf(d),En(d.getUTCFullYear()%100,S,2)}function th(d,S){return En(d.getUTCFullYear()%1e4,S,4)}function sd(d,S){var _=d.getUTCDay();return d=_>=4||_===0?sn(d):sn.ceil(d),En(d.getUTCFullYear()%1e4,S,4)}function ud(){return"+0000"}function ld(){return"%"}function uu(d){return+d}function rh(d){return Math.floor(+d/1e3)}var dh,e,t,r,u;h({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function h(d){return dh=Hs(d),e=dh.format,t=dh.parse,r=dh.utcFormat,u=dh.utcParse,dh}var g=1e3,A=g*60,L=A*60,B=L*24,te=B*7,pe=B*30,Se=B*365;function Me(d){return new Date(d)}function it(d){return d instanceof Date?+d:+new Date(+d)}function St(d,S,_,x,C,M,U,ie,ve){var Be=Xl(Es,Es),Lt=Be.invert,$t=Be.domain,Pr=ve(".%L"),Mr=ve(":%S"),mn=ve("%I:%M"),On=ve("%I %p"),Mn=ve("%a %d"),Sa=ve("%b %d"),Ha=ve("%B"),ri=ve("%Y"),Ka=[[U,1,g],[U,5,5*g],[U,15,15*g],[U,30,30*g],[M,1,A],[M,5,5*A],[M,15,15*A],[M,30,30*A],[C,1,L],[C,3,3*L],[C,6,6*L],[C,12,12*L],[x,1,B],[x,2,2*B],[_,1,te],[S,1,pe],[S,3,3*pe],[d,1,Se]];function ni(Aa){return(U(Aa)<Aa?Pr:M(Aa)<Aa?Mr:C(Aa)<Aa?mn:x(Aa)<Aa?On:S(Aa)<Aa?_(Aa)<Aa?Mn:Sa:d(Aa)<Aa?Ha:ri)(Aa)}function io(Aa,Do,rs,Xs){if(Aa==null&&(Aa=10),typeof Aa=="number"){var Wa=Math.abs(rs-Do)/Aa,ds=Fl(function(Fo){return Fo[2]}).right(Ka,Wa);ds===Ka.length?(Xs=b(Do/Se,rs/Se,Aa),Aa=d):ds?(ds=Ka[Wa/Ka[ds-1][2]<Ka[ds][2]/Wa?ds-1:ds],Xs=ds[1],Aa=ds[0]):(Xs=Math.max(b(Do,rs,Aa),1),Aa=ie)}return Xs==null?Aa:Aa.every(Xs)}return Be.invert=function(Aa){return new Date(Lt(Aa))},Be.domain=function(Aa){return arguments.length?$t($i.call(Aa,it)):$t().map(Me)},Be.ticks=function(Aa,Do){var rs=$t(),Xs=rs[0],Wa=rs[rs.length-1],ds=Wa<Xs,Fo;return ds&&(Fo=Xs,Xs=Wa,Wa=Fo),Fo=io(Aa,Xs,Wa,Do),Fo=Fo?Fo.range(Xs,Wa+1):[],ds?Fo.reverse():Fo},Be.tickFormat=function(Aa,Do){return Do==null?ni:ve(Do)},Be.nice=function(Aa,Do){var rs=$t();return(Aa=io(Aa,rs[0],rs[rs.length-1],Do))?$t(k(rs,Aa)):Be},Be.copy=function(){return Nu(Be,St(d,S,_,x,C,M,U,ie,ve))},Be}var xt=function(){return _r.apply(St(pc,ah,Qf,on,cn,Kr,Jr,Xn,e).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},Gt=Ta(function(d){d.setUTCDate(1),d.setUTCHours(0,0,0,0)},function(d,S){d.setUTCMonth(d.getUTCMonth()+S)},function(d,S){return S.getUTCMonth()-d.getUTCMonth()+(S.getUTCFullYear()-d.getUTCFullYear())*12},function(d){return d.getUTCMonth()}),Bt=Gt,ar=Gt.range,hr=Ta(function(d){d.setUTCMinutes(0,0,0)},function(d,S){d.setTime(+d+S*Jf)},function(d,S){return(S-d)/Jf},function(d){return d.getUTCHours()}),Tr=hr,Fr=hr.range,Ir=Ta(function(d){d.setUTCSeconds(0,0)},function(d,S){d.setTime(+d+S*wf)},function(d,S){return(S-d)/wf},function(d){return d.getUTCMinutes()}),hn=Ir,yn=Ir.range,Un=function(){return _r.apply(St(ji,Bt,Ur,So,Tr,hn,Jr,Xn,r).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)};function Jn(){var d=0,S=1,_,x,C,M,U=Es,ie=!1,ve;function Be(Lt){return isNaN(Lt=+Lt)?ve:U(C===0?.5:(Lt=(M(Lt)-_)*C,ie?Math.max(0,Math.min(1,Lt)):Lt))}return Be.domain=function(Lt){return arguments.length?(_=M(d=+Lt[0]),x=M(S=+Lt[1]),C=_===x?0:1/(x-_),Be):[d,S]},Be.clamp=function(Lt){return arguments.length?(ie=!!Lt,Be):ie},Be.interpolator=function(Lt){return arguments.length?(U=Lt,Be):U},Be.unknown=function(Lt){return arguments.length?(ve=Lt,Be):ve},function(Lt){return M=Lt,_=Lt(d),x=Lt(S),C=_===x?0:1/(x-_),Be}}function Dn(d,S){return S.domain(d.domain()).interpolator(d.interpolator()).clamp(d.clamp()).unknown(d.unknown())}function In(){var d=Kl(Jn()(Es));return d.copy=function(){return Dn(d,In())},wr.apply(d,arguments)}function _a(){var d=Vn(Jn()).domain([1,10]);return d.copy=function(){return Dn(d,_a()).base(d.base())},wr.apply(d,arguments)}function sa(){var d=za(Jn());return d.copy=function(){return Dn(d,sa()).constant(d.constant())},wr.apply(d,arguments)}function Yn(){var d=Qi(Jn());return d.copy=function(){return Dn(d,Yn()).exponent(d.exponent())},wr.apply(d,arguments)}function si(){return Yn.apply(null,arguments).exponent(.5)}function Ma(){var d=[],S=Es;function _(x){if(!isNaN(x=+x))return S((bu(d,x)-1)/(d.length-1))}return _.domain=function(x){if(!arguments.length)return d.slice();d=[];for(var C=0,M=x.length,U;C<M;++C)(U=x[C],U!=null&&!isNaN(U=+U))&&d.push(U);return d.sort(yu),_},_.interpolator=function(x){return arguments.length?(S=x,_):S},_.copy=function(){return Ma(S).domain(d)},wr.apply(_,arguments)}function zi(){var d=0,S=.5,_=1,x,C,M,U,ie,ve=Es,Be,Lt=!1,$t;function Pr(Mr){return isNaN(Mr=+Mr)?$t:(Mr=.5+((Mr=+Be(Mr))-C)*(Mr<C?U:ie),ve(Lt?Math.max(0,Math.min(1,Mr)):Mr))}return Pr.domain=function(Mr){return arguments.length?(x=Be(d=+Mr[0]),C=Be(S=+Mr[1]),M=Be(_=+Mr[2]),U=x===C?0:.5/(C-x),ie=C===M?0:.5/(M-C),Pr):[d,S,_]},Pr.clamp=function(Mr){return arguments.length?(Lt=!!Mr,Pr):Lt},Pr.interpolator=function(Mr){return arguments.length?(ve=Mr,Pr):ve},Pr.unknown=function(Mr){return arguments.length?($t=Mr,Pr):$t},function(Mr){return Be=Mr,x=Mr(d),C=Mr(S),M=Mr(_),U=x===C?0:.5/(C-x),ie=C===M?0:.5/(M-C),Pr}}function da(){var d=Kl(zi()(Es));return d.copy=function(){return Dn(d,da())},wr.apply(d,arguments)}function ui(){var d=Vn(zi()).domain([.1,1,10]);return d.copy=function(){return Dn(d,ui()).base(d.base())},wr.apply(d,arguments)}function wo(){var d=za(zi());return d.copy=function(){return Dn(d,wo()).constant(d.constant())},wr.apply(d,arguments)}function Wo(){var d=Qi(zi());return d.copy=function(){return Dn(d,Wo()).exponent(d.exponent())},wr.apply(d,arguments)}function lu(){return Wo.apply(null,arguments).exponent(.5)}var Mi,Ss,zo,cs,qu,Is,gl,Tu,fs,zu=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,di=(Mi={},we()(Mi,T.ScaleTypes.LINEAR,ne),we()(Mi,T.ScaleTypes.POWER,oi),we()(Mi,T.ScaleTypes.LOG,ta),we()(Mi,T.ScaleTypes.IDENTITY,se),we()(Mi,T.ScaleTypes.TIME,xt),we()(Mi,T.ScaleTypes.QUANTILE,ki),we()(Mi,T.ScaleTypes.QUANTIZE,yo),we()(Mi,T.ScaleTypes.THRESHOLD,us),we()(Mi,T.ScaleTypes.CAT,Ji),Mi),Pi=(Ss=Object(ir.injectable)(),zo=Object(ir.inject)(T.TYPES.IGlobalConfigService),cs=Object(ir.inject)(T.TYPES.ILogService),Ss(qu=(Is=(fs=function(){function d(){X()(this,d),je()(this,"configService",gl,this),je()(this,"logger",Tu,this),this.scaleCache={},this.scaleOptions={}}return o()(d,[{key:"apply",value:function(_,x){var C=this,M=x.styleAttributeService;_.hooks.init.tap("FeatureScalePlugin",function(){C.scaleOptions=_.getScaleOptions();var U=M.getLayerStyleAttributes(),ie=_.getSource().data.dataArray;if(ie.length===0)return;C.caculateScalesForAttributes(U||[],ie)}),_.hooks.beforeRenderData.tap("FeatureScalePlugin",function(){C.scaleOptions=_.getScaleOptions();var U=M.getLayerStyleAttributes(),ie=_.getSource().data.dataArray;return C.caculateScalesForAttributes(U||[],ie),_.layerModelNeedUpdate=!0,!0}),_.hooks.beforeRender.tap("FeatureScalePlugin",function(){if(_.layerModelNeedUpdate)return;C.scaleOptions=_.getScaleOptions();var U=M.getLayerStyleAttributes();if(U){var ie=_.getSource().data.dataArray;if(ie.length===0)return;var ve=U.filter(function(Be){return Be.needRescale});ve.length&&(C.caculateScalesForAttributes(ve,ie),C.logger.debug("rescale finished"))}})}},{key:"isNumber",value:function(_){return!isNaN(parseFloat(_))&&isFinite(_)}},{key:"caculateScalesForAttributes",value:function(_,x){var C=this;this.scaleCache={},_.forEach(function(M){if(M.scale){var U=M.scale,ie=M.name;U.names=C.parseFields(M.scale.field||[]);var ve=[];U.names.forEach(function(Be){ve.push(C.getOrCreateScale(Be,M,x))}),ve.some(function(Be){return Be.type===T.StyleScaleType.VARIABLE})?(U.type=T.StyleScaleType.VARIABLE,ve.forEach(function(Be){if(!U.callback){var Lt;if(U.values&&U.values!=="text"){var $t;if((($t=Be.option)===null||$t===void 0?void 0:$t.type)==="linear"&&U.values.length>2){var Pr=Be.scale.ticks(U.values.length);ie==="color"&&Be.scale.domain(Pr)}Be.scale.range(U.values)}else((Lt=Be.option)===null||Lt===void 0?void 0:Lt.type)==="cat"&&Be.scale.range(Be.option.domain)}})):(U.type=T.StyleScaleType.CONSTANT,U.defaultValues=ve.map(function(Be,Lt){return Be.scale(U.names[Lt])})),U.scalers=ve.map(function(Be){return{field:Be.field,func:Be.scale,option:Be.option}}),M.needRescale=!1}})}},{key:"getOrCreateScale",value:function(_,x,C){var M,U=[_,x.name].join("_"),ie=(M=x.scale)===null||M===void 0?void 0:M.values,ve=this.createScale(_,x.name,ie,C);return ve}},{key:"parseFields",value:function(_){return Array.isArray(_)?_:_i()(_)?_.split("*"):[_]}},{key:"createScale",value:function(_,x,C,M){var U,ie=this.scaleOptions[x]&&this.scaleOptions[x].field===_?this.scaleOptions[x]:this.scaleOptions[_],ve={field:_,scale:void 0,type:T.StyleScaleType.VARIABLE,option:ie};if(!M||!M.length)return ie&&ie.type?ve.scale=this.createDefaultScale(ie):(ve.scale=Ji([_]),ve.type=T.StyleScaleType.CONSTANT),ve;var Be=(U=M.find(function(Pr){return!Xu()(Pr[_])}))===null||U===void 0?void 0:U[_];if(this.isNumber(_)||Xu()(Be)&&!ie)ve.scale=Ji([_]),ve.type=T.StyleScaleType.CONSTANT;else{var Lt=ie&&ie.type||this.getDefaultType(Be);C==="text"&&(Lt=T.ScaleTypes.CAT);var $t=this.createDefaultScaleConfig(Lt,_,M);Object.assign($t,ie),ve.scale=this.createDefaultScale($t),ve.option=$t}return ve}},{key:"getDefaultType",value:function(_){var x=T.ScaleTypes.LINEAR;return typeof _=="string"&&(x=zu.test(_)?T.ScaleTypes.TIME:T.ScaleTypes.CAT),x}},{key:"createDefaultScaleConfig",value:function(_,x,C){var M={type:_},U=(C==null?void 0:C.map(function(ie){return ie[x]}))||[];return _!==T.ScaleTypes.CAT&&_!==T.ScaleTypes.QUANTILE?M.domain=cc(U):_===T.ScaleTypes.CAT?M.domain=Zc()(U):_===T.ScaleTypes.QUANTILE&&(M.domain=U),M}},{key:"createDefaultScale",value:function(_){var x=_.type,C=_.domain,M=di[x]();return C&&M.domain(C),M}}]),d}(),fs),gl=Je()(Is.prototype,"configService",[zo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tu=Je()(Is.prototype,"logger",[cs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Is))||qu),no,Li,el,Ws,po,Zs,ao,As;function Dc(d,S){var _=Object.keys(d);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(d);S&&(x=x.filter(function(C){return Object.getOwnPropertyDescriptor(d,C).enumerable})),_.push.apply(_,x)}return _}function Lf(d){for(var S=1;S<arguments.length;S++){var _=arguments[S]!=null?arguments[S]:{};S%2?Dc(Object(_),!0).forEach(function(x){we()(d,x,_[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(_)):Dc(Object(_)).forEach(function(x){Object.defineProperty(d,x,Object.getOwnPropertyDescriptor(_,x))})}return d}var Nc=(no=Object(ir.injectable)(),Li=Object(ir.inject)(T.TYPES.ICameraService),el=Object(ir.inject)(T.TYPES.IRendererService),no(Ws=(po=(As=function(){function d(){X()(this,d),je()(this,"cameraService",Zs,this),je()(this,"rendererService",ao,this)}return o()(d,[{key:"apply",value:function(_){_.hooks.beforeRender.tap("LayerAnimateStylePlugin",function(){_.models.forEach(function(x){x.addUniforms(Lf({},_.layerModel.getAnimateUniforms()))})})}}]),d}(),As),Zs=Je()(po.prototype,"cameraService",[Li],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ao=Je()(po.prototype,"rendererService",[el],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),po))||Ws),_u,Bf,nh=(_u=Object(ir.injectable)(),_u(Bf=function(){function d(){X()(this,d)}return o()(d,[{key:"apply",value:function(_){_.hooks.init.tap("LayerModelPlugin",function(){_.prepareBuildModel(),_.buildModels(),_.styleNeedUpdate=!1}),_.hooks.beforeRenderData.tap("DataSourcePlugin",function(){return _.prepareBuildModel(),_.clearModels(),_.buildModels(),_.layerModelNeedUpdate=!1,!1})}}]),d}())||Bf),Vf,Ch,Gf=(Vf=Object(ir.injectable)(),Vf(Ch=function(){function d(){X()(this,d)}return o()(d,[{key:"apply",value:function(_){_.hooks.afterInit.tap("LayerStylePlugin",function(){_.updateLayerConfig({});var x=_.getLayerConfig(),C=x.autoFit,M=x.fitBoundsOptions;C&&setTimeout(function(){_.fitBounds(M)},100)})}}]),d}())||Ch),wh,Oh;function ph(d,S){var _=Object.keys(d);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(d);S&&(x=x.filter(function(C){return Object.getOwnPropertyDescriptor(d,C).enumerable})),_.push.apply(_,x)}return _}function oh(d){for(var S=1;S<arguments.length;S++){var _=arguments[S]!=null?arguments[S]:{};S%2?ph(Object(_),!0).forEach(function(x){we()(d,x,_[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(_)):ph(Object(_)).forEach(function(x){Object.defineProperty(d,x,Object.getOwnPropertyDescriptor(_,x))})}return d}var Mh={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},Kh={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},sh={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},Ph={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5},td=["ambient","diffuse","specular"];function Lh(d){var S={u_DirectionalLights:new Array(3).fill(oh({},sh)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill(oh({},Ph)),u_NumOfSpotLights:0};return(!d||!d.length)&&(d=[Kh]),d.forEach(function(_,x){var C=_.type,M=C===void 0?"directional":C,U=Ze()(_,["type"]),ie=Mh[M].lights,ve=Mh[M].num,Be=S[ve];S[ie][Be]=oh(oh({},S[ie][Be]),U),S[ve]++}),S}var uh=(wh=Object(ir.injectable)(),wh(Oh=function(){function d(){X()(this,d)}return o()(d,[{key:"apply",value:function(_){_.hooks.beforeRender.tap("LightingPlugin",function(){var x=_.getLayerConfig(),C=x.enableLighting;C&&_.models.forEach(function(M){return M.addUniforms(oh({},Lh()))})})}}]),d}())||Oh),Rh,Uh,mh={NONE:0,ENCODE:1,HIGHLIGHT:2},Ih=(Rh=Object(ir.injectable)(),Rh(Uh=function(){function d(){X()(this,d)}return o()(d,[{key:"apply",value:function(_,x){var C=x.rendererService,M=x.styleAttributeService;_.hooks.init.tap("PixelPickingPlugin",function(){var U=_.getLayerConfig(),ie=U.enablePicking;M.registerStyleAttribute({name:"pickingColor",type:T.AttributeType.Attribute,descriptor:{name:"a_PickingColor",buffer:{data:[],type:T.gl.FLOAT},size:3,update:function(Be,Lt){var $t=Be.id;return ie?Object(Le.l)($t):[0,0,0]}}})}),_.hooks.beforePickingEncode.tap("PixelPickingPlugin",function(){var U=_.getLayerConfig(),ie=U.enablePicking;ie&&_.isVisible()&&_.models.forEach(function(ve){return ve.addUniforms({u_PickingStage:mh.ENCODE})})}),_.hooks.afterPickingEncode.tap("PixelPickingPlugin",function(){var U=_.getLayerConfig(),ie=U.enablePicking;ie&&_.isVisible()&&_.models.forEach(function(ve){return ve.addUniforms({u_PickingStage:mh.HIGHLIGHT})})}),_.hooks.beforeHighlight.tap("PixelPickingPlugin",function(U){var ie=_.getLayerConfig(),ve=ie.highlightColor,Be=typeof ve=="string"?Object(Le.s)(ve):ve||[1,0,0,1];_.updateLayerConfig({pickedFeatureID:Object(Le.k)(new Uint8Array(U))}),_.models.forEach(function(Lt){return Lt.addUniforms({u_PickingStage:mh.HIGHLIGHT,u_PickingColor:U,u_HighlightColor:Be.map(function($t){return $t*255})})})}),_.hooks.beforeSelect.tap("PixelPickingPlugin",function(U){var ie=_.getLayerConfig(),ve=ie.selectColor,Be=typeof ve=="string"?Object(Le.s)(ve):ve||[1,0,0,1];_.updateLayerConfig({pickedFeatureID:Object(Le.k)(new Uint8Array(U))}),_.models.forEach(function(Lt){return Lt.addUniforms({u_PickingStage:mh.HIGHLIGHT,u_PickingColor:U,u_HighlightColor:Be.map(function($t){return $t*255})})})})}}]),d}())||Uh),Bh,Vh,vh,Dh,Nh,kh,Gh=(Bh=Object(ir.injectable)(),Vh=Object(ir.inject)(T.TYPES.ILogService),Bh(vh=(Dh=(kh=function(){function d(){X()(this,d),je()(this,"logger",Nh,this)}return o()(d,[{key:"apply",value:function(_,x){var C=this,M=x.styleAttributeService;_.hooks.init.tap("RegisterStyleAttributePlugin",function(){C.registerBuiltinAttributes(M)})}},{key:"registerBuiltinAttributes",value:function(_){_.registerStyleAttribute({name:"position",type:T.AttributeType.Attribute,descriptor:{name:"a_Position",buffer:{data:[],type:T.gl.FLOAT},size:3,update:function(C,M,U){return U.length===2?[U[0],U[1],0]:[U[0],U[1],U[2]]}}}),_.registerStyleAttribute({name:"filter",type:T.AttributeType.Attribute,descriptor:{name:"filter",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:1,update:function(C,M){var U=C.filter;return U?[1]:[0]}}}),_.registerStyleAttribute({name:"color",type:T.AttributeType.Attribute,descriptor:{name:"a_Color",buffer:{usage:T.gl.DYNAMIC_DRAW,data:[],type:T.gl.FLOAT},size:4,update:function(C,M){var U=C.color;return!U||!U.length?[1,1,1,1]:U}}})}}]),d}(),kh),Nh=Je()(Dh.prototype,"logger",[Vh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dh))||vh),gh,jh,yh,bh,zh,xh,$h,rd,Jh,nd,ad=(gh=Object(ir.injectable)(),jh=Object(ir.inject)(T.TYPES.ICameraService),yh=Object(ir.inject)(T.TYPES.ICoordinateSystemService),bh=Object(ir.inject)(T.TYPES.IRendererService),gh(zh=(xh=(nd=function(){function d(){X()(this,d),je()(this,"cameraService",$h,this),je()(this,"coordinateSystemService",rd,this),je()(this,"rendererService",Jh,this)}return o()(d,[{key:"apply",value:function(_){var x=this;_.hooks.beforeRender.tap("ShaderUniformPlugin",function(){x.coordinateSystemService.refresh();var C=x.rendererService.getViewportSize(),M=C.width,U=C.height;_.models.forEach(function(ie){var ve;return ie.addUniforms((ve={},we()(ve,T.CameraUniform.ProjectionMatrix,x.cameraService.getProjectionMatrix()),we()(ve,T.CameraUniform.ViewMatrix,x.cameraService.getViewMatrix()),we()(ve,T.CameraUniform.ViewProjectionMatrix,x.cameraService.getViewProjectionMatrix()),we()(ve,T.CameraUniform.Zoom,x.cameraService.getZoom()),we()(ve,T.CameraUniform.ZoomScale,x.cameraService.getZoomScale()),we()(ve,T.CameraUniform.FocalDistance,x.cameraService.getFocalDistance()),we()(ve,T.CameraUniform.CameraPosition,x.cameraService.getCameraPosition()),we()(ve,T.CoordinateUniform.CoordinateSystem,x.coordinateSystemService.getCoordinateSystem()),we()(ve,T.CoordinateUniform.ViewportCenter,x.coordinateSystemService.getViewportCenter()),we()(ve,T.CoordinateUniform.ViewportCenterProjection,x.coordinateSystemService.getViewportCenterProjection()),we()(ve,T.CoordinateUniform.PixelsPerDegree,x.coordinateSystemService.getPixelsPerDegree()),we()(ve,T.CoordinateUniform.PixelsPerDegree2,x.coordinateSystemService.getPixelsPerDegree2()),we()(ve,T.CoordinateUniform.PixelsPerMeter,x.coordinateSystemService.getPixelsPerMeter()),we()(ve,"u_ViewportSize",[M,U]),we()(ve,"u_DevicePixelRatio",window.devicePixelRatio),we()(ve,"u_ModelMatrix",[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),we()(ve,"u_PickingBuffer",_.getLayerConfig().pickingBuffer||0),ve))})})}}]),d}(),nd),$h=Je()(xh.prototype,"cameraService",[jh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rd=Je()(xh.prototype,"coordinateSystemService",[yh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jh=Je()(xh.prototype,"rendererService",[bh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xh))||zh),gd,cd,Hh=(gd=Object(ir.injectable)(),gd(cd=function(){function d(){X()(this,d)}return o()(d,[{key:"apply",value:function(_){_.hooks.beforeRender.tap("UpdateModelPlugin",function(){_.layerModel&&_.layerModel.needUpdate()})}}]),d}())||cd),hs,yf,fd,Hf,Qh,id,qh=(hs=Object(ir.injectable)(),yf=Object(ir.inject)(T.TYPES.ILogService),hs(fd=(Hf=(id=function(){function d(){X()(this,d),je()(this,"logger",Qh,this)}return o()(d,[{key:"apply",value:function(_,x){var C=this,M=x.styleAttributeService;_.hooks.init.tap("UpdateStyleAttributePlugin",function(){C.initStyleAttribute(_,{styleAttributeService:M})}),_.hooks.beforeRender.tap("UpdateStyleAttributePlugin",function(){if(_.layerModelNeedUpdate)return;C.updateStyleAtrribute(_,{styleAttributeService:M})})}},{key:"updateStyleAtrribute",value:function(_,x){var C=this,M=x.styleAttributeService,U=M.getLayerStyleAttributes()||[],ie=M.getLayerStyleAttribute("filter"),ve=M.getLayerStyleAttribute("shape");if(ie&&ie.needRegenerateVertices||ve&&ve.needRegenerateVertices){_.layerModelNeedUpdate=!0,U.forEach(function(Be){return Be.needRegenerateVertices=!1});return}U.filter(function(Be){return Be.needRegenerateVertices}).forEach(function(Be){M.updateAttributeByFeatureRange(Be.name,_.getEncodedData(),Be.featureRange.startIndex,Be.featureRange.endIndex),Be.needRegenerateVertices=!1,C.logger.debug("regenerate vertex attributes: ".concat(Be.name," finished"))})}},{key:"initStyleAttribute",value:function(_,x){var C=this,M=x.styleAttributeService,U=M.getLayerStyleAttributes()||[];U.filter(function(ie){return ie.needRegenerateVertices}).forEach(function(ie){M.updateAttributeByFeatureRange(ie.name,_.getEncodedData(),ie.featureRange.startIndex,ie.featureRange.endIndex),ie.needRegenerateVertices=!1,C.logger.debug("init vertex attributes: ".concat(ie.name," finished"))})}}]),d}(),id),Qh=Je()(Hf.prototype,"logger",[yf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hf))||fd);T.container.bind(T.TYPES.ILayerPlugin).to(Di).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(Gh).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(Pi).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(Qn).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(Gf).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(qh).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(Hh).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(rt).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(ad).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(Nc).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(uh).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(Ih).inRequestScope(),T.container.bind(T.TYPES.ILayerPlugin).to(nh).inRequestScope()},t2Dn:function(Re,E,i){var T=i("hypo"),m=i("ljhN");function X(z,o,Z){(Z!==void 0&&!m(z[o],Z)||Z===void 0&&!(o in z))&&T(z,o,Z)}Re.exports=X},u6S6:function(Re,E,i){var T=i("6acW"),m=i("sgoq"),X=m(function(z,o,Z){return o=o.toLowerCase(),z+(Z?T(o):o)});Re.exports=X},uhBA:function(Re,E,i){"use strict";var T=Object.prototype.hasOwnProperty,m="~";function X(){}Object.create&&(X.prototype=Object.create(null),new X().__proto__||(m=!1));function z(K,re,de){this.fn=K,this.context=re,this.once=de||!1}function o(K,re,de,Y,Fe){if(typeof de!="function")throw new TypeError("The listener must be a function");var Ze=new z(de,Y||K,Fe),ye=m?m+re:re;return K._events[ye]?K._events[ye].fn?K._events[ye]=[K._events[ye],Ze]:K._events[ye].push(Ze):(K._events[ye]=Ze,K._eventsCount++),K}function Z(K,re){--K._eventsCount===0?K._events=new X:delete K._events[re]}function D(){this._events=new X,this._eventsCount=0}D.prototype.eventNames=function(){var re=[],de,Y;if(this._eventsCount===0)return re;for(Y in de=this._events)T.call(de,Y)&&re.push(m?Y.slice(1):Y);return Object.getOwnPropertySymbols?re.concat(Object.getOwnPropertySymbols(de)):re},D.prototype.listeners=function(re){var de=m?m+re:re,Y=this._events[de];if(!Y)return[];if(Y.fn)return[Y.fn];for(var Fe=0,Ze=Y.length,ye=new Array(Ze);Fe<Ze;Fe++)ye[Fe]=Y[Fe].fn;return ye},D.prototype.listenerCount=function(re){var de=m?m+re:re,Y=this._events[de];return Y?Y.fn?1:Y.length:0},D.prototype.emit=function(re,de,Y,Fe,Ze,ye){var we=m?m+re:re;if(!this._events[we])return!1;var pt=this._events[we],je=arguments.length,Tt,Xe;if(pt.fn){pt.once&&this.removeListener(re,pt.fn,void 0,!0);switch(je){case 1:return pt.fn.call(pt.context),!0;case 2:return pt.fn.call(pt.context,de),!0;case 3:return pt.fn.call(pt.context,de,Y),!0;case 4:return pt.fn.call(pt.context,de,Y,Fe),!0;case 5:return pt.fn.call(pt.context,de,Y,Fe,Ze),!0;case 6:return pt.fn.call(pt.context,de,Y,Fe,Ze,ye),!0}for(Xe=1,Tt=new Array(je-1);Xe<je;Xe++)Tt[Xe-1]=arguments[Xe];pt.fn.apply(pt.context,Tt)}else{var gt=pt.length,Je;for(Xe=0;Xe<gt;Xe++){pt[Xe].once&&this.removeListener(re,pt[Xe].fn,void 0,!0);switch(je){case 1:pt[Xe].fn.call(pt[Xe].context);break;case 2:pt[Xe].fn.call(pt[Xe].context,de);break;case 3:pt[Xe].fn.call(pt[Xe].context,de,Y);break;case 4:pt[Xe].fn.call(pt[Xe].context,de,Y,Fe);break;default:if(!Tt)for(Je=1,Tt=new Array(je-1);Je<je;Je++)Tt[Je-1]=arguments[Je];pt[Xe].fn.apply(pt[Xe].context,Tt)}}}return!0},D.prototype.on=function(re,de,Y){return o(this,re,de,Y,!1)},D.prototype.once=function(re,de,Y){return o(this,re,de,Y,!0)},D.prototype.removeListener=function(re,de,Y,Fe){var Ze=m?m+re:re;if(!this._events[Ze])return this;if(!de)return Z(this,Ze),this;var ye=this._events[Ze];if(ye.fn)ye.fn===de&&(!Fe||ye.once)&&(!Y||ye.context===Y)&&Z(this,Ze);else{for(var we=0,pt=[],je=ye.length;we<je;we++)(ye[we].fn!==de||Fe&&!ye[we].once||Y&&ye[we].context!==Y)&&pt.push(ye[we]);pt.length?this._events[Ze]=pt.length===1?pt[0]:pt:Z(this,Ze)}return this},D.prototype.removeAllListeners=function(re){var de;return re?(de=m?m+re:re,this._events[de]&&Z(this,de)):(this._events=new X,this._eventsCount=0),this},D.prototype.off=D.prototype.removeListener,D.prototype.addListener=D.prototype.on,D.prefixed=m,D.EventEmitter=D,Re.exports=D},ujMp:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("MON2");function m(re){if(typeof re=="function"){var de=re;return de.name}else{if(typeof re=="symbol")return re.toString();var de=re;return de}}E.getServiceIdentifierAsString=m;function X(re,de,Y){var Fe="",Ze=Y(re,de);return Ze.length!==0&&(Fe=`
Registered bindings:`,Ze.forEach(function(ye){var we="Object";ye.implementationType!==null&&(we=K(ye.implementationType)),Fe=Fe+`
 `+we,ye.constraint.metaData&&(Fe=Fe+" - "+ye.constraint.metaData)})),Fe}E.listRegisteredBindingsForServiceIdentifier=X;function z(re,de){return re.parentRequest===null?!1:re.parentRequest.serviceIdentifier===de?!0:z(re.parentRequest,de)}function o(re){function de(Fe,Ze){Ze===void 0&&(Ze=[]);var ye=m(Fe.serviceIdentifier);return Ze.push(ye),Fe.parentRequest!==null?de(Fe.parentRequest,Ze):Ze}var Y=de(re);return Y.reverse().join(" --> ")}function Z(re){re.childRequests.forEach(function(de){if(z(de,de.serviceIdentifier)){var Y=o(de);throw new Error(T.CIRCULAR_DEPENDENCY+" "+Y)}else Z(de)})}E.circularDependencyToException=Z;function D(re,de){if(de.isTagged()||de.isNamed()){var Y="",Fe=de.getNamedTag(),Ze=de.getCustomTags();return Fe!==null&&(Y+=Fe.toString()+`
`),Ze!==null&&Ze.forEach(function(ye){Y+=ye.toString()+`
`})," "+re+`
 `+re+" - "+Y}else return" "+re}E.listMetadataForTarget=D;function K(re){if(re.name)return re.name;var de=re.toString(),Y=de.match(/^function\s*([^\s(]+)/);return Y?Y[1]:"Anonymous function: "+de}E.getFunctionName=K},"vN+2":function(Re,E){function i(){}Re.exports=i},"w/wX":function(Re,E,i){var T=i("QqLw"),m=i("ExA7"),X="[object Set]";function z(o){return m(o)&&T(o)==X}Re.exports=z},w26f:function(Re,E,i){(function(T){var m=200,X="__lodash_hash_undefined__",z=1/0,o="[object Function]",Z="[object GeneratorFunction]",D=/[\\^$.*+?()[\]{}|]/g,K=/^\[object .+?Constructor\]$/,re=typeof T=="object"&&T&&T.Object===Object&&T,de=typeof self=="object"&&self&&self.Object===Object&&self,Y=re||de||Function("return this")();function Fe(ct,Qe){var Ft=ct?ct.length:0;return!!Ft&&we(ct,Qe,0)>-1}function Ze(ct,Qe,Ft){for(var vr=-1,Vr=ct?ct.length:0;++vr<Vr;)if(Ft(Qe,ct[vr]))return!0;return!1}function ye(ct,Qe,Ft,vr){for(var Vr=ct.length,lr=Ft+(vr?1:-1);vr?lr--:++lr<Vr;)if(Qe(ct[lr],lr,ct))return lr;return-1}function we(ct,Qe,Ft){if(Qe!==Qe)return ye(ct,pt,Ft);for(var vr=Ft-1,Vr=ct.length;++vr<Vr;)if(ct[vr]===Qe)return vr;return-1}function pt(ct){return ct!==ct}function je(ct,Qe){return ct.has(Qe)}function Tt(ct,Qe){return ct==null?void 0:ct[Qe]}function Xe(ct){var Qe=!1;if(ct!=null&&typeof ct.toString!="function")try{Qe=!!(ct+"")}catch(Ft){}return Qe}function gt(ct){var Qe=-1,Ft=Array(ct.size);return ct.forEach(function(vr){Ft[++Qe]=vr}),Ft}var Je=Array.prototype,Et=Function.prototype,_t=Object.prototype,Ne=Y["__core-js_shared__"],ke=function(){var ct=/[^.]+$/.exec(Ne&&Ne.keys&&Ne.keys.IE_PROTO||"");return ct?"Symbol(src)_1."+ct:""}(),Ue=Et.toString,st=_t.hasOwnProperty,Le=_t.toString,ut=RegExp("^"+Ue.call(st).replace(D,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Vt=Je.splice,Zt=ae(Y,"Map"),ir=ae(Y,"Set"),oe=ae(Object,"create");function Q(ct){var Qe=-1,Ft=ct?ct.length:0;for(this.clear();++Qe<Ft;){var vr=ct[Qe];this.set(vr[0],vr[1])}}function H(){this.__data__=oe?oe(null):{}}function Ce(ct){return this.has(ct)&&delete this.__data__[ct]}function Ee(ct){var Qe=this.__data__;if(oe){var Ft=Qe[ct];return Ft===X?void 0:Ft}return st.call(Qe,ct)?Qe[ct]:void 0}function Ae(ct){var Qe=this.__data__;return oe?Qe[ct]!==void 0:st.call(Qe,ct)}function ge(ct,Qe){var Ft=this.__data__;return Ft[ct]=oe&&Qe===void 0?X:Qe,this}Q.prototype.clear=H,Q.prototype.delete=Ce,Q.prototype.get=Ee,Q.prototype.has=Ae,Q.prototype.set=ge;function rt(ct){var Qe=-1,Ft=ct?ct.length:0;for(this.clear();++Qe<Ft;){var vr=ct[Qe];this.set(vr[0],vr[1])}}function Yt(){this.__data__=[]}function At(ct){var Qe=this.__data__,Ft=yt(Qe,ct);if(Ft<0)return!1;var vr=Qe.length-1;return Ft==vr?Qe.pop():Vt.call(Qe,Ft,1),!0}function be(ct){var Qe=this.__data__,Ft=yt(Qe,ct);return Ft<0?void 0:Qe[Ft][1]}function xe(ct){return yt(this.__data__,ct)>-1}function Ve(ct,Qe){var Ft=this.__data__,vr=yt(Ft,ct);return vr<0?Ft.push([ct,Qe]):Ft[vr][1]=Qe,this}rt.prototype.clear=Yt,rt.prototype.delete=At,rt.prototype.get=be,rt.prototype.has=xe,rt.prototype.set=Ve;function lt(ct){var Qe=-1,Ft=ct?ct.length:0;for(this.clear();++Qe<Ft;){var vr=ct[Qe];this.set(vr[0],vr[1])}}function Pe(){this.__data__={hash:new Q,map:new(Zt||rt),string:new Q}}function dt(ct){return Ke(this,ct).delete(ct)}function w(ct){return Ke(this,ct).get(ct)}function I(ct){return Ke(this,ct).has(ct)}function q(ct,Qe){return Ke(this,ct).set(ct,Qe),this}lt.prototype.clear=Pe,lt.prototype.delete=dt,lt.prototype.get=w,lt.prototype.has=I,lt.prototype.set=q;function ce(ct){var Qe=-1,Ft=ct?ct.length:0;for(this.__data__=new lt;++Qe<Ft;)this.add(ct[Qe])}function Ge(ct){return this.__data__.set(ct,X),this}function $e(ct){return this.__data__.has(ct)}ce.prototype.add=ce.prototype.push=Ge,ce.prototype.has=$e;function yt(ct,Qe){for(var Ft=ct.length;Ft--;)if(mt(ct[Ft][0],Qe))return Ft;return-1}function nt(ct){if(!vt(ct)||jt(ct))return!1;var Qe=Ct(ct)||Xe(ct)?ut:K;return Qe.test(sr(ct))}function Nt(ct,Qe,Ft){var vr=-1,Vr=Fe,lr=ct.length,Nn=!0,vn=[],na=vn;if(Ft)Nn=!1,Vr=Ze;else if(lr>=m){var ha=Qe?null:$(ct);if(ha)return gt(ha);Nn=!1,Vr=je,na=new ce}else na=Qe?[]:vn;e:for(;++vr<lr;){var Zn=ct[vr],Hn=Qe?Qe(Zn):Zn;if(Zn=Ft||Zn!==0?Zn:0,Nn&&Hn===Hn){for(var F=na.length;F--;)if(na[F]===Hn)continue e;Qe&&na.push(Hn),vn.push(Zn)}else Vr(na,Hn,Ft)||(na!==vn&&na.push(Hn),vn.push(Zn))}return vn}var $=ir&&1/gt(new ir([,-0]))[1]==z?function(ct){return new ir(ct)}:Oe;function Ke(ct,Qe){var Ft=ct.__data__;return et(Qe)?Ft[typeof Qe=="string"?"string":"hash"]:Ft.map}function ae(ct,Qe){var Ft=Tt(ct,Qe);return nt(Ft)?Ft:void 0}function et(ct){var Qe=typeof ct;return Qe=="string"||Qe=="number"||Qe=="symbol"||Qe=="boolean"?ct!=="__proto__":ct===null}function jt(ct){return!!ke&&ke in ct}function sr(ct){if(ct!=null){try{return Ue.call(ct)}catch(Qe){}try{return ct+""}catch(Qe){}}return""}function ft(ct){return ct&&ct.length?Nt(ct):[]}function mt(ct,Qe){return ct===Qe||ct!==ct&&Qe!==Qe}function Ct(ct){var Qe=vt(ct)?Le.call(ct):"";return Qe==o||Qe==Z}function vt(ct){var Qe=typeof ct;return!!ct&&(Qe=="object"||Qe=="function")}function Oe(){}Re.exports=ft}).call(this,i("yLpj"))},wclG:function(Re,E,i){var T=i("pFRH"),m=i("88Gu"),X=m(T);Re.exports=X},wnjb:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("xfSm"),m=function(){function X(){}return X.prototype.getConstructorMetadata=function(z){var o=Reflect.getMetadata(T.PARAM_TYPES,z),Z=Reflect.getMetadata(T.TAGGED,z);return{compilerGeneratedMetadata:o,userGeneratedMetadata:Z||{}}},X.prototype.getPropertiesMetadata=function(z){var o=Reflect.getMetadata(T.TAGGED_PROP,z)||[];return o},X}();E.MetadataReader=m},wrZu:function(Re,E,i){var T=i("+K+b"),m=i("XYm9"),X=i("b2z7"),z=i("otv/"),o=i("yP5f"),Z="[object Boolean]",D="[object Date]",K="[object Map]",re="[object Number]",de="[object RegExp]",Y="[object Set]",Fe="[object String]",Ze="[object Symbol]",ye="[object ArrayBuffer]",we="[object DataView]",pt="[object Float32Array]",je="[object Float64Array]",Tt="[object Int8Array]",Xe="[object Int16Array]",gt="[object Int32Array]",Je="[object Uint8Array]",Et="[object Uint8ClampedArray]",_t="[object Uint16Array]",Ne="[object Uint32Array]";function ke(Ue,st,Le){var ut=Ue.constructor;switch(st){case ye:return T(Ue);case Z:case D:return new ut(+Ue);case we:return m(Ue,Le);case pt:case je:case Tt:case Xe:case gt:case Je:case Et:case _t:case Ne:return o(Ue,Le);case K:return new ut;case re:case Fe:return new ut(Ue);case de:return X(Ue);case Y:return new ut;case Ze:return z(Ue)}}Re.exports=ke},wy8a:function(Re,E,i){var T=i("KxBF");function m(X,z,o){var Z=X.length;return o=o===void 0?Z:o,!z&&o>=Z?X:T(X,z,o)}Re.exports=m},xfSm:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.NAMED_TAG="named",E.NAME_TAG="name",E.UNMANAGED_TAG="unmanaged",E.OPTIONAL_TAG="optional",E.INJECT_TAG="inject",E.MULTI_INJECT_TAG="multi_inject",E.TAGGED="inversify:tagged",E.TAGGED_PROP="inversify:tagged_props",E.PARAM_TYPES="inversify:paramtypes",E.DESIGN_PARAM_TYPES="design:paramtypes",E.POST_CONSTRUCT="post_construct"},xfeJ:function(Re,E){function i(T){return Function.toString.call(T).indexOf("[native code]")!==-1}Re.exports=i},xiII:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("d9O0"),m=function(){function X(z,o,Z,D,K){this.id=T.id(),this.serviceIdentifier=z,this.parentContext=o,this.parentRequest=Z,this.target=K,this.childRequests=[],this.bindings=Array.isArray(D)?D:[D],this.requestScope=Z===null?new Map:null}return X.prototype.addChildRequest=function(z,o,Z){var D=new X(z,this.parentContext,this,o,Z);return this.childRequests.push(D),D},X}();E.Request=m},xp6e:function(Re,E,i){"use strict";(function(T){i.d(E,"a",function(){return Ee}),i.d(E,"b",function(){return Yt}),i.d(E,"c",function(){return oe}),i.d(E,"d",function(){return rt});/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function m(At,be,xe,Ve){function lt(Pe){return Pe instanceof xe?Pe:new xe(function(dt){dt(Pe)})}return new(xe||(xe=Promise))(function(Pe,dt){function w(ce){try{q(Ve.next(ce))}catch(Ge){dt(Ge)}}function I(ce){try{q(Ve.throw(ce))}catch(Ge){dt(Ge)}}function q(ce){ce.done?Pe(ce.value):lt(ce.value).then(w,I)}q((Ve=Ve.apply(At,be||[])).next())})}function X(At,be){var xe={label:0,sent:function(){if(Pe[0]&1)throw Pe[1];return Pe[1]},trys:[],ops:[]},Ve,lt,Pe,dt;return dt={next:w(0),throw:w(1),return:w(2)},typeof Symbol=="function"&&(dt[Symbol.iterator]=function(){return this}),dt;function w(q){return function(ce){return I([q,ce])}}function I(q){if(Ve)throw new TypeError("Generator is already executing.");for(;xe;)try{if(Ve=1,lt&&(Pe=q[0]&2?lt.return:q[0]?lt.throw||((Pe=lt.return)&&Pe.call(lt),0):lt.next)&&!(Pe=Pe.call(lt,q[1])).done)return Pe;(lt=0,Pe)&&(q=[q[0]&2,Pe.value]);switch(q[0]){case 0:case 1:Pe=q;break;case 4:return xe.label++,{value:q[1],done:!1};case 5:xe.label++,lt=q[1],q=[0];continue;case 7:q=xe.ops.pop(),xe.trys.pop();continue;default:if(!(Pe=xe.trys,Pe=Pe.length>0&&Pe[Pe.length-1])&&(q[0]===6||q[0]===2)){xe=0;continue}if(q[0]===3&&(!Pe||q[1]>Pe[0]&&q[1]<Pe[3])){xe.label=q[1];break}if(q[0]===6&&xe.label<Pe[1]){xe.label=Pe[1],Pe=q;break}if(Pe&&xe.label<Pe[2]){xe.label=Pe[2],xe.ops.push(q);break}Pe[2]&&xe.ops.pop(),xe.trys.pop();continue}q=be.call(At,xe)}catch(ce){q=[6,ce],lt=0}finally{Ve=Pe=0}if(q[0]&5)throw q[1];return{value:q[0]?q[1]:void 0,done:!0}}}function z(At,be){var xe=typeof Symbol=="function"&&At[Symbol.iterator];if(!xe)return At;var Ve=xe.call(At),lt,Pe=[],dt;try{for(;(be===void 0||be-- >0)&&!(lt=Ve.next()).done;)Pe.push(lt.value)}catch(w){dt={error:w}}finally{try{lt&&!lt.done&&(xe=Ve.return)&&xe.call(Ve)}finally{if(dt)throw dt.error}}return Pe}function o(){for(var At=[],be=0;be<arguments.length;be++)At=At.concat(z(arguments[be]));return At}function Z(At){return At&&At.__esModule&&Object.prototype.hasOwnProperty.call(At,"default")?At.default:At}function D(At,be){return be={exports:{}},At(be,be.exports),be.exports}var K=D(function(At,be){Object.defineProperty(be,"__esModule",{value:!0}),be.default=xe;function xe(Ve){return Ve&&typeof Ve.length=="number"&&Ve.length>=0&&Ve.length%1===0}At.exports=be.default});Z(K);var re=D(function(At,be){Object.defineProperty(be,"__esModule",{value:!0}),be.default=function(xe){return function(){for(var Ve=[],lt=arguments.length;lt--;)Ve[lt]=arguments[lt];var Pe=Ve.pop();return xe.call(this,Ve,Pe)}},At.exports=be.default});Z(re);var de=D(function(At,be){Object.defineProperty(be,"__esModule",{value:!0}),be.fallback=lt,be.wrap=Pe;var xe=be.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,Ve=be.hasNextTick=typeof T=="object"&&typeof T.nextTick=="function";function lt(w){setTimeout(w,0)}function Pe(w){return function(I){for(var q=[],ce=arguments.length-1;ce-- >0;)q[ce]=arguments[ce+1];return w(function(){return I.apply(void 0,q)})}}var dt;xe?dt=setImmediate:Ve?dt=T.nextTick:dt=lt,be.default=Pe(dt)});Z(de);var Y=de.fallback,Fe=de.wrap,Ze=de.hasSetImmediate,ye=de.hasNextTick,we=D(function(At,be){Object.defineProperty(be,"__esModule",{value:!0}),be.default=Pe;var xe=lt(re),Ve=lt(de);function lt(I){return I&&I.__esModule?I:{default:I}}function Pe(I){return(0,pt.isAsync)(I)?function(){for(var q=[],ce=arguments.length;ce--;)q[ce]=arguments[ce];var Ge=q.pop(),$e=I.apply(this,q);return dt($e,Ge)}:(0,xe.default)(function(q,ce){var Ge;try{Ge=I.apply(this,q)}catch($e){return ce($e)}if(Ge&&typeof Ge.then=="function")return dt(Ge,ce);ce(null,Ge)})}function dt(I,q){return I.then(function(ce){w(q,null,ce)},function(ce){w(q,ce&&ce.message?ce:new Error(ce))})}function w(I,q,ce){try{I(q,ce)}catch(Ge){(0,Ve.default)(function($e){throw $e},Ge)}}At.exports=be.default});Z(we);var pt=D(function(At,be){Object.defineProperty(be,"__esModule",{value:!0}),be.isAsyncIterable=be.isAsyncGenerator=be.isAsync=void 0;var xe=Ve(we);function Ve(I){return I&&I.__esModule?I:{default:I}}function lt(I){return I[Symbol.toStringTag]==="AsyncFunction"}function Pe(I){return I[Symbol.toStringTag]==="AsyncGenerator"}function dt(I){return typeof I[Symbol.asyncIterator]=="function"}function w(I){if(typeof I!="function")throw new Error("expected a function");return lt(I)?(0,xe.default)(I):I}be.default=w,be.isAsync=lt,be.isAsyncGenerator=Pe,be.isAsyncIterable=dt});Z(pt);var je=pt.isAsyncIterable,Tt=pt.isAsyncGenerator,Xe=pt.isAsync,gt=D(function(At,be){Object.defineProperty(be,"__esModule",{value:!0}),be.default=xe;function xe(Ve,lt){if(lt===void 0&&(lt=Ve.length),!lt)throw new Error("arity is undefined");function Pe(){for(var dt=this,w=[],I=arguments.length;I--;)w[I]=arguments[I];return typeof w[lt-1]=="function"?Ve.apply(this,w):new Promise(function(q,ce){w[lt-1]=function(Ge){for(var $e=[],yt=arguments.length-1;yt-- >0;)$e[yt]=arguments[yt+1];if(Ge)return ce(Ge);q($e.length>1?$e:$e[0])},Ve.apply(dt,w)})}return Object.defineProperty(Pe,"name",{configurable:!0,value:"awaitable("+Ve.name+")"}),Pe}At.exports=be.default});Z(gt);var Je=D(function(At,be){Object.defineProperty(be,"__esModule",{value:!0});var xe=Pe(K),Ve=Pe(pt),lt=Pe(gt);function Pe(dt){return dt&&dt.__esModule?dt:{default:dt}}be.default=(0,lt.default)(function(dt,w,I){var q=(0,xe.default)(w)?[]:{};dt(w,function(ce,Ge,$e){(0,Ve.default)(ce)(function(yt){for(var nt,Nt=[],$=arguments.length-1;$-- >0;)Nt[$]=arguments[$+1];Nt.length<2&&(nt=Nt,Nt=nt[0]),q[Ge]=Nt,$e(yt)})},function(ce){return I(ce,q)})},3),At.exports=be.default});Z(Je);var Et=D(function(At,be){Object.defineProperty(be,"__esModule",{value:!0}),be.default=xe;function xe(Ve){function lt(){for(var Pe=[],dt=arguments.length;dt--;)Pe[dt]=arguments[dt];if(Ve===null)return;var w=Ve;Ve=null,w.apply(this,Pe)}return Object.assign(lt,Ve),lt}At.exports=be.default});Z(Et);var _t=D(function(At,be){Object.defineProperty(be,"__esModule",{value:!0}),be.default=function(xe){return xe[Symbol.iterator]&&xe[Symbol.iterator]()},At.exports=be.default});Z(_t);var Ne=D(function(At,be){Object.defineProperty(be,"__esModule",{value:!0}),be.default=I;var xe=lt(K),Ve=lt(_t);function lt(q){return q&&q.__esModule?q:{default:q}}function Pe(q){var ce=-1,Ge=q.length;return function(){return++ce<Ge?{value:q[ce],key:ce}:null}}function dt(q){var ce=-1;return function(){var $e=q.next();return $e.done?null:(ce++,{value:$e.value,key:ce})}}function w(q){var ce=q?Object.keys(q):[],Ge=-1,$e=ce.length;return function(){var nt=ce[++Ge];return Ge<$e?{value:q[nt],key:nt}:null}}function I(q){if((0,xe.default)(q))return Pe(q);var ce=(0,Ve.default)(q);return ce?dt(ce):w(q)}At.exports=be.default});Z(Ne);var ke=D(function(At,be){Object.defineProperty(be,"__esModule",{value:!0}),be.default=xe;function xe(Ve){return function(){for(var lt=[],Pe=arguments.length;Pe--;)lt[Pe]=arguments[Pe];if(Ve===null)throw new Error("Callback was already called.");var dt=Ve;Ve=null,dt.apply(this,lt)}}At.exports=be.default});Z(ke);var Ue=D(function(At,be){Object.defineProperty(be,"__esModule",{value:!0});var xe={};be.default=xe,At.exports=be.default});Z(Ue);var st=D(function(At,be){Object.defineProperty(be,"__esModule",{value:!0}),be.default=lt;var xe=Ve(Ue);function Ve(Pe){return Pe&&Pe.__esModule?Pe:{default:Pe}}function lt(Pe,dt,w,I){var q=!1,ce=!1,Ge=!1,$e=0,yt=0;function nt(){if($e>=dt||Ge||q)return;Ge=!0,Pe.next().then(function(Ke){var ae=Ke.value,et=Ke.done;if(ce||q)return;if(Ge=!1,et){q=!0,$e<=0&&I(null);return}$e++,w(ae,yt,Nt),yt++,nt()}).catch($)}function Nt(Ke,ae){if($e-=1,ce)return;if(Ke)return $(Ke);if(Ke===!1){q=!0,ce=!0;return}if(ae===xe.default||q&&$e<=0)return q=!0,I(null);nt()}function $(Ke){if(ce)return;Ge=!1,q=!0,I(Ke)}nt()}At.exports=be.default});Z(st);var Le=D(function(At,be){Object.defineProperty(be,"__esModule",{value:!0});var xe=w(Et),Ve=w(Ne),lt=w(ke),Pe=w(st),dt=w(Ue);function w(I){return I&&I.__esModule?I:{default:I}}be.default=function(I){return function(q,ce,Ge){if(Ge=(0,xe.default)(Ge),I<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!q)return Ge(null);if((0,pt.isAsyncGenerator)(q))return(0,Pe.default)(q,I,ce,Ge);if((0,pt.isAsyncIterable)(q))return(0,Pe.default)(q[Symbol.asyncIterator](),I,ce,Ge);var $e=(0,Ve.default)(q),yt=!1,nt=!1,Nt=0,$=!1;function Ke(et,jt){if(nt)return;if(Nt-=1,et)yt=!0,Ge(et);else if(et===!1)yt=!0,nt=!0;else{if(jt===dt.default||yt&&Nt<=0)return yt=!0,Ge(null);$||ae()}}function ae(){for($=!0;Nt<I&&!yt;){var et=$e();if(et===null){yt=!0,Nt<=0&&Ge(null);return}Nt+=1,ce(et.value,et.key,(0,lt.default)(Ke))}$=!1}ae()}},At.exports=be.default});Z(Le);var ut=D(function(At,be){Object.defineProperty(be,"__esModule",{value:!0});var xe=Pe(Le),Ve=Pe(pt),lt=Pe(gt);function Pe(w){return w&&w.__esModule?w:{default:w}}function dt(w,I,q,ce){return(0,xe.default)(I)(w,(0,Ve.default)(q),ce)}be.default=(0,lt.default)(dt,4),At.exports=be.default});Z(ut);var Vt=D(function(At,be){Object.defineProperty(be,"__esModule",{value:!0});var xe=lt(ut),Ve=lt(gt);function lt(dt){return dt&&dt.__esModule?dt:{default:dt}}function Pe(dt,w,I){return(0,xe.default)(dt,1,w,I)}be.default=(0,Ve.default)(Pe,3),At.exports=be.default});Z(Vt);var Zt=D(function(At,be){Object.defineProperty(be,"__esModule",{value:!0}),be.default=Pe;var xe=lt(Je),Ve=lt(Vt);function lt(dt){return dt&&dt.__esModule?dt:{default:dt}}function Pe(dt,w){return(0,xe.default)(Ve.default,dt,w)}At.exports=be.default}),ir=Z(Zt),oe=function(){function At(){for(var be=arguments,xe=[],Ve=0;Ve<arguments.length;Ve++)xe[Ve]=be[Ve];this.args=[],this.tasks=[]}return At.prototype.call=function(){for(var be=arguments,xe=[],Ve=0;Ve<arguments.length;Ve++)xe[Ve]=be[Ve];return this.args=xe,ir(this.tasks)},At.prototype.tap=function(be,xe){var Ve=this;this.tasks.push(function(lt){xe.apply(void 0,o(Ve.args)),lt(null,be)})},At}(),Q=D(function(At,be){Object.defineProperty(be,"__esModule",{value:!0});var xe=q(K),Ve=q(Ue),lt=q(ut),Pe=q(Et),dt=q(ke),w=q(pt),I=q(gt);function q(yt){return yt&&yt.__esModule?yt:{default:yt}}function ce(yt,nt,Nt){Nt=(0,Pe.default)(Nt);var $=0,Ke=0,ae=yt.length,et=!1;ae===0&&Nt(null);function jt(sr,ft){if(sr===!1&&(et=!0),et===!0)return;sr?Nt(sr):(++Ke===ae||ft===Ve.default)&&Nt(null)}for(;$<ae;$++)nt(yt[$],$,(0,dt.default)(jt))}function Ge(yt,nt,Nt){return(0,lt.default)(yt,Infinity,nt,Nt)}function $e(yt,nt,Nt){var $=(0,xe.default)(yt)?ce:Ge;return $(yt,(0,w.default)(nt),Nt)}be.default=(0,I.default)($e,3),At.exports=be.default});Z(Q);var H=D(function(At,be){Object.defineProperty(be,"__esModule",{value:!0}),be.default=Pe;var xe=lt(Q),Ve=lt(Je);function lt(dt){return dt&&dt.__esModule?dt:{default:dt}}function Pe(dt,w){return(0,Ve.default)(xe.default,dt,w)}At.exports=be.default}),Ce=Z(H),Ee=function(){function At(){for(var be=arguments,xe=[],Ve=0;Ve<arguments.length;Ve++)xe[Ve]=be[Ve];this.tasks=[]}return At.prototype.promise=function(){for(var be=arguments,xe=[],Ve=0;Ve<arguments.length;Ve++)xe[Ve]=be[Ve];return Ce(this.tasks)},At.prototype.tapPromise=function(be,xe){var Ve=this;this.tasks.push(function(lt){return m(Ve,void 0,void 0,function(){return X(this,function(Pe){switch(Pe.label){case 0:return[4,xe()];case 1:return Pe.sent(),lt(null,be),[2]}})})})},At}(),Ae=D(function(At,be){Object.defineProperty(be,"__esModule",{value:!0});var xe=dt(Et),Ve=dt(ke),lt=dt(pt),Pe=dt(gt);function dt(I){return I&&I.__esModule?I:{default:I}}function w(I,q){if(q=(0,xe.default)(q),!Array.isArray(I))return q(new Error("First argument to waterfall must be an array of functions"));if(!I.length)return q();var ce=0;function Ge(yt){var nt=(0,lt.default)(I[ce++]);nt.apply(void 0,yt.concat([(0,Ve.default)($e)]))}function $e(yt){for(var nt=[],Nt=arguments.length-1;Nt-- >0;)nt[Nt]=arguments[Nt+1];if(yt===!1)return;if(yt||ce===I.length)return q.apply(void 0,[yt].concat(nt));Ge(nt)}Ge([])}be.default=(0,Pe.default)(w),At.exports=be.default}),ge=Z(Ae),rt=function(){function At(){for(var be=arguments,xe=[],Ve=0;Ve<arguments.length;Ve++)xe[Ve]=be[Ve];this.tasks=[]}return At.prototype.call=function(){for(var be=arguments,xe=[],Ve=0;Ve<arguments.length;Ve++)xe[Ve]=be[Ve];return ge(this.tasks)},At.prototype.tap=function(be,xe){this.tasks.length===0?this.tasks.push(function(Ve){var lt=xe();Ve(lt?null:!1,lt)}):this.tasks.push(function(Ve,lt){var Pe=xe();lt(Pe?null:!1,be)})},At}(),Yt=function(){function At(){for(var be=arguments,xe=[],Ve=0;Ve<arguments.length;Ve++)xe[Ve]=be[Ve];this.tasks=[]}return At.prototype.call=function(){for(var be=arguments,xe=[],Ve=0;Ve<arguments.length;Ve++)xe[Ve]=be[Ve];return ir(this.tasks)},At.prototype.tap=function(be,xe){this.tasks.push(function(Ve){var lt=xe();Ve(lt,be)})},At}()}).call(this,i("Q2Ig"))},yG8O:function(Re,E){function i(T,m,X,z){if(!X)return;Object.defineProperty(T,m,{enumerable:X.enumerable,configurable:X.configurable,writable:X.writable,value:X.initializer?X.initializer.call(z):void 0})}Re.exports=i},yHx3:function(Re,E){var i=Object.prototype,T=i.hasOwnProperty;function m(X){var z=X.length,o=new X.constructor(z);return z&&typeof X[0]=="string"&&T.call(X,"index")&&(o.index=X.index,o.input=X.input),o}Re.exports=m},yLV6:function(Re,E,i){var T;/*! Hammer.JS - v2.0.7 - 2016-04-22
* http://hammerjs.github.io/
*
* Copyright (c) 2016 Jorik Tangelder;
* Licensed under the MIT license */(function(m,X,z,o){"use strict";var Z=["","webkit","Moz","MS","ms","o"],D=X.createElement("div"),K="function",re=Math.round,de=Math.abs,Y=Date.now;function Fe(Ut,Ie,Mt){return setTimeout(gt(Ut,Mt),Ie)}function Ze(Ut,Ie,Mt){return Array.isArray(Ut)?(ye(Ut,Mt[Ie],Mt),!0):!1}function ye(Ut,Ie,Mt){var cr;if(!Ut)return;if(Ut.forEach)Ut.forEach(Ie,Mt);else if(Ut.length!==o)for(cr=0;cr<Ut.length;)Ie.call(Mt,Ut[cr],cr,Ut),cr++;else for(cr in Ut)Ut.hasOwnProperty(cr)&&Ie.call(Mt,Ut[cr],cr,Ut)}function we(Ut,Ie,Mt){var cr="DEPRECATED METHOD: "+Ie+`
`+Mt+` AT 
`;return function(){var en=new Error("get-stack-trace"),bn=en&&en.stack?en.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",jn=m.console&&(m.console.warn||m.console.log);return jn&&jn.call(m.console,cr,bn),Ut.apply(this,arguments)}}var pt;typeof Object.assign!="function"?pt=function(Ie){if(Ie===o||Ie===null)throw new TypeError("Cannot convert undefined or null to object");for(var Mt=Object(Ie),cr=1;cr<arguments.length;cr++){var en=arguments[cr];if(en!==o&&en!==null)for(var bn in en)en.hasOwnProperty(bn)&&(Mt[bn]=en[bn])}return Mt}:pt=Object.assign;var je=we(function(Ie,Mt,cr){for(var en=Object.keys(Mt),bn=0;bn<en.length;)(!cr||cr&&Ie[en[bn]]===o)&&(Ie[en[bn]]=Mt[en[bn]]),bn++;return Ie},"extend","Use `assign`."),Tt=we(function(Ie,Mt){return je(Ie,Mt,!0)},"merge","Use `assign`.");function Xe(Ut,Ie,Mt){var cr=Ie.prototype,en;en=Ut.prototype=Object.create(cr),en.constructor=Ut,en._super=cr,Mt&&pt(en,Mt)}function gt(Ut,Ie){return function(){return Ut.apply(Ie,arguments)}}function Je(Ut,Ie){return typeof Ut==K?Ut.apply(Ie&&Ie[0]||o,Ie):Ut}function Et(Ut,Ie){return Ut===o?Ie:Ut}function _t(Ut,Ie,Mt){ye(st(Ie),function(cr){Ut.addEventListener(cr,Mt,!1)})}function Ne(Ut,Ie,Mt){ye(st(Ie),function(cr){Ut.removeEventListener(cr,Mt,!1)})}function ke(Ut,Ie){for(;Ut;){if(Ut==Ie)return!0;Ut=Ut.parentNode}return!1}function Ue(Ut,Ie){return Ut.indexOf(Ie)>-1}function st(Ut){return Ut.trim().split(/\s+/g)}function Le(Ut,Ie,Mt){if(Ut.indexOf&&!Mt)return Ut.indexOf(Ie);for(var cr=0;cr<Ut.length;){if(Mt&&Ut[cr][Mt]==Ie||!Mt&&Ut[cr]===Ie)return cr;cr++}return-1}function ut(Ut){return Array.prototype.slice.call(Ut,0)}function Vt(Ut,Ie,Mt){for(var cr=[],en=[],bn=0;bn<Ut.length;){var jn=Ie?Ut[bn][Ie]:Ut[bn];Le(en,jn)<0&&cr.push(Ut[bn]),en[bn]=jn,bn++}return Mt&&(Ie?cr=cr.sort(function(qi,Mo){return qi[Ie]>Mo[Ie]}):cr=cr.sort()),cr}function Zt(Ut,Ie){for(var Mt,cr,en=Ie[0].toUpperCase()+Ie.slice(1),bn=0;bn<Z.length;){if(Mt=Z[bn],cr=Mt?Mt+en:Ie,cr in Ut)return cr;bn++}return o}var ir=1;function oe(){return ir++}function Q(Ut){var Ie=Ut.ownerDocument||Ut;return Ie.defaultView||Ie.parentWindow||m}var H=/mobile|tablet|ip(ad|hone|od)|android/i,Ce="ontouchstart"in m,Ee=Zt(m,"PointerEvent")!==o,Ae=Ce&&H.test(navigator.userAgent),ge="touch",rt="pen",Yt="mouse",At="kinect",be=25,xe=1,Ve=2,lt=4,Pe=8,dt=1,w=2,I=4,q=8,ce=16,Ge=w|I,$e=q|ce,yt=Ge|$e,nt=["x","y"],Nt=["clientX","clientY"];function $(Ut,Ie){var Mt=this;this.manager=Ut,this.callback=Ie,this.element=Ut.element,this.target=Ut.options.inputTarget,this.domHandler=function(cr){Je(Ut.options.enable,[Ut])&&Mt.handler(cr)},this.init()}$.prototype={handler:function(){},init:function(){this.evEl&&_t(this.element,this.evEl,this.domHandler),this.evTarget&&_t(this.target,this.evTarget,this.domHandler),this.evWin&&_t(Q(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&Ne(this.element,this.evEl,this.domHandler),this.evTarget&&Ne(this.target,this.evTarget,this.domHandler),this.evWin&&Ne(Q(this.element),this.evWin,this.domHandler)}};function Ke(Ut){var Ie,Mt=Ut.options.inputClass;return Mt?Ie=Mt:Ee?Ie=Hn:Ae?Ie=ht:Ce?Ie=qr:Ie=Nn,new Ie(Ut,ae)}function ae(Ut,Ie,Mt){var cr=Mt.pointers.length,en=Mt.changedPointers.length,bn=Ie&xe&&cr-en===0,jn=Ie&(lt|Pe)&&cr-en===0;Mt.isFirst=!!bn,Mt.isFinal=!!jn,bn&&(Ut.session={}),Mt.eventType=Ie,et(Ut,Mt),Ut.emit("hammer.input",Mt),Ut.recognize(Mt),Ut.session.prevInput=Mt}function et(Ut,Ie){var Mt=Ut.session,cr=Ie.pointers,en=cr.length;Mt.firstInput||(Mt.firstInput=ft(Ie)),en>1&&!Mt.firstMultiple?Mt.firstMultiple=ft(Ie):en===1&&(Mt.firstMultiple=!1);var bn=Mt.firstInput,jn=Mt.firstMultiple,Fi=jn?jn.center:bn.center,qi=Ie.center=mt(cr);Ie.timeStamp=Y(),Ie.deltaTime=Ie.timeStamp-bn.timeStamp,Ie.angle=ct(Fi,qi),Ie.distance=Oe(Fi,qi),jt(Mt,Ie),Ie.offsetDirection=vt(Ie.deltaX,Ie.deltaY);var Mo=Ct(Ie.deltaTime,Ie.deltaX,Ie.deltaY);Ie.overallVelocityX=Mo.x,Ie.overallVelocityY=Mo.y,Ie.overallVelocity=de(Mo.x)>de(Mo.y)?Mo.x:Mo.y,Ie.scale=jn?Ft(jn.pointers,cr):1,Ie.rotation=jn?Qe(jn.pointers,cr):0,Ie.maxPointers=Mt.prevInput?Ie.pointers.length>Mt.prevInput.maxPointers?Ie.pointers.length:Mt.prevInput.maxPointers:Ie.pointers.length,sr(Mt,Ie);var To=Ut.element;ke(Ie.srcEvent.target,To)&&(To=Ie.srcEvent.target),Ie.target=To}function jt(Ut,Ie){var Mt=Ie.center,cr=Ut.offsetDelta||{},en=Ut.prevDelta||{},bn=Ut.prevInput||{};(Ie.eventType===xe||bn.eventType===lt)&&(en=Ut.prevDelta={x:bn.deltaX||0,y:bn.deltaY||0},cr=Ut.offsetDelta={x:Mt.x,y:Mt.y}),Ie.deltaX=en.x+(Mt.x-cr.x),Ie.deltaY=en.y+(Mt.y-cr.y)}function sr(Ut,Ie){var Mt=Ut.lastInterval||Ie,cr=Ie.timeStamp-Mt.timeStamp,en,bn,jn,Fi;if(Ie.eventType!=Pe&&(cr>be||Mt.velocity===o)){var qi=Ie.deltaX-Mt.deltaX,Mo=Ie.deltaY-Mt.deltaY,To=Ct(cr,qi,Mo);bn=To.x,jn=To.y,en=de(To.x)>de(To.y)?To.x:To.y,Fi=vt(qi,Mo),Ut.lastInterval=Ie}else en=Mt.velocity,bn=Mt.velocityX,jn=Mt.velocityY,Fi=Mt.direction;Ie.velocity=en,Ie.velocityX=bn,Ie.velocityY=jn,Ie.direction=Fi}function ft(Ut){for(var Ie=[],Mt=0;Mt<Ut.pointers.length;)Ie[Mt]={clientX:re(Ut.pointers[Mt].clientX),clientY:re(Ut.pointers[Mt].clientY)},Mt++;return{timeStamp:Y(),pointers:Ie,center:mt(Ie),deltaX:Ut.deltaX,deltaY:Ut.deltaY}}function mt(Ut){var Ie=Ut.length;if(Ie===1)return{x:re(Ut[0].clientX),y:re(Ut[0].clientY)};for(var Mt=0,cr=0,en=0;en<Ie;)Mt+=Ut[en].clientX,cr+=Ut[en].clientY,en++;return{x:re(Mt/Ie),y:re(cr/Ie)}}function Ct(Ut,Ie,Mt){return{x:Ie/Ut||0,y:Mt/Ut||0}}function vt(Ut,Ie){return Ut===Ie?dt:de(Ut)>=de(Ie)?Ut<0?w:I:Ie<0?q:ce}function Oe(Ut,Ie,Mt){Mt||(Mt=nt);var cr=Ie[Mt[0]]-Ut[Mt[0]],en=Ie[Mt[1]]-Ut[Mt[1]];return Math.sqrt(cr*cr+en*en)}function ct(Ut,Ie,Mt){Mt||(Mt=nt);var cr=Ie[Mt[0]]-Ut[Mt[0]],en=Ie[Mt[1]]-Ut[Mt[1]];return Math.atan2(en,cr)*180/Math.PI}function Qe(Ut,Ie){return ct(Ie[1],Ie[0],Nt)+ct(Ut[1],Ut[0],Nt)}function Ft(Ut,Ie){return Oe(Ie[0],Ie[1],Nt)/Oe(Ut[0],Ut[1],Nt)}var vr={mousedown:xe,mousemove:Ve,mouseup:lt},Vr="mousedown",lr="mousemove mouseup";function Nn(){this.evEl=Vr,this.evWin=lr,this.pressed=!1,$.apply(this,arguments)}Xe(Nn,$,{handler:function(Ie){var Mt=vr[Ie.type];if(Mt&xe&&Ie.button===0&&(this.pressed=!0),Mt&Ve&&Ie.which!==1&&(Mt=lt),!this.pressed)return;Mt&lt&&(this.pressed=!1),this.callback(this.manager,Mt,{pointers:[Ie],changedPointers:[Ie],pointerType:Yt,srcEvent:Ie})}});var vn={pointerdown:xe,pointermove:Ve,pointerup:lt,pointercancel:Pe,pointerout:Pe},na={2:ge,3:rt,4:Yt,5:At},ha="pointerdown",Zn="pointermove pointerup pointercancel";m.MSPointerEvent&&!m.PointerEvent&&(ha="MSPointerDown",Zn="MSPointerMove MSPointerUp MSPointerCancel");function Hn(){this.evEl=ha,this.evWin=Zn,$.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}Xe(Hn,$,{handler:function(Ie){var Mt=this.store,cr=!1,en=Ie.type.toLowerCase().replace("ms",""),bn=vn[en],jn=na[Ie.pointerType]||Ie.pointerType,Fi=jn==ge,qi=Le(Mt,Ie.pointerId,"pointerId");if(bn&xe&&(Ie.button===0||Fi)?qi<0&&(Mt.push(Ie),qi=Mt.length-1):bn&(lt|Pe)&&(cr=!0),qi<0)return;Mt[qi]=Ie,this.callback(this.manager,bn,{pointers:Mt,changedPointers:[Ie],pointerType:jn,srcEvent:Ie}),cr&&Mt.splice(qi,1)}});var F={touchstart:xe,touchmove:Ve,touchend:lt,touchcancel:Pe},W="touchstart",le="touchstart touchmove touchend touchcancel";function me(){this.evTarget=W,this.evWin=le,this.started=!1,$.apply(this,arguments)}Xe(me,$,{handler:function(Ie){var Mt=F[Ie.type];if(Mt===xe&&(this.started=!0),!this.started)return;var cr=at.call(this,Ie,Mt);Mt&(lt|Pe)&&cr[0].length-cr[1].length===0&&(this.started=!1),this.callback(this.manager,Mt,{pointers:cr[0],changedPointers:cr[1],pointerType:ge,srcEvent:Ie})}});function at(Ut,Ie){var Mt=ut(Ut.touches),cr=ut(Ut.changedTouches);return Ie&(lt|Pe)&&(Mt=Vt(Mt.concat(cr),"identifier",!0)),[Mt,cr]}var bt={touchstart:xe,touchmove:Ve,touchend:lt,touchcancel:Pe},He="touchstart touchmove touchend touchcancel";function ht(){this.evTarget=He,this.targetIds={},$.apply(this,arguments)}Xe(ht,$,{handler:function(Ie){var Mt=bt[Ie.type],cr=Qt.call(this,Ie,Mt);if(!cr)return;this.callback(this.manager,Mt,{pointers:cr[0],changedPointers:cr[1],pointerType:ge,srcEvent:Ie})}});function Qt(Ut,Ie){var Mt=ut(Ut.touches),cr=this.targetIds;if(Ie&(xe|Ve)&&Mt.length===1)return cr[Mt[0].identifier]=!0,[Mt,Mt];var en,bn,jn=ut(Ut.changedTouches),Fi=[],qi=this.target;if(bn=Mt.filter(function(Mo){return ke(Mo.target,qi)}),Ie===xe)for(en=0;en<bn.length;)cr[bn[en].identifier]=!0,en++;for(en=0;en<jn.length;)cr[jn[en].identifier]&&Fi.push(jn[en]),Ie&(lt|Pe)&&delete cr[jn[en].identifier],en++;return Fi.length?[Vt(bn.concat(Fi),"identifier",!0),Fi]:void 0}var qt=2500,Nr=25;function qr(){$.apply(this,arguments);var Ut=gt(this.handler,this);this.touch=new ht(this.manager,Ut),this.mouse=new Nn(this.manager,Ut),this.primaryTouch=null,this.lastTouches=[]}Xe(qr,$,{handler:function(Ie,Mt,cr){var en=cr.pointerType==ge,bn=cr.pointerType==Yt;if(bn&&cr.sourceCapabilities&&cr.sourceCapabilities.firesTouchEvents)return;if(en)or.call(this,Mt,cr);else if(bn&&Tn.call(this,cr))return;this.callback(Ie,Mt,cr)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function or(Ut,Ie){Ut&xe?(this.primaryTouch=Ie.changedPointers[0].identifier,Br.call(this,Ie)):Ut&(lt|Pe)&&Br.call(this,Ie)}function Br(Ut){var Ie=Ut.changedPointers[0];if(Ie.identifier===this.primaryTouch){var Mt={x:Ie.clientX,y:Ie.clientY};this.lastTouches.push(Mt);var cr=this.lastTouches,en=function(){var jn=cr.indexOf(Mt);jn>-1&&cr.splice(jn,1)};setTimeout(en,qt)}}function Tn(Ut){for(var Ie=Ut.srcEvent.clientX,Mt=Ut.srcEvent.clientY,cr=0;cr<this.lastTouches.length;cr++){var en=this.lastTouches[cr],bn=Math.abs(Ie-en.x),jn=Math.abs(Mt-en.y);if(bn<=Nr&&jn<=Nr)return!0}return!1}var dr=Zt(D.style,"touchAction"),Xr=dr!==o,dn="compute",Kn="auto",gn="manipulation",ur="none",kn="pan-x",An="pan-y",Za=bo();function ea(Ut,Ie){this.manager=Ut,this.set(Ie)}ea.prototype={set:function(Ie){Ie==dn&&(Ie=this.compute()),Xr&&this.manager.element.style&&Za[Ie]&&(this.manager.element.style[dr]=Ie),this.actions=Ie.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var Ie=[];return ye(this.manager.recognizers,function(Mt){Je(Mt.options.enable,[Mt])&&(Ie=Ie.concat(Mt.getTouchAction()))}),ca(Ie.join(" "))},preventDefaults:function(Ie){var Mt=Ie.srcEvent,cr=Ie.offsetDirection;if(this.manager.session.prevented){Mt.preventDefault();return}var en=this.actions,bn=Ue(en,ur)&&!Za[ur],jn=Ue(en,An)&&!Za[An],Fi=Ue(en,kn)&&!Za[kn];if(bn){var qi=Ie.pointers.length===1,Mo=Ie.distance<2,To=Ie.deltaTime<250;if(qi&&Mo&&To)return}if(Fi&&jn)return;if(bn||jn&&cr&Ge||Fi&&cr&$e)return this.preventSrc(Mt)},preventSrc:function(Ie){this.manager.session.prevented=!0,Ie.preventDefault()}};function ca(Ut){if(Ue(Ut,ur))return ur;var Ie=Ue(Ut,kn),Mt=Ue(Ut,An);return Ie&&Mt?ur:Ie||Mt?Ie?kn:An:Ue(Ut,gn)?gn:Kn}function bo(){if(!Xr)return!1;var Ut={},Ie=m.CSS&&m.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Mt){Ut[Mt]=Ie?m.CSS.supports("touch-action",Mt):!0}),Ut}var Ri=1,va=2,ii=4,Ia=8,Ln=Ia,Ei=16,Wi=32;function qa(Ut){this.options=pt({},this.defaults,Ut||{}),this.id=oe(),this.manager=null,this.options.enable=Et(this.options.enable,!0),this.state=Ri,this.simultaneous={},this.requireFail=[]}qa.prototype={defaults:{},set:function(Ie){return pt(this.options,Ie),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(Ie){if(Ze(Ie,"recognizeWith",this))return this;var Mt=this.simultaneous;return Ie=cu(Ie,this),Mt[Ie.id]||(Mt[Ie.id]=Ie,Ie.recognizeWith(this)),this},dropRecognizeWith:function(Ie){return Ze(Ie,"dropRecognizeWith",this)?this:(Ie=cu(Ie,this),delete this.simultaneous[Ie.id],this)},requireFailure:function(Ie){if(Ze(Ie,"requireFailure",this))return this;var Mt=this.requireFail;return Ie=cu(Ie,this),Le(Mt,Ie)===-1&&(Mt.push(Ie),Ie.requireFailure(this)),this},dropRequireFailure:function(Ie){if(Ze(Ie,"dropRequireFailure",this))return this;Ie=cu(Ie,this);var Mt=Le(this.requireFail,Ie);return Mt>-1&&this.requireFail.splice(Mt,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(Ie){return!!this.simultaneous[Ie.id]},emit:function(Ie){var Mt=this,cr=this.state;function en(bn){Mt.manager.emit(bn,Ie)}cr<Ia&&en(Mt.options.event+Oo(cr)),en(Mt.options.event),Ie.additionalEvent&&en(Ie.additionalEvent),cr>=Ia&&en(Mt.options.event+Oo(cr))},tryEmit:function(Ie){if(this.canEmit())return this.emit(Ie);this.state=Wi},canEmit:function(){for(var Ie=0;Ie<this.requireFail.length;){if(!(this.requireFail[Ie].state&(Wi|Ri)))return!1;Ie++}return!0},recognize:function(Ie){var Mt=pt({},Ie);if(!Je(this.options.enable,[this,Mt])){this.reset(),this.state=Wi;return}this.state&(Ln|Ei|Wi)&&(this.state=Ri),this.state=this.process(Mt),this.state&(va|ii|Ia|Ei)&&this.tryEmit(Mt)},process:function(Ie){},getTouchAction:function(){},reset:function(){}};function Oo(Ut){return Ut&Ei?"cancel":Ut&Ia?"end":Ut&ii?"move":Ut&va?"start":""}function Ml(Ut){return Ut==ce?"down":Ut==q?"up":Ut==w?"left":Ut==I?"right":""}function cu(Ut,Ie){var Mt=Ie.manager;return Mt?Mt.get(Ut):Ut}function fa(){qa.apply(this,arguments)}Xe(fa,qa,{defaults:{pointers:1},attrTest:function(Ie){var Mt=this.options.pointers;return Mt===0||Ie.pointers.length===Mt},process:function(Ie){var Mt=this.state,cr=Ie.eventType,en=Mt&(va|ii),bn=this.attrTest(Ie);return en&&(cr&Pe||!bn)?Mt|Ei:en||bn?cr&lt?Mt|Ia:Mt&va?Mt|ii:va:Wi}});function Cs(){fa.apply(this,arguments),this.pX=null,this.pY=null}Xe(Cs,fa,{defaults:{event:"pan",threshold:10,pointers:1,direction:yt},getTouchAction:function(){var Ie=this.options.direction,Mt=[];return Ie&Ge&&Mt.push(An),Ie&$e&&Mt.push(kn),Mt},directionTest:function(Ie){var Mt=this.options,cr=!0,en=Ie.distance,bn=Ie.direction,jn=Ie.deltaX,Fi=Ie.deltaY;return bn&Mt.direction||(Mt.direction&Ge?(bn=jn===0?dt:jn<0?w:I,cr=jn!=this.pX,en=Math.abs(Ie.deltaX)):(bn=Fi===0?dt:Fi<0?q:ce,cr=Fi!=this.pY,en=Math.abs(Ie.deltaY))),Ie.direction=bn,cr&&en>Mt.threshold&&bn&Mt.direction},attrTest:function(Ie){return fa.prototype.attrTest.call(this,Ie)&&(this.state&va||!(this.state&va)&&this.directionTest(Ie))},emit:function(Ie){this.pX=Ie.deltaX,this.pY=Ie.deltaY;var Mt=Ml(Ie.direction);Mt&&(Ie.additionalEvent=this.options.event+Mt),this._super.emit.call(this,Ie)}});function oo(){fa.apply(this,arguments)}Xe(oo,fa,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ur]},attrTest:function(Ie){return this._super.attrTest.call(this,Ie)&&(Math.abs(Ie.scale-1)>this.options.threshold||this.state&va)},emit:function(Ie){if(Ie.scale!==1){var Mt=Ie.scale<1?"in":"out";Ie.additionalEvent=this.options.event+Mt}this._super.emit.call(this,Ie)}});function Na(){qa.apply(this,arguments),this._timer=null,this._input=null}Xe(Na,qa,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Kn]},process:function(Ie){var Mt=this.options,cr=Ie.pointers.length===Mt.pointers,en=Ie.distance<Mt.threshold,bn=Ie.deltaTime>Mt.time;if(this._input=Ie,!en||!cr||Ie.eventType&(lt|Pe)&&!bn)this.reset();else if(Ie.eventType&xe)this.reset(),this._timer=Fe(function(){this.state=Ln,this.tryEmit()},Mt.time,this);else if(Ie.eventType&lt)return Ln;return Wi},reset:function(){clearTimeout(this._timer)},emit:function(Ie){if(this.state!==Ln)return;Ie&&Ie.eventType&lt?this.manager.emit(this.options.event+"up",Ie):(this._input.timeStamp=Y(),this.manager.emit(this.options.event,this._input))}});function Fu(){fa.apply(this,arguments)}Xe(Fu,fa,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ur]},attrTest:function(Ie){return this._super.attrTest.call(this,Ie)&&(Math.abs(Ie.rotation)>this.options.threshold||this.state&va)}});function Ai(){fa.apply(this,arguments)}Xe(Ai,fa,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Ge|$e,pointers:1},getTouchAction:function(){return Cs.prototype.getTouchAction.call(this)},attrTest:function(Ie){var Mt=this.options.direction,cr;return Mt&(Ge|$e)?cr=Ie.overallVelocity:Mt&Ge?cr=Ie.overallVelocityX:Mt&$e&&(cr=Ie.overallVelocityY),this._super.attrTest.call(this,Ie)&&Mt&Ie.offsetDirection&&Ie.distance>this.options.threshold&&Ie.maxPointers==this.options.pointers&&de(cr)>this.options.velocity&&Ie.eventType&lt},emit:function(Ie){var Mt=Ml(Ie.offsetDirection);Mt&&this.manager.emit(this.options.event+Mt,Ie),this.manager.emit(this.options.event,Ie)}});function li(){qa.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}Xe(li,qa,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[gn]},process:function(Ie){var Mt=this.options,cr=Ie.pointers.length===Mt.pointers,en=Ie.distance<Mt.threshold,bn=Ie.deltaTime<Mt.time;if(this.reset(),Ie.eventType&xe&&this.count===0)return this.failTimeout();if(en&&bn&&cr){if(Ie.eventType!=lt)return this.failTimeout();var jn=this.pTime?Ie.timeStamp-this.pTime<Mt.interval:!0,Fi=!this.pCenter||Oe(this.pCenter,Ie.center)<Mt.posThreshold;this.pTime=Ie.timeStamp,this.pCenter=Ie.center,!Fi||!jn?this.count=1:this.count+=1,this._input=Ie;var qi=this.count%Mt.taps;if(qi===0)return this.hasRequireFailures()?(this._timer=Fe(function(){this.state=Ln,this.tryEmit()},Mt.interval,this),va):Ln}return Wi},failTimeout:function(){return this._timer=Fe(function(){this.state=Wi},this.options.interval,this),Wi},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Ln&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function xo(Ut,Ie){return Ie=Ie||{},Ie.recognizers=Et(Ie.recognizers,xo.defaults.preset),new Uu(Ut,Ie)}xo.VERSION="2.0.7",xo.defaults={domEvents:!1,touchAction:dn,enable:!0,inputTarget:null,inputClass:null,preset:[[Fu,{enable:!1}],[oo,{enable:!1},["rotate"]],[Ai,{direction:Ge}],[Cs,{direction:Ge},["swipe"]],[li],[li,{event:"doubletap",taps:2},["tap"]],[Na]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var ms=1,so=2;function Uu(Ut,Ie){this.options=pt({},xo.defaults,Ie||{}),this.options.inputTarget=this.options.inputTarget||Ut,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=Ut,this.input=Ke(this),this.touchAction=new ea(this,this.options.touchAction),Ys(this,!0),ye(this.options.recognizers,function(Mt){var cr=this.add(new Mt[0](Mt[1]));Mt[2]&&cr.recognizeWith(Mt[2]),Mt[3]&&cr.requireFailure(Mt[3])},this)}Uu.prototype={set:function(Ie){return pt(this.options,Ie),Ie.touchAction&&this.touchAction.update(),Ie.inputTarget&&(this.input.destroy(),this.input.target=Ie.inputTarget,this.input.init()),this},stop:function(Ie){this.session.stopped=Ie?so:ms},recognize:function(Ie){var Mt=this.session;if(Mt.stopped)return;this.touchAction.preventDefaults(Ie);var cr,en=this.recognizers,bn=Mt.curRecognizer;(!bn||bn&&bn.state&Ln)&&(bn=Mt.curRecognizer=null);for(var jn=0;jn<en.length;)cr=en[jn],Mt.stopped!==so&&(!bn||cr==bn||cr.canRecognizeWith(bn))?cr.recognize(Ie):cr.reset(),!bn&&cr.state&(va|ii|Ia)&&(bn=Mt.curRecognizer=cr),jn++},get:function(Ie){if(Ie instanceof qa)return Ie;for(var Mt=this.recognizers,cr=0;cr<Mt.length;cr++)if(Mt[cr].options.event==Ie)return Mt[cr];return null},add:function(Ie){if(Ze(Ie,"add",this))return this;var Mt=this.get(Ie.options.event);return Mt&&this.remove(Mt),this.recognizers.push(Ie),Ie.manager=this,this.touchAction.update(),Ie},remove:function(Ie){if(Ze(Ie,"remove",this))return this;if(Ie=this.get(Ie),Ie){var Mt=this.recognizers,cr=Le(Mt,Ie);cr!==-1&&(Mt.splice(cr,1),this.touchAction.update())}return this},on:function(Ie,Mt){if(Ie===o)return;if(Mt===o)return;var cr=this.handlers;return ye(st(Ie),function(en){cr[en]=cr[en]||[],cr[en].push(Mt)}),this},off:function(Ie,Mt){if(Ie===o)return;var cr=this.handlers;return ye(st(Ie),function(en){Mt?cr[en]&&cr[en].splice(Le(cr[en],Mt),1):delete cr[en]}),this},emit:function(Ie,Mt){this.options.domEvents&&Eo(Ie,Mt);var cr=this.handlers[Ie]&&this.handlers[Ie].slice();if(!cr||!cr.length)return;Mt.type=Ie,Mt.preventDefault=function(){Mt.srcEvent.preventDefault()};for(var en=0;en<cr.length;)cr[en](Mt),en++},destroy:function(){this.element&&Ys(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Ys(Ut,Ie){var Mt=Ut.element;if(!Mt.style)return;var cr;ye(Ut.options.cssProps,function(en,bn){cr=Zt(Mt.style,bn),Ie?(Ut.oldCssProps[cr]=Mt.style[cr],Mt.style[cr]=en):Mt.style[cr]=Ut.oldCssProps[cr]||""}),Ie||(Ut.oldCssProps={})}function Eo(Ut,Ie){var Mt=X.createEvent("Event");Mt.initEvent(Ut,!0,!0),Mt.gesture=Ie,Ie.target.dispatchEvent(Mt)}pt(xo,{INPUT_START:xe,INPUT_MOVE:Ve,INPUT_END:lt,INPUT_CANCEL:Pe,STATE_POSSIBLE:Ri,STATE_BEGAN:va,STATE_CHANGED:ii,STATE_ENDED:Ia,STATE_RECOGNIZED:Ln,STATE_CANCELLED:Ei,STATE_FAILED:Wi,DIRECTION_NONE:dt,DIRECTION_LEFT:w,DIRECTION_RIGHT:I,DIRECTION_UP:q,DIRECTION_DOWN:ce,DIRECTION_HORIZONTAL:Ge,DIRECTION_VERTICAL:$e,DIRECTION_ALL:yt,Manager:Uu,Input:$,TouchAction:ea,TouchInput:ht,MouseInput:Nn,PointerEventInput:Hn,TouchMouseInput:qr,SingleTouchInput:me,Recognizer:qa,AttrRecognizer:fa,Tap:li,Pan:Cs,Swipe:Ai,Pinch:oo,Rotate:Fu,Press:Na,on:_t,off:Ne,each:ye,merge:Tt,extend:je,assign:pt,inherit:Xe,bindFn:gt,prefixed:Zt});var fu=typeof m!="undefined"?m:typeof self!="undefined"?self:{};fu.Hammer=xo,!(T=function(){return xo}.call(E,i,E,Re),T!==o&&(Re.exports=T))})(window,document,"Hammer")},yMAV:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=function(){function m(X,z){this.parentContext=X,this.rootRequest=z}return m}();E.Plan=T},yP5f:function(Re,E,i){var T=i("+K+b");function m(X,z){var o=z?T(X.buffer):X.buffer;return new X.constructor(o,X.byteOffset,X.length)}Re.exports=m},yU0y:function(Re,E,i){"use strict";i.d(E,"b",function(){return T}),i.d(E,"a",function(){return m}),i.d(E,"c",function(){return X});var T=1e-6,m=typeof Float32Array!="undefined"?Float32Array:Array,X=Math.random;function z(K){m=K}var o=Math.PI/180;function Z(K){return K*o}function D(K,re){return Math.abs(K-re)<=T*Math.max(1,Math.abs(K),Math.abs(re))}Math.hypot||(Math.hypot=function(){for(var K=0,re=arguments.length;re--;)K+=arguments[re]*arguments[re];return Math.sqrt(K)})},yXPU:function(Re,E){function i(m,X,z,o,Z,D,K){try{var re=m[D](K),de=re.value}catch(Y){z(Y);return}re.done?X(de):Promise.resolve(de).then(o,Z)}function T(m){return function(){var X=this,z=arguments;return new Promise(function(o,Z){var D=m.apply(X,z);function K(de){i(D,o,Z,K,re,"next",de)}function re(de){i(D,o,Z,K,re,"throw",de)}K(void 0)})}}Re.exports=T},ycre:function(Re,E,i){var T=i("711d"),m=T("length");Re.exports=m},z4Hk:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=i("406g"),m=i("RR/i"),X=function(){function z(o){this._binding=o}return z.prototype.when=function(o){return this._binding.constraint=o,new T.BindingOnSyntax(this._binding)},z.prototype.whenTargetNamed=function(o){return this._binding.constraint=m.namedConstraint(o),new T.BindingOnSyntax(this._binding)},z.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(o){var Z=o.target!==null&&!o.target.isNamed()&&!o.target.isTagged();return Z},new T.BindingOnSyntax(this._binding)},z.prototype.whenTargetTagged=function(o,Z){return this._binding.constraint=m.taggedConstraint(o)(Z),new T.BindingOnSyntax(this._binding)},z.prototype.whenInjectedInto=function(o){return this._binding.constraint=function(Z){return m.typeConstraint(o)(Z.parentRequest)},new T.BindingOnSyntax(this._binding)},z.prototype.whenParentNamed=function(o){return this._binding.constraint=function(Z){return m.namedConstraint(o)(Z.parentRequest)},new T.BindingOnSyntax(this._binding)},z.prototype.whenParentTagged=function(o,Z){return this._binding.constraint=function(D){return m.taggedConstraint(o)(Z)(D.parentRequest)},new T.BindingOnSyntax(this._binding)},z.prototype.whenAnyAncestorIs=function(o){return this._binding.constraint=function(Z){return m.traverseAncerstors(Z,m.typeConstraint(o))},new T.BindingOnSyntax(this._binding)},z.prototype.whenNoAncestorIs=function(o){return this._binding.constraint=function(Z){return!m.traverseAncerstors(Z,m.typeConstraint(o))},new T.BindingOnSyntax(this._binding)},z.prototype.whenAnyAncestorNamed=function(o){return this._binding.constraint=function(Z){return m.traverseAncerstors(Z,m.namedConstraint(o))},new T.BindingOnSyntax(this._binding)},z.prototype.whenNoAncestorNamed=function(o){return this._binding.constraint=function(Z){return!m.traverseAncerstors(Z,m.namedConstraint(o))},new T.BindingOnSyntax(this._binding)},z.prototype.whenAnyAncestorTagged=function(o,Z){return this._binding.constraint=function(D){return m.traverseAncerstors(D,m.taggedConstraint(o)(Z))},new T.BindingOnSyntax(this._binding)},z.prototype.whenNoAncestorTagged=function(o,Z){return this._binding.constraint=function(D){return!m.traverseAncerstors(D,m.taggedConstraint(o)(Z))},new T.BindingOnSyntax(this._binding)},z.prototype.whenAnyAncestorMatches=function(o){return this._binding.constraint=function(Z){return m.traverseAncerstors(Z,o)},new T.BindingOnSyntax(this._binding)},z.prototype.whenNoAncestorMatches=function(o){return this._binding.constraint=function(Z){return!m.traverseAncerstors(Z,o)},new T.BindingOnSyntax(this._binding)},z}();E.BindingWhenSyntax=X},zEVN:function(Re,E,i){var T=i("Gi0A"),m=i("sEf8"),X=i("mdPL"),z=X&&X.isMap,o=z?m(z):T;Re.exports=o},zZ0H:function(Re,E){function i(T){return T}Re.exports=i},zZPE:function(Re,E){var i="[object Object]";function T(Fe){var Ze=!1;if(Fe!=null&&typeof Fe.toString!="function")try{Ze=!!(Fe+"")}catch(ye){}return Ze}function m(Fe,Ze){return function(ye){return Fe(Ze(ye))}}var X=Function.prototype,z=Object.prototype,o=X.toString,Z=z.hasOwnProperty,D=o.call(Object),K=z.toString,re=m(Object.getPrototypeOf,Object);function de(Fe){return!!Fe&&typeof Fe=="object"}function Y(Fe){if(!de(Fe)||K.call(Fe)!=i||T(Fe))return!1;var Ze=re(Fe);if(Ze===null)return!0;var ye=Z.call(Ze,"constructor")&&Ze.constructor;return typeof ye=="function"&&ye instanceof ye&&o.call(ye)==D}Re.exports=Y},zoYe:function(Re,E,i){var T=i("nmnc"),m=i("eUgh"),X=i("Z0cm"),z=i("/9aa"),o=1/0,Z=T?T.prototype:void 0,D=Z?Z.toString:void 0;function K(re){if(typeof re=="string")return re;if(X(re))return m(re,K)+"";if(z(re))return D?D.call(re):"";var de=re+"";return de=="0"&&1/re==-o?"-0":de}Re.exports=K},zvhG:function(Re,E){Re.exports=i;function i(T,m,X,z){this.cx=3*T,this.bx=3*(X-T)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*m,this.by=3*(z-m)-this.cy,this.ay=1-this.cy-this.by,this.p1x=T,this.p1y=z,this.p2x=X,this.p2y=z}i.prototype.sampleCurveX=function(T){return((this.ax*T+this.bx)*T+this.cx)*T},i.prototype.sampleCurveY=function(T){return((this.ay*T+this.by)*T+this.cy)*T},i.prototype.sampleCurveDerivativeX=function(T){return(3*this.ax*T+2*this.bx)*T+this.cx},i.prototype.solveCurveX=function(T,m){typeof m=="undefined"&&(m=1e-6);var X,z,o,Z,D;for(o=T,D=0;D<8;D++){if(Z=this.sampleCurveX(o)-T,Math.abs(Z)<m)return o;var K=this.sampleCurveDerivativeX(o);if(Math.abs(K)<1e-6)break;o=o-Z/K}if(X=0,z=1,o=T,o<X)return X;if(o>z)return z;for(;X<z;){if(Z=this.sampleCurveX(o),Math.abs(Z-T)<m)return o;T>Z?X=o:z=o,o=(z-X)*.5+X}return o},i.prototype.solve=function(T,m){return this.sampleCurveY(this.solveCurveX(T,m))}},zxMA:function(Re,E,i){"use strict";Object.defineProperty(E,"__esModule",{value:!0});var T=function(){function m(X){this.str=X}return m.prototype.startsWith=function(X){return this.str.indexOf(X)===0},m.prototype.endsWith=function(X){var z="",o=X.split("").reverse().join("");return z=this.str.split("").reverse().join(""),this.startsWith.call({str:z},o)},m.prototype.contains=function(X){return this.str.indexOf(X)!==-1},m.prototype.equals=function(X){return this.str===X},m.prototype.value=function(){return this.str},m}();E.QueryableString=T}}]);
